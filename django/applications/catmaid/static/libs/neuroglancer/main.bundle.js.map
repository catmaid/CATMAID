{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/gl-matrix/esm/common.js","webpack:///./node_modules/gl-matrix/esm/mat3.js","webpack:///./node_modules/gl-matrix/esm/mat4.js","webpack:///./node_modules/gl-matrix/esm/vec3.js","webpack:///./node_modules/gl-matrix/esm/vec4.js","webpack:///./node_modules/gl-matrix/esm/quat.js","webpack:///./node_modules/gl-matrix/esm/vec2.js","webpack:///./src/neuroglancer/util/geom.ts","webpack:///./src/neuroglancer/util/json.ts","webpack:///./src/neuroglancer/util/disposable.ts","webpack:///./src/neuroglancer/util/signal.ts","webpack:///./src/neuroglancer/sliceview/volume/base.ts","webpack:///./src/neuroglancer/chunk_manager/base.ts","webpack:///./src/neuroglancer/annotation/index.ts","webpack:///./src/neuroglancer/util/event_action_map.ts","webpack:///./src/neuroglancer/util/hierarchical_map.ts","webpack:///./src/neuroglancer/worker_rpc.ts","webpack:///./src/neuroglancer/trackable_value.ts","webpack:///./src/neuroglancer/util/dom.ts","webpack:///./src/neuroglancer/chunk_manager/frontend.ts","webpack:///./src/neuroglancer/util/data_type.ts","webpack:///./node_modules/lodash/debounce.js","webpack:///./src/neuroglancer/util/cancellation.ts","webpack:///./node_modules/css-loader/dist/runtime/api.js","webpack:///./node_modules/style-loader/lib/addStyles.js","webpack:///./src/neuroglancer/util/uint64.ts","webpack:///./src/neuroglancer/trackable_boolean.ts","webpack:///./src/neuroglancer/webgl/buffer.ts","webpack:///./src/neuroglancer/util/signal_binding_updater.ts","webpack:///./src/neuroglancer/layer.ts","webpack:///./src/neuroglancer/webgl/texture_access.ts","webpack:///./src/neuroglancer/status.ts","webpack:///./src/neuroglancer/webgl/shader.ts","webpack:///./src/neuroglancer/util/http_request.ts","webpack:///./src/neuroglancer/visibility_priority/frontend.ts","webpack:///./src/neuroglancer/webgl/shader_lib.ts","webpack:///./src/neuroglancer/sliceview/chunk_layout.ts","webpack:///./src/neuroglancer/sliceview/base.ts","webpack:///./src/neuroglancer/util/compare.ts","webpack:///./src/neuroglancer/layer_specification.ts","webpack:///./src/neuroglancer/navigation_state.ts","webpack:///./src/neuroglancer/render_scale_statistics.ts","webpack:///./src/neuroglancer/widget/tab_view.ts","webpack:///./src/neuroglancer/annotation/type_handler.ts","webpack:///./src/neuroglancer/util/touch_bindings.ts","webpack:///./src/neuroglancer/util/wheel_zoom.ts","webpack:///./src/neuroglancer/rendered_data_panel.ts","webpack:///./src/neuroglancer/sliceview/volume/frontend.ts","webpack:///./src/neuroglancer/util/object_id.ts","webpack:///./src/neuroglancer/util/keyboard_bindings.ts","webpack:///./src/neuroglancer/util/completion.ts","webpack:///./src/neuroglancer/webgl/offscreen.ts","webpack:///./src/neuroglancer/segmentation_display_state/base.ts","webpack:///./src/neuroglancer/datasource/index.ts","webpack:///./src/neuroglancer/datasource/default_provider.ts","webpack:///./src/neuroglancer/util/array.ts","webpack:///./src/neuroglancer/mesh/multiscale.ts","webpack:///./src/neuroglancer/util/zorder.ts","webpack:///./src/neuroglancer/mesh/frontend.ts","webpack:///./src/neuroglancer/segmentation_display_state/frontend.ts","webpack:///./src/neuroglancer/sliceview/frontend.ts","webpack:///./src/neuroglancer/webgl/dynamic_shader.ts","webpack:///./src/neuroglancer/trackable_alpha.ts","webpack:///./src/neuroglancer/util/trackable.ts","webpack:///./src/neuroglancer/overlay.ts","webpack:///./node_modules/codemirror/lib/codemirror.js","webpack:///./src/neuroglancer/util/random.ts","webpack:///./src/neuroglancer/annotation/base.ts","webpack:///./src/neuroglancer/mesh/base.ts","webpack:///./src/neuroglancer/widget/scale_bar.ts","webpack:///./src/neuroglancer/widget/range.ts","webpack:///./src/neuroglancer/skeleton/base.ts","webpack:///./src/neuroglancer/skeleton/frontend.ts","webpack:///./src/neuroglancer/shared_watchable_value.ts","webpack:///./src/neuroglancer/datasource/computed/frontend.ts","webpack:///./src/neuroglancer/coordinate_transform.ts","webpack:///./src/neuroglancer/webgl/square_corners_buffer.ts","webpack:///./src/neuroglancer/perspective_view/render_layer.ts","webpack:///./src/neuroglancer/annotation/annotation_layer_state.ts","webpack:///./src/neuroglancer/annotation/bounding_box.ts","webpack:///./src/neuroglancer/annotation/line.ts","webpack:///./src/neuroglancer/annotation/point.ts","webpack:///./src/neuroglancer/webgl/ellipse.ts","webpack:///./src/neuroglancer/webgl/spheres.ts","webpack:///./src/neuroglancer/annotation/ellipsoid.ts","webpack:///./src/neuroglancer/annotation/renderlayer.ts","webpack:///./src/neuroglancer/annotation/frontend.ts","webpack:///./src/neuroglancer/datasource/brainmaps/api.ts","webpack:///./src/neuroglancer/webgl/circles.ts","webpack:///./src/neuroglancer/datasource/boss/api.ts","webpack:///./src/neuroglancer/annotation/frontend_source.ts","webpack:///./src/neuroglancer/util/mouse_drag.ts","webpack:///./src/neuroglancer/webgl/lines.ts","webpack:///./src/neuroglancer/credentials_provider/shared.ts","webpack:///./src/neuroglancer/credentials_provider/shared_common.ts","webpack:///./src/neuroglancer/credentials_provider/chunk_source_frontend.ts","webpack:///./src/neuroglancer/sliceview/renderlayer.ts","webpack:///./src/neuroglancer/util/linked_list.0.ts","webpack:///./src/neuroglancer/util/automatic_focus.ts","webpack:///./src/neuroglancer/sliceview/panel.ts","webpack:///./src/neuroglancer/util/colorspace.ts","webpack:///./src/neuroglancer/credentials_provider/index.ts","webpack:///./src/neuroglancer/util/color.ts","webpack:///./src/neuroglancer/widget/color.ts","webpack:///./src/neuroglancer/ui/annotations.ts","webpack:///./src/neuroglancer/ui/tool.ts","webpack:///./src/neuroglancer/util/spatial_units.ts","webpack:///./src/neuroglancer/noselect.css?13a2","webpack:///./src/neuroglancer/webgl/texture.ts","webpack:///./src/neuroglancer/webgl/quad.ts","webpack:///./src/neuroglancer/webgl/colormaps.glsl","webpack:///./src/neuroglancer/widget/text_icon_button.ts","webpack:///./src/neuroglancer/util/memoize.ts","webpack:///./src/neuroglancer/annotation/selection.ts","webpack:///./src/neuroglancer/util/mouse_bindings.ts","webpack:///./node_modules/lodash/throttle.js","webpack:///./src/neuroglancer/credentials_provider/default_manager.ts","webpack:///./src/neuroglancer/datasource/computed/base.ts","webpack:///./src/neuroglancer/util/float32_to_string.ts","webpack:///./src/neuroglancer/widget/close_button.ts","webpack:///./src/neuroglancer/widget/shader_code_widget.ts","webpack:///./src/neuroglancer/widget/coordinate_transform.ts","webpack:///./src/neuroglancer/user_layer_with_coordinate_transform.ts","webpack:///./src/neuroglancer/sliceview/bounding_box_shader_helper.ts","webpack:///./src/neuroglancer/sliceview/vector_graphics/base.ts","webpack:///./src/neuroglancer/webgl/trivial_shaders.ts","webpack:///./src/neuroglancer/util/hex.ts","webpack:///./src/neuroglancer/widget/render_scale_widget.ts","webpack:///./src/neuroglancer/util/number_to_string.ts","webpack:///./src/neuroglancer/ui/button.css?0825","webpack:///./src/neuroglancer/axes_lines.ts","webpack:///./src/neuroglancer/object_picking.ts","webpack:///./node_modules/resize-observer-polyfill/dist/ResizeObserver.es.js","webpack:///./src/neuroglancer/credentials_provider/http_request.ts","webpack:///./src/neuroglancer/util/trackable_enum.ts","webpack:///./src/neuroglancer/sliceview/vector_graphics/frontend.ts","webpack:///./src/neuroglancer/sliceview/volume/renderlayer.ts","webpack:///./src/neuroglancer/user_layer_with_volume_source.ts","webpack:///./src/neuroglancer/widget/uint64_entry_widget.ts","webpack:///./src/neuroglancer/widget/enum_widget.ts","webpack:///./src/neuroglancer/gpu_hash/hash_function.ts","webpack:///./src/neuroglancer/gpu_hash/hash_table.ts","webpack:///./src/neuroglancer/gpu_hash/shader.ts","webpack:///./src/neuroglancer/segment_color.ts","webpack:///./src/neuroglancer/util/disjoint_sets.ts","webpack:///./src/neuroglancer/shared_disjoint_sets.ts","webpack:///./src/neuroglancer/sliceview/volume/segmentation_renderlayer.ts","webpack:///./src/neuroglancer/uint64_set.ts","webpack:///./src/neuroglancer/widget/segment_set_widget.ts","webpack:///./src/neuroglancer/segmentation_user_layer.ts","webpack:///./src/neuroglancer/datasource/brainmaps/base.ts","webpack:///./src/neuroglancer/datasource/brainmaps/frontend.ts","webpack:///./src/neuroglancer/webgl/context.ts","webpack:///./src/neuroglancer/display_context.ts","webpack:///./node_modules/lodash/isObject.js","webpack:///./src/neuroglancer/datasource/boss/base.ts","webpack:///./src/neuroglancer/datasource/boss/frontend.ts","webpack:///./src/neuroglancer/datasource/dvid/base.ts","webpack:///./src/neuroglancer/datasource/dvid/frontend.ts","webpack:///./src/neuroglancer/datasource/render/base.ts","webpack:///./src/neuroglancer/datasource/render/frontend.ts","webpack:///./src/neuroglancer/datasource/precomputed/base.ts","webpack:///./src/neuroglancer/datasource/precomputed/frontend.ts","webpack:///./src/neuroglancer/datasource/nifti/base.ts","webpack:///./src/neuroglancer/datasource/nifti/frontend.ts","webpack:///./src/neuroglancer/datasource/n5/base.ts","webpack:///./src/neuroglancer/datasource/n5/frontend.ts","webpack:///./src/neuroglancer/datasource/computed/example/frontend.ts","webpack:///./src/neuroglancer/datasource/computed/example/base.ts","webpack:///./src/neuroglancer/datasource/computed/tensorflow/frontend.ts","webpack:///./src/neuroglancer/datasource/computed/tensorflow/base.ts","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/lodash/_root.js","webpack:///./node_modules/lodash/_Symbol.js","webpack:///./node_modules/codemirror/lib/codemirror.css?c00e","webpack:///./node_modules/codemirror/addon/lint/lint.css?6e96","webpack:///./src/neuroglancer/image_user_layer.css?39e5","webpack:///./src/neuroglancer/maximize_button.css?818f","webpack:///./node_modules/codemirror/addon/fold/foldcode.js","webpack:///./node_modules/lodash/now.js","webpack:///./node_modules/lodash/_freeGlobal.js","webpack:///./node_modules/lodash/toNumber.js","webpack:///./node_modules/lodash/isSymbol.js","webpack:///./node_modules/lodash/_baseGetTag.js","webpack:///./node_modules/lodash/_getRawTag.js","webpack:///./node_modules/lodash/_objectToString.js","webpack:///./node_modules/lodash/isObjectLike.js","webpack:///./src/neuroglancer/widget/tab_view.css?0940","webpack:///./src/neuroglancer/widget/tab_view.css","webpack:///./node_modules/style-loader/lib/urls.js","webpack:///./src/neuroglancer/status.css?9614","webpack:///./src/neuroglancer/status.css","webpack:///./src/neuroglancer/rendered_data_panel.css?5600","webpack:///./src/neuroglancer/rendered_data_panel.css","webpack:///./src/neuroglancer/noselect.css","webpack:///./src/neuroglancer/datasource/brainmaps/register_default.ts","webpack:///./src/neuroglancer/datasource/boss/register_default.ts","webpack:///./src/neuroglancer/datasource/dvid/register_default.ts","webpack:///./src/neuroglancer/datasource/render/register_default.ts","webpack:///./src/neuroglancer/datasource/precomputed/register_default.ts","webpack:///./src/neuroglancer/datasource/nifti/register_default.ts","webpack:///./src/neuroglancer/datasource/n5/register_default.ts","webpack:///./src/neuroglancer/datasource/computed/register_default.ts","webpack:///./src/neuroglancer/datasource/computed/example/register_default.ts","webpack:///./src/neuroglancer/datasource/computed/tensorflow/register_default.ts","webpack:///./src/neuroglancer/overlay.css?3c24","webpack:///./src/neuroglancer/overlay.css","webpack:///./src/neuroglancer/ui/annotations.css?909a","webpack:///./src/neuroglancer/ui/annotations.css","webpack:///./src/neuroglancer/widget/text_icon_button.css?e726","webpack:///./src/neuroglancer/widget/text_icon_button.css","webpack:///./src/neuroglancer/widget/range.css?2fac","webpack:///./src/neuroglancer/widget/range.css","webpack:///./src/neuroglancer/widget/uint64_entry_widget.css?3f00","webpack:///./src/neuroglancer/widget/uint64_entry_widget.css","webpack:///./src/neuroglancer/widget/coordinate_transform.css?0102","webpack:///./src/neuroglancer/widget/coordinate_transform.css","webpack:///./src/neuroglancer/widget/render_scale_widget.css?8247","webpack:///./src/neuroglancer/widget/render_scale_widget.css","webpack:///./node_modules/codemirror/addon/lint/lint.js","webpack:///./src/neuroglancer/widget/shader_code_widget.css?155a","webpack:///./src/neuroglancer/widget/shader_code_widget.css","webpack:///./node_modules/codemirror/lib/codemirror.css","webpack:///./node_modules/codemirror/addon/lint/lint.css","webpack:///./node_modules/glsl-editor/glsl.js","webpack:///./src/neuroglancer/image_user_layer.css","webpack:///./src/neuroglancer/maximize_button.css","webpack:///./src/neuroglancer/widget/vec3.css?c544","webpack:///./src/neuroglancer/widget/vec3.css","webpack:///./src/neuroglancer/segmentation_user_layer.css?9479","webpack:///./src/neuroglancer/segmentation_user_layer.css","webpack:///./src/neuroglancer/widget/segment_set_widget.css?ada5","webpack:///./src/neuroglancer/widget/segment_set_widget.css","webpack:///./src/neuroglancer/single_mesh_user_layer.css?6987","webpack:///./src/neuroglancer/single_mesh_user_layer.css","webpack:///./src/neuroglancer/annotation/user_layer.css?04a8","webpack:///./src/neuroglancer/annotation/user_layer.css","webpack:///./src/neuroglancer/ui/default_viewer.css?f954","webpack:///./src/neuroglancer/ui/default_viewer.css","webpack:///./src/neuroglancer/ui/button.css","webpack:///./src/neuroglancer/data_panel_layout.css?3c6a","webpack:///./src/neuroglancer/data_panel_layout.css","webpack:///./src/neuroglancer/perspective_view/panel.css?c803","webpack:///./src/neuroglancer/perspective_view/panel.css","webpack:///./src/neuroglancer/help/input_event_bindings.css?41d2","webpack:///./src/neuroglancer/help/input_event_bindings.css","webpack:///./src/neuroglancer/widget/autocomplete.css?2212","webpack:///./src/neuroglancer/widget/autocomplete.css","webpack:///./src/neuroglancer/layer_dialog.css?ae89","webpack:///./src/neuroglancer/layer_dialog.css","webpack:///./src/neuroglancer/widget/position_widget.css?faff","webpack:///./src/neuroglancer/widget/position_widget.css","webpack:///./src/neuroglancer/layer_panel.css?6caf","webpack:///./src/neuroglancer/layer_panel.css","webpack:///./src/neuroglancer/ui/context_menu.css?c2eb","webpack:///./src/neuroglancer/ui/context_menu.css","webpack:///./src/neuroglancer/layer_group_viewer.css?7ab1","webpack:///./src/neuroglancer/layer_group_viewer.css","webpack:///./src/neuroglancer/layer_groups_layout.css?8867","webpack:///./src/neuroglancer/layer_groups_layout.css","webpack:///./src/neuroglancer/ui/drag_resize.css?adf2","webpack:///./src/neuroglancer/ui/drag_resize.css","webpack:///./src/neuroglancer/ui/layer_side_panel.css?a64b","webpack:///./src/neuroglancer/ui/layer_side_panel.css","webpack:///./src/neuroglancer/ui/mouse_selection_state_tooltip.css?9f56","webpack:///./src/neuroglancer/ui/mouse_selection_state_tooltip.css","webpack:///./src/neuroglancer/widget/tooltip.css?865d","webpack:///./src/neuroglancer/widget/tooltip.css","webpack:///./node_modules/codemirror/mode/javascript/javascript.js","webpack:///./node_modules/codemirror/addon/fold/foldgutter.js","webpack:///./node_modules/codemirror/addon/fold/brace-fold.js","webpack:///./node_modules/codemirror/addon/fold/foldgutter.css?c543","webpack:///./node_modules/codemirror/addon/fold/foldgutter.css","webpack:///./src/neuroglancer/ui/state_editor.css?55cc","webpack:///./src/neuroglancer/ui/state_editor.css","webpack:///./src/neuroglancer/ui/statistics.css?dfdd","webpack:///./src/neuroglancer/ui/statistics.css","webpack:///./src/neuroglancer/widget/annotation_tool_status.css?6a78","webpack:///./src/neuroglancer/widget/annotation_tool_status.css","webpack:///./src/neuroglancer/viewer.css?cfd7","webpack:///./src/neuroglancer/viewer.css","webpack:///./src/neuroglancer/util/clipboard.ts","webpack:///./src/neuroglancer/ui/default_clipboard_handling.ts","webpack:///./src/neuroglancer/ui/default_input_event_bindings.ts","webpack:///./src/neuroglancer/sliceview/single_texture_chunk_format.ts","webpack:///./src/neuroglancer/sliceview/uncompressed_chunk_format.ts","webpack:///./src/neuroglancer/sliceview/compressed_segmentation/decode_common.ts","webpack:///./src/neuroglancer/sliceview/compressed_segmentation/decode_uint32.ts","webpack:///./src/neuroglancer/sliceview/compressed_segmentation/decode_uint64.ts","webpack:///./src/neuroglancer/sliceview/compressed_segmentation/chunk_format.ts","webpack:///./src/neuroglancer/layout.ts","webpack:///./src/neuroglancer/perspective_view/base.ts","webpack:///./src/neuroglancer/util/watchable_map.ts","webpack:///./src/neuroglancer/perspective_view/panel.ts","webpack:///./src/neuroglancer/data_panel_layout.ts","webpack:///./src/neuroglancer/help/input_event_bindings.ts","webpack:///./src/neuroglancer/widget/associate_label.ts","webpack:///./src/neuroglancer/util/scroll_into_view.ts","webpack:///./src/neuroglancer/widget/autocomplete.ts","webpack:///./src/neuroglancer/util/dropdown.ts","webpack:///./src/neuroglancer/util/longest_common_prefix.ts","webpack:///./src/neuroglancer/layer_dialog.ts","webpack:///./src/neuroglancer/widget/hidden_submit_button.ts","webpack:///./src/neuroglancer/util/drag_and_drop.ts","webpack:///./src/neuroglancer/ui/layer_drag_and_drop.ts","webpack:///./src/neuroglancer/util/animation_frame_debounce.ts","webpack:///./src/neuroglancer/widget/position_widget.ts","webpack:///./src/neuroglancer/layer_panel.ts","webpack:///./src/neuroglancer/ui/context_menu.ts","webpack:///./src/neuroglancer/ui/position_drag_and_drop.ts","webpack:///./src/neuroglancer/layer_group_viewer.ts","webpack:///./src/neuroglancer/layer_groups_layout.ts","webpack:///./src/neuroglancer/ui/drag_resize.ts","webpack:///./src/neuroglancer/ui/layer_side_panel.ts","webpack:///./src/neuroglancer/widget/tooltip.ts","webpack:///./src/neuroglancer/ui/mouse_selection_state_tooltip.ts","webpack:///./src/neuroglancer/ui/state_editor.ts","webpack:///./src/neuroglancer/ui/statistics.ts","webpack:///./src/neuroglancer/widget/annotation_tool_status.ts","webpack:///./src/neuroglancer/widget/number_input_widget.ts","webpack:///./src/neuroglancer/viewer.ts","webpack:///./src/neuroglancer/ui/default_viewer.ts","webpack:///./src/neuroglancer/ui/disable_default_actions.ts","webpack:///./src/neuroglancer/ui/url_hash_binding.ts","webpack:///./src/neuroglancer/ui/default_viewer_setup.ts","webpack:///./src/main.ts","webpack:///./src/neuroglancer/trackable_finite_float.ts","webpack:///./src/neuroglancer/trackable_vec3.ts","webpack:///./src/neuroglancer/sliceview/vector_graphics/vector_graphics_line_renderlayer.ts","webpack:///./src/neuroglancer/widget/vec3_entry_widget.ts","webpack:///./src/neuroglancer/vector_graphics_user_layer.ts","webpack:///./src/neuroglancer/single_mesh/base.ts","webpack:///./src/neuroglancer/webgl/index_emulation.ts","webpack:///./src/neuroglancer/single_mesh/frontend.ts","webpack:///./src/neuroglancer/single_mesh_user_layer.ts","webpack:///./src/neuroglancer/util/google_oauth2.ts","webpack:///./src/neuroglancer/datasource/brainmaps/credentials_provider.ts","webpack:///./src/neuroglancer/datasource/brainmaps/register_credentials_provider.ts","webpack:///./src/neuroglancer/trackable_blend.ts","webpack:///./src/neuroglancer/sliceview/volume/image_renderlayer.ts","webpack:///./src/neuroglancer/image_user_layer.ts","webpack:///./src/neuroglancer/datasource/boss/credentials_provider.ts","webpack:///./src/neuroglancer/datasource/boss/register_credentials_provider.ts","webpack:///./src/neuroglancer/widget/layer_reference.ts","webpack:///./src/neuroglancer/annotation/user_layer.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","installedModules","0","__webpack_require__","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","p","1","jsonpScriptSrc","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","error","Error","request","undefined","setTimeout","head","appendChild","all","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","s","EPSILON","ARRAY_TYPE","Float32Array","Array","RANDOM","Math","random","PI","out","fromMat4","a","clone","copy","fromValues","m00","m01","m02","m10","m11","m12","m20","m21","m22","set","identity","transpose","a01","a02","a12","invert","a00","a10","a11","a20","a21","a22","b01","b11","b21","det","adjoint","determinant","multiply","b","b00","b02","b10","b12","b20","b22","translate","v","x","y","rotate","rad","sin","cos","mat3_scale","fromTranslation","fromRotation","fromScaling","fromMat2d","fromQuat","q","z","w","x2","y2","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","normalFromMat4","a03","a13","a23","a30","a31","a32","a33","b03","b04","b05","b06","b07","b08","b09","projection","width","height","str","frob","sqrt","pow","add","subtract","multiplyScalar","multiplyScalarAndAdd","scale","exactEquals","mat3_equals","a0","a1","a2","a3","a4","a5","a6","a7","a8","b0","b1","b2","b3","b4","b5","b6","b7","b8","abs","max","mul","sub","mat4_create","mat4_clone","mat4_copy","mat4_fromValues","m03","m13","m23","m30","m31","m32","m33","mat4_set","mat4_identity","mat4_transpose","mat4_invert","mat4_adjoint","mat4_determinant","mat4_multiply","mat4_translate","mat4_scale","mat4_rotate","axis","len","rotateX","rotateY","rotateZ","mat4_fromTranslation","mat4_fromScaling","mat4_fromRotation","fromXRotation","fromYRotation","fromZRotation","fromRotationTranslation","xy","xz","yz","fromQuat2","translation","bx","by","bz","bw","ax","ay","az","aw","magnitude","getTranslation","mat","getScaling","getRotation","trace","S","fromRotationTranslationScale","sx","sy","sz","fromRotationTranslationScaleOrigin","ox","oy","oz","out0","out1","out2","out4","out5","out6","out8","out9","out10","mat4_fromQuat","frustum","left","right","bottom","top","near","far","rl","tb","nf","perspective","fovy","aspect","f","tan","Infinity","perspectiveFromFieldOfView","fov","upTan","upDegrees","downTan","downDegrees","leftTan","leftDegrees","rightTan","rightDegrees","xScale","yScale","ortho","lr","bt","lookAt","eye","center","up","x0","x1","y0","y1","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","targetTo","mat4_str","mat4_frob","mat4_add","mat4_subtract","mat4_multiplyScalar","mat4_multiplyScalarAndAdd","mat4_exactEquals","mat4_equals","a9","a14","a15","b9","b13","b14","b15","mat4_mul","mat4_sub","vec3_create","vec3_clone","vec3_length","vec3_fromValues","vec3_copy","vec3_set","vec3_add","vec3_subtract","vec3_multiply","divide","ceil","floor","min","round","vec3_scale","scaleAndAdd","distance","squaredDistance","squaredLength","negate","inverse","normalize","vec3_dot","cross","lerp","hermite","factorTimes2","factor1","factor2","factor3","factor4","bezier","inverseFactor","inverseFactorTimesTwo","zScale","transformMat4","transformMat3","transformQuat","qx","qy","qz","qw","uvx","uvy","uvz","uuvx","uuvy","uuvz","w2","vec3_rotateX","vec3_rotateY","vec3_rotateZ","angle","tempA","tempB","cosine","acos","zero","vec3_str","vec3_exactEquals","vec3_equals","vec","vec3_sub","vec3_mul","div","dist","sqrDist","vec3_len","sqrLen","forEach","stride","offset","count","fn","arg","vec4_create","vec4_clone","vec4_fromValues","vec4_copy","vec4_set","vec4_add","vec4_subtract","vec4_multiply","vec4_divide","vec4_ceil","vec4_floor","vec4_min","vec4_max","vec4_round","vec4_scale","vec4_scaleAndAdd","vec4_distance","vec4_squaredDistance","vec4_length","vec4_squaredLength","vec4_negate","vec4_inverse","vec4_normalize","vec4_dot","vec4_cross","u","A","B","C","D","E","F","G","H","I","J","vec4_lerp","vec4_random","v1","v2","v3","v4","s1","s2","vec4_transformMat4","vec4_transformQuat","ix","iy","iz","iw","vec4_zero","vec4_str","vec4_exactEquals","vec4_equals","vec4_sub","vec4_mul","vec4_div","vec4_dist","vec4_sqrDist","vec4_len","vec4_sqrLen","vec4_forEach","quat_create","quat_identity","setAxisAngle","getAxisAngle","out_axis","quat_multiply","quat_rotateX","quat_rotateY","quat_rotateZ","calculateW","slerp","omega","cosom","sinom","scale0","scale1","quat_random","u1","u2","u3","sqrt1MinusU1","sqrtU1","quat_invert","dot","invDot","conjugate","fromMat3","fRoot","fTrace","j","k","fromEuler","halfToRad","cx","cy","cz","quat_str","tmpvec3","xUnitVec3","yUnitVec3","temp1","temp2","matr","quat_clone","quat_fromValues","quat_copy","quat_set","quat_add","quat_mul","quat_scale","quat_dot","quat_lerp","quat_length","quat_len","quat_squaredLength","quat_sqrLen","quat_normalize","quat_exactEquals","quat_equals","rotationTo","sqlerp","setAxes","view","vec2_create","vec2_clone","vec2_fromValues","vec2_copy","vec2_set","vec2_add","vec2_subtract","vec2_multiply","vec2_divide","vec2_ceil","vec2_floor","vec2_min","vec2_max","vec2_round","vec2_scale","vec2_scaleAndAdd","vec2_distance","vec2_squaredDistance","vec2_length","vec2_squaredLength","vec2_negate","vec2_inverse","vec2_normalize","vec2_dot","vec2_cross","vec2_lerp","vec2_random","transformMat2","transformMat2d","vec2_transformMat3","vec2_transformMat4","vec2_rotate","p0","p1","sinC","cosC","vec2_angle","len1","len2","vec2_zero","vec2_str","vec2_exactEquals","vec2_equals","vec2_len","vec2_sub","vec2_mul","vec2_div","vec2_dist","vec2_sqrDist","vec2_sqrLen","vec2_forEach","__webpack_exports__","identityMat4","AXES_NAMES","BoundingBox","kAxes","kZeroVec","kOneVec","kInfinityVec","prod3","vec3Key","rectifyTransformMatrixIfAxisAligned","transformVectorByMat4","effectiveScalingFactorFromMat4","translationRotationScaleZReflectionToMat4","projectPointToLineSegment","mat3FromMat4","getFrustrumPlanes","isAABBVisible","mat3_namespaceObject","mat4_namespaceObject","quat_namespaceObject","vec2_namespaceObject","vec3_namespaceObject","vec4_namespaceObject","[object Object]","lower","upper","this","RECTIFY_EPSILON","rectifyVec3IfAxisAligned","m0","m1","m2","m4","m5","m6","m8","m9","rotation","zReflection","temp","denominator","numerator","aValue","findClosestParameterizedLinePosition","nearA","nearB","nearC","nearD","nearNorm","xLower","yLower","zLower","xUpper","yUpper","zUpper","clippingPlanes","verifyFloat","verifyFiniteFloat","verifyFinitePositiveFloat","parseXYZ","parseFiniteVec","parseIntVec","stableStringify","urlSafeParse","parseArray","parseFixedLengthArray","verifyObject","verifyInt","verifyPositiveInt","verifyMapKey","verifyString","verifyOptionalString","verifyOptionalInt","verifyOptionalBoolean","verifyObjectProperty","verifyObjectAsMap","verifyFloat01","parseQueryStringParameters","verifyEnumString","verify3dVec","verify3dScale","verify3dDimensions","verifyBoolean","neuroglancer_util_geom__WEBPACK_IMPORTED_MODULE_0__","obj","parseFloat","Number","isNaN","JSON","stringify","isFinite","validator","keys","isArray","val","parseInt","isInteger","size","sort","SINGLE_QUOTE_STRING_PATTERN","DOUBLE_QUOTE_STRING_PATTERN","SINGLE_OR_DOUBLE_QUOTE_STRING_PATTERN","RegExp","source","DOUBLE_OR_SINGLE_QUOTE_STRING_PATTERN","DOUBLE_QUOTE_PATTERN","SINGLE_QUOTE_PATTERN","convertStringLiteral","quoteInitial","quoteReplace","quoteSearch","charAt","inner","substr","match","index","convertJsonHelper","desiredCommaChar","desiredQuoteChar","commaSearch","stringLiteralPattern","before","replacement","originalString","replace","parse","urlSafeToJSON","parseElement","map","result","from","propertyName","parseError","message","Map","queryString","startsWith","parts","split","part","decodeURIComponent","enumType","toUpperCase","invokeDisposers","disposers","disposer","dispose","registerEventListener","listener","options","addEventListener","removeEventListener","RefCounted","RefCountedValue","refCount","refCountReachedZero","disposed","wasDisposed","indexOf","splice","registerDisposer","cancellable","cancel","super","Signal","NullarySignal","handlers","Set","dispatch","handler","apply","arguments","remove","delete","VolumeType","VolumeChunkSpecification","neuroglancer_sliceview_base__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_util_data_type__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_util_geom__WEBPACK_IMPORTED_MODULE_2__","lowerVoxelBound","upperVoxelBound","chunkDataSize","voxelSize","transform","baseVoxelOffset","lowerClipBound","upperClipBound","chunkSize","lowerChunkBound","upperChunkBound","dataType","numChannels","chunkBytes","compressedSegmentationBlockSize","assign","volumeSourceOptions","msg","toObject","volumeType","SEGMENTATION","UINT32","UINT64","maxVoxelsPerChunkLog2","maxBlockSize","maxCompressedSegmentationBlockSize","adjustedOptions","chunkDataSizes","withDefaultCompression","ChunkState","numChunkStates","ChunkPriorityTier","ChunkDownloadStatistics","ChunkMemoryStatistics","numChunkMemoryStatistics","getChunkStateStatisticIndex","getChunkDownloadStatisticIndex","CHUNK_QUEUE_MANAGER_RPC_ID","CHUNK_MANAGER_RPC_ID","CHUNK_SOURCE_INVALIDATE_RPC_ID","REQUEST_CHUNK_STATISTICS_RPC_ID","numChunkPriorityTiers","state","priorityTier","statistic","AnnotationReference","AnnotationType","annotationTypes","getAnnotationTypeHandler","AnnotationSource","LocalAnnotationSource","makeAnnotationId","makeDataBoundsBoundingBox","deserializeAnnotation","neuroglancer_util_disposable__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_util_geom__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_util_json__WEBPACK_IMPORTED_MODULE_2__","neuroglancer_util_random__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_util_signal__WEBPACK_IMPORTED_MODULE_4__","neuroglancer_util_uint64__WEBPACK_IMPORTED_MODULE_5__","id","changed","POINT","LINE","AXIS_ALIGNED_BOUNDING_BOX","ELLIPSOID","typeHandlers","annotationToJson","annotation","toJSON","toLowerCase","description","segments","toString","icon","pointA","pointB","restoreState","serializedBytes","serializer","buffer","numAnnotations","coordinates","coordinateOffset","point","radii","objectToLocal","annotationMap","readonly","childAdded","childUpdated","childDeleted","pending","references","commit","has","getReference","reference","iterator","values","existing","addRef","clear","allowMissingId","parseString","restoreAnnotation","DATA_BOUNDS_DESCRIPTION","low","high","Modifiers","HierarchicalMap","parents","parentPriorities","bindings","parent","priority","removeParent","numParents","parentIndex","entries","getStrokeIdentifier","keyName","modifiers","identifier","normalizeEventAction","action","normalizeEventIdentifier","firstColonOffset","suffix","normalizeModifiersAndBaseIdentifier","substring","prefix","event_action_map_EventActionMap","dispatchEvent","dispatchEventWithModifiers","registerActionListener","label","addParent","normalizedAction","normalizedIdentifier","uniqueBindings","join","eventPhaseNames","baseIdentifier","originalEvent","eventPhase","detail","eventMap","eventIdentifier","eventAction","stopPropagation","actionEvent","CustomEvent","bubbles","cancelable","cancelled","preventDefault","dispatchEventAction","ctrlKey","altKey","metaKey","shiftKey","disposable","Event","AT_TARGET","CAPTURING_PHASE","BUBBLING_PHASE","registerRPC","registerPromiseRPC","RPC","SharedObject","SharedObjectCounterpart","registerSharedObjectOwner","registerSharedObject","neuroglancer_util_cancellation__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_util_disposable__WEBPACK_IMPORTED_MODULE_1__","IS_WORKER","Window","self","DEBUG","DEBUG_MESSAGES","PROMISE_RESPONSE_ID","PROMISE_CANCEL_ID","RPCError","cancellationToken","then","transfers","invoke","errorName","INITIAL_RPC_ID","objects","nextId","onmessage","log","functionName","numObjects","rpcId","referencedGeneration","postMessage","token","newId","rpc","isOwner","initializeSharedObject","unreferencedGeneration","RPC_TYPE_ID","gen","ownerDispose","generation","initializeSharedObjectCounterpart","counterpartRefCountReachedZero","sharedObjectConstructors","constructorFunction","typeName","WatchableValue","TrackableValue","makeDerivedWatchableValue","ComputedWatchableValue","WatchableRefCounted","TrackableRefCounted","WatchableSet","registerNested","lodash_debounce__WEBPACK_IMPORTED_MODULE_0__","lodash_debounce__WEBPACK_IMPORTED_MODULE_0___default","neuroglancer_util_signal__WEBPACK_IMPORTED_MODULE_2__","value_","newValue","defaultValue","ignoredError","DerivedWatchableValue","ws","signals","signal","unregisterDisposer","valueHandler","jsonConverter","baseState","context","updateValue","handleChange","signalDisposer","removeChildren","element","child","firstElementChild","removeChild","removeFromParent","parentElement","Chunk","CapacitySpecification","ChunkQueueManager","ChunkManager","ChunkSource","WithParameters","neuroglancer_chunk_manager_base__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_shared_watchable_value__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_trackable_value__WEBPACK_IMPORTED_MODULE_2__","neuroglancer_util_cancellation__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_util_json__WEBPACK_IMPORTED_MODULE_4__","neuroglancer_util_memoize__WEBPACK_IMPORTED_MODULE_5__","neuroglancer_util_object_id__WEBPACK_IMPORTED_MODULE_6__","neuroglancer_util_signal__WEBPACK_IMPORTED_MODULE_7__","neuroglancer_worker_rpc__WEBPACK_IMPORTED_MODULE_8__","DEBUG_CHUNK_UPDATES","SYSTEM_MEMORY","gl","_gl","GPU_MEMORY","validateLimitValue","defaultItemLimit","POSITIVE_INFINITY","defaultSizeLimit","sizeLimit","itemLimit","frameNumberCounter","capacities","visibleChunksChanged","pendingChunkUpdates","pendingChunkUpdatesTail","chunkUpdateDeadline","chunkUpdateDelay","makeCapacityCounterparts","capacity","makeFromExisting","initializeCounterpart","gpuMemoryCapacity","gpuMemory","systemMemoryCapacity","systemMemory","downloadCapacity","download","computeCapacity","compute","delay","deadline","Date","now","processPendingChunkUpdates","update","applyChunkUpdate","nextUpdate","numPendingChunkUpdates","isCanceled","chunks","constructor","handleFetch_","chunkKey","deleteChunk","newState","EXPIRED","getChunk","addChunk","copyToGPU","freeGPUMemory","updateChunk","queueManager","chunkManager","chunkQueueManager","immediateChunkUpdates","pendingTail","scheduleChunkUpdate","__decorate","memoize","keyObject","encodeOptions","newSource","_options","_x","Base","parametersConstructor","args","parameters","RPC_ID","DataType","DATA_TYPE_BYTES","UINT8","UINT16","FLOAT32","isObject","toNumber","FUNC_ERROR_TEXT","nativeMax","nativeMin","func","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","thisArg","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","leadingEdge","flush","CANCELED","uncancelableToken","CancellationTokenSource","MultipleConsumerCancellationTokenSource","makeCancelablePromise","noopFunction","consumers","executor","scopedToken","unregister","useSourceMap","list","item","content","cssMapping","btoa","sourceMapping","sourceMap","unescape","encodeURIComponent","sourceURLs","sources","sourceRoot","concat","cssWithMappingToString","mediaQuery","alreadyImportedModules","memo","stylesInDom","isOldIE","atob","getElement","styleTarget","querySelector","HTMLIFrameElement","contentDocument","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","domStyle","refs","addStyle","listToStyles","newStyles","base","css","media","insertStyleElement","style","insertInto","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","firstChild","removeStyleElement","parentNode","idx","createStyleElement","attrs","nonce","getNonce","addAttrs","el","default","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","createLinkElement","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","href","styleSheet","cssText","createTextNode","newObj","newList","mayRemove","textStore","replaceText","filter","Boolean","cssNode","childNodes","Uint64","randomTempBuffer","Uint32Array","trueBase","stringConversionData","lowDigits","log2","lowBase","patternString","String","fromCharCode","charCodeAt","pattern","uint32MultiplyHigh","a16","b16","c16","c32","c48","vLow","vHigh","vHighExtra","vLowStr","repeat","less","crypto","getRandomValues","test","splitPoint","lowPrime","highPrime","highRemainder","imul","tryParseString","input","bits","lowSum","highSum","ZERO","ONE","TrackableBoolean","TrackableBooleanCheckbox","ElementVisibilityFromTrackableBoolean","model","updateCheckbox","_e","checked","initialDisplay","display","updateVisibility","registerCancellable","Buffer","getMemoizedBuffer","neuroglancer_util_json__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_util_object_id__WEBPACK_IMPORTED_MODULE_2__","bufferType","WebGL2RenderingContext","ARRAY_BUFFER","createBuffer","bindBuffer","location","componentsPerVertexAttribute","attributeType","FLOAT","normalized","enableVertexAttribArray","vertexAttribPointer","UNSIGNED_INT","vertexAttribIPointer","usage","STATIC_DRAW","bufferData","deleteBuffer","setData","fromData","removeSignalBinding","addSignalBinding","RenderLayerRole","allRenderLayerRoles","trackable_value","DATA","ANNOTATION","DEFAULT_ANNOTATION","layer_RenderLayer","layer_VisibilityTrackedRenderLayer","layer_UserLayer","layer_ManagedUserLayer","layer_LayerManager","layer_MouseSelectionState","layer_LayerSelectedValues","makeRenderedPanelVisibleLayerTracker","layer_SelectedLayerState","layer_LayerReference","ready","role","layerChanged","redrawNeeded","readyStateChanged","boundingBox","_action","pickedValue","_pickedOffset","_mouseState","_pickedValue","_data","visibility","frontend","TAB_JSON_KEY","TOOL_JSON_KEY","manager","specification","layersChanged","specificationChanged","renderLayers","isReady","tabs","tab_view","tool","layer","position","pickState","pickedRenderLayer","transformPickedValue","pickedOffset","getValueAt","visible","layer_","name_","oldLayer","unregisterUserLayer","removers","handleLayerChanged","managedLayers","layerSet","boundPositions","WeakSet","numDirectUsers","renderLayerToManagedLayerMapGeneration","renderLayerToManagedLayerMap_","scheduleRemoveLayersWithSingleRef","debounce_default","removeLayersWithSingleRef","renderLayerToManagedLayerMap","managedLayer","userLayer","renderLayer","predicate","unbindManagedLayer","callback","updateSignalBindings","addManagedLayer","managedUserLayer","oldIndex","newIndex","numLayers","find","suggestedName","getLayerByName","updatePositionFromLayers","valid","geom","setValid","spatialCoordinatesValid","voxelCoordinatesValid","centerPosition","spatialCoordinates","layerManager","visibleRenderLayers","handleAction","active","uint64","pickedAnnotationLayer","pickedAnnotationId","pickedAnnotationBuffer","pickedAnnotationBufferOffset","forcerFunction","forcer","setActive","mouseState","needsUpdate","handleLayerChange","layer_VisibleRenderLayerTracker","renderLayerType","roles","layerAdded","visibleLayers","newVisibleLayers","debouncedUpdateVisibleLayers","updateVisibleLayers","readyRenderLayers","typedLayer","visibilityDisposer","panel","scheduleRedraw","disposer2","visible_","json","existingLayerDisposer","layerDisposed","layerChangedDisposer","deactivate","reset","layerName","validate","layerName_","TextureFormat","getSamplerPrefixForDataType","computeTextureFormat","compute1dTextureLayout","setOneDimensionalTextureData","setThreeDimensionalTextureData","OneDimensionalTextureAccessHelper","ThreeDimensionalTextureAccessHelper","neuroglancer_util_array__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_webgl_shader_lib__WEBPACK_IMPORTED_MODULE_2__","neuroglancer_webgl_texture__WEBPACK_IMPORTED_MODULE_3__","integerTextureFormatForNumComponents","RED_INTEGER","RG_INTEGER","RGB_INTEGER","RGBA_INTEGER","floatTextureFormatForNumComponents","RED","RG","RGB","RGBA","textureSelectorForNumComponents","internalUint8FormatForNumComponents","R8UI","RG8UI","RGB8UI","RGBA8UI","internalUint16FormatForNumComponents","R16UI","RG16UI","RGB16UI","RGBA16UI","internalUint32FormatForNumComponents","R32UI","RG32UI","RGB32UI","RGBA32UI","internalFloatFormatForNumComponents","R32F","RG32F","RGB32F","RGBA32F","format","numComponents","texelsPerElement","textureInternalFormat","textureFormat","texelType","UNSIGNED_BYTE","arrayElementsPerTexel","arrayConstructor","Uint8Array","samplerPrefix","UNSIGNED_SHORT","Uint16Array","layout","numElements","maxTextureSize","minX","textureXBits","textureWidth","textureHeight","textureLayout","requiredSize","byteOffset","byteLength","BYTES_PER_ELEMENT","padded","pixelStorei","UNPACK_ALIGNMENT","texImage2D","TEXTURE_2D","depth","texImage3D","TEXTURE_3D","getShaderCodeForDataType","getAccessorFunction","readTextureValue","samplerName","indexType","shaderType","code","uniformName","builder","addUniform","getReadTextureValueCode","shader","uniform1ui","uniform","StatusMessage","statusContainer","DEFAULT_STATUS_DELAY","body","setVisible","timer","text","makeVisible","textContent","innerHTML","status","setText","initialMessage","reason","errorPrefix","setErrorMessage","button","closeAfter","showMessage","textureTargetForSamplerType","ShaderBuilder","emitterDependentShaderGetter","DEBUG_SHADER","ShaderType","VERTEX_SHADER","FRAGMENT_SHADER","ShaderCompilationError","errorMessages","ShaderLinkError","vertexSource","fragmentSource","getShader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","lines","line","open","write","writeError","trim","file","parseShaderErrors","ShaderProgram","uniformNames","attributeNames","attributes","uniforms","vertexShader","fragmentShader","shaderProgram","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","program","getUniformLocation","getAttribLocation","symbol","textureUnits","useProgram","deleteShader","deleteProgram","ShaderCode","sampler2D","isampler2D","usampler2D","sampler3D","isampler3D","usampler3D","nextSymbolID","nextTextureUnit","uniformsCode","attributesCode","varyingsCodeVS","varyingsCodeFS","fragmentExtensionsSet","fragmentExtensions","vertexCode","vertexMain","fragmentCode","outputBufferCode","fragmentMain","required","initializers","old","samplerType","extent","textureUnit","allocateTextureUnit","addInitializer","Int32Array","uniform1iv","uniform1i","interpolationMode","initializer","refCounted","defineShader","shaders","emitter","require","build","HttpError","fetchOk","responseArrayBuffer","responseJson","cancellableFetchOk","parseSpecialUrl","neuroglancer_util_uint64__WEBPACK_IMPORTED_MODULE_1__","url","statusText","response","async","init","fetch","ok","fromResponse","arrayBuffer","transformResponse","abortController","AbortController","unregisterCancellation","abort","bucket","path","WatchableVisibilityPriority","VisibilityPriorityAggregator","withSharedVisibility","neuroglancer_shared_watchable_value__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_trackable_value__WEBPACK_IMPORTED_MODULE_1__","NEGATIVE_INFINITY","ignored","VISIBLE","IGNORED","contributors","changedDisposer","glsl_hsvToRgb","glsl_uint64","glsl_unpackUint64leFromUint32","glsl_equalUint64","glsl_uint8","glsl_float","glsl_uint16","glsl_uint32","glsl_getFortranOrderIndex","getShaderType","neuroglancer_util_data_type__WEBPACK_IMPORTED_MODULE_0__","chunk_layout_ChunkLayout","invTransform","cache","localSpatial","globalSpatial","globalToLocalSpatial","localVector","globalVector","getTransformedSources","base_SliceViewBase","getNearIsotropicBlockSize","ChunkLayoutPreference","getCombinedTransform","getChunkDataSizes","base_SliceViewChunkSpecification","SLICEVIEW_RPC_ID","SLICEVIEW_RENDERLAYER_RPC_ID","SLICEVIEW_ADD_VISIBLE_LAYER_RPC_ID","SLICEVIEW_REMOVE_VISIBLE_LAYER_RPC_ID","SLICEVIEW_UPDATE_VIEW_RPC_ID","SLICEVIEW_RENDERLAYER_UPDATE_TRANSFORM_RPC_ID","DEBUG_CHUNK_INTERSECTIONS","DEBUG_VISIBLE_SOURCES","tempVec3","estimateSliceAreaPerChunk","zAxis","chunkLayout","zAxisRotated","globalToLocalSpatialVector","minProjection","maxProjection","chunkVolume","chunkSizeValue","BoundsComparisonResult","compareBounds","needleLowerBound","needleUpperBound","haystackLowerBound","haystackUpperBound","curResult","FULLY_INSIDE","newResult","needleLower","needleUpper","haystackLower","haystackUpper","FULLY_OUTSIDE","PARTIALLY_INSIDE","transformedSources","transformedSourcesGeneration","equals","alternatives","spec","transformedChunkLayout","localSpatialVectorToGlobal","pickBestAlternativeSource","numAlternatives","bestAlternativeIndex","bestSliceArea","alternativeIndex","alternative","sliceArea","tempCorners","worker_rpc","hasViewportToData","hasValidViewport","viewportToData","viewportAxes","previousViewportAxes","centerDataPosition","viewportPlaneDistanceToOrigin","visibleChunkLayouts","visibleSourcesStale","pixelSize","onHasValidViewport","onViewportChanged","maybeSetHasValidViewport","newPixelSize","onViewportToDataMatrixChanged","visibleSources","scaleIndex","numSources","smallestVoxelSize","renderScaleTarget","canImproveOnVoxelSize","targetSize","improvesOnPrevVoxelSize","prevVoxelSize","prevSize","addVisibleSource","transformedSource","sourceScaleIndex","existingSources","reverse","getLayoutObject","updateVisibleSources","globalCorners","sourcesLowerChunkBound","sourcesUpperChunkBound","positiveVertex","planeNormal","partiallyVisibleSources","fullyVisibleSources","layoutObject","sourcesLowerBound","sourcesUpperBound","computeSourcesChunkBounds","planeDistanceToOrigin","globalToLocalGrid","localCorner","partiallyVisibleSourcesLength","checkBounds","nextSplitDim","dimLower","dimUpper","diff","volume","positiveVertexDistanceToOrigin","negativeVertexDistanceToOrigin","normalValue","lowerValue","positiveOffset","intersectsPlane","newNextSplitDim","fullyVisibleSourcesLength","oldPartiallyVisibleSourcesLength","adjustSources","array","DEFAULT_MAX_VOXELS_PER_CHUNK_LOG2","maxChunkDataSize","findNextDimension","minSize","minDimension","nextDim","getTwoDimensionalBlockSize","flatDimension","additionalTransform","chunkLayoutPreference","ISOTROPIC","FLAT","getTwoDimensionalBlockSizes","getVolumeWithStatusMessage","ManagedUserLayerWithSpecification","TopLevelLayerListSpecification","LayerSubsetSpecification","registerLayerType","registerVolumeLayerType","neuroglancer_layer__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_sliceview_volume_base__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_status__WEBPACK_IMPORTED_MODULE_2__","neuroglancer_util_disposable__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_util_signal__WEBPACK_IMPORTED_MODULE_5__","dataSourceProvider","forPromise","getVolume","initialSpecification","layerSpec","layerSelectedValues","voxelCoordinatesSet","spatialCoordinatesSet","worker","layerObj","getUniqueLayerName","getLayer","layerType","makeUserLayer","layerConstructor","sourceUrl","volumeLayerTypes","layerTypes","initializeLayerFromSpec","numResults","layerJson","voxelCoordinates","rootLayers","master","masterLayerManager","layers","setVoxelCoordinates","setSpatialCoordinates","NavigationLinkType","VoxelSize","LinkedSpatialPosition","OrientationState","LinkedOrientationState","Pose","LinkedZoomState","NavigationState","neuroglancer_util_signal__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_util_trackable_enum__WEBPACK_IMPORTED_MODULE_4__","TrackableNavigationLink","LINKED","voxel","spatial","tempQuat","makeLinked","peer","operations","selfMinusPeer","updatingSelf","previousLinkValue","UNLINKED","handleLinkUpdate","linkValue","RELATIVE","difference","isValid","SpatialPosition","handleVoxelSizeChanged","voxelFromSpatial","spatialFromVoxel","markSpatialCoordinatesChanged","voxelCoordinates_","empty","voxelSizeJson","getVoxelCoordinates","voxelSizeValue","other","spatialOffset","voxelOffset","LinkedBase","getValueJson","getOffset","addOffset","amount","orientation","usedAxes","maxComponent","argmaxComponent","sign","peerToSelf","updatingPeer","selfToPeer","positionJson","orientationJson","snap","snapToVoxel","fixedPoint","fixedPointLocal","invOrientation","TrackableZoomState","NaN","factor","pose","zoomFactor","setZoomFactorFromVoxelSize","toMat4","zoom","poseJson","zoomFactorJson","zoomBy","numRenderScaleHistogramBins","getRenderScaleHistogramOffset","getRenderScaleFromHistogramOffset","trackableRenderScaleTarget","RenderScaleHistogram","neuroglancer_trackable_value__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_visibility_priority_frontend__WEBPACK_IMPORTED_MODULE_2__","_util_signal__WEBPACK_IMPORTED_MODULE_3__","renderScaleHistogramBinSize","renderScaleHistogramOrigin","renderScale","initialValue","frameNumber","spatialScales","numHistogramRows","fill","spatialScale","presentCount","notPresentCount","spatialScaleIndex","Tab","StackView","TabSpecification","TabView","neuroglancer_util_dom__WEBPACK_IMPORTED_MODULE_2__","neuroglancer_visibility_priority_frontend__WEBPACK_IMPORTED_MODULE_4__","classList","OptionSpecification","optionsChanged","selectedValue","ready_","validValue","tabVisibilityChanged","className","updateSelectedTab","selected","selectedTabValue","tab","displayedTab","newTab","hideTab","showTab","invalidateAll","tabBar","tabLabels","tabsGeneration","updateTabs","stack","labelElement","destroyTabs","makeTabs","optionsArray","order","aOrder","bOrder","AnnotationRenderHelper","registerAnnotationTypeRenderHandler","getAnnotationTypeRenderHandler","tempPickID","partIndexExpressions","_","addVertexCode","targetIsSliceView","addVarying","pickIdsPerInstance","addFragmentCode","renderContext","annotationLayer","uniformMatrix4fv","projectionMatrix","emitPickID","basePickId","emitColor","colorVec4","color","uniform4fv","saturationAmount","selectedIndex","annotationTypeRenderHandlers","moveThreshold","holdThreshold","maxTapDuration","multiTapMaxInterval","rotateThreshold","pinchThreshold","translateThreshold","norm2","deltaX","deltaY","getTwoFingerDistanceAndAngle","touches","t0","t1","offsetX","clientX","offsetY","clientY","atan2","touch_bindings_TouchEventBinder","prevTouches","moved","prevAngle","rotated","prevDistance","pinched","prevCenterX","prevCenterY","translated","startHold","throttle_default","centerX","centerY","info","targetTouches","numPriorTaps","priorTapNumTouches","tapStartTime","tapEndTime","curTapNumTouches","handleTouchEvent","event_action_map","newTouches","prevEvent","touch","newTouch","angleDiff","TAU","getAngleDifference","DOM_DELTA_PIXEL","DOM_DELTA_LINE","DOM_DELTA_PAGE","pickRadius","pickDiameter","pickOffsetSequence","clearOutOfBoundsPickData","rendered_data_panel_RenderedDataPanel","rendered_data_panel_FramePickingData","pickIDs","object_picking","viewportWidth","viewportHeight","PickRequest","glWindowX","glWindowY","pickRequestInterval","maxDist2","getDist2","offsets","subarray","baseOffset","startX","startY","relativeY","relativeX","display_context","viewer","mouseX","mouseY","pickRequestPending","mouseStateForcer","blockOnPickRequest","pickingData","pickRequests","pickBufferContents","pickTimerId","nextPickRequestTime","pendingPickRequestTimerId","pendingPickRequestTimerExpired","attemptToIssuePickRequest","inputEventMap","automatic_focus","keyboard_bindings","mouse_bindings","onMousemove","onTouchstart","onMouseout","navigationState","invokeAction","axisName","signStr","rotateRelative","tempOffset","translateVoxelsRelative","zoomByMouse","multiplier","deltaMode","exp","getWheelZoomAmount","mouse_drag","_event","translateByViewportPixels","delta","updateUnconditionally","selection","selectedLayer","selectedAnnotation","partIndex","selectedAnnotationId","annotationRef","ann","type_handler","repPoint","getRepresentativePoint","objectToGlobal","totDeltaVec","newRepPt","translateDataPointByViewportPixels","newAnnotation","updateViaRepresentativePoint","globalToObject","ref","handleMouseMove","ratio","sync","deleteSync","clientWidth","clientHeight","panelSizeChanged","pickRequest","PIXEL_PACK_BUFFER","STREAM_READ","issuePickRequest","fenceSync","SYNC_GPU_COMMANDS_COMPLETE","scheduleCheckForPickRequestCompletion","getBufferSubData","completePickRequest","checkForPickRequestCompletion","checkingBeforeDraw","block","currentFrameNumber","cancelIfNotReadyFrameNumber","available","remaining","cancelRemaining","getSyncParameter","SYNC_STATUS","SIGNALED","completePickInternal","canIssuePickRequest","issuePickRequestInternal","cancelPickRequests","checkForResize","newPickingData","drawWithPicking","updateMousePosition","setForcer","bounds","getBoundingClientRect","pageX","scrollX","pageY","scrollY","removeForcer","registerChunkFormatHandler","VolumeChunkSource","VolumeChunk","neuroglancer_sliceview_frontend__WEBPACK_IMPORTED_MODULE_0__","tempChunkGridPosition","tempLocalPosition","chunkFormatHandlers","factory","chunkFormatHandler","getChunkFormatHandler","chunkFormat","chunkGridPosition","localPosition","localPositionValue","dataPosition","getChannelValueAt","getObjectId","OBJECT_ID_SYMBOL","nextObjectId","KeyboardEventBinder","neuroglancer_util_event_action_map__WEBPACK_IMPORTED_MODULE_1__","globalKeys","DEFAULT_TEXT_INPUTS","modifierShortcutsAreGlobal","allShortcutsAreGlobal","allowSpaceKeyOnButtons","handleKeyDown","tagName","isFormElement","isContentEditable","ownerDocument","designMode","getEventKeyName","shouldIgnoreEvent","applyCompletionOffset","completionResult","getPrefixMatches","option","getPrefixMatchesWithDescriptions","getValue","getDescription","DepthBuffer","StencilBuffer","TextureBuffer","makeTextureBuffers","FramebufferConfiguration","OffscreenCopyHelper","neuroglancer_webgl_square_corners_buffer__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_webgl_texture__WEBPACK_IMPORTED_MODULE_4__","neuroglancer_webgl_trivial_shaders__WEBPACK_IMPORTED_MODULE_5__","SizeManaged","hasSize","performResize","Renderbuffer","internalformat","renderbuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","deleteRenderbuffer","attachment","framebufferRenderbuffer","FRAMEBUFFER","includeStencilBuffer","DEPTH_STENCIL","DEPTH_COMPONENT16","attachToFramebuffer","DEPTH_STENCIL_ATTACHMENT","DEPTH_ATTACHMENT","Framebuffer","framebuffer","createFramebuffer","deleteFramebuffer","bindFramebuffer","internalFormat","texture","createTexture","deleteTexture","framebufferTexture2D","RGBA8","tempPixel","tempPixelUint32","tempPixelFloat32","configuration","fullAttachmentList","attachmentVerified","singleAttachmentList","COLOR_ATTACHMENT0","colorBuffers","depthBuffer","resize","drawBuffers","verifyAttachment","viewport","textureIndex","bindTexture","unbind","bindSingle","readPixels","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","copyVertexPositionsBuffer","copyTexCoordsBuffer","textures","numTextures","activeTexture","TEXTURE0","aVertexPosition","attribute","bindToVertexAttrib","aTexCoord","drawArrays","TRIANGLE_FAN","disableVertexAttribArray","shaderModule","getObjectKey","objectId","forEachVisibleSegment","visibleSegments","segmentEquivalences","rootObjectId","disjointSets","isMinElement","setElements","DataSource","DataSourceProvider","neuroglancer_util_completion__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_util_disposable__WEBPACK_IMPORTED_MODULE_2__","findSourceGroupBasedOnSeparator","separator","lastIndexOf","protocolPattern","dataSources","dataSource","getDataSource","getAnnotationSource","getVectorGraphicsSource","getMeshSource","getSkeletonSource","protocolMatch","protocol","completions","volumeCompleter","suggestor","suggestLayerName","groupIndex","suggestLayerNameBasedOnSeparator","dataSourceName","findSourceGroup","registerProvider","getDefaultDataSourceProvider","neuroglancer_datasource__WEBPACK_IMPORTED_MODULE_0__","providerFactories","provider","register","partitionArray","start","end","maybePadArray","newSize","newArray","tile2dArray","majorDimension","minorTiles","majorTiles","minorDimension","minorTileStride","majorTileStride","minorStride","minor","major","inputValue","minorTile","majorTile","binarySearch","haystack","needle","compare","mid","compareResult","getDesiredMultiscaleMeshChunks","manifest","modelViewProjection","detailCutoff","octree","lodScales","chunkGridSpatialOrigin","chunkShape","maxLod","minWXcoeff","minWYcoeff","minWZcoeff","getPointW","minWClip","objectXLower","clipLowerBound","objectYLower","objectZLower","objectXUpper","clipUpperBound","objectYUpper","objectZUpper","scaleFactor","handleChunk","lod","row","priorLodScale","rowOffset","gridX","gridY","gridZ","childBegin","childEndAndEmpty","getBoxW","lodScale","nextPriorLodScale","childEnd","childRow","getMultiscaleChunksToDraw","hasChunk","stackEntryStride","stackDepth","priorSubChunkIndex","emitChunksUpTo","targetStackIndex","subChunkIndex","stackIndex","entryLod","entryRow","numSubChunks","entrySubChunkIndex","entryRenderScale","endSubChunk","priorMissingLod","getOctreeChildIndex","stackOffset","getMultiscaleFragmentKey","objectKey","chunkIndex","frontend_MeshLayer","frontend_MeshSource","frontend_MultiscaleMeshLayer","frontend_MultiscaleMeshSource","tempMat4","tempModelMatrix","tempMat3","DEBUG_MULTISCALE_FRAGMENTS","copyMeshDataToGpu","vertexBuffer","meshData","vertexPositions","indexBuffer","indices","ELEMENT_ARRAY_BUFFER","normalBuffer","vertexNormals","freeGpuMeshData","glsl_decodeNormalOctahedronSnorm8","getFloatPositionHandler","glAttributeType","addAttribute","fragmentChunk","endLayer","vertexPositionHandlers","mesh_base","float32","uint16","uint10","bindToVertexAttribI","frontend_MeshShaderManager","fragmentRelativeVertices","vertexPositionFormat","tempLightVec","vertexPositionHandler","setVertexMain","setFragmentMain","lightDirection","ambientLighting","directionalLighting","lightVec","pickID","modelMat","dataToDevice","uniformMatrix3fv","object_id","webgl_shader","indexBegin","indexEnd","BYTE","drawElements","strips","TRIANGLE_STRIP","TRIANGLES","drawFragmentHelper","subChunkBegin","subChunkEnd","subChunkOffsets","render_layer","displayState","meshShaderManager","segmentation_display_state_frontend","sharedObject","backend","initializeCounterpartWithChunkManager","addCounterpartRef","setReady","renderScaleHistogram","isTransparent","objectAlpha","alreadyEmittedPickID","alpha","objectToDataMatrix","objectToDataTransform","beginLayer","beginModel","manifestChunks","totalChunks","presentChunks","fragmentChunks","segmentation_display_state_base","manifestChunk","setColor","setPickID","registerUint64","fragmentIds","fragmentId","fragment","drawFragment","begin","frontend_ManifestChunk","frontend_FragmentChunk","frontend_FragmentSource","meshSource","hasFragmentChunk","scaleMultiplier","vertexOffsets","fragmentKey","uniform3f","drawMultiscaleFragment","hasAllChunks","frontend_MultiscaleManifestChunk","frontend_MultiscaleFragmentChunk","frontend_MultiscaleFragmentSource","Uint64MapEntry","SegmentSelectionState","registerRedrawWhenSegmentationDisplayStateChanged","registerRedrawWhenSegmentationDisplayState3DChanged","getObjectColor","SegmentationLayerSharedObject","neuroglancer_util_colorspace__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_util_geom__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_visibility_priority_frontend__WEBPACK_IMPORTED_MODULE_6__","neuroglancer_worker_rpc__WEBPACK_IMPORTED_MODULE_7__","selectedSegment","hasSelectedSegment","existingValue","equal","dispatchRedrawNeeded","segmentColorHash","saturation","highlightedSegments","segmentSelectionState","registerRedrawWhenSegmentationDisplayStateWithAlphaChanged","tempColor","isSelected","hsv","rgb","SliceView","SliceViewChunkSource","SliceViewChunk","SliceViewRenderHelper","neuroglancer_chunk_manager_base__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_chunk_manager_frontend__WEBPACK_IMPORTED_MODULE_2__","neuroglancer_sliceview_base__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_sliceview_renderlayer__WEBPACK_IMPORTED_MODULE_4__","neuroglancer_util_disposable__WEBPACK_IMPORTED_MODULE_5__","neuroglancer_util_geom__WEBPACK_IMPORTED_MODULE_6__","neuroglancer_util_object_id__WEBPACK_IMPORTED_MODULE_7__","neuroglancer_util_signal__WEBPACK_IMPORTED_MODULE_8__","neuroglancer_visibility_priority_frontend__WEBPACK_IMPORTED_MODULE_9__","neuroglancer_webgl_offscreen__WEBPACK_IMPORTED_MODULE_10__","neuroglancer_webgl_shader__WEBPACK_IMPORTED_MODULE_11__","neuroglancer_webgl_square_corners_buffer__WEBPACK_IMPORTED_MODULE_12__","neuroglancer_worker_rpc__WEBPACK_IMPORTED_MODULE_13__","tempMat","dataToViewport","viewportToDevice","visibleChunks","viewChanged","renderingStale","visibleChunksStale","visibleLayerList","offscreenFramebuffer","numVisibleChunks","updateVisibleLayersNow","invalidateVisibleSources","visibleLayerDisposers","setViewportSizeDebounced","setViewportSize","updateViewportFromNavigationState","maybeUpdateVisibleChunks","numValidChunks","setViewportToDataMatrix","rpcMessage","bindVisibleRenderLayer","disable","SCISSOR_TEST","clearStencil","clearColor","colorMask","COLOR_BUFFER_BIT","enable","STENCIL_TEST","DEPTH_TEST","stencilOpSeparate","FRONT_AND_BACK","KEEP","REPLACE","renderLayerNum","STENCIL_BUFFER_BIT","stencilFuncSeparate","GREATER","setGLBlendMode","draw","BLEND","updateVisibleChunks","allVisibleChunks","computeVisibleChunks","_chunkLayout","positionInChunks","encoding","textureCoordinateAdjustment","colorFactor","backgroundColor","xStart","yStart","xEnd","yEnd","makeWatchableShaderError","makeTrackableFragmentMain","ShaderGetter","parameterizedEmitterDependentShaderGetter","neuroglancer_util_object_id__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_webgl_shader__WEBPACK_IMPORTED_MODULE_4__","getShaderKey","shaderError","shaderUpdated","newShader","disposeShader","buildShader","memoizeKey","fallbackParameters","stringMemoizeKey","getNewShader","entry","oldShader","_a","trackableAlphaValue","CompoundTrackable","getCachedJson","children","baseJSON","subValue","restoreError","jsonCache","WeakMap","root","cacheState","overlaysOpen","Overlay","neuroglancer_util_automatic_focus__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_util_keyboard_bindings__WEBPACK_IMPORTED_MODULE_2__","defaultEventMap","fromObject","escape","keyMap","container","focus","userAgent","navigator","platform","gecko","ie_upto10","ie_11up","exec","edge","ie","ie_version","documentMode","webkit","qtwebkit","chrome","presto","safari","vendor","mac_geMountainLion","phantom","ios","android","mobile","mac","chromeOS","windows","presto_version","flipCtrlCmd","captureRightClick","classTest","cls","range","rmClass","node","current","after","removeChildrenAndAdd","elt","tag","eltP","contains","nodeType","host","activeElt","activeElement","shadowRoot","addClass","joinClasses","as","createRange","endNode","setEnd","setStart","createTextRange","moveToElementText","collapse","moveEnd","moveStart","selectInput","select","copyObj","overwrite","prop","countColumn","string","tabSize","startIndex","startValue","search","nextTab","selectionStart","selectionEnd","Delayed","ms","scrollerGap","Pass","sel_dontScroll","scroll","sel_mouse","origin","sel_move","findColumn","goal","pos","col","skipped","spaceStrs","spaceStr","lst","arr","nothing","createObj","props","inst","nonASCIISingleCaseWordChar","isWordCharBasic","ch","isWordChar","helper","isEmpty","extendingChars","isExtendingChar","skipExtendingChars","dir","findFirst","pred","to","midF","Display","place","doc","scrollbarFiller","gutterFiller","lineDiv","selectionDiv","cursorDiv","measure","lineMeasure","lineSpace","mover","sizer","sizerWidth","heightForcer","gutters","lineGutter","scroller","wrapper","zIndex","paddingRight","draggable","viewFrom","viewTo","first","reportedViewFrom","reportedViewTo","renderedView","externalMeasured","viewOffset","lastWrapHeight","lastWrapWidth","updateLineNumbers","nativeBarWidth","barHeight","barWidth","scrollbarsClipped","lineNumWidth","lineNumInnerWidth","lineNumChars","alignWidgets","cachedCharWidth","cachedTextHeight","cachedPaddingH","maxLine","maxLineLength","maxLineChanged","wheelDX","wheelDY","wheelStartX","wheelStartY","selForContextMenu","activeTouch","getLine","getBetween","iter","getLines","updateLineHeight","lineNo","cur","no","lineAtHeight","h","outer","i$1","lh","isLine","lineNumberFor","lineNumberFormatter","firstLineNumber","Pos","sticky","cmp","equalCursorPos","copyPos","maxPos","minPos","clipLine","clipPos","last","linelen","clipToLen","clipPosArray","sawReadOnlySpans","sawCollapsedSpans","MarkedSpan","marker","getMarkedSpanFor","spans","span","removeMarkedSpan","stretchSpansOverChange","change","full","oldFirst","markedSpans","oldLast","startCh","endCh","isInsert","nw","startsBefore","inclusiveLeft","insertLeft","endsAfter","inclusiveRight","markedSpansBefore","markedSpansAfter","sameLine","found","span$1","found$1","clearEmptySpans","newMarkers","gapMarkers","gap","i$2","i$3","clearWhenEmpty","detachMarkedSpans","detachLine","attachMarkedSpans","attachLine","extraLeft","extraRight","compareCollapsedMarkers","lenDiff","aPos","bPos","fromCmp","toCmp","collapsedSpanAtSide","sps","sp","collapsed","collapsedSpanAtStart","collapsedSpanAtEnd","collapsedSpanAround","conflictingCollapsedRange","lineNo$$1","visualLine","merged","visualLineNo","lineN","vis","visualLineEndNo","lastLine","lineIsHidden","widgetNode","lineIsHiddenInner","heightAtLine","lineObj","lineLength","findMaxLine","cm","bidiOther","getBidiPartAt","bidiOrdering","lowTypes","arabicTypes","bidiRE","isNeutral","isStrong","countsAsLeft","countsAsNum","BidiSpan","level","direction","outerType","types","prev","type$1","prev$1","type$2","i$4","type$3","i$5","cur$1","type$4","i$6","end$1","replace$1","j$1","i$7","at","j$2","nstart","unshift","getOrder","noHandlers","on","attachEvent","map$$1","_handlers","getHandlers","off","detachEvent","signalDOMEvent","override","defaultPrevented","e_defaultPrevented","codemirrorIgnore","signalCursorActivity","cursorActivity","curOp","cursorActivityHandlers","hasHandler","eventMixin","ctor","e_preventDefault","returnValue","e_stopPropagation","cancelBubble","e_stop","e_target","srcElement","e_button","which","zwspSupported","badBidiRects","dragAndDrop","zeroWidthElement","offsetHeight","offsetWidth","hasBadBidiRects","txt","r0","r1","splitLinesAuto","nl","rt","hasSelection","getSelection","te","range$$1","compareEndPoints","hasCopyEvent","oncopy","badZoomedRects","modes","mimeModes","resolveMode","getMode","mfactory","modeObj","modeExtensions","exts","helperType","modeProps","prop$1","extendMode","properties","copyState","nstate","innerMode","startState","StringStream","lineOracle","lastColumnPos","lastColumnValue","lineStart","eol","sol","peek","next","eat","eatWhile","eatSpace","skipToEnd","skipTo","backUp","column","indentation","consume","caseInsensitive","cased","hideFirstChars","lookAhead","oracle","baseToken","SavedContext","Context","maxLookAhead","baseTokens","baseTokenPos","highlightLine","forceToEnd","st","modeGen","lineClasses","runMode","loop","overlay","overlays","i_end","opaque","classes","bgClass","textClass","getLineStyles","updateFrontier","getContextBefore","resetState","maxHighlightLength","stateAfter","save","styleClasses","highlightFrontier","modeFrontier","precise","minindent","minline","lim","indented","findStartLine","saved","fromSaved","processLine","nextLine","startAt","stream","callBlankLine","readToken","blankLine","Token","takeToken","asArray","tokens","extractLineClasses","output","lineClass","flattenSpans","curStart","curStyle","addModeClass","mName","Line","estimateHeight","cleanUpLine","styleToClassCache","styleToClassCacheWithMode","interpretTokenStyle","buildLineContent","lineView","pre","trailingSpace","splitSpaces","getOption","rest","addToken","buildToken","buildTokenBadBidi","allowFrontierUpdate","insertLineContent","maps","caches","lastChild","defaultSpecialCharPlaceholder","title","startStyle","endStyle","displayText","trailingBefore","spaceBefore","special","specialChars","mustWrap","createDocumentFragment","lastIndex","txt$1","tabWidth","specialCharPlaceholder","fullStyle","attr","buildCollapsedSpan","ignoreWidget","widget","needsContentAttribute","setUneditable","allText","spanStyle","spanEndStyle","spanStartStyle","nextChange","foundBookmarks","endStyles","upto","tokenText","LineView","visualLineContinued","hidden","buildViewArray","nextPos","operationGroup","orphanDelayedCallbacks","signalLater","delayedCallbacks","fireOrphanDelayed","delayed","updateLineForChanges","dims","changes","updateLineText","updateLineGutter","updateLineClasses","updateLineWidgets","ensureLineWrapped","replaceChild","getLineContent","ext","built","background","wrap","updateLineBackground","wrapClass","gutter","gutterBackground","gutterClass","fixedGutter","fixedPos","gutterTotalWidth","markers","gutterMarkers","lineNumbers","wrap$1","gutterWrap","lineNumber","gutterLeft","gutterWidth","alignable","insertLineWidgets","buildLineElement","insertLineWidgetsFor","allowAbove","widgets","handleMouseEvents","positionLineWidget","above","noHScroll","wrapperWidth","coverGutter","paddingLeft","marginLeft","widgetHeight","parentStyle","eventInWidget","getAttribute","paddingTop","offsetTop","paddingVert","paddingH","getComputedStyle","currentStyle","scrollGap","displayWidth","displayHeight","mapFromLineView","measureChar","bias","measureCharPrepared","prepareMeasureForLine","findViewForLine","findViewIndex","getDimensions","forceUpdate","updateExternalMeasurement","rect","hasHeights","prepared","varHeight","wrapping","lineWrapping","curWidth","heights","rects","getClientRects","ensureLineHeights","nodeAndOffsetInLineMap","coverStart","coverEnd","getUsefulRect","screen","logicalXDPI","deviceXDPI","normal","fromRange","hasBadZoomedRects","scaleX","scaleY","logicalYDPI","deviceYDPI","maybeUpdateRectForZooming","rSpan","charWidth","nullRect","rtop","rbot","bot","bogus","singleCursorHeightPerLine","rbottom","measureCharInner","measureText","mStart","mEnd","clearLineMeasurementCacheFor","clearLineMeasurementCache","externalMeasure","clearCaches","pageScrollX","pageXOffset","documentElement","scrollLeft","pageScrollY","marginTop","pageYOffset","scrollTop","widgetTopHeight","intoCoordSystem","includeWidgets","yOff","lOff","xOff","fromCoordSystem","coords","localBox","lineSpaceBox","charCoords","cursorCoords","preparedMeasure","getBidi","partPos","estimateCoords","PosWithInfo","outside","xRel","coordsChar","coordsCharInner","rangeEnd","wrappedLineExtent","wrappedLineExtentChar","targetTop","boxIsAfter","box","widgetHeight$$1","ltr","_lineNo","closestDist","endX","baseX","chAround","boxAround","atLeft","atStart","textHeight","anchor","clientLeft","offsetLeft","compensateForHScroll","th","perLine","widgetsHeight","estimateLineHeights","est","estHeight","posFromMouse","liberal","forRect","space","colDiff","updateSelection","showSelection","prepareSelection","primary","curFragment","cursors","selFragment","sel","ranges","primIndex","showCursorWhenSelecting","drawSelectionCursor","drawSelectionRange","cursor","cursorHeight","otherCursor","cmpCoords","padding","leftSide","rightSide","docLTR","drawForLine","fromArg","toArg","lineLen","wrapX","side","iterateBidiSections","fromPos","toPos","openStart","openEnd","openLeft","openRight","topLeft","topRight","botLeft","botRight","sFrom","sTo","fromLine","toLine","singleVLine","leftEnd","rightStart","restartBlink","focused","clearInterval","blinker","cursorBlinkRate","setInterval","ensureFocus","onFocus","delayBlurEvent","delayingBlurEvent","onBlur","readOnly","receivedFocus","updateHeightsInViewport","prevBottom","updateWidgetHeight","chWidth","visibleLines","ensure","ensureFrom","ensureTo","alignHorizontally","comp","gutterW","align","maybeUpdateLineNumberWidth","innerW","updateGutterSpace","calculateScrollPos","snapMargin","screentop","docBottom","atTop","atBottom","newTop","screenleft","screenw","tooWide","addToScrollTop","resolveScrollToPos","ensureCursorVisible","getCursor","scrollToPos","margin","cursorScrollMargin","scrollToCoords","scrollToCoordsRange","sPos","updateScrollTop","updateDisplaySimple","setScrollTop","startWorker","forceScroll","scrollHeight","scrollbars","setScrollLeft","isScroller","scrollWidth","measureForScrollbars","docH","viewHeight","viewWidth","barLeft","docHeight","NativeScrollbars","vert","horiz","tabIndex","checkedZeroWidth","minHeight","minWidth","needsH","needsV","sWidth","totalHeight","totalWidth","zeroWidthHack","disableHoriz","enableZeroWidthBar","disableVert","pointerEvents","bar","maybeDisable","elt$$1","elementFromPoint","NullScrollbars","updateScrollbars","startWidth","startHeight","updateScrollbarsInner","sizes","paddingBottom","borderBottom","coverGutterNextToScrollbar","scrollbarModel","native","null","initScrollbars","scrollbarStyle","nextOpId","startOperation","op","updateInput","typing","changeObjs","cursorActivityCalled","selectionChanged","updateMaxLine","ops","ownsGroup","endOperation","endCb","group","callbacks","fireCallbacksForOps","finishOperation","endOperation_R1","updatedDisplay","mustUpdate","updateDisplayIfNeeded","endOperation_R2","endOperation_W2","endOperation_finish","endOperations","marginBottom","borderRightWidth","maybeClipScrollbars","DisplayUpdate","barMeasure","adjustWidthTo","maxScrollLeft","preparedSelection","takeFocus","setDocumentHeight","postUpdateDisplay","limit","endCoords","scrollPos","startTop","startLeft","scrollPosIntoView","doScroll","innerHeight","scrollNode","scrollIntoView","maybeScrollWindow","maybeHiddenMarkers","unhidden","maybeUnhiddenMarkers","finish","runInOp","operation","methodOp","docMethodOp","regChange","lendiff","resetView","cut","viewCuttingPoint","cut$1","cutTop","cutBot","regLineChange","oldN","newN","countDirtyView","dirty","highlight","highlightWorker","workTime","changedLines","oldStyles","highlighted","oldCls","newCls","ischange","workDelay","force","editorIsHidden","wrapperHeight","oldDisplayWidth","events","viewportMargin","different","adjustView","toUpdate","selSnapshot","hasFocus","anchorNode","extend","anchorOffset","focusNode","focusOffset","selectionSnapshot","updateNumbersFrom","rm","currentWheelTarget","updateNumber","patchDisplay","snapshot","removeAllRanges","addRange","restoreSelection","updateGutters","specs","gElt","setGuttersForLineNumbers","wheelSamples","wheelPixelsPerUnit","wheelEventDelta","dx","wheelDeltaX","dy","wheelDeltaY","HORIZONTAL_AXIS","VERTICAL_AXIS","wheelDelta","wheelEventPixels","onScrollWheel","canScrollX","canScrollY","pixels","movedX","movedY","sample","Selection","here","there","deepCopy","Range","somethingSelected","normalizeSelection","mayTouch","selectionsMayTouch","prim","inv","simpleSelection","changeEnd","adjustForChange","computeSelAfterChange","offsetPos","loadMode","modeOption","resetModeState","isWholeLineUpdate","wholeLineUpdateBefore","updateDoc","estimateHeight$$1","spansFor","updateLine","linesFor","firstLine","lastText","lastSpans","nlines","insert","added","added$1","added$2","linkedDocs","sharedHistOnly","propagate","skip","sharedHist","linked","shared","attachDoc","setDirectionClass","History","startGen","done","undone","undoDepth","lastModTime","lastSelTime","lastOp","lastSelOp","lastOrigin","lastSelOrigin","maxGeneration","historyChangeFromChange","histChange","attachLocalSpans","clearSelectionEvents","pop","addChangeToHistory","selAfter","opId","hist","history","historyEventDelay","lastChangeEvent","pushSelectionToHistory","addSelectionToHistory","selectionEventCanBeMerged","clearRedo","dest","removeClearedSpans","explicitlyCleared","mergeOldSpans","getOldSpans","stretched","oldCur","stretchCur","copyHistoryArray","newGroup","instantiateSel","newChanges","extendRange","posBefore","extendSelection","setSelection","extendSelections","heads","newSel","replaceOneSelection","setSimpleSelection","setSelectionReplaceHistory","setSelectionNoUndo","filterSelectionChange","setSelectionInner","skipAtomicInSelection","reCheckSelection","mayClear","newAnchor","skipAtomic","newHead","skipAtomicInner","oldPos","atomic","movePos","cantEdit","selectAll","filterChange","canceled","makeChange","ignoreReadOnly","suppressEdits","mark","mk","newParts","dfrom","dto","removeReadOnlyRanges","makeChangeInner","makeChangeSingleDoc","rebased","rebaseHist","makeChangeFromHistory","allowSelectionOnly","suppress","antiChanges","returned","shiftDoc","removed","recomputeMaxLength","checkWidthStart","retreatFrontier","changesHandler","changeHandler","makeChangeSingleDocInEditor","replaceRange","splitLines","rebaseHistSelSingle","rebaseHistArray","copied","changeLine","handle","changeType","LeafChunk","BranchChunk","removeInner","insertInner","iterN","oldHeight","leaf","maybeSpill","me","spilled","sibling","myIndex","used","LineWidget","opt","adjustScrollWhenAboveVisible","this$1","oldH","nextMarkerId","TextMarker","markText","cloneNode","isParent","SharedTextMarker","markTextShared","replacedWith","addToHistory","curLine","addMarkedSpan","clearOnEnter","clearHistory","withOp","visual","dHeight","findSharedMarkers","findMarks","detachSharedMarkers","subMarker","nextDocId","Doc","lineSep","cleanGeneration","lineSeparator","setValue","getRange","getLineHandle","getLineNumber","getLineHandleVisualStart","lineCount","listSelections","setCursor","extendSelectionsBy","setSelections","addSelection","getSelections","replaceSelection","dup","replaceSelections","hint","oldPrev","newPrev","computeReplacedSel","undo","redo","undoSelection","redoSelection","setExtending","getExtending","historySize","markClean","changeGeneration","forceSplit","isClean","getHistory","setHistory","histData","setGutterMarker","gutterID","clearGutter","lineInfo","addLineClass","where","removeLineClass","addLineWidget","aboveVisible","removeLineWidget","setBookmark","realOpts","findMarksAt","getAllMarks","posFromIndex","sepSize","indexFromPos","copyHistory","linkedDoc","mFrom","mTo","subMark","copySharedMarkers","unlinkDoc","CodeMirror","splitIds","iterLinkedDocs","getEditor","setDirection","eachLine","lastDrop","onDrop","clearDragCursor","files","dataTransfer","isReadOnly","FileReader","File","read","loadFile","allowDropFileTypes","reader","readAsText","draggingText","text$1","getData","dragCursor","forEachCodeMirror","getElementsByClassName","byClass","editors","globalsRegistered","ensureGlobalHandlers","resizeTimer","onResize","setSize","keyNames","3","8","9","13","16","17","18","19","20","27","32","33","34","35","36","37","38","39","40","44","45","46","59","61","91","92","93","106","107","109","110","111","127","145","173","186","187","188","189","190","191","192","219","220","221","222","63232","63233","63234","63235","63272","63273","63275","63276","63277","63302","normalizeKeyName","alt","ctrl","cmd","mod","normalizeKeyMap","keymap","keyname","lookupKey","getKeyMap","fallthrough","isModifierKey","keyCode","addModifierNames","noShift","altGraphKey","deleteNearSelection","kill","toKill","replaced","moveCharLogically","moveLogically","endOfLine","visually","moveInStorageOrder","prep","basic","Left","Right","Up","Down","End","Home","PageUp","PageDown","Delete","Backspace","Shift-Backspace","Shift-Tab","Enter","Insert","Esc","pcDefault","Ctrl-A","Ctrl-D","Ctrl-Z","Shift-Ctrl-Z","Ctrl-Y","Ctrl-Home","Ctrl-End","Ctrl-Up","Ctrl-Down","Ctrl-Left","Ctrl-Right","Alt-Left","Alt-Right","Ctrl-Backspace","Ctrl-Delete","Ctrl-S","Ctrl-F","Ctrl-G","Shift-Ctrl-G","Shift-Ctrl-F","Shift-Ctrl-R","Ctrl-[","Ctrl-]","Ctrl-U","Shift-Ctrl-U","Alt-U","emacsy","Ctrl-B","Ctrl-P","Ctrl-N","Alt-F","Alt-B","Ctrl-E","Ctrl-V","Shift-Ctrl-V","Ctrl-H","Alt-D","Alt-Backspace","Ctrl-K","Ctrl-T","Ctrl-O","macDefault","Cmd-A","Cmd-D","Cmd-Z","Shift-Cmd-Z","Cmd-Y","Cmd-Home","Cmd-Up","Cmd-End","Cmd-Down","Cmd-Left","Cmd-Right","Ctrl-Alt-Backspace","Alt-Delete","Cmd-S","Cmd-F","Cmd-G","Shift-Cmd-G","Cmd-Alt-F","Shift-Cmd-Alt-F","Cmd-[","Cmd-]","Cmd-Backspace","Cmd-Delete","Cmd-U","Shift-Cmd-U","commands","singleSelection","killLine","deleteLine","delLineLeft","delWrappedLineLeft","leftPos","delWrappedLineRight","rightPos","goDocStart","goDocEnd","goLineStart","goLineStartSmart","lineStartSmart","goLineEnd","visualLineEnd","lineEnd","goLineRight","goLineLeft","goLineLeftSmart","goLineUp","moveV","goLineDown","goPageUp","goPageDown","goCharLeft","moveH","goCharRight","goColumnLeft","goColumnRight","goWordLeft","goGroupRight","goGroupLeft","goWordRight","delCharBefore","deleteH","delCharAfter","delWordBefore","delWordAfter","delGroupBefore","delGroupAfter","indentAuto","indentSelection","indentMore","indentLess","insertTab","insertSoftTab","spaces","defaultTab","execCommand","transposeChars","newlineAndIndent","sels","indentLine","openLine","toggleOverwrite","firstNonWS","inWS","doHandleBinding","bound","dropShift","ensurePolled","prevShift","stopSeq","dispatchKey","seq","keySeq","dispatchKeyInner","keyMaps","extraKeys","lookupKeyForEditor","handleKeyBinding","motion","lastStoppedKey","onKeyDown","handled","showCrossHair","onKeyUp","onKeyPress","charCode","handleCharBinding","lastClick","lastDoubleClick","PastClick","onMouseDown","supportsTouch","clickInGutter","clickRepeat","selectingText","handleMappedButton","contained","behavior","unit","addNew","moveOnDrag","configureMouse","dragDrop","dragEnd","mouseMove","dragStart","e2","leftButtonStartDrag","ourRange","ourIndex","startSel","rangeForUnit","lastPos","extendTo","startCol","posCol","oldRange","ranges$1","anchorLine","boundary","headIndex","usePart","bidiSimplify","editorSize","counter","move","buttons","curCount","leftButtonSelect","leftButtonDown","onContextMenu","findWordAt","gutterEvent","prevent","mX","mY","lineBox","g","contextMenuInGutter","themeChanged","theme","Init","defaults","optionHandlers","guttersChanged","dragDropChanged","wasOn","funcs","dragFunctions","toggle","enter","over","leave","drop","wrappingChanged","inputStyles","inputStyle","pasteIncoming","cutIncoming","autofocus","word","touchFinished","prevTouch","finishTouch","farAway","radiusX","radiusY","isMouseLikeTouchEvent","frag","onDragOver","effectAllowed","setDragImage","img","_top","onDragStart","inp","getField","registerEventHandlers","finishInit","initHooks","textRendering","how","aggressive","indent","curSpace","curSpaceString","indentUnit","indentString","indentWithTabs","pos$1","defineInitHook","lastCopied","setLastCopied","newLastCopied","applyTextInput","inserted","deleted","recent","paste","textLines","multiPaste","pasteLinesPerSelection","lineWise","changeEvent","triggerElectric","handlePaste","pasted","clipboardData","disableInput","electricChars","smartIndent","getModeAt","electricInput","copyableRanges","lineRange","disableBrowserMagic","field","spellcheck","autocorrect","autocapitalize","hiddenTextarea","border","findPosH","origDir","moveOnce","boundToLine","bidi","mv","getWrappedLineExtent","searchInVisualLine","getRes","res","nextCh","moveVisually","sawType","getHelper","hitSide","findPosV","pageSize","moveAmount","ContentEditableInput","lastAnchorNode","lastAnchorOffset","lastFocusNode","lastFocusOffset","polling","composing","gracePeriod","readDOMTimeout","posToDOM","badPos","bad","domToPos","lineNode","locateNodeInLineView","textNode","topNode","nodeValue","curNode","previousSibling","dist$1","onCopyCut","lineWiseCopyCut","clearData","kludge","hadFocus","showPrimarySelection","updateFromDOM","readFromDOMSoon","forceCompositionEnd","showMultipleSelections","curAnchor","curFocus","rng","rangeCount","getRangeAt","startGracePeriod","rememberSelection","selectionInEditor","commonAncestorContainer","blur","pollSelection","pollInterval","poll","scan","isInGutter","triggerOnKeyDown","pollContent","fromIndex","fromNode","toNode","toIndex","newText","closing","extraLinebreak","close","addText","walk","cmText","markerID","isBlock","nodeName","domTextBetween","oldText","cutFront","cutEnd","oldTop","maxCutFront","newBot","oldBot","maxCutEnd","chFrom","chTo","contentEditable","readOnlyChanged","resetPosition","TextareaInput","prevInput","pollingFast","createField","textarea","prepareCopyCut","fastPoll","_display","moveInputWithCursor","headPos","wrapOff","lineOff","teTop","teLeft","drawn","contextMenuPending","slowPoll","missed","same","resetSelectionOnContextMenu","oldScrollY","oldCSS","oldWrapperCSS","wrapperBox","offsetParent","scrollTo","rehide","detectingSelectAll","prepareSelectAllHack","mouseup","extval","disabled","deflt","notOnInit","defineOption","newBreaks","refresh","getInputField","detach","attach","integer","defineOptions","helpers","setOption","getDoc","addKeyMap","removeKeyMap","addOverlay","score","insertSorted","modeSpec","removeOverlay","newRanges","getTokenAt","getLineTokens","getTokenTypeAt","getHelpers","help","_global","getStateAfter","defaultTextHeight","defaultCharWidth","getViewport","addWidget","vspace","hspace","triggerOnKeyPress","triggerOnKeyUp","triggerOnMouseDown","rtlMoveVisually","goalColumn","goals","startChar","check","getScrollInfo","scrollToRange","interpret","swapDoc","phrase","phraseText","phrases","getWrapperElement","getScrollerElement","getGutterElement","registerHelper","registerGlobalHelper","addEditorMethods","dontDelegate","method","contenteditable","defineMode","dependencies","defineMIME","mime","defineExtension","defineDocExtension","fromTextArea","tabindex","placeholder","realSubmit","form","leaveSubmitMethodAlone","submit","wrappedSubmit","getTextArea","toTextArea","cmpPos","addLegacyProps","version","getRandomHexString","numBits","numValues","byteArray","getRandomUint32","ANNOTATION_METADATA_CHUNK_SOURCE_RPC_ID","ANNOTATION_GEOMETRY_CHUNK_SOURCE_RPC_ID","ANNOTATION_SUBSET_GEOMETRY_CHUNK_SOURCE_RPC_ID","ANNOTATION_REFERENCE_ADD_RPC_ID","ANNOTATION_REFERENCE_DELETE_RPC_ID","ANNOTATION_COMMIT_UPDATE_RPC_ID","ANNOTATION_COMMIT_UPDATE_RESULT_RPC_ID","AnnotationGeometryChunkSpecification","ANNOTATION_PERSPECTIVE_RENDER_LAYER_RPC_ID","ANNOTATION_RENDER_LAYER_RPC_ID","ANNOTATION_RENDER_LAYER_UPDATE_SEGMENTATION_RPC_ID","MESH_LAYER_RPC_ID","MULTISCALE_MESH_LAYER_RPC_ID","FRAGMENT_SOURCE_RPC_ID","MULTISCALE_FRAGMENT_SOURCE_RPC_ID","VertexPositionFormat","pickLengthUnit","pickVolumeUnit","ScaleBarTexture","TrackableScaleBarOptions","DEFAULT_ALLOWED_SIGNIFICANDS","ALLOWED_UNITS","lengthInNanometers","numAllowedUnits","allowedUnit","volumeInCubicNanometers","ScaleBarDimensions","allowedSignificands","targetLengthInPixels","nanometersPerPixel","prevNanometersPerPixel","prevTargetLengthInPixels","targetNanometers","exponent","LN10","tenToThePowerExponent","targetSignificand","bestSignificand","allowedSignificand","physicalNanometers","lengthInPixels","physicalUnit","physicalLength","dimensions","priorOptions","defaultScaleBarTextureOptions","canvas","ctx","getContext","textHeightInPixels","font","fontName","fillStyle","textMetrics","innerWidth","barHeightInPixels","barTopMargin","barTopMarginInPixels","paddingInPixels","textAlign","fillRect","fillText","makeScaleBarTexture","defaultScaleBarOptions","maxWidthInPixels","maxWidthFraction","leftPixelOffset","bottomPixelOffset","parseScaleBarOptions","RangeWidget","neuroglancer_util_dom__WEBPACK_IMPORTED_MODULE_1__","step","promptElement","inputElement","valueAsNumber","inputValueChanged","stepUp","stepDown","SKELETON_LAYER_RPC_ID","FRAGMENT_MAIN_START","frontend_SkeletonRenderingOptions","frontend_SkeletonLayer","frontend_PerspectiveViewSkeletonLayer","frontend_SliceViewPanelSkeletonLayer","frontend_SkeletonSource","tempMat2","DEFAULT_FRAGMENT_MAIN","vertexAttributeSamplerSymbols","vertexPositionTextureFormat","texture_access","data_type","frontend_RenderHelper","textureAccessHelper","lineShader","circleShader","circles","edgeShaderGetter","dynamic_shader","vertexAttributes","fallbackFragmentMain","skeletonRenderingOptions","defineAttributeAccess","defineCommonShader","getCrossSectionFadeFactor","colormaps","numAttributes","glslDataType","setFragmentMainFunction","nodeShaderGetter","addTextureSampler","getAccessor","edgeShader","nodeShader","skeletonChunk","lineWidth","pointDiameter","vertexAttributeTextures","setupTextureLayout","aVertexIndex","vertexAttribDivisor","numIndices","interiorRadiusInPixels","borderWidthInPixels","featherWidthInPixels","numVertices","curTextureUnit","SkeletonRenderMode","frontend_TrackableSkeletonRenderMode","trackable_enum","frontend_TrackableSkeletonLineWidth","compound","trackable","getTrackableFragmentMain","params2d","LINES_AND_POINTS","params3d","LINES","voxelSizeObject","renderingOptions","vertexPositionAttribute","webglDataType","getWebglDataType","renderHelper","renderOptions","skeletonVertexCoordinatesInVoxels","skeletons","skeleton","chunk_manager_base","drawSkeleton","frontend_SkeletonChunk","vertexAttributeOffsets","attributeTextureFormats","emptyVertexAttributes","attributeTextureFormats_","getAttributeTextureFormats","SharedWatchableValue","neuroglancer_worker_rpc__WEBPACK_IMPORTED_MODULE_1__","SharedWatchableValue_1","updatingValue_","setupChangedHandler","VolumeComputationFrontend","ComputedMultiscaleVolumeChunkSource","ComputedDataSource","neuroglancer_chunk_manager_frontend__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_datasource__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_datasource_computed_base__WEBPACK_IMPORTED_MODULE_2__","neuroglancer_sliceview_volume_base__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_sliceview_volume_frontend__WEBPACK_IMPORTED_MODULE_4__","neuroglancer_util_geom__WEBPACK_IMPORTED_MODULE_5__","neuroglancer_util_json__WEBPACK_IMPORTED_MODULE_6__","ComputedVolumeChunkSource","params","computation","computationParameters","outputSpec","getDefaults","outputVoxelSize","outputVoxelOffset","outputVolumeSize","originSource","inputScaleIndex","inputSourceIndex","inputResolution","computationRef","sourceRef","inputSize","inputSpec","getChunkSource","originUrl","multiScaleVolumeChunkSource","getSources","volumeChunkSources","volumeChunkSource","volumeSpecs","config","configObj","computationName","computationProvider","computationMap","getOriginVolumes","volumes","dataSourceParams","defaultParams","getUncounted","getComputation","CoordinateTransform","makeDerivedCoordinateTransform","derivedTransform","baseTransform","getSquareCornersBuffer","neuroglancer_webgl_buffer__WEBPACK_IMPORTED_MODULE_1__","getSquareCornersArray","endY","PerspectiveViewRenderLayer","_renderContext","annotation_layer_state_AnnotationHoverState","annotation_layer_state_AnnotationLayerState","transformCacheGeneration","cachedObjectToGlobal","cachedGlobalToObject","coordinate_transform","hoverState","neuroglancer_layer","fillOpacity","segmentationState","filterBySegmentation","trackable_boolean","updateTransforms","EDGES_PER_BOX","CORNERS_PER_BOX","CORNERS_PICK_OFFSET","FULL_OBJECT_PICK_OFFSET","EDGES_PICK_OFFSET","FACES_PICK_OFFSET","PICK_IDS_PER_INSTANCE","edgeBoxCornerOffsetData","bounding_box_RenderHelper","aLower","aUpper","bufferOffset","getBaseIntersectionVertexIndexArray","getIntersectionVertexIndexArray","snapPositionToEdge","objectToData","corners","edgeIndex","edgeCorners","cA","cB","ma","mb","cornerA","cornerB","getEdgeCorners","neuroglancer_annotation","bytes","sliceViewRenderHelper","intersectionVertexIndexBuffer","webgl_buffer","filledIntersectionVertexIndexBuffer","boundingBoxCrossSectionHelper","bounding_box_shader_helper","faceShaderGetter","setPartIndex","fillShaderGetter","setViewportPlane","sliceView","aVertexIndexFloat","uniform1f","drawArraysInstanced","perspectiveViewRenderHelper","edgeBoxCornerOffsetsBuffer","boxCornerOffsetsBuffer","cornerShaderGetter","aBoxCornerOffset1","aBoxCornerOffset2","aBoxCornerOffset","drawEdges","drawCorners","snapPosition","cornerIndex","snapPositionToCorner","oldAnnotation","dataToObject","newPt","baseBox","getEndpointIndexArray","line_RenderHelper","endpointIndexBuffer","endpointShaderGetter","aEndpointIndex","drawEndpoints","ENDPOINTS_PICK_OFFSET","endpoints","snapPositionToLine","endpointIndex","startOffset","snapPositionToEndpoint","line_FULL_OBJECT_PICK_OFFSET","baseLine","point_RenderHelper","shaderGetter","glsl_EllipseQuadraticForm","glsl_computeCrossSectionEllipse","glsl_computeCenterOrientEllipse","getSphereVertexArray","latitudeBands","longitudeBands","latIndex","theta","sinTheta","cosTheta","lonIndex","phi","sinPhi","cosPhi","getSphereIndexArray","second","spheres_SphereRenderHelper","numInstances","aSphereVertex","drawElementsInstanced","ellipsoid_RenderHelper","aCenter","aRadii","quadRenderHelper","quad","squareCornersBuffer","square_corners_buffer","aCornerOffset","viewportToObject","objectToViewport","Aobject","RviewportToObject","Aviewport","cViewport","Ao","computeCrossSectionEllipseDebug","centerOrient","kdenom","k1","k2","mu","lambdaTerm1","lambdaTerm2","lambda1","lambda2","computeCenterOrientEllipseDebug","sphereRenderHelper","renderlayer_AnnotationLayerSharedObject","serializeDisplayState","annotation_base","renderlayer_AnnotationLayer","handleChangeAffectingBuffer","handleSegmentationChanged","unregisterSegmentationState","typeToIds","typeToOffset","numPickIds","annotationSet","annotationType","totalBytes","ArrayBuffer","ids","serializeAnnotationSet","segment","segmentationFilter","AnnotationRenderLayer","renderHelperType","renderHelpers","isAnnotation","baseVisibility","renderHelperConstructor","bufferValid","drawGeometry","pickId","hoverValue","updateBuffer","drawGeometryChunkData","temporary","segmentFilteredSource","geometrySource","instanceIndex","frontend_source","missing","PerspectiveViewAnnotationLayerBase","renderlayer_PerspectiveViewAnnotationLayer","shared_watchable_value","SliceViewAnnotationLayer","credentialsKey","makeRequest","neuroglancer_credentials_provider_http_request__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_util_cancellation__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_util_http_request__WEBPACK_IMPORTED_MODULE_2__","instance","credentialsProvider","httpCall","serverUrl","payload","responseType","credentials","headers","Headers","tokenType","accessToken","VERTICES_PER_CIRCLE","CircleShader","neuroglancer_webgl_quad__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_webgl_square_corners_buffer__WEBPACK_IMPORTED_MODULE_2__","circlesPerInstance","quadHelper","crossSectionFade","aCircleCornerOffset","totalRadius","uniform4f","fetchWithBossCredentials","MultiscaleAnnotationSource","DataFetchSliceViewRenderLayer","neuroglancer_annotation__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_annotation_base__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_annotation_type_handler__WEBPACK_IMPORTED_MODULE_2__","neuroglancer_chunk_manager_frontend__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_segmentation_display_state_base__WEBPACK_IMPORTED_MODULE_4__","neuroglancer_sliceview_frontend__WEBPACK_IMPORTED_MODULE_5__","neuroglancer_sliceview_renderlayer__WEBPACK_IMPORTED_MODULE_6__","neuroglancer_status__WEBPACK_IMPORTED_MODULE_7__","neuroglancer_util_array__WEBPACK_IMPORTED_MODULE_8__","neuroglancer_util_geom__WEBPACK_IMPORTED_MODULE_9__","neuroglancer_util_signal__WEBPACK_IMPORTED_MODULE_10__","neuroglancer_worker_rpc__WEBPACK_IMPORTED_MODULE_11__","AnnotationGeometryData","AnnotationSubsetGeometryChunk","AnnotationGeometryChunk","AnnotationGeometryChunkSource","AnnotationSubsetGeometryChunkSource","AnnotationMetadataChunk","AnnotationMetadataChunkSource","updateAnnotation","numBytes","renderHandler","insertionPoint","newData","otherType","deleteAnnotation","metadataChunkSource","makeTemporaryChunk","localUpdates","numCommitsInProgress","sourceSpecifications","applyLocalUpdate","localUpdate","existingAnnotation","pendingCommit","commitInProgress","forEachPossibleChunk","sendCommitRequest","notifyChanged","updateCommitsInProgress","annotationId","revertLocalUpdate","commitStatus","handleFailedUpdate","handleSuccessfulUpdate","multiscaleSource","startRelativeMouseDrag","initialEvent","finishDragHandler","prevClientX","prevClientY","mouseMoveHandler","mouseUpHandler","VERTICES_PER_LINE","LineShader","linesPerInstance","lineOffsetsBuffer","lineWidthInPixels","aLineOffset","lineWidthIncludingFeather","shared_SharedCredentialsProvider","invalidCredentials","providerId","WithCredentialsProvider","sharedCredentialsProvider","counterpartRef","getCredentialsProviderCounterpart","RenderLayer","neuroglancer_coordinate_transform__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_layer__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_render_scale_statistics__WEBPACK_IMPORTED_MODULE_2__","neuroglancer_shared_watchable_value__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_sliceview_base__WEBPACK_IMPORTED_MODULE_4__","neuroglancer_worker_rpc__WEBPACK_IMPORTED_MODULE_6__","sourceIds","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","linked_list_0","next0","prev0","automatic_focus_AutomaticallyFocusedElement","automaticFocusList","initializeHead","maybeUpdateFocus","front","lastFocusedElement","scheduleUpdateFocus","insertAfter","SliceViewPanelRenderLayer","SliceViewPanel","OffscreenTextures","neuroglancer_axes_lines__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_object_picking__WEBPACK_IMPORTED_MODULE_2__","neuroglancer_rendered_data_panel__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_sliceview_frontend__WEBPACK_IMPORTED_MODULE_4__","neuroglancer_util_event_action_map__WEBPACK_IMPORTED_MODULE_5__","neuroglancer_util_mouse_drag__WEBPACK_IMPORTED_MODULE_7__","neuroglancer_webgl_offscreen__WEBPACK_IMPORTED_MODULE_8__","neuroglancer_widget_scale_bar__WEBPACK_IMPORTED_MODULE_9__","sliceViewPanelEmitColor","addOutputBuffer","sliceViewPanelEmitPickID","tempVec4","axesLineHelper","visibleLayerTracker","visibleLayerRoles","offscreenCopyHelper","scaleBarCopyHelper","scaleBarTexture","initialPosition","rotateAbsolute","crossSectionBackgroundColor","showAxisLines","showScaleBar","scaleBarOptions","orig","getVisibleLayers","updateRendering","COLOR","PICK","axisLength","setGLViewport","readPixelFloat32IntoBuffer","setMouseState","oldZoom","newZoom","hsvToRgb","hueIndex","remainder","val1","val2","val3","rgbToHsv","CredentialsProvider","makeCredentialsGetter","CachingMapBasedCredentialsManager","neuroglancer_util_memoize__WEBPACK_IMPORTED_MODULE_2__","getWithoutGeneration","getUncached","cachedCredentials","pendingCredentials","pendingCancellationToken","addConsumer","makeCachedCredentialsGetter","_invalidCredentials","MapBasedCredentialsManager","providers","providerGetter","CachingCredentialsManager","getCredentialsProvider","serializeColor","TrackableRGB","neuroglancer_util_float32_to_string__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_util_hex__WEBPACK_IMPORTED_MODULE_3__","parseRGBAColorSpecification","rgbaPattern","hexPattern","parseColorSerialization","parseRGBColorSpecification","color_ColorWidget","updateModel","updateView","dom","getPositionSummary","getAnnotationRenderOptions","UserLayerWithAnnotationsMixin","annotations_AnnotationSegmentListWidget","addSegmentWidget","uint64_entry_widget","debouncedUpdateView","valuesEntered","nextElementSibling","computeCssColor","newSegments","annotations_SelectedAnnotationState","annotationLayerState","referenceChanged","updatedLayer","updateAnnotationLayer","reference_","unbindReference","unbindLayer","makePointLinkWithTransform","spatialPoint","positionText","spatial_units","makePointLink","transformedRadii","annotations_AnnotationLayerView","annotationListContainer","annotationListElements","updated","addAnnotationElement","updateAnnotationElement","deleteAnnotationElement","toolbox","initializeAnnotationLayerViewTab","colorPicker","pointButton","annotations_PlacePointTool","boundingBoxButton","PlaceBoundingBoxTool","lineButton","annotations_PlaceLineTool","ellipsoidButton","annotations_PlaceSphereTool","updateHoverView","updateSelectionView","newSelectedId","previousSelectedId","newHoverId","previousHoverId","makeAnnotationListElement","getCenterPosition","addAnnotationElementHelper","resetOnUpdate","lastElementChild","annotations_AnnotationDetailsTab","mouseEntered","titleText","deleteButton","text_icon_button","closeButton","close_button","voxelVolume","spatialLengthText","voxelLengthText","voxelLength","segmentListWidget","rows","annotations_AnnotationTab","detailsTab","updateDetailsVisibility","visibility_priority_frontend","setAnnotationLayerView","getSelectedAssocatedSegment","annotations_PlaceAnnotationTool","annotationDescription","ANNOTATE_POINT_TOOL_ID","ANNOTATE_LINE_TOOL_ID","ANNOTATE_BOUNDING_BOX_TOOL_ID","ANNOTATE_ELLIPSOID_TOOL_ID","getMousePositionInAnnotationCoordinates","TwoStepAnnotationTool","updatePointB","inProgressAnnotation","getUpdatedAnnotation","getInitialAnnotation","mouseDisposer","PlaceTwoCornerAnnotationTool","findIndex","spatialCenter","radius","tempMatrix","objectToGlobalLinearTransform","annotationColor","annotationFillOpacity","SELECTED_ANNOTATION_JSON_KEY","ANNOTATION_COLOR_JSON_KEY","ANNOTATION_FILL_OPACITY_JSON_KEY","trackable_alpha","addRenderLayer","dataFetchLayer","removeRenderLayer","Tool","restoreTool","registerTool","_value","tools","formatIntegerPoint","formatIntegerBounds","formatLength","formatBoundingBoxVolume","neuroglancer_widget_scale_bar__WEBPACK_IMPORTED_MODULE_1__","toPrecision","dimensionText","vector","spatialVector","preTransformVolume","formatVolume","hmr","locals","setRawTextureParameters","texParameteri","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","setRawTexture3DParameters","TEXTURE_WRAP_R","resizeTexture","tempTextureUnit","setTextureFromCanvas","LINEAR","UNPACK_FLIP_Y_WEBGL","VERTICES_PER_QUAD","QuadRenderHelper","INDICES_PER_QUAD","TRIANGLES_PER_QUAD","getQuadIndexArray","quadsPerInstance","quadIndexBuffer","makeTextIconButton","iconText","innerElement","Memoize","StringMemoize","getSelectedAnnotation","setAnnotationHoverStateFromMouseState","MouseEventBinder","debounce","defaultCredentialsManager","ComputedVolumeChunkSourceParameters","ComputationParameters","float32ToString","tempArray","digits","makeCloseButton","neuroglancer_widget_text_icon_button__WEBPACK_IMPORTED_MODULE_0__","ShaderCodeWidget","codemirror__WEBPACK_IMPORTED_MODULE_4__","codemirror__WEBPACK_IMPORTED_MODULE_4___default","lodash_debounce__WEBPACK_IMPORTED_MODULE_5__","lodash_debounce__WEBPACK_IMPORTED_MODULE_5___default","neuroglancer_util_disposable__WEBPACK_IMPORTED_MODULE_6__","neuroglancer_util_dom__WEBPACK_IMPORTED_MODULE_7__","SHADER_UPDATE_DELAY","changingValue","debouncedValueUpdater","textEditor","_element","setValidState","updateErrorState","getAnnotations","fragmentMainStartLineNumber","fragmentMainStartLine","severity","coordinate_transform_CoordinateTransformTab","textArea","modelGeneration","textAreaLabel","resetButton","float32_to_string","numbers","UserLayerWithCoordinateTransformMixin","TRANSFORM_JSON_KEY","vertexBasePositions","BoundingBoxCrossSectionRenderHelper","neuroglancer_webgl_buffer__WEBPACK_IMPORTED_MODULE_2__","tempVec3b","LAMBDA_EPSILON","ORTHOGONAL_EPSILON","findFrontVertexIndex","frontVertexIndex","axis_i","SliceViewShaderBuffers","outputVertexIndices","vertexUncorrectedToCorrected","vertexCorrectedToUncorrected","vertexBaseIndices","vertexPermutation","vertexIndices","vertexPermutationIndex","uniform3fv","uLowerClipBound","uUpperClipBound","uPlaneDistance","uPlaneNormal","uTranslation","vertexIndex","uVertexIndex","vidx","vDir","uVertexBasePosition","denom","lambda","uniform2iv","viewportZAxis","viewportCenterPosition","dataToObjectTransform","localPlaneNormal","setPlane","VectorGraphicsType","VectorGraphicsChunkSpecification","vectorGraphicsSourceOptions","defineCopyFragmentShader","elementWiseTextureShader","trivialColorShader","neuroglancer_util_object_id__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_webgl_shader__WEBPACK_IMPORTED_MODULE_1__","textureIndices","hexEncodeByte","hexEncode","hexDecode","RenderScaleWidget","lodash_debounce__WEBPACK_IMPORTED_MODULE_1__","lodash_debounce__WEBPACK_IMPORTED_MODULE_1___default","lodash_throttle__WEBPACK_IMPORTED_MODULE_2__","lodash_throttle__WEBPACK_IMPORTED_MODULE_2___default","neuroglancer_render_scale_statistics__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_trackable_value__WEBPACK_IMPORTED_MODULE_4__","neuroglancer_util_color__WEBPACK_IMPORTED_MODULE_5__","neuroglancer_util_colorspace__WEBPACK_IMPORTED_MODULE_6__","neuroglancer_util_disposable__WEBPACK_IMPORTED_MODULE_7__","neuroglancer_util_event_action_map__WEBPACK_IMPORTED_MODULE_8__","neuroglancer_util_mouse_bindings__WEBPACK_IMPORTED_MODULE_10__","neuroglancer_util_number_to_string__WEBPACK_IMPORTED_MODULE_11__","neuroglancer_widget_scale_bar__WEBPACK_IMPORTED_MODULE_12__","resize_observer_polyfill__WEBPACK_IMPORTED_MODULE_13__","updateInterval","mousedown0","wheel","dblclick0","histogram","legend","legendRenderScale","legendSpatialScale","legendChunks","hoverTarget","throttledUpdateView","describe","getTargetValue","resizeObserver","observe","disconnect","targetValue","valueString","coeff","formatPixelNumber","binToCanvasX","bin","clearRect","histogramData","sortedSpatialScales","maxCount","numRows","totalPresent","totalNotPresent","countToCanvasY","hoverSpatialScale","sum","hoverY","baseIndex","spatialScaleColors","hue","presentColor","ySplit","numberToStringFixed","maxDigits","toFixed","AxesLineHelper","neuroglancer_webgl_trivial_shaders__WEBPACK_IMPORTED_MODULE_2__","colorBuffer","blend","aColor","ONE_MINUS_DST_ALPHA","DST_ALPHA","PickIDManager","DEBUG_PICKING","pickData","nextPickID","valuesOffset","updateMouseState","global","MapShim","getIndex","some","class_1","__entries__","configurable","_i","isBrowser","global$1","Function","requestAnimationFrame$1","requestAnimationFrame","trailingTimeout","REFRESH_DELAY","transitionKeys","mutationObserverSupported","MutationObserver","ResizeObserverController","connected_","mutationEventsAdded_","mutationsObserver_","observers_","onTransitionEnd_","leadingCall","trailingCall","resolvePending","proxy","timeoutCallback","timeStamp","throttle","addObserver","observer","connect_","removeObserver","observers","disconnect_","updateObservers_","activeObservers","gatherActive","hasActive","broadcastActive","childList","characterData","subtree","_b","getInstance","instance_","defineConfigurable","writable","getWindowOf","defaultView","emptyRect","createRectInit","toFloat","getBordersSize","positions","reduce","getHTMLElementContentRect","paddings","positions_1","getPaddings","horizPad","vertPad","boxSizing","isDocumentElement","vertScrollbar","horizScrollbar","isSVGGraphicsElement","SVGGraphicsElement","SVGElement","getBBox","getContentRect","bbox","getSVGContentRect","ResizeObservation","broadcastWidth","broadcastHeight","contentRect_","isActive","broadcastRect","ResizeObserverEntry","rectInit","Constr","contentRect","DOMRectReadOnly","ResizeObserverSPI","controller","callbackCtx","activeObservations_","observations_","callback_","controller_","callbackCtx_","Element","observations","unobserve","clearActive","_this","observation","ResizeObserver","fetchWithCredentials","neuroglancer_util_http_request__WEBPACK_IMPORTED_MODULE_1__","applyCredentials","errorHandler","credentialsLoop","requestLoop","TrackableEnum","neuroglancer_util_json__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_util_signal__WEBPACK_IMPORTED_MODULE_1__","VectorGraphicsChunkSource","neuroglancer_sliceview_renderlayer__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_webgl_dynamic_shader__WEBPACK_IMPORTED_MODULE_3__","sourceOptions","_sliceView","VectorGraphicsChunk","numPoints","vectorGraphicsCoordinatesInVoxels","neuroglancer_sliceview_base__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_sliceview_bounding_box_shader_helper__WEBPACK_IMPORTED_MODULE_2__","neuroglancer_sliceview_renderlayer__WEBPACK_IMPORTED_MODULE_3__","neuroglancer_util_geom__WEBPACK_IMPORTED_MODULE_4__","neuroglancer_webgl_dynamic_shader__WEBPACK_IMPORTED_MODULE_5__","neuroglancer_webgl_shader_lib__WEBPACK_IMPORTED_MODULE_6__","DEBUG_VERTICES","CHUNK_POSITION_EPSILON","glsl_getPositionWithinChunk","VolumeSliceVertexComputationManager","uChunkDataSize","uVoxelSize","uProjectionMatrix","gl_Position","vChunkPosition","planeNormalAbs","computeVertexPositionDebug","dataToDeviceMatrix","chunkPosition","computeVerticesDebug","shaderKey","vertexComputationManager","globalCorner","localSpatialToGlobal","beginSlice","endSlice","beginDrawing","originalChunkSize","beginSource","sourceChunkFormat","setChunkDataSize","newChunkDataSize","setupChunkDataSize","bindChunk","drawChunk","medianVoxelSize","endDrawing","UserLayerWithVolumeSourceMixin","neuroglancer_annotation_frontend__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_layer_specification__WEBPACK_IMPORTED_MODULE_2__","neuroglancer_ui_annotations__WEBPACK_IMPORTED_MODULE_4__","neuroglancer_user_layer_with_coordinate_transform__WEBPACK_IMPORTED_MODULE_5__","SOURCE_JSON_KEY","CROSS_SECTION_RENDER_SCALE_JSON_KEY","sliceViewRenderScaleHistogram","sliceViewRenderScaleTarget","volumePath","volumeOptions","staticAnnotations","getStaticAnnotations","Uint64EntryWidget","neuroglancer_util_uint64__WEBPACK_IMPORTED_MODULE_3__","validateInput","results","EnumSelectWidget","valueIndexMap","hashCombine","NUM_ALTERNATIVES","DEFAULT_LOAD_FACTOR","pendingLow","pendingHigh","backupPendingLow","backupPendingHigh","hash_table_HashTableBase","hashSeeds","generateHashSeeds","loadFactor","emptyLow","emptyHigh","maxRehashAttempts","maxAttempts","mungedEmptyKey","initialSize","allocate","numHashes","emptySlots","getHash","chooseMungedEmptyKey","table","hashIndex","hash","entryStride","tableSize","indexOfPair","newLow","newHigh","hasPair","clearTable","tempLow","tempHigh","storePending","attempt","tableIndex","swapPending","oldTable","updateHashFunctions","tryToInsert","desiredTableSize","rehashAttempt","rehash","chooseAnotherEmptyKey","backupPending","grow","restorePending","HashSetUint64","insertInternal","pendingValueLow","pendingValueHigh","backupPendingValueLow","backupPendingValueHigh","hash_table_HashMapUint64","glsl_hashCombine","shader_lib","shader_GPUHashTable","hashTable","tableWithMungedEmptyKey","shader_HashSetShaderManager","textureUnitSymbol","for","accessHelper","hashSeedsName","hashKeyMask","readTable","hasFunctionName","uniform1uiv","HashMapShaderManager","getFunctionName","NUM_COMPONENTS","segment_color_SegmentColorShaderManager","seedName","hashSeed","segment_color_SegmentColorHash","c0","c1","colorspace","newSeed","rankSymbol","parentSymbol","nextSymbol","prevSymbol","findRepresentative","ancestor","setElementIterator","minSymbol","disjoint_sets_DisjointUint64Sets","makeSet","newNode","iRank","jRank","linkUnequalSetRepresentatives","iPrev","jPrev","spliceCircularLists","aMin","bMin","mappings","sets","members","member","shared_disjoint_sets_SharedDisjointUint64Sets","al","ah","bl","bh","segmentation_renderlayer_EquivalencesHashMap","hashMap","minObjectId","segmentation_renderlayer_SegmentationRenderLayer","renderlayer","segmentColorShaderManager","hashTableManager","gpuHashTable","hashTableManagerHighlighted","gpuHashTableHighlighted","equivalencesShaderManager","equivalencesHashMap","gpuEquivalencesHashTable","selectedAlpha","hideSegmentZero","invalidateShader","hasEquivalences","notSelectedAlpha","selectedSegmentLow","selectedSegmentHigh","seg","uniform2ui","uint64_set_Uint64Set","Uint64Set_1","add_","delete_","uint64_set_decorate","segment_set_widget_temp","segment_set_widget_SegmentSetWidget","clearButton","itemContainer","items","handleSetChanged","handleColorChanged","addElement","updateClearButtonVisibility","lastElement","itemElement","setItemColor","segmentation_user_layer_SegmentationUserLayer","SELECTED_ALPHA_JSON_KEY","NOT_SELECTED_ALPHA_JSON_KEY","OBJECT_ALPHA_JSON_KEY","SATURATION_JSON_KEY","HIDE_SEGMENT_ZERO_JSON_KEY","MESH_JSON_KEY","SKELETONS_JSON_KEY","SEGMENTS_JSON_KEY","HIGHLIGHTS_JSON_KEY","EQUIVALENCES_JSON_KEY","COLOR_SEED_JSON_KEY","MESH_RENDER_SCALE_JSON_KEY","SKELETON_RENDERING_JSON_KEY","SKELETON_SHADER_JSON_KEY","user_layer_with_volume_source","getDefault","makeWithCounterpart","skeleton_frontend","render_scale_statistics","objectLayerStateChanged","bindTo","segmentation_user_layer_DisplayOptionsTab","volume_base","skeletonShader","restoreSegmentsList","meshPath","skeletonsPath","addMesh","skeletonSource","addSkeletonSource","objectSource","meshLayer","skeletonLayer","mappedValue","randomize","makeSkeletonShaderCodeWidget","shader_code_widget","visibleSegmentWidget","selectedAlphaWidget","notSelectedAlphaWidget","saturationWidget","objectAlphaWidget","renderScaleWidget","render_scale_widget","has3dLayer","checkbox","maybeAddSkeletonShaderUI","codeWidget","addViewSpecificSkeletonRenderingControls","viewName","enum_widget","topRow","flex","helpLink","helpButton","maximizeButton","segmentation_user_layer_ShaderCodeOverlay","layer_specification","VolumeChunkEncoding","VolumeSourceParameters","MultiscaleMeshSourceParameters","MeshSourceParameters","SkeletonSourceParameters","AnnotationSourceParameters","frontend_BrainmapsSkeletonSource","frontend_VolumeInfo","frontend_MultiscaleVolumeInfo","frontend_MultiscaleVolumeChunkSource","parseVolumeKey","frontend_VolumeList","parseChangeStackList","frontend_BrainmapsAnnotationSource","frontend_BrainmapsDataSource","productionInstance","frontend_BrainmapsVolumeChunkSource","chunk_manager_frontend","chunk_source_frontend","volume_frontend","frontend_BrainmapsMultiscaleMeshSource","mesh_frontend","frontend_BrainmapsMeshSource","SERVER_DATA_TYPES","parseBoundingBox","corner","metadata","boundingBoxes","parseMeshInfo","lodPattern","volumeInfoResponse","scales","baseScale","numScales","volumeId","changeSpec","multiscaleVolumeInfo","meshesResponse","IMAGE","meshes","parseMeshesResponse","RAW","COMPRESSED_SEGMENTATION","JPEG","volumeInfo","multiscaleMeshes","baseVolume","invalidLodMeshes","mesh","lods","chunkShapeInVoxels","gridShape","relativeBlockShape","meshLoop","baseLod","baseBlockShapeInVoxels","lodIndex","curSize","baseSize","getMultiscaleMeshes","meshName","changeStackId","meshSourcePattern","parseProject","parseProjectList","parseAPIResponseList","projectsResponse","volumesResponse","projects","hierarchicalVolumeIds","project","volumeIds","hierarchicalSets","componentStart","nextColon","groupString","valueSet","makeAnnotationGeometrySourceSpecifications","multiscaleInfo","MultiscaleAnnotationSourceBase","datasource","getMeshSourceParameters","api","sliceview_base","brainmapsOptions","getMultiscaleInfo","changestack","neuroglancer_status","datasetsResponse","dataset","fullyQualifyiedVolumeList","volumeList","colonCount","colonIndices","lastColon","getProjectList","projectMetadata","projectList","descriptionMap","projectDatum","projectColon","completion","colonLocation","projectId","getDatasetList","datasetList","matchString","possibleMatches","datasetName","datasetId","getVolumeList","getChangeStackList","changeStacks","DEBUG_SHADERS","display_context_RenderedPanel","display_context_DisplayContext","addPanel","clientRect","canvasRect","clientTop","glBottom","scissor","removePanel","updateStarted","updateFinished","panels","updatePending","ResizeObserver_es","antialias","stencil","getParameter","MAX_TEXTURE_SIZE","maxTextureImageUnits","MAX_TEXTURE_IMAGE_UNITS","extension","getExtension","initializeWebGL","cancelAnimationFrame","DEPTH_BUFFER_BIT","BossSourceParameters","VolumeChunkSourceParameters","baseUrl","collection","experiment","channel","resolution","getExperimentInfo","getChannelInfo","getDownsampleInfoForChannel","parseDownsampleScales","parseDownsampleInfoForChannel","getCollections","getExperiments","getCoordinateFrame","collectionExperimentChannelCompleter","frontend_BossDataSource","frontend_BossVolumeChunkSource","frontend_BossMeshSource","serverVolumeTypes","VALID_ENCODINGS","DEFAULT_CUBOID_SIZE","VoxelUnitType","getVoxelUnitInNanometers","voxelUnit","MICROMETERS","MILLIMETERS","CENTIMETERS","getVolumeTypeFromChannelType","channelType","UNKNOWN","parseChannelInfo","downsampleStatus","downsampled","experimentInfo","meshUrl","channelNames","channels","channelInfo","coordFrame","coordinateFrame","windowobj","scaleInfo","voxelSizeNanometers","imageSize","voxelOffsetBase","pathPattern","hostname","http_request","channelPromiseArray","channelArray","scalingLevels","coordFrameKey","parseExperimentInfo","downsample","downsampleObj","voxelSizes","imageSizes","num_hierarchy_levels","experimentInfoWithDownsample","urlPattern","coordinateframe","coordinateFrameObj","voxelSizeBase","imageSizeBase","voxelSizeBaseNanometers","parseCoordinateFrame","channelMatch","collectionPrefix","collections","experimentPrefix","experiments","credentialsManager","authServer","endpoint","baseHostName","getAuthServer","DVIDSourceParameters","frontend_DataInstanceBaseInfo","DataInstanceInfo","frontend_VolumeDataInstanceInfo","parseDataInstance","frontend_RepositoryInfo","parseRepositoriesInfo","ServerInfo","getServerInfo","getDataInstanceDetails","MultiscaleVolumeChunkSource","completeInstanceName","completeNodeAndInstance","frontend_DVIDDataSource","serverDataTypes","compressionName","frontend_DVIDVolumeChunkSource","frontend_DVIDSkeletonSource","frontend_DVIDMeshSource","instanceNames","extended","extendedValues","numLevels","instSet","COMPRESSED_SEGMENTATIONARRAY","maxdownreslevel","meshSrc","skeletonSrc","lowerVoxelNotAligned","upperVoxelNotAligned","dataInstanceKey","volParameters","nodeKey","dataScale","baseInfo","isjpegcompress","errors","dataInstances","vnodes","alias","dataInstanceObjs","instanceKeys","dagObj","nodeObjs","allVersions","key2","rep","uuid","repositories","matches","instanceDetails","serverInfo","repositoryInfo","getNode","dataInstanceInfo","repository","RenderBaseSourceParameters","RenderSourceParameters","TileChunkSourceParameters","PointMatchChunkSourceParameters","computeStackHierarchy","getOwnerInfo","stackAndProjectCompleter","frontend_MultiscaleVectorGraphicsChunkSource","getPointMatches","frontend_RenderDataSource","TileChunkSourceBase","TileChunkSource","PointMatchSourceBase","vector_graphics_frontend","PointMatchSource","VALID_STACK_STATES","PARTIAL_STACK_STATES","parseOwnerInfo","stackObjs","owner","parseStackOwner","stackObj","stackName","parseStackName","stackInfo","parseStackInfo","projectName","projectInfo","stacks","stackIdObj","stackStatsObj","stackBounds","parseLowerVoxelBounds","parseUpperVoxelBounds","channelNamesObj","parseChannelNames","voxelResolution","parseStackVersionInfo","parseStackProject","stackVersionObj","ownerInfo","stackNames","minIntensity","maxIntensity","maxTileSpecsToRender","minY","minZ","maxX","maxY","maxZ","tileSize","make","maxBound","datasourcePath","stackMatch","projectPrefix","stackPrefix","channelPrefix","matchCollection","zoffset","DataEncoding","ShardingHashFunction","frontend_PrecomputedSkeletonSource","getShardedMeshSource","frontend_PrecomputedDataSource","frontend_PrecomputedVolumeChunkSource","frontend_PrecomputedMeshSource","frontend_PrecomputedMultiscaleMeshSource","resolvePath","outputParts","frontend_ScaleInfo","chunkSizes","sharding","parseShardingParameters","parseTransform","getMeshMetadata","lodScaleMultiplier","vertexQuantizationBits","parseMeshMetadata","parseShardingEncoding","shardingData","preshiftBits","shardBits","minishardBits","minishardIndexEncoding","dataEncoding","getSkeletonMetadata","attributeData","parseSkeletonMetadata","GET_NIFTI_VOLUME_INFO_RPC_ID","NiftiDataType","frontend_NiftiDataSource","frontend_NiftiVolumeChunkSource","volumeSize","qoffset","quatern","qfac","promiseInvoke","getNiftiVolumeInfo","cancellation","frontend_N5DataSource","frontend_N5VolumeChunkSource","topLevelMetadata","baseScaleIndex","pixelResolution","pixelResolutionUnits","frontend_TopLevelMetadata","resObj","unitScale","scalesObj","scaleObj","frontend_ScaleMetadata","compression","getAllScales","_scale","getScaleMetadata","catch","topLevelMetadataUrl","getTopLevelMetadata","frontend_ExampleComputation","frontend_ExampleComputationProvider","computeParams","outputSize","loadTFjs","frontend_TensorflowComputation","frontend_TensorflowComputationProvider","tfjs","model_","inferenceQueue_","running_","queue","startInference","outputBuffer","runInference_","pendingInference","modelInference_","inferenceRequest","inputLength","expectedLength","inputTensorNumElements","prediction","tidy","modelInput","tensor","reshape","inputTensorShape","predict","modelPath","endsWith","stdDev","mean","outputType","atype","loadFrozenModel","tfModel","inputs","outputs","dummyOutput","dummyInput","ones","shape","outputTensor","inputShape","outputShape","inputTensor","inputDType","dtype","dim","tfParams","inputBuffer","freeGlobal","freeSelf","doFold","finder","allowFolded","marks","__isFold","cleared","myWidget","makeWidget","myRange","newFoldFunction","rangeFinder","toggleFold","foldCode","fold","unfold","foldAll","unfoldAll","defaultOptions","auto","minFoldSize","scanUp","editorOptions","foldOptions","isSymbol","NAN","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","valueOf","isBinary","baseGetTag","isObjectLike","symbolTag","getRawTag","objectToString","nullTag","undefinedTag","symToStringTag","objectProto","nativeObjectToString","isOwn","unmasked","currentDir","pathname","fullMatch","origUrl","newUrl","unquotedOrigUrl","$1","neuroglancer_datasource_brainmaps_frontend__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_datasource_brainmaps_api__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_datasource_default_provider__WEBPACK_IMPORTED_MODULE_2__","neuroglancer_datasource_boss_frontend__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_datasource_default_provider__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_datasource_dvid_frontend__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_datasource_default_provider__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_datasource_render_frontend__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_datasource_precomputed_frontend__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_datasource_nifti_frontend__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_datasource_n5_frontend__WEBPACK_IMPORTED_MODULE_1__","neuroglancer_datasource_computed_frontend__WEBPACK_IMPORTED_MODULE_0__","neuroglancer_datasource_computed_example_frontend__WEBPACK_IMPORTED_MODULE_0__","registerComputation","neuroglancer_datasource_computed_tensorflow_frontend__WEBPACK_IMPORTED_MODULE_1__","GUTTER_ID","showTooltipFor","tooltip","tt","opacity","showTooltip","hide","LintState","hasGutter","marked","onMouseOver","annotations","__annotation","annotationTooltip","popupTooltips","waitingFor","clearMarks","lint","makeMarker","labels","multiple","tooltips","tip","messageHTML","startLinting","passOptions","arg2","updateLinting","lintAsync","issues","annotationsNotSorted","groupByLine","anns","maxSeverity","tipLabel","formatAnnotation","onUpdateLinting","onChange","lintOnChange","hasLintGutter","words","parserConfig","curPunc","keywords","glslKeywords","builtins","glslBuiltins","blockKeywords","atoms","hooks","multiLineStrings","isOperatorChar","tokenBase","quote","tokenize","escaped","tokenComment","propertyIsEnumerable","maybeEnd","pushContext","popContext","basecolumn","startOfLine","textAfter","firstChar","cppHook","#","statementIndent","jsonldMode","jsonld","jsonMode","isTS","typescript","wordRE","wordCharacters","kw","operator","atom","if","while","with","else","do","try","finally","return","break","continue","new","void","throw","debugger","var","const","let","function","switch","case","in","typeof","instanceof","true","false","class","yield","export","import","extends","await","isJsonldKeyword","ret","tp","cont","expressionAllowed","inSet","readRegexp","tokenQuasi","lexical","lastType","brackets","findFatArrow","fatArrowAt","arrow","sawSomething","bracket","atomicTypes","number","variable","regexp","jsonld-keyword","JSLexical","inScope","varname","localVars","vars","cc","pass","inList","newContext","registerVarScoped","Var","globalVars","isModifier","defaultVars","pushcontext","pushblockcontext","popcontext","pushlex","lex","poplex","expect","wanted","statement","vardef","parenExpr","maybeexpression","maybeelse","functiondef","forspec","enumdef","typename","typeexpr","expression","maybelabel","maybeCatchBinding","afterExport","afterImport","funarg","expressionInner","expressionNoComma","noComma","arrowBodyNoComma","arrowBody","commasep","maybeop","maybeoperatorNoComma","maybeoperatorComma","classExpression","arrayLiteral","contCommasep","objprop","quasi","targetNoComma","maybeTypeArgs","maybeTarget","expr","continueQuasi","getterSetter","afterprop","maybetype","what","sep","proceed","mayberettype","isKW","afterType","typeprop","typearg","maybeReturnType","functiondecl","typeparam","maybeTypeDefault","maybeAssign","vardefCont","eltpattern","proppattern","_type","forspec1","forspec2","classNameAfter","classBody","classfield","isInterface","maybeFrom","exportField","importSpec","maybeMoreImports","maybeAs","enummember","combinator","parseJS","isContinuedStatement","doubleIndentSwitch","blockCommentStart","blockCommentEnd","blockCommentContinue","lineComment","closeBrackets","skipExpression","opts","foldGutter","onGutterClick","onViewportChange","onFold","State","indicatorOpen","indicatorFolded","updateInViewport","isFolded","updateFoldInfo","foldOption","vp","folded","changeUpdate","foldOnChangeTimeSpan","updateViewportTimeSpan","lineText","findOpening","openCh","startToken","endToken","nextOpen","nextClose","hasImport","semi","startLine","hasInclude","eventHasInputTextTarget","isCollapsed","bindDefaultPasteHandler","parsedPosition","parsePositionString","defaultGlobalBindings","defaultRenderedDataPanelBindings","defaultPerspectivePanelBindings","defaultSliceViewPanelBindings","getDefaultRenderedDataPanelBindings","arrowleft","arrowright","arrowup","arrowdown","comma","period","keyz","control+equal","control+shift+equal","control+minus","keyr","keye","shift+arrowdown","shift+arrowup","shift+arrowleft","shift+arrowright","at:control+wheel","at:wheel","at:shift+wheel","at:dblclick0","at:control+mousedown0","at:mousedown2","at:control+mousedown2","at:alt+mousedown0","at:control+alt+mousedown2","at:touchpinch","at:touchrotate","at:touchtranslate2","at:touchhold1","at:touchtap1x2","at:touchtap2x3","setDefaultInputEventBindings","inputEventBindings","getDefaultGlobalBindings","at:mousedown0","at:shift+mousedown0","at:touchtranslate1","perspectiveView","textureLayoutSymbol","single_texture_chunk_format_SingleTextureChunkFormat","shaderSamplerType","_shader","single_texture_chunk_format_SingleTextureVolumeChunk","textureTarget","setTextureData","uncompressed_chunk_format_TextureLayout","uncompressed_chunk_format_ChunkFormat","uncompressed_chunk_format_UncompressedVolumeChunk","getTextureLayout","index2","uncompressed_chunk_format_UncompressedChunkFormatHandler","decodeValueOffset","blockSize","uint32sPerElement","gridOffset","subchunkOffset","gridStride","subchunkStride","posValue","subchunkSizeValue","subchunkSubscript","subchunkHeaderOffset","subchunkHeader0","subchunkHeader1","outputValueOffset","encodingBits","readSingleChannelValue","decode_uint64_readSingleChannelValue","chunk_format_TextureLayout","subchunkSize","dataLength","subchunkGridSize","chunk_format_ChunkFormat","cacheKey","local","glslType","uniform3i","chunk_format_CompressedSegmentationVolumeChunk","chunk_format_CompressedSegmentationChunkFormatHandler","withFlex","flexDirection","PERSPECTIVE_VIEW_RPC_ID","PERSPECTIVE_VIEW_ADD_LAYER_RPC_ID","PERSPECTIVE_VIEW_REMOVE_LAYER_RPC_ID","PERSPECTIVE_VIEW_UPDATE_VIEWPORT_RPC_ID","watchable_map_WatchableMap","glsl_perspectivePanelEmit","glsl_perspectivePanelEmitOIT","perspectivePanelEmit","Z","perspectivePanelEmitOIT","defineTransparencyCopyShader","PerspectiveViewStateBase","PerspectiveViewState","panel_PerspectivePanel","rendered_data_panel","sliceViews","sliceViewDisposers","_unconditional","projectionMat","viewMat","viewMatInverse","viewProjectionMat","viewProjectionMatInverse","axes_lines","sliceview_frontend","offscreen","transparencyCopyHelper","scale_bar","throttledSendViewportUpdate","updateProjectionMatrix","showSliceViewsCheckbox","showSliceViews","showSliceViewsLabel","orthographicProjection","perspectiveViewBackgroundColor","unconditional","widthOverHeight","orthoScalar","numOffsets","zValue","glWindowZ","pickValue","transparentConfiguration","transparentConfiguration_","lightingDirection","hasTransparent","hasAnnotation","drawSliceViews","depthFunc","LEQUAL","NONE","LESS","COLOR_ATTACHMENT1","COLOR_ATTACHMENT2","drawAxisLines","depthMask","blendFuncSeparate","POLYGON_OFFSET_FILL","polygonOffset","length0","length1","AXES_RELATIVE_ORIENTATION","LAYOUT_SYMBOLS","makeNamedSliceView","viewerState","axes","baseToSelf","navigation_state","makeRelative","makeSliceView","getCommonViewerState","getCommonPerspectiveViewerState","perspectiveNavigationState","getCommonSliceViewerState","registerRelatedLayouts","relatedLayouts","controls","relatedLayout","innerDiv","makeSliceViewFromSpecification","updateViewportSize","addUnconditionalSliceViews","crossSections","previouslyAdded","currentCrossSections","crossSection","data_panel_layout_FourPanelLayout","rootElement","perspectiveViewerState","showPerspectiveSliceViews","sliceViewerState","sliceViewerStateWithoutScaleBar","makeSliceViewPanel","sliceview_panel","mainDisplayContents","data_panel_layout_SliceViewPerspectiveTwoPanelLayout","data_panel_layout_SinglePanelLayout","data_panel_layout_SinglePerspectiveLayout","LAYOUTS","splitLayout","getLayoutByName","validateLayoutName","data_panel_layout_CrossSectionSpecification","data_panel_layout_CrossSectionSpecificationMap","parentNavigationState","data_panel_layout_DataPanelLayoutSpecification","defaultLayout","orthographicProjectionJson","data_panel_layout_DataPanelLayoutContainer","scheduleUpdateLayout","updateLayout","disposeLayout","formatKeyName","input_event_bindings_InputEventBindingHelpDialog","uniqueMaps","addMap","addEntries","firstColon","header","dl","container2","dt","dd","nextElementId","associateLabelWithElement","scrollIntoViewIfNeeded","elementLeft","elementTop","elementRight","elementBottom","parentWidth","parentHeight","viewportLeft","viewportRight","viewportTop","viewportBottom","scrollLeftDelta","scrollTopDelta","ACTIVE_COMPLETION_CLASS_NAME","AUTOCOMPLETE_INDEX_SYMBOL","makeDefaultCompletionElement","makeCompletionElementWithDescription","descriptionElement","DEFAULT_COMPLETION_DELAY","autocomplete_AutocompleteTextInput","inputChanged","prevInputValue","completionsVisible","activeCompletionPromise","activeCompletionCancellationToken","dropdownContentsStale","updateHintScrollPositionTimer","completionElements","hasResultForDropdown","commonPrefix","activeIndex","dropdownStyleStale","completer","debouncedCompleter","scheduleUpdateCompletions","setCompletions","dropdownAndInputWrapper","dropdownElement","inputWrapperElement","autocomplete","hintElement","registerInputHandler","handleInputChanged","updateDropdown","handleDropdownMousedown","hintScrollPositionMayBeStale","cycleActiveCompletion","selectActiveCompletion","scheduleUpdateHintScrollPosition","HTMLElement","selectCompletion","numCompletions","setActiveIndex","eventType","associatedElement","horizontal","vertical","topMargin","bottomMargin","leftMargin","rightMargin","maxHeight","maxWidth","distanceLeft","distanceRight","distanceToTop","distanceToBottom","positionDropdown","shouldShowDropdown","makeElement","completionElement","updateDropdownStyle","clearCompletions","showSingleResult","selectSingleResult","setHintValue","getCompletedValueByIndex","commonResultPrefix","strings","it","firstValue","noValues","commonPrefixLength","longestCommonPrefix","getCompletedValue","updateHintScrollPosition","hintValue","completionValue","allowPrefix","cancelActiveCompletion","layer_dialog_LayerDialog","existingLayer","statusElement","submitElement","namePromptElement","nameInputElement","volumeCancellationSource","sourceValid","nameValid","dialogElement","sourceForm","validateSource","sourcePrompt","sourceInput","originalResult","hiddenSourceSubmit","overflow","makeHiddenSubmitButton","nameForm","validateName","hintLayerIndex","hintLayer","setSelectionRange","otherLayer","isNameValid","validityChanged","focusName","baseSuggestedName","setError","setInfo","encodeStringAsDragType","hex","TextEncoder","encode","decodeParametersFromDragType","dragType","jsonString","TextDecoder","decode","savedDropEffect","setDropEffect","dropEffect","getDropEffect","layerDragTypePrefix","dragSource","startLayerDrag","sourceInfo","newDragSource","layoutSpec","endLayerDrag","removedLayers","getLayerDragInfo","dragTypes","decodeParametersFromDragTypeList","getCompatibleDragSource","DropLayers","numSourceLayers","sourceManager","otherMethod","moveSupported","getLayerDropEffect","newTarget","getDefaultLayerDropEfect","getDropLayers","forceCopy","allowMove","layerInfo","newLayer","animationFrameDebounce","positionDragType","shift+tab","backspace","mouseup0","normalizedPrefixString","normalizedSeparatorString","position_widget_PositionWidget","maxNumberWidth","inputContainer","tempPosition","inputFieldWidth","copyButton","success","cleanup","setClipboard","getPositionText","showTemporaryMessage","updatePosition","cleanInput","wasFocused","selectionDirection","mouseCursorPosition","adjustFromCursor","cursorPosition","adjustment","axisIndex","numberPattern","separatorPattern","startAndEndPattern","cleanCursor","curFieldStart","processField","matchText","replacementText","hintText","curFieldEnd","cleanResult","voxelPosition","inputText","firstComma","yLen","prevSelectionStart","prevSelectionEnd","prevSelectionDirection","position_widget_VoxelSizeWidget","dimensionsContainer","unitsElement","minVoxelSize","number_to_string","dimElement","position_widget_MousePositionWidget","updateViewFunction","destroyDropLayers","dropLayers","targetLayer","registerDropHandlers","updateDropEffect","existingDropLayers","compatibleWithMethod","existingLayers","firstRemovalIndex","enterDisposer","dropDisposer","finalize","overDisposer","layer_panel_LayerWidget","layerNumberElement","valueElement","closeElement","removeManagedLayer","getLayoutSpecForDrag","layer_panel_LayerPanel","viewerNavigationState","layerWidgets","layerUpdateNeeded","valueUpdateNeeded","layerWidgetInsertionPoint","positionWidget","scheduleUpdate","handleLayerValuesChanged","handleLayersChanged","addButton","dropZone","addLayerMenu","preventDrag","updatePositionWidgetVisibility","relatedTarget","updateLayers","fround","nextChild","layerIndex","context_menu_ContextMenu","parentDisposers","disabledValue","opened","closed","registerParent","menuDisposer","show","mousedownDisposer","Node","keydownDisposer","menu","posX","posY","positionContextMenu","setupPositionDropHandlers","positionState","dragoverDisposer","viewerDragType","hasViewerDrag","layer_group_viewer_dragSource","getDefaultViewerDropEffect","layerSpecification","getCompatibleViewerDragSource","layer_group_viewer_LinkedViewerNavigationState","crossSectionOrientation","crossSectionZoom","perspectiveOrientation","perspectiveZoom","copyToPeer","layer_group_viewer_LayerGroupViewer","showLayerPanel","showViewerMenu","registerActionBindings","useDirectly","updateUI","makeUI","bindAction","layerPanel","contextMenu","whiteSpace","makeViewerMenu","dragData","layoutComponentContainerSymbol","layer_groups_layout_LayoutComponentContainer","alignItems","foo","setSpecification","dropZones","makeDropZone","setupDropZone","newContainer","dropZonesVisible","component","layer_groups_layout_StackLayoutComponent","oldComponent","componentValue","unsetComponent","scheduleMaybeDelete","childComponent","copyToParent","layersToKeep","setComponent","layer_groups_layout_SingletonLayerGroupViewer","componentType","layerGroupViewer","layer_groups_layout_getCommonViewerState","uiControlVisibility","makeComponent","newComponentSpec","insertChild","existingContainer","existingComponentSpec","existingComponent","stackComponent","makeLayerGroupViewer","leaveDisposer","getViewerDropEffect","updateLayerDropEffect","dropState","makeDropPlaceholder","childSpec","childElementCount","nextElement","getFromElement","beforeElement","layer_groups_layout_RootLayoutContainer","defaultSpecification","drag_resize_DragResizablePanel","sizeProp","insertAdjacentElement","visibleCutoff","layer_side_panel_UserLayerInfoPanel","tabView","layer_side_panel_EmptyUserLayerInfoPanel","layer_side_panel_ManagedUserLayerInfoPanel","collapseButton","handleLayerNameViewChanged","handleLayerNameModelChanged","handleUserLayerChanged","newName","layer_side_panel_LayerInfoPanelContainer","handleStateChanged","invalidate","tooltip_Tooltip","annotationTooltipHandlers","_voxelSize","TOOLTIP_DELAY","mouse_selection_state_tooltip_MouseSelectionStateTooltipManager","debouncedShowTooltip","doCreateTooltip","debouncedShowTooltip0","maybeCreateTooltip","setReference","mouseStateChanged","segmentContainer","combinedTransform","typeHandler","positionElement","valueUpdateDelay","state_editor_StateEditorDialog","parsedValue","applyButton","lib_codemirror_default","applyChanges","getJson","statistics_StatisticsDisplayState","tracker","getProperties","handleObject","getFormattedNames","selectedProps","allProps","areDistinguished","bestReducedMatches","bestProp","reducedMatches","getDistinguishingProperties","getNameFromProps","requestDataInterval","statistics_StatisticsPanel","columns","requestDataTimerId","dataRequested","requestData","statistics","numChunks","DOWNLOADING","SYSTEM_MEMORY_WORKER","FAILED","gpuMemoryBytes","totalTime","formattedNames","sourceFormattedNames","thead","tr","addHeaderColumn","td","prevPrefix","sepIndex","colSpan","tbody","addColumn","annotation_tool_status_AnnotationToolStatusWidget","selectedLayerChanged","unbindPreviousLayer","getDescriptionText","number_input_widget_NumberInputWidget","viewer_DataManagementContext","Worker","terminate","viewerUiControlOptionKeys","viewerOptionKeys","viewer_ViewerUIControlConfiguration","showHelpButton","showEditStateButton","showLocation","showAnnotationToolStatus","viewer_ViewerUIConfiguration","showUIControls","showPanelBorders","defaultViewerOptions","NEUROGLANCER_OVERRIDE_DEFAULT_VIEWER_OPTIONS","showLayerDialog","resetStateWhenEmpty","viewer_Viewer","showDefaultAnnotations","statisticsDisplayState","resetInitiated","dataContext","makeCanvasOverlayElement","default_provider","default_manager","uiConfiguration","setViewerUiConfiguration","optionsWithDefaults","makeUiControlVisibilityState","updateShowBorders","onUpdateDisplay","handleNavigationStateChanged","initializePosition","maybeResetState","registerActionListeners","registerEventActionBindings","gridContainer","addLimitWidget","addCheckbox","makeViewerContextMenu","voxelSizeWidget","mousePositionWidget","alignSelf","annotationToolStatus","editJsonState","showHelpDialog","layoutAndSidePanel","layerInfoPanel","statisticsPanel","shouldBeVisible","trigger","showStatistics","makeDefaultViewer","getElementById","url_hash_binding_UrlHashBinding","updateDelayMilliseconds","updateFromUrlHash","throttledSetUrlHash","setUrlHash","prevStateGeneration","stateString","encodeURI","prevStateString","replaceState","setupDefaultViewer","hashBinding","stateJson","bindDefaultCopyHandler","trackableFiniteFloat","trackableVec3","trackable_vec3_TrackableVec3","vector_graphics_line_renderlayer_VectorGraphicsLineRenderLayer","vertexIndexBuffer","normalDirection","normalDirectionBuffer","aVertexFirst","aVertexSecond","vec3_entry_widget_Vec3Widget","inputx","inputy","inputz","valueEntered","getVec3Values","verifyValue","vector_graphics_user_layer_VectorGraphicsUserLayer","vectorGraphicsLayerType","vectorGraphicsPath","getVectorGraphicsWithStatusMessage","vectorGraphics","vector_graphics_user_layer_DisplayOptionsTab","getLayerType","opacityWidget","lineWidthWidget","colorWidget","vector_graphics_user_layer_VectorGraphicsColorWidget","spacer","num","SINGLE_MESH_LAYER_RPC_ID","GET_SINGLE_MESH_INFO_RPC_ID","SINGLE_MESH_CHUNK_KEY","SingleMeshSourceParameters","SingleMeshSourceParametersWithInfo","index_emulation_CountingBuffer","webglType","divisor","countingBufferShaderModule","IndexBufferAttributeHelper","attrib","frontend_SingleMeshDisplayState","getShaderAttributeType","vertexNormalTextureFormat","frontend_SingleMeshShaderManager","attributeInfo","indexBufferHelper","vertexIndexVariable","attributeName","addVertexMain","vertexTexture","normalTexture","numVertexAttributes","countingBuffer","bindVertexData","vertexData","instanced","disableCountingBuffer","disableVertexData","frontend_VertexChunkData","attributeFormats","getBufferTexture","frontend_SingleMeshChunk","makeIndexBuffer","frontend_SingleMeshSource","SharedObjectWithSharedVisibility","SingleMeshLayerSharedObject","frontend_SingleMeshLayer","shaderChanged","shaderManager","disposeShaders","makeShaderManager","otherShaderError","beginObject","getSingleMeshSource","getSingleMeshInfo","single_mesh_user_layer_SingleMeshUserLayer","BaseUserLayer","user_layer_with_coordinate_transform","meshSourceUrl","attributeSourceUrls","userSpecifiedAttributeNames","defaultAttributeNames","existingNames","seenNames","existingName","suffixNumber","pickAttributeNames","initialAttributeNames","single_mesh_user_layer_DisplayOptionsTab","persistentAttributeNames","makeShaderCodeWidget","single_mesh_user_layer_VertexAttributeWidget","getAttributeInfo","updateAttributeNames","updateInputElements","attributeNameElements","previousSource","minMaxText","makeVertexAttributeWidget","attributeWidget","single_mesh_user_layer_ShaderCodeOverlay","AUTH_SERVER","AUTH_ORIGIN","google_oauth2_PendingRequest","finished","google_oauth2_AuthHandler","proxyName","rpcToken","relayReadyService","oauth2CallbackService","pendingRequests","iframe","embedRelayFrame","relayReadyPromise","relayReadyPromiseResolve","service","errorSubtype","fullMessage","expiresIn","scope","clientId","scopes","approvalPrompt","loginHint","immediate","authUser","authHandlerInstance","authenticateGoogleOAuth2","makeAuthRequestUrl","addPendingRequest","newWindow","google_oauth2_GoogleOAuth2CredentialsProvider","credentials_provider","cancellationSource","writeLoginStatus","linkMessage","login","BRAINMAPS_SCOPE","credentials_provider_BrainmapsCredentialsProvider","BLEND_MODES","BLEND_FUNCTIONS","blendModeValidator","trackableBlendModeValue","DEFAULT","ADDITIVE","image_renderlayer_ImageRenderLayer","blendMode","blendModeValue","image_user_layer_ImageUserLayer","OPACITY_JSON_KEY","BLEND_JSON_KEY","SHADER_JSON_KEY","image_user_layer_RenderingOptionsTab","image_user_layer_ShaderCodeOverlay","credentials_provider_PendingRequest","credentials_provider_AuthHandler","oidcCallbackService","registerListener","redirect_uri","authenticateKeycloakOIDC","credentials_provider_BossCredentialsProvider","realm","layer_reference_LayerReferenceWidget","selectElement","emptyOption","user_layer_AnnotationUserLayer","POINTS_JSON_KEY","ANNOTATIONS_JSON_KEY","isValidLinkedSegmentationLayer","segmentation_user_layer","VOXEL_SIZE_JSON_KEY","LINKED_SEGMENTATION_LAYER_JSON_KEY","FILTER_BY_SEGMENTATION_JSON_KEY","ui_annotations","localAnnotations","linkedSegmentationLayer","voxelSizeValid","voxelScalingMatrix","setSegmentationState","getSegmentationDisplayState","checkboxWidget"],"mappings":"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","file":"main.bundle.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t};\n\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"\" + ({\"1\":\"tfjs-library\"}[chunkId]||chunkId) + \".bundle.js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\tvar error = new Error('Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')');\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 134);\n","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Type} type Array type, such as Float32Array or Array\r\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}","import * as glMatrix from \"./common.js\";\n/**\r\n * 3x3 Matrix\r\n * @module mat3\r\n */\n\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {mat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\n\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {mat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Create a new mat3 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} A new mat3\r\n */\n\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set the components of a mat3 to the given values\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} out\r\n */\n\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {mat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b00 = b[0],\n      b01 = b[1],\n      b02 = b[2];\n  var b10 = b[3],\n      b11 = b[4],\n      b12 = b[5];\n  var b20 = b[6],\n      b21 = b[7],\n      b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to translate\r\n * @param {vec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\n\nexport function translate(out, a, v) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      x = v[0],\n      y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n;\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to rotate\r\n * @param {vec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.translate(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {vec2} v Translation vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.rotate(dest, dest, rad);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.scale(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {vec2} v Scaling vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\n\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n/**\r\n* Calculates a 3x3 matrix from the given quaternion\r\n*\r\n* @param {mat3} out mat3 receiving operation result\r\n* @param {quat} q Quaternion to create matrix from\r\n*\r\n* @returns {mat3} out\r\n*/\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n/**\r\n* Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n*\r\n* @param {mat3} out mat3 receiving operation result\r\n* @param {mat4} a Mat4 to derive the normal matrix from\r\n*\r\n* @returns {mat3} out\r\n*/\n\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n/**\r\n * Generates a 2D projection matrix with the given bounds\r\n *\r\n * @param {mat3} out mat3 frustum matrix will be written into\r\n * @param {number} width Width of your gl context\r\n * @param {number} height Height of gl context\r\n * @returns {mat3} out\r\n */\n\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {mat3} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return 'mat3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' + a[8] + ')';\n}\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {mat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + Math.pow(a[6], 2) + Math.pow(a[7], 2) + Math.pow(a[8], 2));\n}\n/**\r\n * Adds two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n/**\r\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat3} out the receiving vector\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {mat3} a The first matrix.\r\n * @param {mat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {mat3} a The first matrix.\r\n * @param {mat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7],\n      a8 = a[8];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7],\n      b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\n\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {mat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {mat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to translate\r\n * @param {vec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to scale\r\n * @param {vec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {vec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {vec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {vec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {vec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {quat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {mat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {mat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n  out[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n  out[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n  return out;\n}\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {mat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\n\nexport function getRotation(out, mat) {\n  // Algorithm taken from http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n  var trace = mat[0] + mat[5] + mat[10];\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (mat[6] - mat[9]) / S;\n    out[1] = (mat[8] - mat[2]) / S;\n    out[2] = (mat[1] - mat[4]) / S;\n  } else if (mat[0] > mat[5] && mat[0] > mat[10]) {\n    S = Math.sqrt(1.0 + mat[0] - mat[5] - mat[10]) * 2;\n    out[3] = (mat[6] - mat[9]) / S;\n    out[0] = 0.25 * S;\n    out[1] = (mat[1] + mat[4]) / S;\n    out[2] = (mat[8] + mat[2]) / S;\n  } else if (mat[5] > mat[10]) {\n    S = Math.sqrt(1.0 + mat[5] - mat[0] - mat[10]) * 2;\n    out[3] = (mat[8] - mat[2]) / S;\n    out[0] = (mat[1] + mat[4]) / S;\n    out[1] = 0.25 * S;\n    out[2] = (mat[6] + mat[9]) / S;\n  } else {\n    S = Math.sqrt(1.0 + mat[10] - mat[0] - mat[5]) * 2;\n    out[3] = (mat[1] - mat[4]) / S;\n    out[0] = (mat[8] + mat[2]) / S;\n    out[1] = (mat[6] + mat[9]) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @param {vec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @param {vec3} s Scaling vector\r\n * @param {vec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\n\nexport function perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function ortho(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {vec3} eye Position of the viewer\r\n * @param {vec3} center Point the viewer is looking at\r\n * @param {vec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {vec3} eye Position of the viewer\r\n * @param {vec3} center Point the viewer is looking at\r\n * @param {vec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n;\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {mat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return 'mat4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' + a[8] + ', ' + a[9] + ', ' + a[10] + ', ' + a[11] + ', ' + a[12] + ', ' + a[13] + ', ' + a[14] + ', ' + a[15] + ')';\n}\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {mat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + Math.pow(a[6], 2) + Math.pow(a[7], 2) + Math.pow(a[8], 2) + Math.pow(a[9], 2) + Math.pow(a[10], 2) + Math.pow(a[11], 2) + Math.pow(a[12], 2) + Math.pow(a[13], 2) + Math.pow(a[14], 2) + Math.pow(a[15], 2));\n}\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {mat4} a The first matrix.\r\n * @param {mat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {mat4} a The first matrix.\r\n * @param {mat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\n\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {vec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {vec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the source vector\r\n * @returns {vec3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to floor\r\n * @returns {vec3} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to round\r\n * @returns {vec3} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {vec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to negate\r\n * @returns {vec3} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to invert\r\n * @returns {vec3} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {vec3} c the third operand\r\n * @param {vec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {vec3} c the third operand\r\n * @param {vec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {mat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {quat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec3} out\r\n */\n\nexport function rotateX(out, a, b, c) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(c) - p[2] * Math.sin(c);\n  r[2] = p[1] * Math.sin(c) + p[2] * Math.cos(c); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec3} out\r\n */\n\nexport function rotateY(out, a, b, c) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(c) + p[0] * Math.cos(c);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(c) - p[0] * Math.sin(c); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec3} out\r\n */\n\nexport function rotateZ(out, a, b, c) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(c) - p[1] * Math.sin(c);\n  r[1] = p[0] * Math.sin(c) + p[1] * Math.cos(c);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {vec3} a The first operand\r\n * @param {vec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var tempA = fromValues(a[0], a[1], a[2]);\n  var tempB = fromValues(b[0], b[1], b[2]);\n  normalize(tempA, tempA);\n  normalize(tempB, tempB);\n  var cosine = dot(tempA, tempB);\n\n  if (cosine > 1.0) {\n    return 0;\n  } else if (cosine < -1.0) {\n    return Math.PI;\n  } else {\n    return Math.acos(cosine);\n  }\n}\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return 'vec3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ')';\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {vec3} a The first vector.\r\n * @param {vec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {vec3} a The first vector.\r\n * @param {vec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\n\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {vec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the source vector\r\n * @returns {vec4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to floor\r\n * @returns {vec4} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to round\r\n * @returns {vec4} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.sqrt(x * x + y * y + z * z + w * w);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {vec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.sqrt(x * x + y * y + z * z + w * w);\n}\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {vec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to negate\r\n * @returns {vec4} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to invert\r\n * @returns {vec4} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {vec4} result the receiving vector\r\n * @param {vec4} U the first vector\r\n * @param {vec4} V the second vector\r\n * @param {vec4} W the third vector\r\n * @returns {vec4} result\r\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n;\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to transform\r\n * @param {quat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return 'vec4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {vec4} a The first vector.\r\n * @param {vec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {vec4} a The first vector.\r\n * @param {vec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n/**\r\n * Quaternion\r\n * @module quat\r\n */\n\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {vec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\n\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n/**\r\n * Gets the rotation axis and angle for a given\r\n *  quaternion. If a quaternion is created with\r\n *  setAxisAngle, this method will return the same\r\n *  values as providied in the original parameter list\r\n *  OR functionally equivalent values.\r\n * Example: The quaternion formed by axis [0, 0, 1] and\r\n *  angle -90 is the same as the quaternion formed by\r\n *  [0, 0, 1] and 270. This method favors the latter.\r\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\r\n * @param  {quat} q     Quaternion to be decomposed\r\n * @return {Number}     Angle, in radians, of the rotation\r\n */\n\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n\n  return rad;\n}\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {quat} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var by = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bz = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\n\nexport function calculateW(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega, cosom, sinom, scale0, scale1; // calc cosine\n\n  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)\n\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  } // calculate coefficients\n\n\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  } // calculate final values\n\n\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n/**\r\n * Generates a random quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {mat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n\n  return out;\n}\n/**\r\n * Creates a quaternion from the given euler angle x, y, z.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {x} Angle to rotate around X axis in degrees.\r\n * @param {y} Angle to rotate around Y axis in degrees.\r\n * @param {z} Angle to rotate around Z axis in degrees.\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromEuler(out, x, y, z) {\n  var halfToRad = 0.5 * Math.PI / 180.0;\n  x *= halfToRad;\n  y *= halfToRad;\n  z *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  out[0] = sx * cy * cz - cx * sy * sz;\n  out[1] = cx * sy * cz + sx * cy * sz;\n  out[2] = cx * cy * sz - sx * sy * cz;\n  out[3] = cx * cy * cz + sx * sy * sz;\n  return out;\n}\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {quat} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return 'quat(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {quat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var clone = vec4.clone;\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var fromValues = vec4.fromValues;\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var copy = vec4.copy;\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var set = vec4.set;\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var add = vec4.add;\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {quat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var scale = vec4.scale;\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = vec4.dot;\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var lerp = vec4.lerp;\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {quat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport var length = vec4.length;\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {quat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = vec4.squaredLength;\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var normalize = vec4.normalize;\n/**\r\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {quat} a The first quaternion.\r\n * @param {quat} b The second quaternion.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var exactEquals = vec4.exactEquals;\n/**\r\n * Returns whether or not the quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {quat} a The first vector.\r\n * @param {quat} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var equals = vec4.equals;\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {vec3} a the initial vector\r\n * @param {vec3} b the destination vector\r\n * @returns {quat} out\r\n */\n\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n/**\r\n * Performs a spherical linear interpolation with two control points\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {quat} c the third operand\r\n * @param {quat} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {vec3} view  the vector representing the viewing direction\r\n * @param {vec3} right the vector representing the local \"right\" direction\r\n * @param {vec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\n\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 2 Dimensional Vector\r\n * @module vec2\r\n */\n\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {vec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the source vector\r\n * @returns {vec2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to ceil\r\n * @returns {vec2} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to floor\r\n * @returns {vec2} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to round\r\n * @returns {vec2} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.sqrt(x * x + y * y);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {vec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.sqrt(x * x + y * y);\n}\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {vec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to negate\r\n * @returns {vec2} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to invert\r\n * @returns {vec2} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\r\n * Rotate a 2D vector\r\n * @param {vec2} out The receiving vec2\r\n * @param {vec2} a The vec2 point to rotate\r\n * @param {vec2} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec2} out\r\n */\n\nexport function rotate(out, a, b, c) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(c),\n      cosC = Math.cos(c); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\r\n * Get the angle between two 2D vectors\r\n * @param {vec2} a The first operand\r\n * @param {vec2} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1];\n  var len1 = x1 * x1 + y1 * y1;\n\n  if (len1 > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len1 = 1 / Math.sqrt(len1);\n  }\n\n  var len2 = x2 * x2 + y2 * y2;\n\n  if (len2 > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len2 = 1 / Math.sqrt(len2);\n  }\n\n  var cosine = (x1 * x2 + y1 * y2) * len1 * len2;\n\n  if (cosine > 1.0) {\n    return 0;\n  } else if (cosine < -1.0) {\n    return Math.PI;\n  } else {\n    return Math.acos(cosine);\n  }\n}\n/**\r\n * Set the components of a vec2 to zero\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @returns {vec2} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec2} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return 'vec2(' + a[0] + ', ' + a[1] + ')';\n}\n/**\r\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\r\n *\r\n * @param {vec2} a The first vector.\r\n * @param {vec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {vec2} a The first vector.\r\n * @param {vec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {mat3, mat4, quat, vec3} from 'gl-matrix';\n\nexport {mat2, mat3, mat4, quat, vec2, vec3, vec4} from 'gl-matrix';\n\nexport const identityMat4 = mat4.create();\n\nexport const AXES_NAMES = ['x', 'y', 'z'];\n\nexport class BoundingBox {\n  constructor(public lower: vec3, public upper: vec3) {}\n}\n\nexport const kAxes = [\n  vec3.fromValues(1, 0, 0),\n  vec3.fromValues(0, 1, 0),\n  vec3.fromValues(0, 0, 1),\n];\nexport const kZeroVec = vec3.fromValues(0, 0, 0);\nexport const kOneVec = vec3.fromValues(1, 1, 1);\nexport const kInfinityVec = vec3.fromValues(Infinity, Infinity, Infinity);\nexport const kIdentityQuat = quat.create();\n\nexport function prod3(x: ArrayLike<number>) {\n  return x[0] * x[1] * x[2];\n}\n\nexport function prod4(x: ArrayLike<number>) {\n  return x[0] * x[1] * x[2] * x[3];\n}\n\n/**\n * Implements a one-to-one conversion from Vec3 to string, suitable for use a Map key.\n *\n * Specifically, returns the string representation of the 3 values separated by commas.\n */\nexport function vec3Key(x: ArrayLike<number>) {\n  return `${x[0]},${x[1]},${x[2]}`;\n}\n\nconst RECTIFY_EPSILON = 1e-4;\n\nexport function rectifyVec3IfAxisAligned(v: Float32Array, offset: number) {\n  let a0 = Math.abs(v[offset]), a1 = Math.abs(v[offset + 1]), a2 = Math.abs(v[offset + 2]);\n  let max = Math.max(a0, a1, a2);\n  if (a0 / max < RECTIFY_EPSILON) {\n    v[offset] = 0;\n  }\n  if (a1 / max < RECTIFY_EPSILON) {\n    v[offset + 1] = 0;\n  }\n  if (a2 / max < RECTIFY_EPSILON) {\n    v[offset + 2] = 0;\n  }\n}\n\n/**\n * Makes columns of m that are approximately axis-aligned exactly axis aligned.\n *\n * Note that mat is stored in Fortran order, and therefore the first column is m[0], m[1], m[2].\n */\nexport function rectifyTransformMatrixIfAxisAligned(m: mat4) {\n  rectifyVec3IfAxisAligned(m, 0);\n  rectifyVec3IfAxisAligned(m, 4);\n  rectifyVec3IfAxisAligned(m, 8);\n}\n\n/**\n * Transforms `a` by a 180-degree rotation about X, stores result in `out`.\n */\nexport function quatRotateX180(out: quat, a: quat) {\n  let x = a[0], y = a[1], z = a[2], w = a[3];\n  out[0] = w;\n  out[1] = z;\n  out[2] = -y;\n  out[3] = -x;\n}\n\n/**\n * Transforms `a` by a 180-degree rotation about Y, stores result in `out`.\n */\nexport function quatRotateY180(out: quat, a: quat) {\n  let x = a[0], y = a[1], z = a[2], w = a[3];\n  out[0] = -z;\n  out[1] = w;\n  out[2] = x;\n  out[3] = -y;\n}\n\n/**\n * Transforms `a` by a 180-degree rotation about Z, stores result in `out`.\n */\nexport function quatRotateZ180(out: quat, a: quat) {\n  let x = a[0], y = a[1], z = a[2], w = a[3];\n  out[0] = y;\n  out[1] = -x;\n  out[2] = w;\n  out[3] = -z;\n}\n\n\n/**\n * Transforms a vector `a` by a homogenous transformation matrix `m`.  The translation component of\n * `m` is ignored.\n */\nexport function transformVectorByMat4(out: vec3, a: vec3, m: mat4) {\n  let x = a[0], y = a[1], z = a[2];\n  out[0] = m[0] * x + m[4] * y + m[8] * z;\n  out[1] = m[1] * x + m[5] * y + m[9] * z;\n  out[2] = m[2] * x + m[6] * y + m[10] * z;\n  return out;\n}\n\n\n/**\n * Computes the effective scaling factor of each local spatial dimension by `m`, which is assumed to\n * transform local coordinates to global coordinates.\n */\nexport function effectiveScalingFactorFromMat4(out: vec3, m: mat4) {\n  const m0 = m[0], m1 = m[1], m2 = m[2], m4 = m[4], m5 = m[5], m6 = m[6], m8 = m[8], m9 = m[9],\n        m10 = m[10];\n  out[0] = Math.sqrt(m0 * m0 + m1 * m1 + m2 * m2);\n  out[1] = Math.sqrt(m4 * m4 + m5 * m5 + m6 * m6);\n  out[2] = Math.sqrt(m8 * m8 + m9 * m9 + m10 * m10);\n  return out;\n}\n\nexport function translationRotationScaleZReflectionToMat4(\n    out: mat4, translation: vec3, rotation: quat, scale: vec3, zReflection: number) {\n  const temp: Float32Array = out;\n  out[0] = scale[0];\n  out[1] = scale[1];\n  out[2] = scale[2] * zReflection;\n  return mat4.fromRotationTranslationScale(out, rotation, translation, <vec3>temp);\n}\n\n/**\n * Returns the value of `t` that minimizes `(p - (a + t * (b - a)))`.\n */\nexport function findClosestParameterizedLinePosition(a: vec3, b: vec3, p: vec3) {\n  // http://mathworld.wolfram.com/Point-LineDistance3-Dimensional.html\n  // Compute t: -dot(a-p, b-a) / |b - a|^2\n  const denominator = vec3.squaredDistance(a, b);\n  let numerator = 0;\n  for (let i = 0; i < 3; ++i) {\n    const aValue = a[i];\n    numerator -= (aValue - p[i]) * (b[i] - aValue);\n  }\n  return numerator / Math.max(denominator, 1e-6);\n}\n\n/**\n * Sets `out` to the position on the line segment `[a, b]` closest to `p`.\n */\nexport function projectPointToLineSegment(out: vec3, a: vec3, b: vec3, p: vec3) {\n  let t = findClosestParameterizedLinePosition(a, b, p);\n  t = Math.max(0.0, Math.min(1.0, t));\n  for (let i = 0; i < 3; ++i) {\n    const aValue = a[i];\n    out[i] = aValue + t * (b[i] - aValue);\n  }\n  return out;\n}\n\nexport function mat3FromMat4(out: mat3, m: mat4) {\n  const m00 = m[0], m01 = m[1], m02 = m[2], m10 = m[4], m11 = m[5], m12 = m[6], m20 = m[8],\n        m21 = m[9], m22 = m[10];\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n\n/**\n * Extracts the left, right, bottom, top, near, far clipping planes from `projectionMat`.\n * @param out Row-major array of shape `(6, 4)` specifying for each of the left, right, bottom, top,\n *     near, far clipping planes the `a`, `b`, `c`, `d` coefficients such that\n *     `0 < a * x + b * y + c * z + d` if the point `x, y, z` is inside the half-space of the\n * clipping plane.\n * @param m Projection matrix\n */\nexport function getFrustrumPlanes(out: Float32Array, m: mat4): Float32Array {\n  // http://web.archive.org/web/20120531231005/http://crazyjoke.free.fr/doc/3D/plane%20extraction.pdf\n  const m00 = m[0], m10 = m[1], m20 = m[2], m30 = m[3], m01 = m[4], m11 = m[5], m21 = m[6],\n        m31 = m[7], m02 = m[8], m12 = m[9], m22 = m[10], m32 = m[11], m03 = m[12], m13 = m[13],\n        m23 = m[14], m33 = m[15];\n\n  out[0] = m30 + m00;  // left: a\n  out[1] = m31 + m01;  // left: b\n  out[2] = m32 + m02;  // left: c\n  out[3] = m33 + m03;  // left: d\n\n  out[4] = m30 - m00;  // right: a\n  out[5] = m31 - m01;  // right: b\n  out[6] = m32 - m02;  // right: c\n  out[7] = m33 - m03;  // right: d\n\n  out[8] = m30 + m10;   // bottom: a\n  out[9] = m31 + m11;   // bottom: b\n  out[10] = m32 + m12;  // bottom: c\n  out[11] = m33 + m13;  // bottom: d\n\n  out[12] = m30 - m10;  // top: a\n  out[13] = m31 - m11;  // top: b\n  out[14] = m32 - m12;  // top: c\n  out[15] = m33 - m13;  // top: d\n\n  const nearA = m30 + m20;  // near: a\n  const nearB = m31 + m21;  // near: b\n  const nearC = m32 + m22;  // near: c\n  const nearD = m33 + m23;  // near: d\n\n  // Normalize near plane\n  const nearNorm = Math.sqrt(nearA ** 2 + nearB ** 2 + nearC ** 2);\n  out[16] = nearA / nearNorm;\n  out[17] = nearB / nearNorm;\n  out[18] = nearC / nearNorm;\n  out[19] = nearD / nearNorm;\n\n  out[20] = m30 - m20;  // far: a\n  out[21] = m31 - m21;  // far: b\n  out[22] = m32 - m22;  // far: c\n  out[23] = m33 - m23;  // far: d\n\n  return out;\n}\n\n/**\n * Checks whether the specified axis-aligned bounding box (AABB) intersects the view frustrum.\n *\n * @param clippingPlanes Array of length 24 specifying the clipping planes of the view frustrum, as\n *     computed by `getFrustrumPlanes`\n */\nexport function isAABBVisible(\n    xLower: number, yLower: number, zLower: number, xUpper: number, yUpper: number, zUpper: number,\n    clippingPlanes: Float32Array) {\n  for (let i = 0; i < 6; ++i) {\n    const a = clippingPlanes[i * 4], b = clippingPlanes[i * 4 + 1], c = clippingPlanes[i * 4 + 2],\n          d = clippingPlanes[i * 4 + 3];\n    const sum = Math.max(a * xLower, a * xUpper) + Math.max(b * yLower, b * yUpper) +\n        Math.max(c * zLower, c * zUpper) + d;\n    if (sum < 0) {\n      return false;\n    }\n  }\n  return true;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {WritableArrayLike} from 'neuroglancer/util/array';\nimport {vec3} from 'neuroglancer/util/geom';\n\nexport function verifyFloat(obj: any): number {\n  let t = typeof obj;\n  if (t === 'number' || t === 'string') {\n    let x = parseFloat('' + obj);\n    if (!Number.isNaN(x)) {\n      return x;\n    }\n  }\n  throw new Error(`Expected floating-point number, but received: ${JSON.stringify(obj)}.`);\n}\n\nexport function verifyFiniteFloat(obj: any): number {\n  let x = verifyFloat(obj);\n  if (Number.isFinite(x)) {\n    return x;\n  }\n  throw new Error(`Expected finite floating-point number, but received: ${x}.`);\n}\n\nexport function verifyFinitePositiveFloat(obj: any): number {\n  let x = verifyFiniteFloat(obj);\n  if (x > 0) {\n    return x;\n  }\n  throw new Error(`Expected positive finite floating-point number, but received: ${x}.`);\n}\n\nexport function parseXYZ<A extends WritableArrayLike<number>>(\n    out: A, obj: any, validator: (x: any) => number = verifyFloat): A {\n  verifyObject(obj);\n  out[0] = out[1] = out[2] = 0;\n  for (const key of Object.keys(obj)) {\n    switch (key) {\n    case 'x':\n      out[0] = validator(obj[key]);\n      break;\n    case 'y':\n      out[1] = validator(obj[key]);\n      break;\n    case 'z':\n      out[2] = validator(obj[key]);\n      break;\n    default:\n      throw new Error(\n          `Expected object to have keys ['x', 'y', 'z'], but received: ${JSON.stringify(obj)}.`);\n    }\n  }\n  return out;\n}\n\nexport function parseFiniteVec<U extends WritableArrayLike<number>>(out: U, obj: any[]) {\n  let length = out.length;\n  if (!Array.isArray(obj) || obj.length !== length) {\n    throw new Error('Incompatible sizes');\n  }\n\n  for (let i = 0; i < length; ++i) {\n    if (!Number.isFinite(parseFloat(obj[i]))) {\n      throw new Error('Non-finite value.');\n    }\n  }\n  for (let i = 0; i < length; ++i) {\n    out[i] = parseFloat(obj[i]);\n  }\n  return out;\n}\n\nexport function parseIntVec<U extends WritableArrayLike<number>>(out: U, obj: any) {\n  let length = out.length;\n  if (!Array.isArray(obj) || obj.length !== length) {\n    throw new Error('Incompatible sizes.');\n  }\n\n  for (let i = 0; i < length; ++i) {\n    let val = parseInt(obj[i], undefined);\n    if (!Number.isInteger(val)) {\n      throw new Error('Non-integer value.');\n    }\n  }\n\n  for (let i = 0; i < length; ++i) {\n    out[i] = parseInt(obj[i], undefined);\n  }\n  return out;\n}\n\n/**\n * Returns a JSON representation of x, with object keys sorted to ensure a\n * consistent result.\n */\nexport function stableStringify(x: any) {\n  if (typeof x === 'object') {\n    if (x === null) {\n      return 'null';\n    }\n    if (Array.isArray(x)) {\n      let s = '[';\n      let size = x.length;\n      let i = 0;\n      if (i < size) {\n        s += stableStringify(x[i]);\n        while (++i < size) {\n          s += ',';\n          s += stableStringify(x[i]);\n        }\n      }\n      s += ']';\n      return s;\n    }\n    let s = '{';\n    let keys = Object.keys(x).sort();\n    let i = 0;\n    let size = keys.length;\n    if (i < size) {\n      let key = keys[i];\n      s += JSON.stringify(key);\n      s += ':';\n      s += stableStringify(x[key]);\n      while (++i < size) {\n        s += ',';\n        key = keys[i];\n        s += JSON.stringify(key);\n        s += ':';\n        s += stableStringify(x[key]);\n      }\n    }\n    s += '}';\n    return s;\n  }\n  return JSON.stringify(x);\n}\n\nfunction swapQuotes(x: string) {\n  return x.replace(/['\"]/g, s => {\n    return (s === '\"' ? '\\'' : '\"');\n  });\n}\n\nexport function urlSafeStringifyString(x: string) {\n  return swapQuotes(JSON.stringify(swapQuotes(x)));\n}\n\nconst URL_SAFE_COMMA = '_';\n\nexport function urlSafeStringify(x: any): string {\n  if (typeof x === 'object') {\n    if (x === null) {\n      return 'null';\n    }\n    let toJSON = x['toJSON'];\n    if (typeof toJSON === 'function') {\n      return urlSafeStringify(toJSON.call(x));\n    }\n    if (Array.isArray(x)) {\n      let s = '[';\n      let size = x.length;\n      let i = 0;\n      if (i < size) {\n        s += urlSafeStringify(x[i]);\n        while (++i < size) {\n          s += URL_SAFE_COMMA;\n          s += urlSafeStringify(x[i]);\n        }\n      }\n      s += ']';\n      return s;\n    }\n    let s = '{';\n    let keys = Object.keys(x);\n    let first = true;\n    for (let key of keys) {\n      let value = x[key];\n      if (value === undefined) {\n        continue;\n      }\n      let valueString = urlSafeStringify(value);\n      if (!valueString) {\n        continue;\n      }\n      if (!first) {\n        s += URL_SAFE_COMMA;\n      } else {\n        first = false;\n      }\n      s += urlSafeStringifyString(key);\n      s += ':';\n      s += valueString;\n    }\n    s += '}';\n    return s;\n  }\n  if (typeof x === 'string') {\n    return urlSafeStringifyString(x);\n  }\n  return JSON.stringify(x);\n}\n\nconst SINGLE_QUOTE_STRING_PATTERN = /('(?:[^'\\\\]|(?:\\\\.))*')/;\nconst DOUBLE_QUOTE_STRING_PATTERN = /(\"(?:[^'\\\\]|(?:\\\\.))*\")/;\nconst SINGLE_OR_DOUBLE_QUOTE_STRING_PATTERN =\n    new RegExp(`${SINGLE_QUOTE_STRING_PATTERN.source}|${DOUBLE_QUOTE_STRING_PATTERN.source}`);\nconst DOUBLE_OR_SINGLE_QUOTE_STRING_PATTERN =\n    new RegExp(`${DOUBLE_QUOTE_STRING_PATTERN.source}|${SINGLE_QUOTE_STRING_PATTERN.source}`);\n\nconst DOUBLE_QUOTE_PATTERN = /^((?:[^\"'\\\\]|(?:\\\\[^']))*)(\"|\\\\')/;\nconst SINGLE_QUOTE_PATTERN = /^((?:[^\"'\\\\]|(?:\\\\.))*)'/;\n\nfunction convertStringLiteral(\n  x: string, quoteInitial: string, quoteReplace: string, quoteSearch: RegExp) {\n  if (x.length >= 2 && x.charAt(0) === quoteInitial && x.charAt(x.length - 1) === quoteInitial) {\n    let inner = x.substr(1, x.length - 2);\n    let s = quoteReplace;\n    while (inner.length > 0) {\n      let m = inner.match(quoteSearch);\n      if (m === null) {\n        s += inner;\n        break;\n      }\n      s += m[1];\n      if (m[2] === quoteReplace) {\n        // We received a single unescaped quoteReplace character.\n        s += '\\\\';\n        s += quoteReplace;\n      } else {\n        // We received \"\\\\\" + quoteInitial.  We need to remove the escaping.\n        s += quoteInitial;\n      }\n      inner = inner.substr(m.index! + m[0].length);\n    }\n    s += quoteReplace;\n    return s;\n  }\n  return x;\n}\n\n/**\n * Converts a string literal delimited by either single or double quotes into a string literal\n * delimited by double quotes.\n */\nexport function normalizeStringLiteral(x: string) {\n  return convertStringLiteral(x, '\\'', '\"', DOUBLE_QUOTE_PATTERN);\n}\n\n\n\n// quoteChar: des\nfunction convertJsonHelper(x: string, desiredCommaChar: string, desiredQuoteChar: string) {\n  const commaSearch = /[&_,]/g;\n  let quoteInitial: string;\n  let quoteSearch: RegExp;\n  let stringLiteralPattern: RegExp;\n  if (desiredQuoteChar === '\"') {\n    quoteInitial = '\\'';\n    quoteSearch = DOUBLE_QUOTE_PATTERN;\n    stringLiteralPattern = SINGLE_OR_DOUBLE_QUOTE_STRING_PATTERN;\n  } else {\n    quoteInitial = '\"';\n    quoteSearch = SINGLE_QUOTE_PATTERN;\n    stringLiteralPattern = DOUBLE_OR_SINGLE_QUOTE_STRING_PATTERN;\n  }\n  let s = '';\n  while (x.length > 0) {\n    let m = x.match(stringLiteralPattern);\n    let before: string;\n    let replacement: string;\n    if (m === null) {\n      before = x;\n      x = '';\n      replacement = '';\n    } else {\n      before = x.substr(0, m.index);\n      x = x.substr(m.index! + m[0].length);\n      let originalString = m[1];\n      if (originalString !== undefined) {\n        replacement =\n            convertStringLiteral(originalString, quoteInitial, desiredQuoteChar, quoteSearch);\n      } else {\n        replacement = m[2];\n      }\n    }\n    s += before.replace(commaSearch, desiredCommaChar);\n    s += replacement;\n  }\n  return s;\n}\n\nexport function urlSafeToJSON(x: string) {\n  return convertJsonHelper(x, ',', '\"');\n}\n\nexport function jsonToUrlSafe(x: string) {\n  return convertJsonHelper(x, '_', '\\'');\n}\n\nexport function urlSafeParse(x: string) {\n  return JSON.parse(urlSafeToJSON(x));\n}\n\n// Converts a string containing a Python literal into a string containing an equivalent JSON\n// literal.\nexport function pythonLiteralToJSON(x: string) {\n  let s = '';\n  while (x.length > 0) {\n    let m = x.match(SINGLE_OR_DOUBLE_QUOTE_STRING_PATTERN);\n    let before: string;\n    let replacement: string;\n    if (m === null) {\n      before = x;\n      x = '';\n      replacement = '';\n    } else {\n      before = x.substr(0, m.index);\n      x = x.substr(m.index! + m[0].length);\n      let singleQuoteString = m[1];\n      if (singleQuoteString !== undefined) {\n        replacement = normalizeStringLiteral(singleQuoteString);\n      } else {\n        replacement = m[2];\n      }\n    }\n    s += before.replace(/\\(/g, '[')\n             .replace(/\\)/g, ']')\n             .replace('True', 'true')\n             .replace('False', 'false')\n             .replace(/,\\s*([\\}\\]])/g, '$1');\n    s += replacement;\n  }\n  return s;\n}\n\n// Converts a string containing a Python literal into an equivalent JavaScript value.\nexport function pythonLiteralParse(x: string) {\n  return JSON.parse(pythonLiteralToJSON(x));\n}\n\n// Checks that `x' is an array, maps each element by parseElement.\nexport function parseArray<T>(x: any, parseElement: (x: any, index: number) => T): T[] {\n  if (!Array.isArray(x)) {\n    throw new Error(`Expected array, but received: ${JSON.stringify(x)}.`);\n  }\n  return (<any[]>x).map(parseElement);\n}\n\nexport function parseFixedLengthArray<T, U extends WritableArrayLike<T>>(\n    out: U, obj: any, parseElement: (x: any, index: number) => T): U {\n  const length = out.length;\n  if (!Array.isArray(obj) || obj.length !== length) {\n    throw new Error(`Expected length ${length} array, but received: ${JSON.stringify(obj)}.`);\n  }\n  for (let i = 0; i < length; ++i) {\n    out[i] = parseElement(obj[i], i);\n  }\n  return out;\n}\n\nexport function verifyObject(obj: any) {\n  if (typeof obj !== 'object' || obj == null || Array.isArray(obj)) {\n    throw new Error(`Expected JSON object, but received: ${JSON.stringify(obj)}.`);\n  }\n  return obj;\n}\n\nexport function verifyInt(obj: any) {\n  let result = parseInt(obj, 10);\n  if (!Number.isInteger(result)) {\n    throw new Error(`Expected integer, but received: ${JSON.stringify(obj)}.`);\n  }\n  return result;\n}\n\nexport function verifyPositiveInt(obj: any) {\n  let result = verifyInt(obj);\n  if (result <= 0) {\n    throw new Error(`Expected positive integer, but received: ${result}.`);\n  }\n  return result;\n}\n\nexport function verifyMapKey<U>(obj: any, map: Map<string, U>) {\n  let result = map.get(obj);\n  if (result === undefined) {\n    throw new Error(\n        `Expected one of ${JSON.stringify(Array.from(map.keys()))}, ` +\n        `but received: ${JSON.stringify(obj)}.`);\n  }\n  return result;\n}\n\nexport function verifyString(obj: any) {\n  if (typeof obj !== 'string') {\n    throw new Error(`Expected string, but received: ${JSON.stringify(obj)}.`);\n  }\n  return obj;\n}\n\nexport function verifyOptionalString(obj: any): string|undefined {\n  if (obj === undefined) {\n    return undefined;\n  }\n  return verifyString(obj);\n}\n\nexport function verifyOptionalInt(obj: any): number|undefined {\n  if (obj === undefined) {\n    return undefined;\n  }\n  return verifyInt(obj);\n}\n\nexport function verifyOptionalBoolean(obj: any): boolean|undefined {\n  if (obj === undefined) {\n    return undefined;\n  }\n  if (typeof obj === 'boolean') {\n    return obj;\n  } else if (obj === 'true') {\n    return true;\n  } else if (obj === 'false') {\n    return false;\n  } else {\n    throw new Error(`Expected string or boolean but received: ${JSON.stringify(obj)}`);\n  }\n}\n\nexport function valueOr<T>(value: T|undefined, defaultValue: T) {\n  return value === undefined ? defaultValue : value;\n}\n\nexport function verifyObjectProperty<T>(\n    obj: any, propertyName: string, validator: (value: any) => T): T {\n  let value = obj.hasOwnProperty(propertyName) ? obj[propertyName] : undefined;\n  try {\n    return validator(value);\n  } catch (parseError) {\n    throw new Error(\n        `Error parsing ${JSON.stringify(propertyName)} property: ${parseError.message}`);\n  }\n}\n\nexport function verifyObjectAsMap<T>(obj: any, validator: (value: any) => T): Map<string, T> {\n  verifyObject(obj);\n  let map = new Map<string, T>();\n  for (let key of Object.keys(obj)) {\n    try {\n      map.set(key, validator(obj[key]));\n    } catch (parseError) {\n      throw new Error(\n          `Error parsing value associated with key ${JSON.stringify(key)}: ${parseError.message}`);\n    }\n  }\n  return map;\n}\n\nexport function verifyFloat01(obj: any): number {\n  if (typeof obj !== 'number' || !Number.isFinite(obj) || obj < 0 || obj > 1) {\n    throw new Error(\n        `Expected floating point number in [0,1], but received: ${JSON.stringify(obj)}.`);\n  }\n  return obj;\n}\n\n/**\n * The query string parameters may either be specified in the usual\n * 'name=value&otherName=otherValue' form or as (optionally urlSafe) JSON: '{\"name\":\"value\"}`.\n */\nexport function parseQueryStringParameters(queryString: string) {\n  if (queryString === '') {\n    return {};\n  }\n  if (queryString.startsWith('{')) {\n    return urlSafeParse(queryString);\n  } else {\n    let result: any = {};\n    let parts = queryString.split(/[&;]/);\n    for (let part of parts) {\n      let m = part.match(/^([^=&;]+)=([^&;]*)$/);\n      if (m === null) {\n        throw new Error(`Invalid query string part: ${JSON.stringify(part)}.`);\n      }\n      result[m[1]] = decodeURIComponent(m[2]);\n    }\n    return result;\n  }\n}\n\n/**\n * Verifies that `obj' is a string that, when converted to uppercase, matches a string property of\n * `enumType`.\n *\n * Note: TypeScript does not seem to allow better typing of the return type.\n *\n * @returns The corresponding numerical value.\n */\nexport function verifyEnumString(obj: any, enumType: {[x: string]: any}): number {\n  if (typeof obj === 'string' && obj.match(/^[a-zA-Z]/) !== null) {\n    obj = obj.toUpperCase();\n    if (enumType.hasOwnProperty(obj)) {\n      return enumType[obj];\n    }\n  }\n  throw new Error(`Invalid enum value: ${JSON.stringify(obj)}.`);\n}\n\nexport function verify3dVec(obj: any) {\n  return parseFixedLengthArray(vec3.create(), obj, verifyFiniteFloat);\n}\n\nexport function verify3dScale(obj: any) {\n  return parseFixedLengthArray(vec3.create(), obj, verifyFinitePositiveFloat);\n}\n\nexport function verify3dDimensions(obj: any) {\n  return parseFixedLengthArray(vec3.create(), obj, verifyPositiveInt);\n}\n\nexport function verifyStringArray(a: any) {\n  if (!Array.isArray(a)) {\n    throw new Error(`Expected array, received: ${JSON.stringify(a)}.`);\n  }\n  for (let x of a) {\n    if (typeof x !== 'string') {\n      throw new Error(`Expected string, received: ${JSON.stringify(x)}.`);\n    }\n  }\n  return <string[]>a;\n}\n\nexport function verifyBoolean(x: any) {\n  if (typeof x !== 'boolean') {\n    throw new Error(`Expected boolean, received: ${JSON.stringify(x)}`);\n  }\n  return x;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface Disposable { dispose: () => void; }\n\nexport type Disposer = Disposable | (() => void);\n\nexport function invokeDisposer(disposer: Disposer) {\n  if (typeof disposer === 'object') {\n    disposer.dispose();\n  } else {\n    disposer();\n  }\n}\n\nexport function invokeDisposers(disposers: Disposer[]) {\n  for (let i = disposers.length; i > 0; --i) {\n    invokeDisposer(disposers[i - 1]);\n  }\n}\n\nexport function registerEventListener(\n    target: EventTarget, type: string, listener: EventListenerOrEventListenerObject,\n    options?: boolean|AddEventListenerOptions) {\n  target.addEventListener(type, listener, options);\n  return () => target.removeEventListener(type, listener, options);\n}\n\nexport class RefCounted implements Disposable {\n  public refCount = 1;\n  wasDisposed: boolean|undefined;\n  private disposers: Disposer[];\n  addRef() {\n    ++this.refCount;\n    return this;\n  }\n  dispose() {\n    if (--this.refCount !== 0) {\n      return;\n    }\n    this.refCountReachedZero();\n  }\n\n  protected refCountReachedZero() {\n    this.disposed();\n    let {disposers} = this;\n    if (disposers !== undefined) {\n      invokeDisposers(disposers);\n      this.disposers = <any>undefined;\n    }\n    this.wasDisposed = true;\n  }\n  disposed() {}\n  registerDisposer<T extends Disposer>(f: T): T {\n    let {disposers} = this;\n    if (disposers == null) {\n      this.disposers = [f];\n    } else {\n      disposers.push(f);\n    }\n    return f;\n  }\n  unregisterDisposer<T extends Disposer>(f: T): T {\n    let {disposers} = this;\n    if (disposers != null) {\n      let index = disposers.indexOf(f);\n      if (index !== -1) {\n        disposers.splice(index, 1);\n      }\n    }\n    return f;\n  }\n  registerEventListener(\n      target: EventTarget, type: string, listener: EventListenerOrEventListenerObject,\n      options?: boolean|AddEventListenerOptions) {\n    this.registerDisposer(registerEventListener(target, type, listener, options));\n  }\n  registerCancellable<T extends{cancel: () => void}>(cancellable: T) {\n    this.registerDisposer(() => {\n      cancellable.cancel();\n    });\n    return cancellable;\n  }\n}\n\nexport class RefCountedValue<T> extends RefCounted {\n  constructor(public value: T) {\n    super();\n  }\n}\n\n/**\n * A variable of this type is associated with an increment of the reference count.  If a function\n * parameter is declared with this type, then callers must donate a reference count.\n */\nexport type Owned<T extends Disposable> = T;\n\n/**\n * A variable of this type is not associated with an increment of the reference count.\n */\nexport type Borrowed<T extends Disposable> = T;\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Simple signal dispatch mechanism.\n */\n\n/**\n * This class provides a simple signal dispatch mechanism.  Handlers can be added, and then the\n * `dispatch` method calls all of them.\n *\n * If specified, Callable should be an interface containing only a callable signature returning\n * void.  Due to limitations in TypeScript, any interface containing a callable signature will be\n * accepted by the compiler, but the resultant signature of `dispatch` will not be correct.\n */\nexport class Signal<Callable extends Function> {\n  private handlers = new Set<Callable>();\n\n  /**\n   * Count of number of times this signal has been dispatched.  This is incremented each time\n   * `dispatch` is called prior to invoking the handlers.\n   */\n  count = 0;\n\n  constructor() {\n    const obj = this;\n    this.dispatch = <Callable><Function>function(this: any) {\n      ++obj.count;\n      obj.handlers.forEach(handler => {\n        handler.apply(this, arguments);\n      });\n    };\n  }\n\n  /**\n   * Add a handler function.  If `dispatch` is currently be called, then the new handler will be\n   * called before `dispatch` returns.\n   *\n   * @param handler The handler function to add.\n   *\n   * @return A function that unregisters the handler.\n   */\n  add(handler: Callable): () => boolean {\n    this.handlers.add(handler);\n    return () => {\n      return this.remove(handler);\n    };\n  }\n\n  /**\n   * Remove a handler function.  If `dispatch` is currently be called and the new handler has not\n   * yet been called, then it will not be called.\n   *\n   * @param handler Handler to remove.\n   * @return `true` if the handler was present, `false` otherwise.\n   */\n  remove(handler: Callable): boolean {\n    return this.handlers.delete(handler);\n  }\n\n  /**\n   * Invokes each handler function with the same parameters (including `this`) with which it is\n   * called.  Handlers are invoked in the order in which they were added.\n   */\n  dispatch: Callable;\n\n  /**\n   * Disposes of resources.  No methods, including `dispatch`, may be invoked afterwards.\n   */\n  dispose() {\n    this.handlers = <any>undefined;\n  }\n}\n\n/**\n * Simple specialization of Signal for the common case of a nullary handler signature.\n */\nexport class NullarySignal extends Signal<() => void> {}\n\n/**\n * Interface for a signal excluding the dispatch method.\n *\n * Unlike Signal, this interface is covariant in the type of Callable.\n */\nexport interface ReadonlySignal<Callable extends Function> {\n  readonly count: number;\n  add(handler: Callable): () => void;\n  remove(handler: Callable): boolean;\n}\n\nexport type NullaryReadonlySignal = ReadonlySignal<() => void>;\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkLayoutOptions, getChunkDataSizes, getCombinedTransform, getNearIsotropicBlockSize, SliceViewChunkSource, SliceViewChunkSpecification, SliceViewChunkSpecificationBaseOptions, SliceViewChunkSpecificationOptions, SliceViewSourceOptions} from 'neuroglancer/sliceview/base';\nimport {DATA_TYPE_BYTES, DataType} from 'neuroglancer/util/data_type';\nimport {kInfinityVec, kZeroVec, prod3, vec3} from 'neuroglancer/util/geom';\n\nexport {DATA_TYPE_BYTES, DataType};\n\nexport interface RenderLayer {\n  sources: VolumeChunkSource[][]|null;\n}\n\n/**\n * Specifies the interpretation of volumetric data.\n */\nexport enum VolumeType {\n  UNKNOWN,\n  IMAGE,\n  SEGMENTATION,\n}\n\n/**\n * By default, choose a chunk size with at most 2^18 = 262144 voxels.\n */\nexport const DEFAULT_MAX_VOXELS_PER_CHUNK_LOG2 = 18;\n\nexport interface VolumeSourceOptions extends SliceViewSourceOptions {}\n\n/**\n * Common parameters for the VolumeChunkSpecification constructor and\n * VolumeChunkSpecification.getDefaults.\n */\n/**\n * Specifies constructor parameters for VolumeChunkSpecification.\n */\nexport interface VolumeChunkSpecificationBaseOptions extends\n    SliceViewChunkSpecificationBaseOptions {\n  /**\n   * Lower clipping bound (in nanometers), relative to chunkLayout coordinates.  If not specified,\n   * defaults to lowerVoxelBound * voxelSize.\n   *\n   * Both lowerClipBound and upperClipBound are applied during rendering but do not affect which\n   * chunks/voxels are actually retrieved.  That is determined by lowerVoxelBound and\n   * upperVoxelBound.\n   */\n  lowerClipBound?: vec3;\n\n  /**\n   * Upper clipping bound (in nanometers), relative to chunkLayout coordinates.  If not specified,\n   * defaults to upperVoxelBound * voxelSize.\n   */\n  upperClipBound?: vec3;\n\n  /**\n   * If not specified, defaults to (0, 0, 0).  This determines lowerChunkBound.  If this is not a\n   * multiple of chunkDataSize, then voxels at lower positions may still be requested.\n   */\n  lowerVoxelBound?: vec3;\n\n  /**\n   * Upper voxel bound, relative to chunkLayout coordinates.  This determines upperChunkBound.\n   */\n  upperVoxelBound: vec3;\n\n  /**\n   * Specifies offset for use by backend.ts:GenericVolumeChunkSource.computeChunkBounds in\n   * calculating chunk voxel coordinates.  The calculated chunk coordinates will be equal to the\n   * voxel position (in chunkLayout coordinates) plus this value.\n   *\n   * Defaults to kZeroVec if not specified.\n   */\n  baseVoxelOffset?: vec3;\n  numChannels: number;\n  dataType: DataType;\n\n  /**\n   * If set, indicates that the chunk is in compressed segmentation format with the specified block\n   * size.\n   */\n  compressedSegmentationBlockSize?: vec3;\n}\n\nexport interface VolumeChunkSpecificationOptions extends VolumeChunkSpecificationBaseOptions {\n  /**\n   * Chunk size in voxels.\n   */\n  chunkDataSize: vec3;\n}\n\n\nexport interface VolumeChunkSpecificationVolumeSourceOptions {\n  volumeSourceOptions: VolumeSourceOptions;\n}\n\n/**\n * Specifies additional parameters for VolumeChunkSpecification.withDefaultCompression.\n */\nexport interface VolumeChunkSpecificationDefaultCompressionOptions {\n  /**\n   * Volume type.\n   */\n  volumeType: VolumeType;\n  maxCompressedSegmentationBlockSize?: vec3;\n}\n\n/**\n * Specifies parameters for VolumeChunkSpecification.getDefaults.\n */\nexport interface VolumeChunkSpecificationGetDefaultsOptions extends\n    VolumeChunkSpecificationBaseOptions, VolumeChunkSpecificationDefaultCompressionOptions,\n    ChunkLayoutOptions, VolumeChunkSpecificationVolumeSourceOptions {}\n\n/**\n * Specifies a chunk layout and voxel size.\n */\nexport class VolumeChunkSpecification extends SliceViewChunkSpecification {\n  lowerClipBound: vec3;\n  upperClipBound: vec3;\n\n  lowerVoxelBound: vec3;\n  upperVoxelBound: vec3;\n\n  baseVoxelOffset: vec3;\n  chunkDataSize: vec3;\n  numChannels: number;\n  dataType: DataType;\n\n  chunkBytes: number;\n\n  compressedSegmentationBlockSize: vec3|undefined;\n\n  constructor(options: VolumeChunkSpecificationOptions) {\n    let {\n      lowerVoxelBound = kZeroVec,\n      upperVoxelBound,\n      chunkDataSize,\n      voxelSize,\n      transform,\n      baseVoxelOffset = kZeroVec\n    } = options;\n    let {\n      lowerClipBound = vec3.multiply(vec3.create(), voxelSize, lowerVoxelBound),\n      upperClipBound = vec3.multiply(vec3.create(), voxelSize, upperVoxelBound)\n    } = options;\n    const chunkSize = vec3.multiply(vec3.create(), chunkDataSize, voxelSize);\n    let lowerChunkBound = vec3.create();\n    let upperChunkBound = vec3.create();\n    for (let i = 0; i < 3; ++i) {\n      lowerChunkBound[i] = Math.floor(lowerVoxelBound[i] / chunkDataSize[i]);\n      upperChunkBound[i] = Math.floor((upperVoxelBound[i] - 1) / chunkDataSize[i] + 1);\n    }\n    super({voxelSize, transform, lowerChunkBound, upperChunkBound, chunkSize});\n    this.baseVoxelOffset = baseVoxelOffset;\n    this.lowerClipBound = lowerClipBound;\n    this.upperClipBound = upperClipBound;\n    this.lowerVoxelBound = lowerVoxelBound;\n    this.upperVoxelBound = upperVoxelBound;\n    this.chunkDataSize = chunkDataSize;\n\n    let dataType = this.dataType = options.dataType;\n    let numChannels = this.numChannels = options.numChannels;\n\n    this.chunkBytes = prod3(chunkDataSize) * DATA_TYPE_BYTES[dataType] * numChannels;\n\n    this.compressedSegmentationBlockSize = options.compressedSegmentationBlockSize;\n  }\n\n  static make(options: VolumeChunkSpecificationOptions&\n              {volumeSourceOptions: SliceViewSourceOptions}) {\n    return new VolumeChunkSpecification(Object.assign(\n        {}, options,\n        {transform: getCombinedTransform(options.transform, options.volumeSourceOptions)}));\n  }\n\n  static fromObject(msg: any) {\n    return new VolumeChunkSpecification(msg);\n  }\n  toObject(): VolumeChunkSpecificationOptions&SliceViewChunkSpecificationOptions {\n    return {\n      ...super.toObject(),\n      numChannels: this.numChannels,\n      chunkDataSize: this.chunkDataSize,\n      dataType: this.dataType,\n      lowerVoxelBound: this.lowerVoxelBound,\n      upperVoxelBound: this.upperVoxelBound,\n      lowerClipBound: this.lowerClipBound,\n      upperClipBound: this.upperClipBound,\n      baseVoxelOffset: this.baseVoxelOffset,\n      compressedSegmentationBlockSize: this.compressedSegmentationBlockSize,\n    };\n  }\n\n  /**\n   * Returns a VolumeChunkSpecification with default compression specified if suitable for the\n   * volumeType.\n   */\n  static withDefaultCompression(options: VolumeChunkSpecificationDefaultCompressionOptions&\n                                VolumeChunkSpecificationOptions&\n                                VolumeChunkSpecificationVolumeSourceOptions) {\n    let {\n      compressedSegmentationBlockSize,\n      dataType,\n      voxelSize,\n      transform,\n      lowerVoxelBound,\n      upperVoxelBound\n    } = options;\n    transform = getCombinedTransform(transform, options.volumeSourceOptions);\n    if (compressedSegmentationBlockSize === undefined &&\n        options.volumeType === VolumeType.SEGMENTATION &&\n        (dataType === DataType.UINT32 || dataType === DataType.UINT64)) {\n      compressedSegmentationBlockSize = getNearIsotropicBlockSize({\n        voxelSize,\n        transform,\n        lowerVoxelBound,\n        upperVoxelBound,\n        maxVoxelsPerChunkLog2: 9,\n        maxBlockSize: vec3.min(\n            vec3.create(), options.chunkDataSize,\n            options.maxCompressedSegmentationBlockSize || kInfinityVec),\n      });\n    }\n    return new VolumeChunkSpecification(\n        Object.assign({}, options, {compressedSegmentationBlockSize, transform}));\n  }\n\n  static getDefaults(options: VolumeChunkSpecificationGetDefaultsOptions) {\n    const adjustedOptions = Object.assign(\n        {}, options,\n        {transform: getCombinedTransform(options.transform, options.volumeSourceOptions)});\n\n    let {chunkDataSizes = getChunkDataSizes(adjustedOptions)} = options;\n    return chunkDataSizes.map(\n        chunkDataSize => VolumeChunkSpecification.withDefaultCompression(\n            Object.assign({}, options, {chunkDataSize})));\n  }\n}\n\nexport interface VolumeChunkSource extends SliceViewChunkSource {\n  spec: VolumeChunkSpecification;\n}\n\nexport const VOLUME_RPC_ID = 'volume';\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum ChunkState {\n  // Chunk is stored in GPU memory in addition to system memory.\n  GPU_MEMORY = 0,\n  // Chunk is stored only in system memory but not in GPU memory.\n  SYSTEM_MEMORY = 1,\n\n  // Chunk is stored in system memory on worker.\n  SYSTEM_MEMORY_WORKER = 2,\n\n  // Chunk is downloading.\n  DOWNLOADING = 3,\n  // Chunk is not yet downloading.\n  QUEUED = 4,\n\n  // Chunk has just been added.\n  NEW = 5,\n\n  // Download failed.\n  FAILED = 6,\n\n  EXPIRED = 7,\n\n  // If new states are added, keep numChangeStates in sync.\n}\n\nexport const numChunkStates = 8;\n\nexport enum ChunkPriorityTier {\n  FIRST_TIER = 0,\n  FIRST_ORDERED_TIER = 0,\n  VISIBLE = 0,\n  PREFETCH = 1,\n  LAST_ORDERED_TIER = 1,\n  RECENT = 2,\n  LAST_TIER = 2\n}\n\nexport const numChunkPriorityTiers = 3;\n\nexport enum ChunkDownloadStatistics {\n  totalTime = 0,\n  totalChunks = 1,\n}\n\nexport enum ChunkMemoryStatistics {\n  numChunks = 0,\n  systemMemoryBytes = 1,\n  gpuMemoryBytes = 2,\n}\n\nexport const numChunkMemoryStatistics = 3;\n\nexport const numChunkDownloadStatistics = 2;\n\nexport const numChunkStatistics =\n    numChunkStates * numChunkPriorityTiers * numChunkMemoryStatistics + numChunkDownloadStatistics;\n\nexport function getChunkStateStatisticIndex(state: ChunkState, priorityTier: ChunkPriorityTier) {\n  return state * numChunkPriorityTiers + priorityTier;\n}\n\nexport function getChunkDownloadStatisticIndex(statistic: ChunkDownloadStatistics) {\n  return numChunkStates * numChunkPriorityTiers * numChunkMemoryStatistics + statistic;\n}\n\nexport const PREFETCH_PRIORITY_MULTIPLIER = 1e13;\n\nexport const CHUNK_QUEUE_MANAGER_RPC_ID = 'ChunkQueueManager';\nexport const CHUNK_MANAGER_RPC_ID = 'ChunkManager';\nexport const CHUNK_SOURCE_INVALIDATE_RPC_ID = 'ChunkSource.invalidate';\n\nexport const REQUEST_CHUNK_STATISTICS_RPC_ID = 'ChunkQueueManager.requestChunkStatistics';\n\nexport interface ChunkSourceParametersConstructor<T> {\n  new(): T;\n  RPC_ID: string;\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Basic annotation data structures.\n */\n\nimport {Borrowed, RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {parseArray, verify3dScale, verify3dVec, verifyEnumString, verifyObject, verifyObjectProperty, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\nimport {getRandomHexString} from 'neuroglancer/util/random';\nimport {Signal, NullarySignal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nexport type AnnotationId = string;\n\nexport class AnnotationReference extends RefCounted {\n  changed = new NullarySignal();\n\n  /**\n   * If `undefined`, we are still waiting to look up the result.  If `null`, annotation has been\n   * deleted.\n   */\n  value: Annotation|null|undefined;\n\n  constructor(public id: AnnotationId) {\n    super();\n  }\n}\n\nexport enum AnnotationType {\n  POINT,\n  LINE,\n  AXIS_ALIGNED_BOUNDING_BOX,\n  ELLIPSOID,\n}\n\nexport const annotationTypes = [\n  AnnotationType.POINT,\n  AnnotationType.LINE,\n  AnnotationType.AXIS_ALIGNED_BOUNDING_BOX,\n  AnnotationType.ELLIPSOID,\n];\n\nexport interface AnnotationBase {\n  /**\n   * If equal to `undefined`, then the description is unknown (possibly still being loaded).  If\n   * equal to `null`, then there is no description.\n   */\n  description?: string|undefined|null;\n\n  id: AnnotationId;\n  type: AnnotationType;\n\n  segments?: Uint64[];\n}\n\nexport interface Line extends AnnotationBase {\n  pointA: vec3;\n  pointB: vec3;\n  type: AnnotationType.LINE;\n}\n\nexport interface Point extends AnnotationBase {\n  point: vec3;\n  type: AnnotationType.POINT;\n}\n\nexport interface AxisAlignedBoundingBox extends AnnotationBase {\n  pointA: vec3;\n  pointB: vec3;\n  type: AnnotationType.AXIS_ALIGNED_BOUNDING_BOX;\n}\n\nexport interface Ellipsoid extends AnnotationBase {\n  center: vec3;\n  radii: vec3;\n  type: AnnotationType.ELLIPSOID;\n}\n\nexport type Annotation = Line|Point|AxisAlignedBoundingBox|Ellipsoid;\n\nexport interface AnnotationTypeHandler<T extends Annotation> {\n  icon: string;\n  description: string;\n  toJSON: (annotation: T) => any;\n  restoreState: (annotation: T, obj: any) => void;\n  serializedBytes: number;\n  serializer:\n      (buffer: ArrayBuffer, offset: number,\n       numAnnotations: number) => ((annotation: T, index: number) => void);\n}\n\nconst typeHandlers = new Map<AnnotationType, AnnotationTypeHandler<Annotation>>();\nexport function getAnnotationTypeHandler(type: AnnotationType) {\n  return typeHandlers.get(type)!;\n}\n\ntypeHandlers.set(AnnotationType.LINE, {\n  icon: '',\n  description: 'Line',\n  toJSON: (annotation: Line) => {\n    return {\n      pointA: Array.from(annotation.pointA),\n      pointB: Array.from(annotation.pointB),\n    };\n  },\n  restoreState: (annotation: Line, obj: any) => {\n    annotation.pointA = verifyObjectProperty(obj, 'pointA', verify3dVec);\n    annotation.pointB = verifyObjectProperty(obj, 'pointB', verify3dVec);\n  },\n  serializedBytes: 6 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 6);\n    return (annotation: Line, index: number) => {\n      const {pointA, pointB} = annotation;\n      const coordinateOffset = index * 6;\n      coordinates[coordinateOffset] = pointA[0];\n      coordinates[coordinateOffset + 1] = pointA[1];\n      coordinates[coordinateOffset + 2] = pointA[2];\n      coordinates[coordinateOffset + 3] = pointB[0];\n      coordinates[coordinateOffset + 4] = pointB[1];\n      coordinates[coordinateOffset + 5] = pointB[2];\n    };\n  },\n});\n\ntypeHandlers.set(AnnotationType.POINT, {\n  icon: '',\n  description: 'Point',\n  toJSON: (annotation: Point) => {\n    return {\n      point: Array.from(annotation.point),\n    };\n  },\n  restoreState: (annotation: Point, obj: any) => {\n    annotation.point = verifyObjectProperty(obj, 'point', verify3dVec);\n  },\n  serializedBytes: 3 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 3);\n    return (annotation: Point, index: number) => {\n      const {point} = annotation;\n      const coordinateOffset = index * 3;\n      coordinates[coordinateOffset] = point[0];\n      coordinates[coordinateOffset + 1] = point[1];\n      coordinates[coordinateOffset + 2] = point[2];\n    };\n  },\n});\n\ntypeHandlers.set(AnnotationType.AXIS_ALIGNED_BOUNDING_BOX, {\n  icon: '',\n  description: 'Bounding Box',\n  toJSON: (annotation: AxisAlignedBoundingBox) => {\n    return {\n      pointA: Array.from(annotation.pointA),\n      pointB: Array.from(annotation.pointB),\n    };\n  },\n  restoreState: (annotation: AxisAlignedBoundingBox, obj: any) => {\n    annotation.pointA = verifyObjectProperty(obj, 'pointA', verify3dVec);\n    annotation.pointB = verifyObjectProperty(obj, 'pointB', verify3dVec);\n  },\n  serializedBytes: 6 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 6);\n    return (annotation: AxisAlignedBoundingBox, index: number) => {\n      const {pointA, pointB} = annotation;\n      const coordinateOffset = index * 6;\n      coordinates[coordinateOffset] = Math.min(pointA[0], pointB[0]);\n      coordinates[coordinateOffset + 1] = Math.min(pointA[1], pointB[1]);\n      coordinates[coordinateOffset + 2] = Math.min(pointA[2], pointB[2]);\n      coordinates[coordinateOffset + 3] = Math.max(pointA[0], pointB[0]);\n      coordinates[coordinateOffset + 4] = Math.max(pointA[1], pointB[1]);\n      coordinates[coordinateOffset + 5] = Math.max(pointA[2], pointB[2]);\n    };\n  },\n});\n\ntypeHandlers.set(AnnotationType.ELLIPSOID, {\n  icon: '',\n  description: 'Ellipsoid',\n  toJSON: (annotation: Ellipsoid) => {\n    return {\n      center: Array.from(annotation.center),\n      radii: Array.from(annotation.radii),\n    };\n  },\n  restoreState: (annotation: Ellipsoid, obj: any) => {\n    annotation.center = verifyObjectProperty(obj, 'center', verify3dVec);\n    annotation.radii = verifyObjectProperty(obj, 'radii', verify3dScale);\n  },\n  serializedBytes: 6 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 6);\n    return (annotation: Ellipsoid, index: number) => {\n      const {center, radii} = annotation;\n      const coordinateOffset = index * 6;\n      coordinates.set(center, coordinateOffset);\n      coordinates.set(radii, coordinateOffset + 3);\n    };\n  },\n});\n\nexport function annotationToJson(annotation: Annotation) {\n  const result = getAnnotationTypeHandler(annotation.type).toJSON(annotation);\n  result.type = AnnotationType[annotation.type].toLowerCase();\n  result.id = annotation.id;\n  result.description = annotation.description || undefined;\n  const {segments} = annotation;\n  if (segments !== undefined && segments.length > 0) {\n    result.segments = segments.map(x => x.toString());\n  }\n  return result;\n}\n\nexport function restoreAnnotation(obj: any, allowMissingId = false): Annotation {\n  verifyObject(obj);\n  const type = verifyObjectProperty(obj, 'type', x => verifyEnumString(x, AnnotationType));\n  const id =\n      verifyObjectProperty(obj, 'id', allowMissingId ? verifyOptionalString : verifyString) ||\n      makeAnnotationId();\n  const result: Annotation = <any>{\n    id,\n    description: verifyObjectProperty(obj, 'description', verifyOptionalString),\n    segments: verifyObjectProperty(\n        obj, 'segments',\n        x => x === undefined ? undefined : parseArray(x, y => Uint64.parseString(y))),\n    type,\n  };\n  getAnnotationTypeHandler(type).restoreState(result, obj);\n  return result;\n}\n\nexport interface AnnotationSourceSignals {\n  changed:NullarySignal;\n  childAdded:Signal<(annotation: Annotation) => void>;\n  childUpdated:Signal<(annotation: Annotation) => void>;\n  childDeleted:Signal<(annotationId: string) => void>;\n}\n\nexport class AnnotationSource extends RefCounted implements AnnotationSourceSignals {\n  private annotationMap = new Map<AnnotationId, Annotation>();\n  changed = new NullarySignal();\n  readonly = false;\n  childAdded = new Signal<(annotation: Annotation) => void>();\n  childUpdated = new Signal<(annotation: Annotation) => void>();\n  childDeleted = new Signal<(annotationId: string) => void>();\n\n  private pending = new Set<AnnotationId>();\n\n  constructor(public objectToLocal = mat4.create()) {\n    super();\n  }\n\n  add(annotation: Annotation, commit: boolean = true): AnnotationReference {\n    if (!annotation.id) {\n      annotation.id = makeAnnotationId();\n    } else if (this.annotationMap.has(annotation.id)) {\n      throw new Error(`Annotation id already exists: ${JSON.stringify(annotation.id)}.`);\n    }\n    this.annotationMap.set(annotation.id, annotation);\n    this.changed.dispatch();\n    this.childAdded.dispatch(annotation);\n    if (!commit) {\n      this.pending.add(annotation.id);\n    }\n    return this.getReference(annotation.id);\n  }\n\n  commit(reference: AnnotationReference): void {\n    const id = reference.id;\n    this.pending.delete(id);\n  }\n\n  update(reference: AnnotationReference, annotation: Annotation) {\n    if (reference.value === null) {\n      throw new Error(`Annotation already deleted.`);\n    }\n    reference.value = annotation;\n    this.annotationMap.set(annotation.id, annotation);\n    reference.changed.dispatch();\n    this.changed.dispatch();\n    this.childUpdated.dispatch(annotation);\n  }\n\n  [Symbol.iterator]() {\n    return this.annotationMap.values();\n  }\n\n  get(id: AnnotationId) {\n    return this.annotationMap.get(id);\n  }\n\n  delete(reference: AnnotationReference) {\n    if (reference.value === null) {\n      return;\n    }\n    reference.value = null;\n    this.annotationMap.delete(reference.id);\n    this.pending.delete(reference.id);\n    reference.changed.dispatch();\n    this.changed.dispatch();\n    this.childDeleted.dispatch(reference.id);\n  }\n\n  getReference(id: AnnotationId): AnnotationReference {\n    let existing = this.references.get(id);\n    if (existing !== undefined) {\n      return existing.addRef();\n    }\n    existing = new AnnotationReference(id);\n    existing.value = this.annotationMap.get(id) || null;\n    this.references.set(id, existing);\n    existing.registerDisposer(() => {\n      this.references.delete(id);\n    });\n    return existing;\n  }\n\n  references = new Map<AnnotationId, Borrowed<AnnotationReference>>();\n\n  toJSON() {\n    const result: any[] = [];\n    const {pending} = this;\n    for (const annotation of this) {\n      if (pending.has(annotation.id)) {\n        // Don't serialize uncommitted annotations.\n        continue;\n      }\n      result.push(annotationToJson(annotation));\n    }\n    return result;\n  }\n\n  clear() {\n    this.annotationMap.clear();\n    this.pending.clear();\n    this.changed.dispatch();\n  }\n\n  restoreState(obj: any) {\n    const {annotationMap} = this;\n    annotationMap.clear();\n    this.pending.clear();\n    if (obj !== undefined) {\n      parseArray(obj, x => {\n        const annotation = restoreAnnotation(x);\n        annotationMap.set(annotation.id, annotation);\n      });\n    }\n    for (const reference of this.references.values()) {\n      const {id} = reference;\n      const value = annotationMap.get(id);\n      reference.value = value || null;\n      reference.changed.dispatch();\n    }\n    this.changed.dispatch();\n  }\n\n  reset() {\n    this.clear();\n  }\n}\n\nexport class LocalAnnotationSource extends AnnotationSource {}\n\nexport const DATA_BOUNDS_DESCRIPTION = 'Data Bounds';\n\nexport function makeAnnotationId() {\n  return getRandomHexString(160);\n}\n\nexport function makeDataBoundsBoundingBox(\n    lowerVoxelBound: vec3, upperVoxelBound: vec3): AxisAlignedBoundingBox {\n  return {\n    type: AnnotationType.AXIS_ALIGNED_BOUNDING_BOX,\n    id: 'data-bounds',\n    description: DATA_BOUNDS_DESCRIPTION,\n    pointA: lowerVoxelBound,\n    pointB: upperVoxelBound\n  };\n}\n\nfunction compare3WayById(a: Annotation, b: Annotation) {\n  return a.id < b.id ? -1 : a.id === b.id ? 0 : 1;\n}\n\nexport interface SerializedAnnotations {\n  data: Uint8Array;\n  typeToIds: string[][];\n  typeToOffset: number[];\n  segmentListIndex: Uint32Array;\n  segmentList: Uint32Array;\n}\n\nexport function serializeAnnotations(allAnnotations: Annotation[][]): SerializedAnnotations {\n  let totalBytes = 0;\n  const typeToOffset: number[] = [];\n  const typeToSegmentListIndexOffset: number[] = [];\n  let totalNumSegments = 0;\n  let totalNumAnnotations = 0;\n  for (const annotationType of annotationTypes) {\n    typeToOffset[annotationType] = totalBytes;\n    typeToSegmentListIndexOffset[annotationType] = totalNumAnnotations;\n    const annotations: Annotation[] = allAnnotations[annotationType];\n    let numSegments = 0;\n    for (const annotation of annotations) {\n      const {segments} = annotation;\n      if (segments !== undefined) {\n        numSegments += segments.length;\n      }\n    }\n    totalNumAnnotations += annotations.length;\n    totalNumSegments += numSegments;\n    annotations.sort(compare3WayById);\n    const count = annotations.length;\n    const handler = getAnnotationTypeHandler(annotationType);\n    totalBytes += handler.serializedBytes * count;\n  }\n  const segmentListIndex = new Uint32Array(totalNumAnnotations + 1);\n  const segmentList = new Uint32Array(totalNumSegments * 2);\n  const typeToIds: string[][] = [];\n  const data = new ArrayBuffer(totalBytes);\n  let segmentListOffset = 0;\n  let segmentListIndexOffset = 0;\n  for (const annotationType of annotationTypes) {\n    const annotations: Annotation[] = allAnnotations[annotationType];\n    typeToIds[annotationType] = annotations.map(x => x.id);\n    const count = annotations.length;\n    const handler = getAnnotationTypeHandler(annotationType);\n    const serializer = handler.serializer(data, typeToOffset[annotationType], count);\n    annotations.forEach((annotation, index) => {\n      serializer(annotation, index);\n      segmentListIndex[segmentListIndexOffset++] = segmentListOffset;\n      const {segments} = annotation;\n      if (segments !== undefined) {\n        for (const segment of segments) {\n          segmentList[segmentListOffset * 2] = segment.low;\n          segmentList[segmentListOffset * 2 + 1] = segment.high;\n          ++segmentListOffset;\n        }\n      }\n    });\n  }\n  return {data: new Uint8Array(data), typeToIds, typeToOffset, segmentListIndex, segmentList};\n}\n\nexport class AnnotationSerializer {\n  annotations: [Point[], Line[], AxisAlignedBoundingBox[], Ellipsoid[]] = [[], [], [], []];\n  add(annotation: Annotation) {\n    (<Annotation[]>this.annotations[annotation.type]).push(annotation);\n  }\n  serialize() {\n    return serializeAnnotations(this.annotations);\n  }\n}\n\nexport function deserializeAnnotation(obj: any) {\n  if (obj == null) {\n    return obj;\n  }\n  const segments = obj.segments;\n  if (segments !== undefined) {\n    obj.segments = segments.map((x: {low: number, high: number}) => new Uint64(x.low, x.high));\n  }\n  return obj;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {registerEventListener} from 'neuroglancer/util/disposable';\nimport {HierarchicalMap, HierarchicalMapInterface} from 'neuroglancer/util/hierarchical_map';\n\n/**\n * @file Facilities for dispatching user-defined actions in response to input events.\n */\n\n/**\n * Specifies a unique string representation of an input event, used for matching an input event to a\n * corresponding action with which it has been associated.\n *\n * The EventIdentifier combines several pieces of information using the following syntax:\n *\n *   NormalizedEventIdentifier ::= phase ':' ( modifier '+' )* base-event-identifier\n *\n *   - The event `phase` name, corresponding to the phase of DOM event processing at which the event was\n *     received, which may be 'at', 'bubble', or 'capture'.  (Currently, 'capture' is not supported.)\n *\n *   - The set of `modifier` keys ('control', 'alt', 'meta', and/or 'shift') active when the event occurred.\n *\n *   - The `base-event-identifier`, which in the case of keyboard events is the lowercase KeyboardEvent\n *     `code`, and in the case of mouse events is one of:\n *\n *       - 'mousedown' + n\n *       - 'mouseup' + n\n *       - 'click' + n\n *       - 'dblclick' + n\n *       - 'wheel'\n *\n *     where `n` is the index of the mouse button, starting from 0.\n *\n * In the normalized form used for matching events, the set of modifiers must be specified in\n * exactly the order: 'control', 'alt', 'meta', 'shift'.  Consequently, there is exactly one\n * NormalizedEventIdentifier representation for a given input event.\n */\nexport type NormalizedEventIdentifier = string;\n\n/**\n * An EventIdentifier specifies a criteria for matching input events using a relaxed form of the\n * NormalizedEventIdentifier syntax.  Each EventIdentifier corresponds to one or more\n * NormalizedEventIdentifier values.\n *\n *   EventIdentifier ::= [ phase ':' ] ( modifier '+' )* base-event-identifier\n *\n * In addition to the phase being optional, the modifiers may be specified in any order.  If the\n * phase is not specified, then the EventIdentifier matches both the 'at' and 'bubble' phases.\n */\nexport type EventIdentifier = string;\n\n/**\n * Identifies a user-defined action name.  Actions are dispatched as DOM events, using 'action:'\n * prepended to the ActionIdentifier as the event type.\n */\nexport type ActionIdentifier = string;\n\n/**\n * Specifies how to handle an event.\n */\nexport interface EventAction {\n  /**\n   * Identifier of action to dispatch.\n   */\n  action: ActionIdentifier;\n\n  /**\n   * Whether to call `stopPropagation()` on the triggering event.  Defaults to true.\n   */\n  stopPropagation?: boolean;\n\n  /**\n   * Whether to call `preventDefault()` on the triggering event.  Defaults to true.  Additionally,\n   * if `preventDefault()` is called on the dispatched ActionEvent, `preventDefault()` will also be\n   * called on the triggering event regardless of the value of `preventDefault`.\n   */\n  preventDefault?: boolean;\n}\n\nexport type EventActionMapInterface =\n    HierarchicalMapInterface<NormalizedEventIdentifier, EventAction>;\n\nexport const enum Modifiers {\n  CONTROL = 1,\n  ALT = 2,\n  META = 4,\n  SHIFT = 8,\n}\n\nexport type ModifierMask = number;\n\nexport interface EventModifierKeyState {\n  ctrlKey: boolean;\n  altKey: boolean;\n  metaKey: boolean;\n  shiftKey: boolean;\n}\n\nexport function getEventModifierMask(event: EventModifierKeyState): ModifierMask {\n  return (event.ctrlKey ? Modifiers.CONTROL : 0) | (event.altKey ? Modifiers.ALT : 0) |\n      (event.metaKey ? Modifiers.META : 0) | (event.shiftKey ? Modifiers.SHIFT : 0);\n}\n\nexport function getStrokeIdentifier(keyName: string, modifiers: ModifierMask) {\n  let identifier = '';\n  if (modifiers & Modifiers.CONTROL) {\n    identifier += 'control+';\n  }\n  if (modifiers & Modifiers.ALT) {\n    identifier += 'alt+';\n  }\n  if (modifiers & Modifiers.META) {\n    identifier += 'meta+';\n  }\n  if (modifiers & Modifiers.SHIFT) {\n    identifier += 'shift+';\n  }\n  identifier += keyName;\n  return identifier;\n}\n\nfunction normalizeModifiersAndBaseIdentifier(identifier: string): string|undefined {\n  let parts = identifier.split('+');\n  let keyName: string|undefined;\n  let modifiers = 0;\n  for (let part of parts) {\n    switch (part) {\n      case 'control':\n        modifiers |= Modifiers.CONTROL;\n        break;\n      case 'alt':\n        modifiers |= Modifiers.ALT;\n        break;\n      case 'meta':\n        modifiers |= Modifiers.META;\n        break;\n      case 'shift':\n        modifiers |= Modifiers.SHIFT;\n        break;\n      default:\n        if (keyName === undefined) {\n          keyName = part;\n        } else {\n          return undefined;\n        }\n    }\n  }\n  if (keyName === undefined) {\n    return undefined;\n  }\n  return getStrokeIdentifier(keyName, modifiers);\n}\n\n/**\n * Specifies either an EventAction or a bare ActionIdentifier.\n */\ntype ActionOrEventAction = EventAction|ActionIdentifier;\n\n/**\n * Normalizes an ActionOrEventAction into an EventAction.\n */\nexport function normalizeEventAction(action: ActionOrEventAction): EventAction {\n  if (typeof action === 'string') {\n    return {action: action};\n  }\n  return action;\n}\n\n/**\n * Normalizes a user-specified EventIdentifier into a list of one or more corresponding\n * NormalizedEventIdentifier strings.\n */\nexport function*\n    normalizeEventIdentifier(identifier: EventIdentifier):\n        IterableIterator<NormalizedEventIdentifier> {\n  const firstColonOffset = identifier.indexOf(':');\n  const suffix =\n      normalizeModifiersAndBaseIdentifier(identifier.substring(firstColonOffset + 1));\n  if (suffix === undefined) {\n    throw new Error(`Invalid event identifier: ${JSON.stringify(identifier)}`);\n  }\n  if (firstColonOffset !== -1) {\n    const prefix = identifier.substring(0, firstColonOffset);\n    // TODO(jbms): Support capture phase.\n    if (prefix !== 'at' && prefix !== 'bubble') {\n      throw new Error(`Invalid event phase: ${JSON.stringify(prefix)}`);\n    }\n    yield`${prefix}:${suffix}`;\n  } else {\n    yield`at:${suffix}`;\n    yield`bubble:${suffix}`;\n  }\n}\n\n/**\n * Hierarchical map of `EventIdentifier` specifications to `EventAction` specifications.  These maps\n * are used by KeyboardEventBinder and MouseEventBinder to dispatch an ActionEvent in response to an\n * input event.\n */\nexport class EventActionMap extends HierarchicalMap<NormalizedEventIdentifier, EventAction, EventActionMap>\n    implements EventActionMapInterface {\n  label: string|undefined;\n\n  /**\n   * Returns a new EventActionMap with the specified bindings.\n   *\n   * The keys of the `bindings` object specify unnormalized event identifiers to be mapped to their\n   * corresponding `ActionOrEventAction` values.\n   */\n  static fromObject(\n      bindings: {[key: string]: ActionOrEventAction},\n      options: {label?: string, parents?: Iterable<[EventActionMap, number]>} = {}) {\n    const map = new EventActionMap();\n    map.label = options.label;\n    if (options.parents !== undefined) {\n      for (const [parent, priority] of options.parents) {\n        map.addParent(parent, priority);\n      }\n    }\n    for (const key of Object.keys(bindings)) {\n      map.set(key, normalizeEventAction(bindings[key]));\n    }\n    return map;\n  }\n\n  setFromObject(bindings: {[key: string]: ActionOrEventAction}) {\n    for (const key of Object.keys(bindings)) {\n      this.set(key, normalizeEventAction(bindings[key]));\n    }\n  }\n\n  /**\n   * Maps the specified event `identifier` to the specified `action`.\n   *\n   * The `identifier` may be unnormalized; the actual mapping is created for each corresponding\n   * normalized identifier.\n   */\n  set(identifier: EventIdentifier, action: ActionOrEventAction) {\n    const normalizedAction = normalizeEventAction(action);\n    for (const normalizedIdentifier of normalizeEventIdentifier(identifier)) {\n      super.set(normalizedIdentifier, normalizedAction);\n    }\n  }\n\n  /**\n   * Deletes the mapping for the specified `identifier`.\n   *\n   * The `identifier` may be unnormalized; the mapping is deleted for each corresponding normalized\n   * identifier.\n   */\n  delete(identifier: EventIdentifier) {\n    for (const normalizedIdentifier of normalizeEventIdentifier(identifier)) {\n      super.delete(normalizedIdentifier);\n    }\n  }\n\n  describe(): string {\n    const bindings = [];\n    const uniqueBindings = new Map<string, string>();\n    for (const [key, value] of this.entries()) {\n      const split = key.indexOf(':');\n      uniqueBindings.set(key.substring(split+1), value.action);\n    }\n    for (const [key, value] of uniqueBindings) {\n      bindings.push(`${key}${value}`);\n    }\n    return bindings.join(', ');\n  }\n}\n\nexport function dispatchEventAction(\n      originalEvent: Event, detail: any, eventAction: EventAction|undefined) {\n  if (eventAction === undefined) {\n    return;\n  }\n  if (eventAction.stopPropagation !== false) {\n    originalEvent.stopPropagation();\n  }\n  const actionEvent = new CustomEvent(\n      'action:' + eventAction.action, {'bubbles': true, detail: detail, cancelable: true});\n  const cancelled = !originalEvent.target!.dispatchEvent(actionEvent);\n  if (eventAction.preventDefault !== false || cancelled) {\n    originalEvent.preventDefault();\n  }\n}\n\nexport const eventPhaseNames: string[] = [];\neventPhaseNames[Event.AT_TARGET] = 'at';\neventPhaseNames[Event.CAPTURING_PHASE] = 'capture';\neventPhaseNames[Event.BUBBLING_PHASE] = 'bubble';\n\nexport function dispatchEvent(\n  baseIdentifier: EventIdentifier, originalEvent: Event, eventPhase: number, detail: any,\n    eventMap: EventActionMapInterface) {\n  const eventIdentifier = eventPhaseNames[eventPhase] + ':' + baseIdentifier;\n  const eventAction = eventMap.get(eventIdentifier);\n  dispatchEventAction(originalEvent, detail, eventAction);\n}\n\nexport function dispatchEventWithModifiers(\n    baseIdentifier: EventIdentifier, originalEvent: Event&EventModifierKeyState, detail: any,\n    eventMap: EventActionMapInterface) {\n  dispatchEvent(\n      getStrokeIdentifier(baseIdentifier, getEventModifierMask(originalEvent)), originalEvent,\n      originalEvent.eventPhase, detail, eventMap);\n}\n\n/**\n * DOM Event type used for dispatching actions.\n *\n * Additional information relevant to the acction is specified as the `detail` property.\n */\nexport interface ActionEvent<Info> extends CustomEvent {\n  detail: Info;\n}\n\n/**\n * Register an event listener for the specified `action`.\n *\n * There is no checking that the `TriggerEvent` type is suitable for use with the specified\n * `action`.\n *\n * @returns A nullary disposer function that unregisters the listener when called.\n */\nexport function registerActionListener<Info>(\n    target: EventTarget, action: ActionIdentifier, listener: (event: ActionEvent<Info>) => void,\n    options?: boolean|AddEventListenerOptions) {\n  return registerEventListener(target, `action:${action}`, listener, options);\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Hierarchical mapping from keys to values.\n */\n\nexport interface HierarchicalMapInterface<Key, Value> {\n  get(key: Key): Value|undefined;\n  entries(): IterableIterator<[Key, Value]>;\n}\n\n/**\n * Maps string event identifiers to string action identifiers.\n *\n * When an event identifier is looked up in a given HierarchicalMap, it is resolved to a\n * corresponding action identifier in one of two ways:\n *\n * 1. via mappings defined directly on the HierarchicalMap.\n *\n * 2. via a recursive lookup on a \"parent\" HierarchicalMap that has been specified for the root\n *    HierarchicalMap on which the lookup was initiated.\n *\n * HierarchicalMap objects may be specified as \"parents\" of another HierarchicalMap along with a\n * specified numerical priority value, such that there is a directed graph of HierarchicalMap\n * objects.  Cycles in this graph may lead to infinite looping.\n *\n * Recursive lookups in parent HierarchicalMap objects are performed in order of decreasing\n * priority. The lookup stops as soon as a mapping is found.  Direct bindings have a priority of 0.\n * Therefore, parent maps with a priority higher than 0 take precedence over direct bindings.\n */\nexport class HierarchicalMap<Key, Value, Parent extends HierarchicalMapInterface<Key, Value> =\n                                                            HierarchicalMapInterface<Key, Value>>\n    implements HierarchicalMapInterface<Key, Value> {\n  parents = new Array<Parent>();\n  private parentPriorities = new Array<number>();\n  bindings = new Map<Key, Value>();\n\n  /**\n   * If an existing HierarchicalMap is specified, a shallow copy is made.\n   *\n   * @param existing Existing map to make a shallow copy of.\n   */\n  constructor(existing?: HierarchicalMap<Key, Value, Parent>) {\n    if (existing !== undefined) {\n      this.parents.push(...existing.parents);\n      this.parentPriorities.push(...existing.parentPriorities);\n      for (const [k, v] of existing.bindings) {\n        this.bindings.set(k, v);\n      }\n    }\n  }\n\n  /**\n   * Register `parent` as a parent map.  If `priority > 0`, this map will take precedence over\n   * direct bindings.\n   *\n   * @returns A nullary function that unregisters the parent (and may be called at most once).\n   */\n  addParent(parent: Parent, priority: number) {\n    const {parents, parentPriorities} = this;\n    let index = 0;\n    const {length} = parents;\n    while (index < length && priority < parentPriorities[index]) {\n      ++index;\n    }\n    parents.splice(index, 0, parent);\n    parentPriorities.splice(index, 0, priority);\n\n    return () => {\n      this.removeParent(parent);\n    };\n  }\n\n  /**\n   * Unregisters `parent` as a parent.\n   */\n  removeParent(parent: Parent) {\n    const index = this.parents.indexOf(parent);\n    if (index === -1) {\n      throw new Error(`Attempt to remove non-existent parent map.`);\n    }\n    this.parents.splice(index, 1);\n    this.parentPriorities.splice(index, 1);\n  }\n\n  /**\n   * Register a direct binding.\n   */\n  set(key: Key, value: Value) {\n    this.bindings.set(key, value);\n  }\n\n  /**\n   * Unregister a direct binding.\n   */\n  delete(key: Key) {\n    this.bindings.delete(key);\n  }\n\n  /**\n   * Deletes all bindings, including parents.\n   */\n  clear() {\n    this.bindings.clear();\n    this.parents.length = 0;\n    this.parentPriorities.length = 0;\n  }\n\n  /**\n   * Lookup the highest priority value to which the specified key is mapped.\n   */\n  get(key: Key): Value|undefined {\n    const {parents, parentPriorities} = this;\n    const numParents = parentPriorities.length;\n    let parentIndex = 0;\n    let value;\n    for (; parentIndex < numParents && parentPriorities[parentIndex] > 0; ++parentIndex) {\n      value = parents[parentIndex].get(key);\n      if (value !== undefined) {\n        return value;\n      }\n    }\n    value = this.bindings.get(key);\n    if (value !== undefined) {\n      return value;\n    }\n    for (; parentIndex < numParents; ++parentIndex) {\n      value = parents[parentIndex].get(key);\n      if (value !== undefined) {\n        return value;\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * Find all values to which the specified key is mapped.\n   */\n  * getAll(key: Key): IterableIterator<Value> {\n    const {parents, parentPriorities} = this;\n    const numParents = parentPriorities.length;\n    let parentIndex = 0;\n    let value;\n    while (parentIndex < numParents && parentPriorities[parentIndex] > 0) {\n      value = parents[parentIndex].get(key);\n      if (value !== undefined) {\n        yield value;\n      }\n    }\n    value = this.bindings.get(key);\n    if (value !== undefined) {\n      yield value;\n    }\n    while (parentIndex < numParents) {\n      value = parents[parentIndex].get(key);\n      if (value !== undefined) {\n        yield value;\n      }\n    }\n  }\n\n  * entries(): IterableIterator<[Key, Value]> {\n    const {parents, parentPriorities} = this;\n    const numParents = parentPriorities.length;\n    let parentIndex = 0;\n    while (parentIndex < numParents && parentPriorities[parentIndex] > 0) {\n      yield *parents[parentIndex].entries();\n    }\n    yield *this.bindings.entries();\n    while (parentIndex < numParents) {\n      yield *parents[parentIndex].entries();\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CANCELED, CancellationToken, CancellationTokenSource, makeCancelablePromise, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {RefCounted} from 'neuroglancer/util/disposable';\n\nexport type RPCHandler = (this: RPC, x: any) => void;\n\nexport type RpcId = number;\n\nconst IS_WORKER = !(typeof Window !== 'undefined' && self instanceof Window);\n\nconst DEBUG = false;\n\nconst DEBUG_MESSAGES = false;\n\nconst PROMISE_RESPONSE_ID = 'rpc.promise.response';\nconst PROMISE_CANCEL_ID = 'rpc.promise.cancel';\n\nvar handlers = new Map<string, RPCHandler>();\n\nexport function registerRPC(key: string, handler: RPCHandler) {\n  handlers.set(key, handler);\n}\n\nexport type RPCPromise<T> = Promise<{value: T, transfers?: any[]}>;\n\nexport class RPCError extends Error {\n  constructor(public name: string, public message: string) {\n    super(message);\n  }\n}\n\nexport function registerPromiseRPC<T>(\n    key: string,\n    handler: (this: RPC, x: any, cancellationToken: CancellationToken) => RPCPromise<T>) {\n  registerRPC(key, function(this: RPC, x: any) {\n    let id = <number>x['id'];\n    const cancellationToken = new CancellationTokenSource();\n    let promise = handler.call(this, x, cancellationToken) as RPCPromise<T>;\n    this.set(id, {promise, cancellationToken});\n    promise.then(\n        ({value, transfers}) => {\n          this.delete(id);\n          this.invoke(PROMISE_RESPONSE_ID, {'id': id, 'value': value}, transfers);\n        },\n        error => {\n          this.delete(id);\n          this.invoke(\n              PROMISE_RESPONSE_ID, {'id': id, 'error': error.message, 'errorName': error.name});\n        });\n  });\n}\n\nregisterRPC(PROMISE_CANCEL_ID, function(this: RPC, x: any) {\n  let id = <number>x['id'];\n  const request = this.get(id);\n  if (request !== undefined) {\n    let {cancellationToken} = request;\n    cancellationToken.cancel();\n  }\n});\n\nregisterRPC(PROMISE_RESPONSE_ID, function(this: RPC, x: any) {\n  let id = <number>x['id'];\n  let {resolve, reject} = this.get(id);\n  this.delete(id);\n  if (x.hasOwnProperty('value')) {\n    resolve(x['value']);\n  } else {\n    const errorName = x['errorName'];\n    if (errorName === CANCELED.name) {\n      reject(CANCELED);\n    } else {\n      reject(new RPCError(x['errorName'], x['error']));\n    }\n  }\n});\n\ninterface RPCTarget {\n  postMessage(message?: any, ports?: any): void;\n  onmessage: ((ev: MessageEvent) => any)|null;\n}\n\nconst INITIAL_RPC_ID = IS_WORKER ? -1 : 0;\n\nexport class RPC {\n  private objects = new Map<RpcId, any>();\n  private nextId: RpcId = INITIAL_RPC_ID;\n  constructor(public target: RPCTarget) {\n    target.onmessage = (e) => {\n      let data = e.data;\n      if (DEBUG_MESSAGES) {\n        console.log('Received message', data);\n      }\n      handlers.get(data.functionName)!.call(this, data);\n    };\n  }\n\n  get numObjects() {\n    return this.objects.size;\n  }\n\n  set(id: RpcId, value: any) {\n    this.objects.set(id, value);\n  }\n\n  delete(id: RpcId) {\n    this.objects.delete(id);\n  }\n  get(id: RpcId) {\n    return this.objects.get(id);\n  }\n  getRef<T extends SharedObject>(x: {'id': RpcId, 'gen': number}) {\n    let rpcId = x['id'];\n    let obj = <T>this.get(rpcId);\n    obj.referencedGeneration = x['gen'];\n    obj.addRef();\n    return obj;\n  }\n\n  invoke(name: string, x: any, transfers?: any[]) {\n    x.functionName = name;\n    if (DEBUG_MESSAGES) {\n      console.trace('Sending message', x);\n    }\n    this.target.postMessage(x, transfers);\n  }\n\n  promiseInvoke<T>(name: string, x: any, cancellationToken = uncancelableToken, transfers?: any[]):\n      Promise<T> {\n    return makeCancelablePromise<T>(cancellationToken, (resolve, reject, token) => {\n      const id = x['id'] = this.newId();\n      this.set(id, {resolve, reject});\n      this.invoke(name, x, transfers);\n      token.add(() => {\n        this.invoke(PROMISE_CANCEL_ID, {'id': id});\n      });\n    });\n  }\n  newId() {\n    return IS_WORKER ? this.nextId-- : this.nextId++;\n  }\n}\n\nexport class SharedObject extends RefCounted {\n  rpc: RPC|null = null;\n  rpcId: RpcId|null = null;\n  isOwner: boolean|undefined;\n  unreferencedGeneration: number;\n  referencedGeneration: number;\n\n  initializeSharedObject(rpc: RPC, rpcId = rpc.newId()) {\n    this.rpc = rpc;\n    this.rpcId = rpcId;\n    this.isOwner = false;\n    rpc.set(rpcId, this);\n  }\n\n  initializeCounterpart(rpc: RPC, options: any = {}) {\n    this.initializeSharedObject(rpc);\n    this.unreferencedGeneration = 0;\n    this.referencedGeneration = 0;\n    this.isOwner = true;\n    options['id'] = this.rpcId;\n    options['type'] = this.RPC_TYPE_ID;\n    rpc.invoke('SharedObject.new', options);\n  }\n\n  dispose() {\n    super.dispose();\n  }\n\n  /**\n   * Precondition: this.isOwner === true.\n   */\n  addCounterpartRef() {\n    return {'id': this.rpcId, 'gen': ++this.referencedGeneration};\n  }\n\n  protected refCountReachedZero() {\n    if (this.isOwner === true) {\n      if (this.referencedGeneration === this.unreferencedGeneration) {\n        this.ownerDispose();\n      }\n    } else if (this.isOwner === false) {\n      this.rpc!.invoke(\n          'SharedObject.refCountReachedZero', {'id': this.rpcId, 'gen': this.referencedGeneration});\n    } else {\n      super.refCountReachedZero();\n    }\n  }\n\n  /**\n   * Precondition: this.isOwner === true.\n   */\n  protected ownerDispose() {\n    if (DEBUG) {\n      console.log(`[${IS_WORKER}] #rpc object = ${this.rpc!.numObjects}`);\n    }\n    let {rpc, rpcId} = this;\n    super.refCountReachedZero();\n    rpc!.delete(rpcId!);\n    rpc!.invoke('SharedObject.dispose', {'id': rpcId});\n  }\n\n  /**\n   * Precondition: this.isOwner === true.\n   *\n   * This should be called when the counterpart's refCount is decremented and reaches zero.\n   */\n  counterpartRefCountReachedZero(generation: number) {\n    this.unreferencedGeneration = generation;\n    if (this.refCount === 0 && generation === this.referencedGeneration) {\n      this.ownerDispose();\n    }\n  }\n\n  /**\n   * Should be set to a constant specifying the SharedObject type identifier on the prototype of\n   * final derived owner classes.  It is not used on counterpart (non-owner) classes.\n   */\n  RPC_TYPE_ID: string;\n}\n\nexport function initializeSharedObjectCounterpart(obj: SharedObject, rpc?: RPC, options: any = {}) {\n  if (rpc != null) {\n    obj.initializeSharedObject(rpc, options['id']);\n  }\n}\n\n/**\n * Base class for defining a SharedObject type that will never be owned.\n */\nexport class SharedObjectCounterpart extends SharedObject {\n  constructor(rpc?: RPC, options: any = {}) {\n    super();\n    initializeSharedObjectCounterpart(this, rpc, options);\n  }\n}\n\n\nexport interface SharedObjectConstructor { new(rpc: RPC, options: any): SharedObjectCounterpart; }\n\nregisterRPC('SharedObject.dispose', function(x) {\n  let obj = <SharedObject>this.get(x['id']);\n  if (obj.refCount !== 0) {\n    throw new Error(`Attempted to dispose object with non-zero reference count.`);\n  }\n  if (DEBUG) {\n    console.log(`[${IS_WORKER}] #rpc objects: ${this.numObjects}`);\n  }\n  obj.disposed();\n  this.delete(obj.rpcId!);\n  obj.rpcId = null;\n  obj.rpc = null;\n});\n\nregisterRPC('SharedObject.refCountReachedZero', function(x) {\n  let obj = <SharedObject>this.get(x['id']);\n  let generation = <number>x['gen'];\n  obj.counterpartRefCountReachedZero(generation);\n});\n\nconst sharedObjectConstructors = new Map<string, SharedObjectConstructor>();\n\n/**\n * Register a class as a SharedObject owner type under the specified identifier.\n *\n * This is intended to be used as a decorator.\n */\nexport function registerSharedObjectOwner(identifier: string) {\n  return (constructorFunction: {prototype: {RPC_TYPE_ID: string}}) => {\n    constructorFunction.prototype.RPC_TYPE_ID = identifier;\n  };\n}\n\n/**\n * Register a class as a SharedObject counterpart type under the specified identifier.\n *\n * This is intended to be used as a decorator.\n *\n * Also register the type as a SharedObject owner, which is useful if this type is also used as a\n * SharedObject owner.\n */\nexport function registerSharedObject(identifier?: string) {\n  return (constructorFunction: SharedObjectConstructor) => {\n    if (identifier !== undefined) {\n      constructorFunction.prototype.RPC_TYPE_ID = identifier;\n    } else {\n      identifier = constructorFunction.prototype.RPC_TYPE_ID;\n      if (identifier === undefined) {\n        throw new Error('RPC_TYPE_ID should have already been defined');\n      }\n    }\n    sharedObjectConstructors.set(identifier, constructorFunction);\n  };\n}\n\nregisterRPC('SharedObject.new', function(x) {\n  let rpc = <RPC>this;\n  let typeName = <string>x['type'];\n  let constructorFunction = sharedObjectConstructors.get(typeName)!;\n  let obj = new constructorFunction(rpc, x);\n  // Counterpart objects start with a reference count of zero.\n  --obj.refCount;\n});\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {Borrowed, Disposer, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {NullaryReadonlySignal, NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\n\nexport interface WatchableValueInterface<T> {\n  value: T;\n  changed: NullaryReadonlySignal;\n}\n\nexport class WatchableValue<T> implements WatchableValueInterface<T> {\n  get value() {\n    return this.value_;\n  }\n  set value(newValue: T) {\n    if (newValue !== this.value_) {\n      this.value_ = newValue;\n      this.changed.dispatch();\n    }\n  }\n  changed = new NullarySignal();\n  constructor(protected value_: T) {}\n}\n\nexport class TrackableValue<T> extends WatchableValue<T> implements Trackable {\n  constructor(value: T, public validator: (value: any) => T, public defaultValue = value) {\n    super(value);\n  }\n  toJSON() {\n    let {value_} = this;\n    if (value_ === this.defaultValue) {\n      return undefined;\n    }\n    return this.value_;\n  }\n  reset() {\n    this.value = this.defaultValue;\n  }\n  restoreState(x: any) {\n    if (x !== undefined) {\n      let {validator} = this;\n      try {\n        this.value = validator(x);\n        return;\n      } catch (ignoredError) {\n      }\n    }\n    this.value = this.defaultValue;\n  }\n}\n\nclass DerivedWatchableValue<U> extends RefCounted implements WatchableValueInterface<U> {\n  changed = new NullarySignal();\n  get value() {\n    return this.f(...this.ws.map(w => w.value));\n  }\n  private f: (...v: any[]) => U;\n  private ws: WatchableValueInterface<any>[];\n\n  constructor(f: (...v: any[]) => U, ws: WatchableValueInterface<any>[]) {\n    super();\n    this.f = f;\n    this.ws = ws;\n    for (const w of ws) {\n      this.registerDisposer(w.changed.add(this.changed.dispatch));\n    }\n  }\n}\n\nexport function makeDerivedWatchableValue<U, T0>(\n    f: (v0: T0) => U, w0: WatchableValueInterface<T0>): DerivedWatchableValue<U>;\nexport function makeDerivedWatchableValue<U, T0, T1>(\n    f: (v0: T0, v1: T1) => U, w0: WatchableValueInterface<T0>,\n    w1: WatchableValueInterface<T1>): DerivedWatchableValue<U>;\nexport function makeDerivedWatchableValue<U, T0, T1, T2>(\n    f: (v0: T0, v1: T1, v2: T2) => U, w0: WatchableValueInterface<T0>,\n    w1: WatchableValueInterface<T1>, w2: WatchableValueInterface<T2>): DerivedWatchableValue<U>;\nexport function makeDerivedWatchableValue<U, T0, T1, T2, T3>(\n    f: (v0: T0, v1: T1, v2: T2, v3: T3) => U, w0: WatchableValueInterface<T0>,\n    w1: WatchableValueInterface<T1>, w2: WatchableValueInterface<T2>,\n    w3: WatchableValueInterface<T3>): DerivedWatchableValue<U>;\nexport function makeDerivedWatchableValue<U, T>(\n    f: (...values: T[]) => U, ...ws: WatchableValueInterface<T>[]): DerivedWatchableValue<U>;\nexport function makeDerivedWatchableValue<U>(\n    f: (...v: any[]) => U, ...ws: WatchableValueInterface<any>[]) {\n  return new DerivedWatchableValue(f, ws);\n}\n\nexport class ComputedWatchableValue<U> extends RefCounted implements WatchableValueInterface<U> {\n  get value() {\n    return this.f();\n  }\n  changed = new NullarySignal();\n  constructor(public f: () => U, ...signals: NullarySignal[]) {\n    super();\n    for (const signal of signals) {\n      this.registerDisposer(signal.add(this.changed.dispatch));\n    }\n  }\n}\n\nexport class WatchableRefCounted<T extends RefCounted> extends RefCounted implements\n    WatchableValueInterface<T|undefined> {\n  changed = new NullarySignal();\n\n  private value_: Owned<T>|undefined;\n  private valueHandler: (() => void)|undefined;\n\n  get value(): Borrowed<T>|undefined {\n    return this.value_;\n  }\n\n  set value(value: Owned<T>|undefined) {\n    const {value_} = this;\n    this.value_ = value;\n    if (value_ !== undefined) {\n      value_.dispose();\n      value_.unregisterDisposer(this.valueHandler!);\n      this.valueHandler = undefined;\n    }\n    if (value !== undefined) {\n      const valueHandler = this.valueHandler = () => {\n        if (this.value_ === value) {\n          this.value_ = undefined;\n          this.changed.dispatch();\n        }\n      };\n      value.registerDisposer(valueHandler);\n    }\n\n    if (value !== value_) {\n      this.changed.dispatch();\n    }\n  }\n\n  reset() {\n    this.value = undefined;\n  }\n\n  disposed() {\n    if (this.value_ !== undefined) {\n      this.value_.unregisterDisposer(this.valueHandler!);\n      this.value_.dispose();\n    }\n    this.value_ = undefined;\n    super.disposed();\n  }\n}\n\n\nexport interface TrackableValueInterface<T> extends WatchableValueInterface<T>, Trackable {}\n\nexport class TrackableRefCounted<T extends RefCounted> extends WatchableRefCounted<T> implements\n    TrackableValueInterface<T|undefined> {\n  constructor(\n      public validator: (value: any) => T | undefined, public jsonConverter: (value: T) => any) {\n    super();\n  }\n  toJSON() {\n    const {value} = this;\n    return value && this.jsonConverter(value);\n  }\n\n  restoreState(x: any) {\n    this.value = this.validator(x);\n  }\n}\n\nexport class WatchableSet<T> {\n  changed = new NullarySignal();\n  values: Set<T>;\n  constructor(values?: Iterable<T>) {\n    if (values === undefined) {\n      this.values = new Set();\n    } else {\n      this.values = new Set(values);\n    }\n  }\n  add(x: T) {\n    const {values} = this;\n    if (!values.has(x)) {\n      values.add(x);\n      this.changed.dispatch();\n    }\n    return this;\n  }\n  delete(x: T) {\n    const {values} = this;\n    if (values.delete(x)) {\n      this.changed.dispatch();\n      return true;\n    }\n    return false;\n  }\n  has(x: T) {\n    return this.values.has(x);\n  }\n  get size() {\n    return this.values.size;\n  }\n  [Symbol.iterator]() {\n    return this.values[Symbol.iterator]();\n  }\n  clear() {\n    const {values} = this;\n    if (values.size > 0) {\n      values.clear();\n      this.changed.dispatch();\n    }\n  }\n}\n\nexport function registerNested<T>(\n    baseState: WatchableValueInterface<T>, f: (context: RefCounted, value: T) => void): Disposer {\n  let value: T;\n  let context: RefCounted;\n\n  function updateValue() {\n    value = baseState.value;\n    context = new RefCounted();\n    f(context, value);\n  }\n\n  const handleChange = debounce(() => {\n    if (baseState.value !== value) {\n      context.dispose();\n      updateValue();\n    }\n  }, 0);\n\n  const signalDisposer = baseState.changed.add(handleChange);\n\n  updateValue();\n\n  return () => {\n    handleChange.cancel();\n    signalDisposer();\n    context.dispose();\n  };\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function removeChildren(element: HTMLElement) {\n  while (true) {\n    let child = element.firstElementChild;\n    if (!child) {\n      break;\n    }\n    element.removeChild(child);\n  }\n}\n\nexport function removeFromParent(element: HTMLElement) {\n  let {parentElement} = element;\n  if (parentElement) {\n    parentElement.removeChild(element);\n    return true;\n  }\n  return false;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CHUNK_MANAGER_RPC_ID, CHUNK_QUEUE_MANAGER_RPC_ID, CHUNK_SOURCE_INVALIDATE_RPC_ID, ChunkSourceParametersConstructor, ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {SharedWatchableValue} from 'neuroglancer/shared_watchable_value';\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {CANCELED, CancellationToken} from 'neuroglancer/util/cancellation';\nimport {Borrowed} from 'neuroglancer/util/disposable';\nimport {stableStringify} from 'neuroglancer/util/json';\nimport {StringMemoize} from 'neuroglancer/util/memoize';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {registerPromiseRPC, registerRPC, registerSharedObjectOwner, RPC, RPCPromise, SharedObject} from 'neuroglancer/worker_rpc';\n\nconst DEBUG_CHUNK_UPDATES = false;\n\nexport class Chunk {\n  state = ChunkState.SYSTEM_MEMORY;\n  constructor(public source: ChunkSource) {}\n\n  get gl() {\n    return this.source.gl;\n  }\n\n  copyToGPU(_gl: GL) {\n    this.state = ChunkState.GPU_MEMORY;\n  }\n\n  freeGPUMemory(_gl: GL) {\n    this.state = ChunkState.SYSTEM_MEMORY;\n  }\n}\n\nfunction validateLimitValue(x: any) {\n  if (typeof x !== 'number' || x < 0) {\n    throw new Error(`Expected non-negative number as limit, but received: ${JSON.stringify(x)}`);\n  }\n  return x;\n}\n\nexport class CapacitySpecification {\n  sizeLimit: TrackableValue<number>;\n  itemLimit: TrackableValue<number>;\n  constructor({\n    defaultItemLimit = Number.POSITIVE_INFINITY,\n    defaultSizeLimit = Number.POSITIVE_INFINITY\n  } = {}) {\n    this.sizeLimit = new TrackableValue<number>(defaultSizeLimit, validateLimitValue);\n    this.itemLimit = new TrackableValue<number>(defaultItemLimit, validateLimitValue);\n  }\n}\n\nexport interface FrameNumberCounter {\n  frameNumber: number;\n  changed: NullarySignal;\n}\n\n@registerSharedObjectOwner(CHUNK_QUEUE_MANAGER_RPC_ID)\nexport class ChunkQueueManager extends SharedObject {\n  visibleChunksChanged = new NullarySignal();\n  pendingChunkUpdates: any = null;\n  pendingChunkUpdatesTail: any = null;\n\n  /**\n   * If non-null, deadline in milliseconds since epoch after which chunk copies to the GPU may not\n   * start (until the next frame).\n   */\n  chunkUpdateDeadline: number|null = null;\n\n  chunkUpdateDelay: number = 30;\n\n  constructor(\n      rpc: RPC, public gl: GL, public frameNumberCounter: FrameNumberCounter, public capacities: {\n        gpuMemory: CapacitySpecification,\n        systemMemory: CapacitySpecification,\n        download: CapacitySpecification,\n        compute: CapacitySpecification\n      }) {\n    super();\n\n    const makeCapacityCounterparts = (capacity: CapacitySpecification) => {\n      return {\n        itemLimit:\n            this.registerDisposer(SharedWatchableValue.makeFromExisting(rpc, capacity.itemLimit))\n                .rpcId,\n        sizeLimit:\n            this.registerDisposer(SharedWatchableValue.makeFromExisting(rpc, capacity.sizeLimit))\n                .rpcId,\n      };\n    };\n\n    this.initializeCounterpart(rpc, {\n      'gpuMemoryCapacity': makeCapacityCounterparts(capacities.gpuMemory),\n      'systemMemoryCapacity': makeCapacityCounterparts(capacities.systemMemory),\n      'downloadCapacity': makeCapacityCounterparts(capacities.download),\n      'computeCapacity': makeCapacityCounterparts(capacities.compute)\n    });\n  }\n\n  scheduleChunkUpdate() {\n    let deadline = this.chunkUpdateDeadline;\n    let delay: number;\n    if (deadline === null || Date.now() < deadline) {\n      delay = 0;\n    } else {\n      delay = this.chunkUpdateDelay;\n    }\n    setTimeout(this.processPendingChunkUpdates.bind(this), delay);\n  }\n  processPendingChunkUpdates() {\n    let deadline = this.chunkUpdateDeadline;\n    if (deadline === null) {\n      deadline = Date.now() + 30;\n    }\n    let visibleChunksChanged = false;\n    while (true) {\n      if (Date.now() > deadline) {\n        // No time to perform chunk update now, we will wait some more.\n        setTimeout(this.processPendingChunkUpdates.bind(this), this.chunkUpdateDelay);\n        break;\n      }\n      let update = this.pendingChunkUpdates;\n      if (this.applyChunkUpdate(update)) {\n        visibleChunksChanged = true;\n      }\n      // FIXME: do chunk update\n      let nextUpdate = this.pendingChunkUpdates = update.nextUpdate;\n      --(<any>window).numPendingChunkUpdates;\n      if (nextUpdate == null) {\n        this.pendingChunkUpdatesTail = null;\n        break;\n      }\n    }\n    if (visibleChunksChanged) {\n      this.visibleChunksChanged.dispatch();\n    }\n  }\n\n  private handleFetch_(source: ChunkSource, update: any) {\n    const {resolve, reject, cancellationToken} = update['promise'];\n    if ((<CancellationToken>cancellationToken).isCanceled) {\n      reject(CANCELED);\n      return;\n    }\n\n    const key = update['key'];\n    const chunk = source.chunks.get(key);\n    if (!chunk) {\n      reject(new Error(`No chunk found at ${key} for source ${source.constructor.name}`));\n      return;\n    }\n\n    const data = (<any>chunk)['data'];\n    if (!data) {\n      reject(new Error(`At ${key} for source ${source.constructor.name}: chunk has no data`));\n      return;\n    }\n\n    resolve({value: data});\n  }\n\n  applyChunkUpdate(update: any) {\n    let visibleChunksChanged = false;\n    let {rpc} = this;\n    const source = <ChunkSource>rpc!.get(update['source']);\n    if (DEBUG_CHUNK_UPDATES) {\n      console.log(\n          `${Date.now()} Chunk.update processed: ${source.rpcId} ` +\n          `${update['id']} ${update['state']}`);\n    }\n    if (update['promise'] !== undefined) {\n      this.handleFetch_(source, update);\n    } else if (update['id'] === undefined) {\n      // Invalidate source.\n      for (const chunkKey of source.chunks.keys()) {\n        source.deleteChunk(chunkKey);\n      }\n      visibleChunksChanged = true;\n    } else {\n      let newState: number = update['state'];\n      if (newState === ChunkState.EXPIRED) {\n        // FIXME: maybe use freeList for chunks here\n        source.deleteChunk(update['id']);\n      } else {\n        let chunk: Chunk;\n        let key = update['id'];\n        if (update['new']) {\n          chunk = source.getChunk(update);\n          source.addChunk(key, chunk);\n        } else {\n          chunk = source.chunks.get(key)!;\n        }\n        let oldState = chunk.state;\n        if (newState !== oldState) {\n          switch (newState) {\n            case ChunkState.GPU_MEMORY:\n              // console.log(\"Copying to GPU\", chunk);\n              chunk.copyToGPU(this.gl);\n              visibleChunksChanged = true;\n              break;\n            case ChunkState.SYSTEM_MEMORY:\n              chunk.freeGPUMemory(this.gl);\n              break;\n            default:\n              throw new Error(`INTERNAL ERROR: Invalid chunk state: ${ChunkState[newState]}`);\n          }\n        }\n      }\n    }\n    return visibleChunksChanged;\n  }\n}\n\n(<any>window).numPendingChunkUpdates = 0;\n\nfunction updateChunk(rpc: RPC, x: any) {\n  let source: ChunkSource = rpc.get(x['source']);\n  if (DEBUG_CHUNK_UPDATES) {\n    console.log(\n        `${Date.now()} Chunk.update received: ` +\n        `${source.rpcId} ${x['id']} ${x['state']} with chunkDataSize ${x['chunkDataSize']}`);\n  }\n  let queueManager = source.chunkManager.chunkQueueManager;\n  if (source.immediateChunkUpdates) {\n    if (queueManager.applyChunkUpdate(x)) {\n      queueManager.visibleChunksChanged.dispatch();\n    }\n    return;\n  }\n\n  let pendingTail = queueManager.pendingChunkUpdatesTail;\n  if (++(<any>window).numPendingChunkUpdates > 3) {\n    // console.log(`numPendingChunkUpdates=${(<any>window).numPendingChunkUpdates}`);\n  }\n  if (pendingTail == null) {\n    queueManager.pendingChunkUpdates = x;\n    queueManager.pendingChunkUpdatesTail = x;\n    queueManager.scheduleChunkUpdate();\n  } else {\n    pendingTail.nextUpdate = x;\n    queueManager.pendingChunkUpdatesTail = x;\n  }\n}\n\nregisterRPC('Chunk.update', function(x) {\n  updateChunk(this, x);\n});\n\nregisterPromiseRPC('Chunk.retrieve', function(x, cancellationToken): RPCPromise<any> {\n  return new Promise<{value: any}>((resolve, reject) => {\n    x['promise'] = {resolve, reject, cancellationToken};\n    updateChunk(this, x);\n  });\n});\n\nexport interface ChunkSourceConstructor<Options, T extends SharedObject = ChunkSource> {\n  new(...args: any[]): T;\n  encodeOptions(options: Options): {[key: string]: any};\n}\n\n@registerSharedObjectOwner(CHUNK_MANAGER_RPC_ID)\nexport class ChunkManager extends SharedObject {\n  memoize = new StringMemoize();\n\n  get gl() {\n    return this.chunkQueueManager.gl;\n  }\n\n  constructor(public chunkQueueManager: ChunkQueueManager) {\n    super();\n    this.registerDisposer(chunkQueueManager.addRef());\n    this.initializeCounterpart(\n        chunkQueueManager.rpc!, {'chunkQueueManager': chunkQueueManager.rpcId});\n  }\n\n  getChunkSource<T extends SharedObject&{key: any}, Options>(\n      constructorFunction: ChunkSourceConstructor<Options, T>, options: any): T {\n    const keyObject = constructorFunction.encodeOptions(options);\n    keyObject['constructorId'] = getObjectId(constructorFunction);\n    const key = stableStringify(keyObject);\n    return this.memoize.get(key, () => {\n      const newSource = new constructorFunction(this, options);\n      newSource.initializeCounterpart(this.rpc!, {});\n      newSource.key = keyObject;\n      return newSource;\n    }) as T;\n  }\n}\n\nexport class ChunkSource extends SharedObject {\n  chunks = new Map<string, Chunk>();\n  key: any;\n\n  /**\n   * If set to true, chunk updates will be applied to this source immediately, rather than queueing\n   * them.  Sources that dynamically update chunks and need to ensure a consistent order of\n   * processing relative to other messages between the frontend and worker should set this to true.\n   */\n  immediateChunkUpdates = false;\n\n  constructor(public chunkManager: Borrowed<ChunkManager>, _options: {} = {}) {\n    super();\n  }\n\n  initializeCounterpart(rpc: RPC, options: any) {\n    options['chunkManager'] = this.chunkManager.rpcId;\n    super.initializeCounterpart(rpc, options);\n  }\n\n  get gl() {\n    return this.chunkManager.chunkQueueManager.gl;\n  }\n\n  deleteChunk(key: string) {\n    const chunk = this.chunks.get(key)!;\n    if (chunk.state === ChunkState.GPU_MEMORY) {\n      chunk.freeGPUMemory(this.gl);\n    }\n    this.chunks.delete(key);\n  }\n\n  addChunk(key: string, chunk: Chunk) {\n    this.chunks.set(key, chunk);\n  }\n\n  /**\n   * Default implementation for use with backendOnly chunk sources.\n   */\n  getChunk(_x: any): Chunk {\n    throw new Error('Not implemented.');\n  }\n\n  /**\n   * Invalidates the chunk cache.  Operates asynchronously.\n   */\n  invalidateCache(): void {\n    this.rpc!.invoke(CHUNK_SOURCE_INVALIDATE_RPC_ID, {'id': this.rpcId});\n  }\n\n  static encodeOptions(_options: {}): {[key: string]: any} {\n    return {};\n  }\n}\n\nexport function WithParameters<Parameters, BaseOptions,\n                               TBase extends ChunkSourceConstructor<BaseOptions, SharedObject>>(\n    Base: TBase, parametersConstructor: ChunkSourceParametersConstructor<Parameters>) {\n  type Options = BaseOptions&{parameters: Parameters};\n  @registerSharedObjectOwner(parametersConstructor.RPC_ID)\n  class C extends Base {\n    parameters: Parameters;\n    constructor(...args: any[]) {\n      super(...args);\n      const options: Options = args[1];\n      this.parameters = options.parameters;\n    }\n    initializeCounterpart(rpc: RPC, options: any) {\n      options['parameters'] = this.parameters;\n      super.initializeCounterpart(rpc, options);\n    }\n    static encodeOptions(options: Options) {\n      return Object.assign({parameters: options.parameters}, super.encodeOptions(options));\n    }\n  }\n  return C;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * If this is updated, DATA_TYPE_BYTES must also be updated.\n */\nexport enum DataType {\n  UINT8 = 0,\n  UINT16 = 1,\n  UINT32 = 2,\n  UINT64 = 3,\n  FLOAT32 = 4,\n}\n\ninterface DataTypeBytes {\n  [index: number]: number;\n}\n\nexport const DATA_TYPE_BYTES: DataTypeBytes = [];\nDATA_TYPE_BYTES[DataType.UINT8] = 1;\nDATA_TYPE_BYTES[DataType.UINT16] = 2;\nDATA_TYPE_BYTES[DataType.UINT32] = 4;\nDATA_TYPE_BYTES[DataType.UINT64] = 8;\nDATA_TYPE_BYTES[DataType.FLOAT32] = 4;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Cancellation token system with similarity to the cancellation_token in Microsoft's PPL.\n */\n\n/**\n * Interface used by cancelable operations to monitor whether cancellation has occurred.\n *\n * Note that this interface does not provide any way to trigger cancellation; for that,\n * CancellationTokenSource is used.\n */\nexport interface CancellationToken {\n  /**\n   * Indicates whether cancellation has occurred.\n   */\n  readonly isCanceled: boolean;\n\n  /**\n   * Add a cancellation handler function.  The handler will be invoked synchronously if\n   * this.isCanceled === true.  Otherwise, it will be invoked synchronously upon cancellation,\n   * unless it is removed prior to cancellation.\n   *\n   * The handler function must not throw any exceptions when called.\n   *\n   * @precondition The handler function must not already be registered.\n   *\n   * @param handler The handler function to add.\n   *\n   * @return A function that unregisters the handler.\n   */\n  add(handler: () => void): () => void;\n\n  /**\n   * Unregister a cancellation handler function.  If this.isCanceled, or the specified handler\n   * function has not been registered, then this function has no effect.\n   */\n  remove(handler: () => void): void;\n}\n\nclass CancellationError {\n  name = 'CancellationError';\n  message = 'CANCELED';\n  toString() {\n    return 'CANCELED';\n  }\n}\n\n/**\n * Singleton instance of CancellationError thrown to indicate cancellation.\n */\nexport const CANCELED = new CancellationError();\n\n/**\n * Throws CANCELED if token.isCanceled === true.\n */\nexport function throwIfCanceled(token: CancellationToken) {\n  if (token.isCanceled === true) {\n    throw CANCELED;\n  }\n}\n\nconst noopFunction = () => {};\n\n/**\n * CancellationToken that cannot be canceled.  This can be passed to operations that require a\n * CancellationToken but will not need to be canceled.\n */\nexport const uncancelableToken: CancellationToken = {\n  isCanceled: false,\n  add: () => noopFunction,\n  remove: noopFunction\n};\n\n/**\n * Class that can be used to trigger cancellation.\n */\nexport class CancellationTokenSource implements CancellationToken {\n  /**\n   * Trigger cancellation.\n   *\n   * If this.isCanceled === false, then each registered cancellation handler is invoked\n   * synchronously.\n   */\n  cancel() {\n    const {handlers} = this;\n    if (handlers !== null) {\n      this.handlers = null;\n      if (handlers !== undefined) {\n        for (let handler of handlers) {\n          handler();\n        }\n      }\n    }\n  }\n\n  get isCanceled() {\n    return this.handlers === null;\n  }\n\n  private handlers: Set<() => void>|undefined|null;\n\n  add(handler: () => void) {\n    let {handlers} = this;\n    if (handlers === null) {\n      handler();\n      return noopFunction;\n    }\n    if (handlers === undefined) {\n      handlers = this.handlers = new Set<() => void>();\n    }\n    handlers.add(handler);\n    return () => {\n      this.remove(handler);\n    };\n  }\n\n  remove(handler: () => void) {\n    const {handlers} = this;\n    if (handlers != null) {\n      handlers.delete(handler);\n    }\n  }\n}\n\n/**\n * Creates a CancellationToken corresponding to an asynchronous process with multiple consumers.  It\n * is cancelled only when the cancellation tokens corresponding to all of the consumers have been\n * cancelled.\n */\nexport class MultipleConsumerCancellationTokenSource extends CancellationTokenSource {\n  private consumers = new Set<CancellationToken>();\n\n  addConsumer(cancellationToken: CancellationToken = uncancelableToken) {\n    const {consumers} = this;\n    if (consumers.has(cancellationToken) || cancellationToken.isCanceled) {\n      return;\n    }\n    consumers.add(cancellationToken);\n    cancellationToken.add(() => {\n      consumers.delete(cancellationToken);\n      if (consumers.size === 0) {\n        this.cancel();\n      }\n    });\n  }\n}\n\n\n/**\n * Creates a promise and a dependent cancellation token.\n *\n * The dependent cancellation token will be canceled if the specified `cancellationToken` is\n * canceled while the promise is pending.\n *\n * @param cancellationToken The token that provides notification of cancellation.\n * @param executor The executor passed the resolve and reject functions for the promise, as well as\n * the dependent cancellation token.  If cancellation occurs after either resolve or reject is\n * called, then the dependent token is not cancelled.\n *\n * @returns A new Promise.\n */\nexport function makeCancelablePromise<T>(\n    cancellationToken: CancellationToken,\n    executor: (\n        resolve: (value: T|Promise<T>) => void, reject: (error: any) => void,\n        token: CancellationToken) => void) {\n  return new Promise<T>((resolve, reject) => {\n    if (cancellationToken === uncancelableToken) {\n      executor(resolve, reject, uncancelableToken);\n      return;\n    }\n    const scopedToken = new CancellationTokenSource();\n    const unregister = cancellationToken.add(() => {\n      scopedToken.cancel();\n    });\n    executor(\n        value => {\n          unregister();\n          resolve(value);\n        },\n        error => {\n          unregister();\n          reject(error);\n        },\n        scopedToken);\n  });\n}\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return '@media ' + item[2] + '{' + content + '}';\n      } else {\n        return content;\n      }\n    }).join('');\n  }; // import a list of modules into the list\n\n\n  list.i = function (modules, mediaQuery) {\n    if (typeof modules === 'string') {\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    for (var i = 0; i < this.length; i++) {\n      var id = this[i][0];\n\n      if (id != null) {\n        alreadyImportedModules[id] = true;\n      }\n    }\n\n    for (i = 0; i < modules.length; i++) {\n      var item = modules[i]; // skip already imported module\n      // this implementation is not 100% perfect for weird media query combinations\n      // when a module is imported multiple times with different media queries.\n      // I hope this will never occur (Hey this way we have smaller bundles)\n\n      if (item[0] == null || !alreadyImportedModules[item[0]]) {\n        if (mediaQuery && !item[2]) {\n          item[2] = mediaQuery;\n        } else if (mediaQuery) {\n          item[2] = '(' + item[2] + ') and (' + mediaQuery + ')';\n        }\n\n        list.push(item);\n      }\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || '';\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */';\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n  return '/*# ' + data + ' */';\n}","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target, parent) {\n  if (parent){\n    return parent.querySelector(target);\n  }\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target, parent) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target, parent);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertAt.before, target);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\tif(options.attrs.nonce === undefined) {\n\t\tvar nonce = getNonce();\n\t\tif (nonce) {\n\t\t\toptions.attrs.nonce = nonce;\n\t\t}\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction getNonce() {\n\tif (typeof __webpack_nonce__ === 'undefined') {\n\t\treturn null;\n\t}\n\n\treturn __webpack_nonce__;\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = typeof options.transform === 'function'\n\t\t ? options.transform(obj.css) \n\t\t : options.transform.default(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst randomTempBuffer = new Uint32Array(2);\n\nconst trueBase = 0x100000000;\n\n// For dealing with the string representation in base b, we will represent the 64-bit number as\n//\n//   highPrime * intermediateBase[b] + lowPrime,\n//\n// where:\n//\n//   intermediateBaseForBase[b] = Math.pow(b, lowDigitsforBase[b]),\n//\n// and\n//\n//   lowDigitsForBase[b] = Math.floor(Math.log(Math.pow(2,53 - 32)) / Math.log(b)).\n\ninterface StringConversionData {\n  lowDigits: number;\n\n  lowBase: number;\n\n  pattern: RegExp;\n}\n\nlet stringConversionData: StringConversionData[] = [];\nfor (let base = 2; base <= 36; ++base) {\n  let lowDigits = Math.floor(32 / Math.log2(base));\n  let lowBase = Math.pow(base, lowDigits);\n  let patternString = `^[0-${String.fromCharCode('0'.charCodeAt(0) + Math.min(9, base - 1))}`;\n  if (base > 10) {\n    patternString += `a-${String.fromCharCode('a'.charCodeAt(0) + base - 11)}`;\n    patternString += `A-${String.fromCharCode('A'.charCodeAt(0) + base - 11)}`;\n  }\n  let maxDigits = Math.ceil(64 / Math.log2(base));\n  patternString += `]{1,${maxDigits}}$`;\n  let pattern = new RegExp(patternString);\n  stringConversionData[base] = {lowDigits, lowBase, pattern};\n}\n\n/**\n * Returns the high 32 bits of the result of the 32-bit integer multiply `a` and `b`.\n *\n * The low 32-bits can be obtained using the built-in `Math.imul` function.\n */\nfunction uint32MultiplyHigh(a: number, b: number) {\n  a >>>= 0;\n  b >>>= 0;\n\n  const a00 = a & 0xFFFF, a16 = a >>> 16;\n  const b00 = b & 0xFFFF, b16 = b >>> 16;\n\n  let c00 = a00 * b00;\n  let c16 = (c00 >>> 16) + (a16 * b00);\n  let c32 = c16 >>> 16;\n  c16 = (c16 & 0xFFFF) + (a00 * b16);\n  c32 += c16 >>> 16;\n  let c48 = c32 >>> 16;\n  c32 = (c32 & 0xFFFF) + (a16 * b16);\n  c48 += c32 >>> 16;\n\n  return (((c48 & 0xFFFF) << 16) | (c32 & 0xFFFF)) >>> 0;\n}\n\nexport class Uint64 {\n  constructor(public low: number = 0, public high: number = 0) {}\n\n  clone() {\n    return new Uint64(this.low, this.high);\n  }\n\n  assign(x: Uint64) {\n    this.low = x.low;\n    this.high = x.high;\n  }\n\n  toString(base = 10): string {\n    let vLow = this.low, vHigh = this.high;\n    if (vHigh === 0) {\n      return vLow.toString(base);\n    }\n    vHigh *= trueBase;\n    let {lowBase, lowDigits} = stringConversionData[base];\n    let vHighExtra = vHigh % lowBase;\n    vHigh = Math.floor(vHigh / lowBase);\n    vLow += vHighExtra;\n    vHigh += Math.floor(vLow / lowBase);\n    vLow = vLow % lowBase;\n    let vLowStr = vLow.toString(base);\n    return vHigh.toString(base) + '0'.repeat(lowDigits - vLowStr.length) + vLowStr;\n  }\n\n  /**\n   * Returns true if a is strictly less than b.\n   */\n  static less(a: Uint64, b: Uint64): boolean {\n    return a.high < b.high || (a.high === b.high && a.low < b.low);\n  }\n\n  /**\n   * Returns a negative number if a is strictly less than b, 0 if a is equal to b, or a positive\n   * number if a is strictly greater than b.\n   */\n  static compare(a: Uint64, b: Uint64): number {\n    return (a.high - b.high) || (a.low - b.low);\n  }\n\n  static ZERO = new Uint64(0, 0);\n  static ONE = new Uint64(1, 0);\n\n  static equal(a: Uint64, b: Uint64) {\n    return a.low === b.low && a.high === b.high;\n  }\n\n  static min(a: Uint64, b: Uint64): Uint64 {\n    return Uint64.less(a, b) ? a : b;\n  }\n\n  static max(a: Uint64, b: Uint64): Uint64 {\n    return Uint64.less(a, b) ? b : a;\n  }\n\n  static random() {\n    crypto.getRandomValues(randomTempBuffer);\n    return new Uint64(randomTempBuffer[0], randomTempBuffer[1]);\n  }\n\n  tryParseString(s: string, base = 10) {\n    const {lowDigits, lowBase, pattern} = stringConversionData[base];\n    if (!pattern.test(s)) {\n      return false;\n    }\n    if (s.length <= lowDigits) {\n      this.low = parseInt(s, base);\n      this.high = 0;\n      return true;\n    }\n    const splitPoint = s.length - lowDigits;\n    const lowPrime = parseInt(s.substr(splitPoint), base);\n    const highPrime = parseInt(s.substr(0, splitPoint), base);\n\n    let high: number, low: number;\n\n    if (lowBase === trueBase) {\n      high = highPrime;\n      low = lowPrime;\n    } else {\n      const highRemainder = Math.imul(highPrime, lowBase) >>> 0;\n      high = uint32MultiplyHigh(highPrime, lowBase) +\n          (Math.imul(Math.floor(highPrime / trueBase), lowBase) >>> 0);\n      low = lowPrime + highRemainder;\n      if (low >= trueBase) {\n        ++high;\n        low -= trueBase;\n      }\n    }\n    if ((low >>> 0) !== low || ((high >>> 0) !== high)) {\n      return false;\n    }\n    this.low = low;\n    this.high = high;\n    return true;\n  }\n\n  parseString(s: string, base = 10) {\n    if (!this.tryParseString(s, base)) {\n      throw new Error(`Failed to parse string as uint64 value: ${JSON.stringify(s)}.`);\n    }\n    return this;\n  }\n\n  static parseString(s: string, base = 10) {\n    let x = new Uint64();\n    return x.parseString(s, base);\n  }\n\n  valid() {\n    let {low, high} = this;\n    return ((low >>> 0) === low) && ((high >>> 0) === high);\n  }\n\n  toJSON() {\n    return this.toString();\n  }\n\n  static lshift(out: Uint64, input: Uint64, bits: number): Uint64 {\n    const {low, high} = input;\n    if (bits === 0) {\n      out.low = low;\n      out.high = high;\n    } else if (bits < 32) {\n      out.low = low << bits;\n      out.high = (high << bits) | (low >>> (32 - bits));\n    } else {\n      out.low = 0;\n      out.high = low << (bits - 32);\n    }\n    return out;\n  }\n\n  static rshift(out: Uint64, input: Uint64, bits: number) {\n    const {low, high} = input;\n    if (bits === 0) {\n      out.low = low;\n      out.high = high;\n    } else if (bits < 32) {\n      out.low = (low >>> bits) | (high << (32 - bits));\n      out.high = high >>> bits;\n    } else {\n      out.low = high >>> (bits - 32);\n      out.high = 0;\n    }\n    return out;\n  }\n\n  static or(out: Uint64, a: Uint64, b: Uint64): Uint64 {\n    out.low = a.low | b.low;\n    out.high = a.high | b.high;\n    return out;\n  }\n\n  static xor(out: Uint64, a: Uint64, b: Uint64): Uint64 {\n    out.low = a.low ^ b.low;\n    out.high = a.high ^ b.high;\n    return out;\n  }\n\n  static and(out: Uint64, a: Uint64, b: Uint64): Uint64 {\n    out.low = a.low & b.low;\n    out.high = a.high & b.high;\n    return out;\n  }\n\n  static add(out: Uint64, a: Uint64, b: Uint64): Uint64 {\n    let lowSum = a.low + b.low;\n    let highSum = a.high + b.high;\n    const low = lowSum >>> 0;\n    if (low !== lowSum) highSum += 1;\n    out.low = low;\n    out.high = highSum >>> 0;\n    return out;\n  }\n\n  static addUint32(out: Uint64, a: Uint64, b: number): Uint64 {\n    let lowSum = a.low + b;\n    let highSum = a.high;\n    const low = lowSum >>> 0;\n    if (low !== lowSum) highSum += 1;\n    out.low = low;\n    out.high = highSum >>> 0;\n    return out;\n  }\n\n  static decrement(out: Uint64, input: Uint64): Uint64 {\n    let {low, high} = input;\n    if (low === 0) {\n      high -= 1;\n    }\n    out.low = (low - 1) >>> 0;\n    out.high = high >>> 0;\n    return out;\n  }\n\n  static increment(out: Uint64, input: Uint64): Uint64 {\n    let {low, high} = input;\n    if (low === 0xFFFFFFFF) high += 1;\n    out.low = (low + 1) >>> 0;\n    out.high = high >>> 0;\n    return out;\n  }\n\n  static subtract(out: Uint64, a: Uint64, b: Uint64): Uint64 {\n    let lowSum = a.low - b.low;\n    let highSum = a.high - b.high;\n    const low = lowSum >>> 0;\n    if (low !== lowSum) highSum -= 1;\n    out.low = low;\n    out.high = highSum >>> 0;\n    return out;\n  }\n\n  static multiplyUint32(out: Uint64, a: Uint64, b: number): Uint64 {\n    const {low, high} = a;\n    out.low = Math.imul(low, b) >>> 0;\n    out.high = (Math.imul(high, b) + uint32MultiplyHigh(low, b)) >>> 0;\n    return out;\n  }\n\n  static lowMask(out: Uint64, bits: number) {\n    if (bits <= 32) {\n      out.high = 0;\n      out.low = 0xffffffff >>> (32 - bits);\n    } else {\n      out.high = 0xffffffff >>> (bits - 32);\n      out.low = 0xffffffff;\n    }\n    return out;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\n\nexport class TrackableBoolean implements Trackable {\n  get value() {\n    return this.value_;\n  }\n  set value(newValue: boolean) {\n    if (newValue !== this.value_) {\n      this.value_ = newValue;\n      this.changed.dispatch();\n    }\n  }\n  toggle() {\n    this.value = !this.value;\n  }\n  changed = new NullarySignal();\n  constructor(private value_: boolean, public defaultValue: boolean = value_) {}\n  toJSON() {\n    let {value_} = this;\n    if (value_ === this.defaultValue) {\n      return undefined;\n    }\n    return this.value_;\n  }\n  restoreState(x: any) {\n    if (x === true || x === false) {\n      this.value = x;\n      return;\n    }\n    this.value = this.defaultValue;\n  }\n  reset() {\n    this.value = this.defaultValue;\n  }\n}\n\nexport class TrackableBooleanCheckbox extends RefCounted {\n  element = document.createElement('input');\n  constructor(public model: TrackableBoolean) {\n    super();\n    let {element} = this;\n    element.type = 'checkbox';\n    this.registerDisposer(model.changed.add(() => {\n      this.updateCheckbox();\n    }));\n    this.updateCheckbox();\n    this.registerEventListener(element, 'change', function(this: typeof element, _e: Event) {\n      model.value = this.checked;\n    });\n\n    // Prevent the checkbox from becoming focused.\n    element.addEventListener('mousedown', (event: MouseEvent) => {\n      event.preventDefault();\n    });\n  }\n\n  updateCheckbox() {\n    this.element.checked = this.model.value;\n  }\n\n  disposed() {\n    let {element} = this;\n    let {parentElement} = element;\n    if (parentElement) {\n      parentElement.removeChild(element);\n    }\n    super.disposed();\n  }\n}\n\nexport class ElementVisibilityFromTrackableBoolean extends RefCounted {\n  private initialDisplay = this.element.style.display;\n  constructor(public model: WatchableValueInterface<boolean>, public element: HTMLElement) {\n    super();\n    this.updateVisibility();\n    this.registerDisposer(\n        model.changed.add(this.registerCancellable(debounce(() => this.updateVisibility(), 0))));\n  }\n\n  updateVisibility() {\n    this.element.style.display = this.model.value ? this.initialDisplay : 'none';\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Disposable, RefCountedValue} from 'neuroglancer/util/disposable';\nimport {stableStringify} from 'neuroglancer/util/json';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {AttributeIndex} from 'neuroglancer/webgl/shader';\n\nexport type BufferType = number;\nexport type WebGLDataType = number;\nexport type WebGLBufferUsage = number;\nexport class Buffer implements Disposable {\n  buffer: WebGLBuffer|null;\n  constructor(\n      public gl: WebGL2RenderingContext,\n      public bufferType: BufferType = WebGL2RenderingContext.ARRAY_BUFFER) {\n    this.gl = gl;\n    // This should never return null.\n    this.buffer = gl.createBuffer();\n  }\n\n  bind() {\n    this.gl.bindBuffer(this.bufferType, this.buffer);\n  }\n\n  bindToVertexAttrib(\n      location: AttributeIndex, componentsPerVertexAttribute: number,\n      attributeType: WebGLDataType = WebGL2RenderingContext.FLOAT, normalized = false, stride = 0,\n      offset = 0) {\n    this.bind();\n    this.gl.enableVertexAttribArray(location);\n    this.gl.vertexAttribPointer(\n        location, componentsPerVertexAttribute, attributeType, normalized, stride, offset);\n  }\n\n  bindToVertexAttribI(\n      location: AttributeIndex, componentsPerVertexAttribute: number,\n      attributeType: WebGLDataType = WebGL2RenderingContext.UNSIGNED_INT, stride = 0, offset = 0) {\n    this.bind();\n    this.gl.enableVertexAttribArray(location);\n    this.gl.vertexAttribIPointer(\n        location, componentsPerVertexAttribute, attributeType, stride, offset);\n  }\n\n  setData(data: ArrayBufferView, usage: WebGLBufferUsage = WebGL2RenderingContext.STATIC_DRAW) {\n    let gl = this.gl;\n    this.bind();\n    gl.bufferData(this.bufferType, data, usage);\n  }\n\n  dispose() {\n    this.gl.deleteBuffer(this.buffer);\n    this.buffer = <any>undefined;\n    this.gl = <any>undefined;\n  }\n\n  static fromData(\n      gl: WebGL2RenderingContext, data: ArrayBufferView, bufferType?: BufferType,\n      usage?: WebGLBufferUsage) {\n    let buffer = new Buffer(gl, bufferType);\n    buffer.setData(data, usage);\n    return buffer;\n  }\n}\n\nexport function getMemoizedBuffer(\n    gl: GL, bufferType: number, getter: (...args: any[]) => ArrayBufferView, ...args: any[]) {\n  return gl.memoize.get(\n      stableStringify({id: 'getMemoizedBuffer', getter: getObjectId(getter), args}), () => {\n        const result = new RefCountedValue(\n            Buffer.fromData(gl, getter(...args), bufferType, WebGL2RenderingContext.STATIC_DRAW));\n        result.registerDisposer(result.value);\n        return result;\n      });\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Signal} from 'neuroglancer/util/signal';\n\nexport function removeSignalBinding<T extends Function>(signal: Signal<T>, handler: T) {\n  signal.remove(handler);\n}\n\nexport function addSignalBinding<T extends Function>(signal: Signal<T>, handler: T) {\n  signal.add(handler);\n}\n\nexport interface SignalBindingUpdater<T extends Function> { (signal: Signal<T>, handler: T): void; }\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {AnnotationLayerState} from 'neuroglancer/annotation/frontend';\nimport {RenderedPanel} from 'neuroglancer/display_context';\nimport {LayerListSpecification} from 'neuroglancer/layer_specification';\nimport {SpatialPosition} from 'neuroglancer/navigation_state';\nimport {TrackableRefCounted, TrackableValue, WatchableSet} from 'neuroglancer/trackable_value';\nimport {restoreTool, Tool} from 'neuroglancer/ui/tool';\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {BoundingBox, vec3} from 'neuroglancer/util/geom';\nimport {verifyObject, verifyObjectProperty, verifyOptionalBoolean, verifyOptionalString, verifyPositiveInt} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {addSignalBinding, removeSignalBinding, SignalBindingUpdater} from 'neuroglancer/util/signal_binding_updater';\nimport {Trackable} from 'neuroglancer/util/trackable';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {VisibilityPriorityAggregator, WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\nimport {TabSpecification} from 'neuroglancer/widget/tab_view';\n\nexport enum RenderLayerRole {\n  DATA,\n  ANNOTATION,\n  DEFAULT_ANNOTATION,\n}\n\nexport function allRenderLayerRoles() {\n  return new WatchableSet(\n      [RenderLayerRole.DATA, RenderLayerRole.ANNOTATION, RenderLayerRole.DEFAULT_ANNOTATION]);\n}\n\nexport class RenderLayer extends RefCounted {\n  ready = false;\n  role: RenderLayerRole = RenderLayerRole.DATA;\n  layerChanged = new NullarySignal();\n  redrawNeeded = new NullarySignal();\n  readyStateChanged = new NullarySignal();\n  setReady(value: boolean) {\n    this.ready = value;\n    this.readyStateChanged.dispatch();\n    this.layerChanged.dispatch();\n  }\n\n  handleAction(_action: string) {\n    // Do nothing by default.\n  }\n\n  getValueAt(_x: Float32Array): any {\n    return undefined;\n  }\n\n  /**\n   * Base voxel size for this layer, in nanometers per voxel.\n   */\n  voxelSize: vec3|null = null;\n\n  /**\n   * Bounding box for this layer, in nanometers.\n   */\n  boundingBox: BoundingBox|null = null;\n\n  /**\n   * Transform the stored pickedValue and offset associated with the retrieved pick ID into the\n   * actual value.\n   */\n  transformPickedValue(pickedValue: Uint64, _pickedOffset: number): any {\n    return pickedValue;\n  }\n\n  /**\n   * Optionally updates the mouse state based on the retrived pick information.  This might snap the\n   * 3-d position to the center of the picked point.\n   */\n  updateMouseState(\n      _mouseState: MouseSelectionState, _pickedValue: Uint64, _pickedOffset: number, _data: any) {}\n}\n\n/**\n * Extends RenderLayer with functionality for tracking the number of panels in which the layer is\n * visible.\n */\nexport class VisibilityTrackedRenderLayer extends RenderLayer {\n  visibility = new VisibilityPriorityAggregator();\n}\n\nconst TAB_JSON_KEY = 'tab';\nconst TOOL_JSON_KEY = 'tool';\n\nexport class UserLayer extends RefCounted {\n  layersChanged = new NullarySignal();\n  readyStateChanged = new NullarySignal();\n  specificationChanged = new NullarySignal();\n  renderLayers = new Array<RenderLayer>();\n  isReady = false;\n  tabs = this.registerDisposer(new TabSpecification());\n  tool = this.registerDisposer(\n      new TrackableRefCounted<Tool>(value => restoreTool(this, value), value => value.toJSON()));\n  constructor(public manager: Borrowed<LayerListSpecification>, specification: any) {\n    super();\n    specification;\n    this.tabs.changed.add(this.specificationChanged.dispatch);\n    this.tool.changed.add(this.specificationChanged.dispatch);\n  }\n\n  restoreState(specification: any) {\n    this.tool.restoreState(specification[TOOL_JSON_KEY]);\n    this.tabs.restoreState(specification[TAB_JSON_KEY]);\n  }\n\n  addRenderLayer(layer: RenderLayer) {\n    this.renderLayers.push(layer);\n    const {layersChanged, readyStateChanged} = this;\n    layer.layerChanged.add(layersChanged.dispatch);\n    layer.readyStateChanged.add(readyStateChanged.dispatch);\n    readyStateChanged.dispatch();\n    layersChanged.dispatch();\n  }\n\n  removeRenderLayer(layer: RenderLayer) {\n    const {renderLayers, layersChanged, readyStateChanged} = this;\n    const index = renderLayers.indexOf(layer);\n    if (index === -1) {\n      throw new Error('Attempted to remove invalid RenderLayer');\n    }\n    renderLayers.splice(index, 1);\n    layer.layerChanged.remove(layersChanged.dispatch);\n    layer.readyStateChanged.remove(readyStateChanged.dispatch);\n    layer.dispose();\n    readyStateChanged.dispatch();\n    layersChanged.dispatch();\n  }\n\n  disposed() {\n    const {layersChanged, readyStateChanged} = this;\n    for (const layer of this.renderLayers) {\n      layer.layerChanged.remove(layersChanged.dispatch);\n      layer.readyStateChanged.remove(readyStateChanged.dispatch);\n      layer.dispose();\n    }\n    super.disposed();\n  }\n\n  getValueAt(position: Float32Array, pickState: PickState) {\n    let result: any;\n    let {renderLayers} = this;\n    let {pickedRenderLayer} = pickState;\n    if (pickedRenderLayer !== null && renderLayers.indexOf(pickedRenderLayer) !== -1) {\n      result =\n          pickedRenderLayer.transformPickedValue(pickState.pickedValue, pickState.pickedOffset);\n      return this.transformPickedValue(result);\n    }\n    for (let layer of renderLayers) {\n      if (!layer.ready) {\n        continue;\n      }\n      result = layer.getValueAt(position);\n      if (result !== undefined) {\n        break;\n      }\n    }\n    return this.transformPickedValue(result);\n  }\n\n  transformPickedValue(value: any) {\n    return value;\n  }\n\n  toJSON(): any {\n    return {\n      [TAB_JSON_KEY]: this.tabs.toJSON(),\n      [TOOL_JSON_KEY]: this.tool.toJSON(),\n    };\n  }\n\n  handleAction(_action: string): void {}\n}\n\nexport class ManagedUserLayer extends RefCounted {\n  readyStateChanged = new NullarySignal();\n  layerChanged = new NullarySignal();\n  specificationChanged = new NullarySignal();\n  wasDisposed = false;\n  private layer_: UserLayer|null = null;\n  get layer() {\n    return this.layer_;\n  }\n  private unregisterUserLayer: (() => void)|undefined;\n\n  /**\n   * If layer is not null, tranfers ownership of a reference.\n   */\n  set layer(layer: UserLayer|null) {\n    let oldLayer = this.layer_;\n    if (oldLayer != null) {\n      this.unregisterUserLayer!();\n      oldLayer.dispose();\n    }\n    this.layer_ = layer;\n    if (layer != null) {\n      const removers = [\n        layer.layersChanged.add(() => this.handleLayerChanged()),\n        layer.readyStateChanged.add(this.readyStateChanged.dispatch),\n        layer.specificationChanged.add(this.specificationChanged.dispatch)\n      ];\n      this.unregisterUserLayer = () => {\n        removers.forEach(x => x());\n      };\n      this.readyStateChanged.dispatch();\n      this.handleLayerChanged();\n    }\n  }\n\n  isReady() {\n    const {layer} = this;\n    return layer !== null && layer.isReady;\n  }\n\n  private name_: string;\n\n  get name() {\n    return this.name_;\n  }\n\n  set name(value: string) {\n    if (value !== this.name_) {\n      this.name_ = value;\n      this.layerChanged.dispatch();\n    }\n  }\n\n  /**\n   * If layer is not null, tranfers ownership of a reference.\n   */\n  constructor(name: string, layer: UserLayer|null = null, public visible: boolean = true) {\n    super();\n    this.name_ = name;\n    this.layer = layer;\n  }\n\n  private handleLayerChanged() {\n    if (this.visible) {\n      this.layerChanged.dispatch();\n    }\n  }\n  setVisible(value: boolean) {\n    if (value !== this.visible) {\n      this.visible = value;\n      this.layerChanged.dispatch();\n    }\n  }\n\n  disposed() {\n    this.wasDisposed = true;\n    this.layer = null;\n    super.disposed();\n  }\n}\n\nexport class LayerManager extends RefCounted {\n  managedLayers = new Array<Owned<ManagedUserLayer>>();\n  layerSet = new Set<Borrowed<ManagedUserLayer>>();\n  layersChanged = new NullarySignal();\n  readyStateChanged = new NullarySignal();\n  specificationChanged = new NullarySignal();\n  boundPositions = new WeakSet<SpatialPosition>();\n  numDirectUsers = 0;\n  private renderLayerToManagedLayerMapGeneration = -1;\n  private renderLayerToManagedLayerMap_ = new Map<RenderLayer, ManagedUserLayer>();\n\n  constructor() {\n    super();\n    this.layersChanged.add(this.scheduleRemoveLayersWithSingleRef);\n  }\n\n  private scheduleRemoveLayersWithSingleRef =\n      this.registerCancellable(debounce(() => this.removeLayersWithSingleRef(), 0));\n\n  get renderLayerToManagedLayerMap() {\n    const generation = this.layersChanged.count;\n    const map = this.renderLayerToManagedLayerMap_;\n    if (this.renderLayerToManagedLayerMapGeneration !== generation) {\n      this.renderLayerToManagedLayerMapGeneration = generation;\n      map.clear();\n      for (const managedLayer of this.managedLayers) {\n        const userLayer = managedLayer.layer;\n        if (userLayer !== null) {\n          for (const renderLayer of userLayer.renderLayers) {\n            map.set(renderLayer, managedLayer);\n          }\n        }\n      }\n    }\n    return map;\n  }\n\n  filter(predicate: (layer: ManagedUserLayer) => boolean) {\n    let changed = false;\n    this.managedLayers = this.managedLayers.filter(layer => {\n      if (!predicate(layer)) {\n        this.unbindManagedLayer(layer);\n        this.layerSet.delete(layer);\n        changed = true;\n        return false;\n      }\n      return true;\n    });\n    if (changed) {\n      this.layersChanged.dispatch();\n    }\n  }\n\n  private removeLayersWithSingleRef() {\n    if (this.numDirectUsers > 0) {\n      return;\n    }\n    this.filter(layer => layer.refCount !== 1);\n  }\n\n  private updateSignalBindings(\n      layer: ManagedUserLayer, callback: SignalBindingUpdater<() => void>) {\n    callback(layer.layerChanged, this.layersChanged.dispatch);\n    callback(layer.readyStateChanged, this.readyStateChanged.dispatch);\n    callback(layer.specificationChanged, this.specificationChanged.dispatch);\n  }\n\n  useDirectly() {\n    if (++this.numDirectUsers === 1) {\n      this.layersChanged.remove(this.scheduleRemoveLayersWithSingleRef);\n    }\n    return () => {\n      if (--this.numDirectUsers === 0) {\n        this.layersChanged.add(this.scheduleRemoveLayersWithSingleRef);\n        this.scheduleRemoveLayersWithSingleRef();\n      }\n    };\n  }\n\n  /**\n   * Assumes ownership of an existing reference to managedLayer.\n   */\n  addManagedLayer(managedLayer: ManagedUserLayer, index?: number|undefined) {\n    this.updateSignalBindings(managedLayer, addSignalBinding);\n    this.layerSet.add(managedLayer);\n    if (index === undefined) {\n      index = this.managedLayers.length;\n    }\n    this.managedLayers.splice(index, 0, managedLayer);\n    this.layersChanged.dispatch();\n    this.readyStateChanged.dispatch();\n    return managedLayer;\n  }\n\n  /**\n   * Assumes ownership of an existing reference to userLayer.\n   */\n  addUserLayer(name: string, userLayer: UserLayer, visible: boolean) {\n    let managedLayer = new ManagedUserLayer(name, userLayer, visible);\n    return this.addManagedLayer(managedLayer);\n  }\n\n  * readyRenderLayers() {\n    for (let managedUserLayer of this.managedLayers) {\n      if (!managedUserLayer.visible || !managedUserLayer.layer) {\n        continue;\n      }\n      for (let renderLayer of managedUserLayer.layer.renderLayers) {\n        if (!renderLayer.ready) {\n          continue;\n        }\n        yield renderLayer;\n      }\n    }\n  }\n\n  unbindManagedLayer(managedLayer: ManagedUserLayer) {\n    this.updateSignalBindings(managedLayer, removeSignalBinding);\n    managedLayer.dispose();\n  }\n\n  clear() {\n    for (let managedLayer of this.managedLayers) {\n      this.unbindManagedLayer(managedLayer);\n    }\n    this.managedLayers.length = 0;\n    this.layerSet.clear();\n    this.layersChanged.dispatch();\n  }\n\n  remove(index: number) {\n    const layer = this.managedLayers[index];\n    this.unbindManagedLayer(layer);\n    this.managedLayers.splice(index, 1);\n    this.layerSet.delete(layer);\n    this.layersChanged.dispatch();\n  }\n\n  removeManagedLayer(managedLayer: ManagedUserLayer) {\n    let index = this.managedLayers.indexOf(managedLayer);\n    if (index === -1) {\n      throw new Error(`Internal error: invalid managed layer.`);\n    }\n    this.remove(index);\n  }\n\n  reorderManagedLayer(oldIndex: number, newIndex: number) {\n    const numLayers = this.managedLayers.length;\n    if (oldIndex === newIndex || oldIndex < 0 || oldIndex >= numLayers || newIndex < 0 ||\n        newIndex >= numLayers) {\n      // Don't do anything.\n      return;\n    }\n    let [oldLayer] = this.managedLayers.splice(oldIndex, 1);\n    this.managedLayers.splice(newIndex, 0, oldLayer);\n    this.layersChanged.dispatch();\n  }\n\n  disposed() {\n    this.clear();\n    super.disposed();\n  }\n\n  getLayerByName(name: string) {\n    return this.managedLayers.find(x => x.name === name);\n  }\n\n  getUniqueLayerName(name: string) {\n    let suggestedName = name;\n    let suffix = 0;\n    while (this.getLayerByName(suggestedName) !== undefined) {\n      suggestedName = name + (++suffix);\n    }\n    return suggestedName;\n  }\n\n  has(layer: Borrowed<ManagedUserLayer>) {\n    return this.layerSet.has(layer);\n  }\n\n  /**\n   * Asynchronously initialize the voxelSize and position based on the managed layers.\n   *\n   * The first ready layer with an associated bounding box will set the position to the center of\n   * the bounding box.\n   *\n   * If the position later becomes invalid, it will be initialized again.\n   */\n  initializePosition(position: SpatialPosition) {\n    let {boundPositions} = this;\n    if (boundPositions.has(position)) {\n      return;\n    }\n    boundPositions.add(position);\n\n    // Deboucne to ensure that if the position is reset and the layers are reset immediately after,\n    // the position will not be reinitialized based on the soon to be reset layers.\n    const handler = debounce(() => {\n      this.updatePositionFromLayers(position);\n    });\n    this.readyStateChanged.add(handler);\n    position.changed.add(handler);\n    this.updatePositionFromLayers(position);\n  }\n\n  updatePositionFromLayers(position: SpatialPosition) {\n    if (position.valid) {\n      return;\n    }\n    for (let managedLayer of this.managedLayers) {\n      let userLayer = managedLayer.layer;\n      if (userLayer == null) {\n        continue;\n      }\n      for (let renderLayer of userLayer.renderLayers) {\n        if (!renderLayer.ready) {\n          continue;\n        }\n        if (!position.voxelSize.valid && renderLayer.voxelSize != null) {\n          vec3.copy(position.voxelSize.size, renderLayer.voxelSize);\n          position.voxelSize.setValid();\n        }\n\n        if (!position.spatialCoordinatesValid && !position.voxelCoordinatesValid &&\n            renderLayer.boundingBox != null) {\n          let boundingBox = renderLayer.boundingBox;\n          let centerPosition = position.spatialCoordinates;\n          vec3.add(centerPosition, boundingBox.lower, boundingBox.upper);\n          vec3.scale(centerPosition, centerPosition, 0.5);\n          position.spatialCoordinatesValid = true;\n          position.changed.dispatch();\n        }\n      }\n    }\n  }\n\n  get renderLayers() {\n    let layerManager = this;\n    return {\n      * [Symbol.iterator]() {\n          for (let managedLayer of layerManager.managedLayers) {\n            if (managedLayer.layer === null) {\n              continue;\n            }\n            for (let renderLayer of managedLayer.layer.renderLayers) {\n              yield renderLayer;\n            }\n          }\n        }\n    };\n  }\n\n  get visibleRenderLayers() {\n    let layerManager = this;\n    return {\n      * [Symbol.iterator]() {\n          for (let managedLayer of layerManager.managedLayers) {\n            if (managedLayer.layer === null || !managedLayer.visible) {\n              continue;\n            }\n            for (let renderLayer of managedLayer.layer.renderLayers) {\n              yield renderLayer;\n            }\n          }\n        }\n    };\n  }\n\n  invokeAction(action: string) {\n    for (let managedLayer of this.managedLayers) {\n      if (managedLayer.layer === null || !managedLayer.visible) {\n        continue;\n      }\n      let userLayer = managedLayer.layer;\n      userLayer.handleAction(action);\n      for (let renderLayer of userLayer.renderLayers) {\n        if (!renderLayer.ready) {\n          continue;\n        }\n        renderLayer.handleAction(action);\n      }\n    }\n  }\n}\n\nexport interface PickState {\n  pickedRenderLayer: RenderLayer|null;\n  pickedValue: Uint64;\n  pickedOffset: number;\n}\n\nexport class MouseSelectionState implements PickState {\n  changed = new NullarySignal();\n  position = vec3.create();\n  active = false;\n  pickedRenderLayer: RenderLayer|null = null;\n  pickedValue = new Uint64(0, 0);\n  pickedOffset = 0;\n  pickedAnnotationLayer: AnnotationLayerState|undefined = undefined;\n  pickedAnnotationId: string|undefined = undefined;\n  pickedAnnotationBuffer: ArrayBuffer|undefined = undefined;\n  pickedAnnotationBufferOffset: number|undefined = undefined;\n  pageX: number;\n  pageY: number;\n\n  private forcerFunction: (() => void)|undefined = undefined;\n\n  removeForcer(forcer: (() => void)) {\n    if (forcer === this.forcerFunction) {\n      this.forcerFunction = undefined;\n      this.setActive(false);\n    }\n  }\n\n  setForcer(forcer: (() => void)|undefined) {\n    this.forcerFunction = forcer;\n    if (forcer === undefined) {\n      this.setActive(false);\n    }\n  }\n\n  updateUnconditionally(): boolean {\n    const {forcerFunction} = this;\n    if (forcerFunction === undefined) {\n      return false;\n    }\n    forcerFunction();\n    return this.active;\n  }\n\n  setActive(value: boolean) {\n    if (this.active !== value || value === true) {\n      this.active = value;\n      this.changed.dispatch();\n    }\n  }\n}\n\nexport class LayerSelectedValues extends RefCounted {\n  values = new Map<UserLayer, any>();\n  changed = new NullarySignal();\n  needsUpdate = true;\n  constructor(public layerManager: LayerManager, public mouseState: MouseSelectionState) {\n    super();\n    this.registerDisposer(mouseState.changed.add(() => {\n      this.handleChange();\n    }));\n    this.registerDisposer(layerManager.layersChanged.add(() => {\n      this.handleLayerChange();\n    }));\n  }\n\n  /**\n   * This should be called when the layer data may have changed, due to the set of managed layers\n   * changing or new data having been received.\n   */\n  handleLayerChange() {\n    if (this.mouseState.active) {\n      this.handleChange();\n    }\n  }\n\n  handleChange() {\n    this.needsUpdate = true;\n    this.changed.dispatch();\n  }\n\n  update() {\n    if (!this.needsUpdate) {\n      return;\n    }\n    this.needsUpdate = false;\n    let values = this.values;\n    let mouseState = this.mouseState;\n    values.clear();\n    if (mouseState.active) {\n      let position = mouseState.position;\n      for (let layer of this.layerManager.managedLayers) {\n        let userLayer = layer.layer;\n        if (layer.visible && userLayer) {\n          values.set(userLayer, userLayer.getValueAt(position, mouseState));\n        }\n      }\n    }\n  }\n\n  get(userLayer: UserLayer) {\n    this.update();\n    return this.values.get(userLayer);\n  }\n\n  toJSON() {\n    this.update();\n    const result: {[key: string]: any} = {};\n    const {values} = this;\n    for (const layer of this.layerManager.managedLayers) {\n      const userLayer = layer.layer;\n      if (userLayer) {\n        let v = values.get(userLayer);\n        if (v !== undefined) {\n          if (v instanceof Uint64) {\n            v = {'t': 'u64', 'v': v};\n          }\n          result[layer.name] = v;\n        }\n      }\n    }\n    return result;\n  }\n}\n\nexport class VisibleRenderLayerTracker<RenderLayerType extends VisibilityTrackedRenderLayer> extends\n    RefCounted {\n  /**\n   * Maps a layer to the disposer to call when it is no longer visible.\n   */\n  private visibleLayers = new Map<RenderLayerType, () => void>();\n  private newVisibleLayers = new Set<RenderLayerType>();\n\n  private debouncedUpdateVisibleLayers =\n      this.registerCancellable(debounce(() => this.updateVisibleLayers(), 0));\n\n  constructor(\n      public layerManager: LayerManager,\n      public renderLayerType: {new(...args: any[]): RenderLayerType},\n      public roles: WatchableSet<RenderLayerRole>,\n      private layerAdded: (layer: RenderLayerType) => (() => void),\n      public visibility: WatchableVisibilityPriority) {\n    super();\n    this.registerDisposer(layerManager.layersChanged.add(this.debouncedUpdateVisibleLayers));\n    this.registerDisposer(roles.changed.add(this.debouncedUpdateVisibleLayers));\n    this.updateVisibleLayers();\n  }\n\n  disposed() {\n    this.visibleLayers.forEach(disposer => disposer());\n    this.visibleLayers.clear();\n    super.disposed();\n  }\n\n  private updateVisibleLayers() {\n    let {visibleLayers, newVisibleLayers, renderLayerType, layerAdded, roles} = this;\n    for (let renderLayer of this.layerManager.readyRenderLayers()) {\n      if (renderLayer instanceof renderLayerType && roles.has(renderLayer.role)) {\n        let typedLayer = <RenderLayerType>renderLayer;\n        newVisibleLayers.add(typedLayer);\n        if (!visibleLayers.has(typedLayer)) {\n          const visibilityDisposer = typedLayer.visibility.add(this.visibility);\n          const disposer = layerAdded(typedLayer);\n          visibleLayers.set(typedLayer.addRef(), () => {\n            disposer();\n            visibilityDisposer();\n            typedLayer.dispose();\n          });\n        }\n      }\n    }\n    for (let [renderLayer, disposer] of visibleLayers) {\n      if (!newVisibleLayers.has(renderLayer)) {\n        visibleLayers.delete(renderLayer);\n        disposer();\n      }\n    }\n    newVisibleLayers.clear();\n  }\n\n  getVisibleLayers() {\n    (<any>this.debouncedUpdateVisibleLayers).flush();\n    return [...this.visibleLayers.keys()];\n  }\n}\n\nexport function\nmakeRenderedPanelVisibleLayerTracker<RenderLayerType extends VisibilityTrackedRenderLayer>(\n    layerManager: LayerManager, renderLayerType: {new (...args: any[]): RenderLayerType},\n    roles: WatchableSet<RenderLayerRole>, panel: RenderedPanel,\n    layerAdded?: (layer: RenderLayerType) => ((() => void) | void)) {\n  return panel.registerDisposer(\n      new VisibleRenderLayerTracker(layerManager, renderLayerType, roles, layer => {\n        const disposer = layer.redrawNeeded.add(() => panel.scheduleRedraw());\n        const disposer2 = layerAdded && layerAdded(layer);\n        panel.scheduleRedraw();\n        return () => {\n          if (disposer2 !== undefined) {\n            disposer2();\n          }\n          disposer();\n          panel.scheduleRedraw();\n        };\n      }, panel.visibility));\n}\n\nexport class SelectedLayerState extends RefCounted implements Trackable {\n  changed = new NullarySignal();\n  visible_ = false;\n  layer_: ManagedUserLayer|undefined;\n  size = new TrackableValue<number>(300, verifyPositiveInt)\n\n  get layer() {\n    return this.layer_;\n  }\n\n  get visible() {\n    return this.visible_;\n  }\n\n  set visible(value: boolean) {\n    if (this.layer_ === undefined) {\n      value = false;\n    }\n    if (this.visible_ !== value) {\n      this.visible_ = value;\n      this.changed.dispatch();\n    }\n  }\n\n  private existingLayerDisposer?: () => void;\n\n  constructor(public layerManager: Owned<LayerManager>) {\n    super();\n    this.registerDisposer(layerManager);\n    this.size.changed.add(this.changed.dispatch);\n  }\n\n  set layer(layer: ManagedUserLayer|undefined) {\n    if (layer === this.layer_) {\n      return;\n    }\n    if (this.layer_ !== undefined) {\n      this.existingLayerDisposer!();\n      this.existingLayerDisposer = undefined;\n    }\n    this.layer_ = layer;\n    if (layer !== undefined) {\n      const layerDisposed = () => {\n        this.layer_ = undefined;\n        this.visible = false;\n        this.existingLayerDisposer = undefined;\n        this.changed.dispatch();\n      };\n      layer.registerDisposer(layerDisposed);\n      const layerChangedDisposer = layer.specificationChanged.add(() => {\n        this.changed.dispatch();\n      });\n      this.existingLayerDisposer = () => {\n        const userLayer = layer.layer;\n        if (userLayer !== null) {\n          const tool = userLayer.tool.value;\n          if (tool !== undefined) {\n            tool.deactivate();\n          }\n        }\n        layer.unregisterDisposer(layerDisposed);\n        layerChangedDisposer();\n      };\n    } else {\n      this.visible_ = false;\n    }\n    this.changed.dispatch();\n  }\n\n  toJSON() {\n    if (this.layer === undefined) {\n      return undefined;\n    }\n    return {\n      'layer': this.layer.name,\n      'visible': this.visible === true ? true : undefined,\n      'size': this.size.toJSON(),\n    };\n  }\n\n  restoreState(obj: any) {\n    if (obj === undefined) {\n      this.reset();\n      return;\n    }\n    verifyObject(obj);\n    const layerName = verifyObjectProperty(obj, 'layer', verifyOptionalString);\n    const layer = layerName !== undefined ? this.layerManager.getLayerByName(layerName) : undefined;\n    this.layer = layer;\n    this.visible = verifyObjectProperty(obj, 'visible', verifyOptionalBoolean) ? true : false;\n    verifyObjectProperty(obj, 'size', x => this.size.restoreState(x));\n  }\n\n  reset() {\n    this.layer = undefined;\n  }\n}\n\nexport class LayerReference extends RefCounted implements Trackable {\n  private layerName_: string|undefined;\n  private layer_: ManagedUserLayer|undefined;\n  changed = new NullarySignal();\n  constructor(\n      public layerManager: Owned<LayerManager>,\n      public filter: (layer: ManagedUserLayer) => boolean) {\n    super();\n    this.registerDisposer(layerManager);\n    this.registerDisposer(layerManager.specificationChanged.add(() => {\n      const {layer_} = this;\n      if (layer_ !== undefined) {\n        if (!this.layerManager.layerSet.has(layer_) || !this.filter(layer_)) {\n          this.layer_ = undefined;\n          this.layerName_ = undefined;\n          this.changed.dispatch();\n        } else {\n          const {name} = layer_;\n          if (name !== this.layerName_) {\n            this.layerName_ = name;\n            this.changed.dispatch();\n          }\n        }\n      }\n    }));\n  }\n\n  get layer() {\n    return this.layer_;\n  }\n\n  get layerName() {\n    return this.layerName_;\n  }\n\n  set layer(value: ManagedUserLayer|undefined) {\n    if (this.layer_ === value) {\n      return;\n    }\n    if (value !== undefined && this.layerManager.layerSet.has(value) && this.filter(value)) {\n      this.layer_ = value;\n      this.layerName_ = value.name;\n    } else {\n      this.layer_ = undefined;\n      this.layerName_ = undefined;\n    }\n    this.changed.dispatch();\n  }\n\n  set layerName(value: string|undefined) {\n    if (value === this.layerName_) {\n      return;\n    }\n    this.layer_ = undefined;\n    this.layerName_ = value;\n    this.changed.dispatch();\n    this.validate();\n  }\n\n  private validate = debounce(() => {\n    const {layerName_} = this;\n    if (layerName_ !== undefined) {\n      const layer = this.layerManager.getLayerByName(layerName_);\n      if (layer !== undefined && this.filter(layer)) {\n        this.layer_ = layer;\n        this.changed.dispatch();\n      } else {\n        this.layer_ = undefined;\n        this.layerName_ = undefined;\n        this.changed.dispatch();\n      }\n    }\n  }, 0);\n\n  restoreState(obj: any) {\n    const layerName = verifyOptionalString(obj);\n    this.layerName = layerName;\n  }\n\n  toJSON() {\n    const {layer_} = this;\n    if (layer_ !== undefined) {\n      return layer_.name;\n    }\n    return this.layerName_;\n  }\n\n  reset() {\n    this.layerName_ = undefined;\n    this.layer_ = undefined;\n    this.changed.dispatch();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Facilities for reading various data types from 2-D and 3-D WebGL textures.\n *\n * WebGL2 only supports 2-D and 3-D textures, and because implementations typically limit the size\n * of each dimension, a large 1-D array has to be fit to a rectangular 2-D texture, which may\n * require padding.\n */\n\nimport {maybePadArray, TypedArray, TypedArrayConstructor} from 'neuroglancer/util/array';\nimport {DataType} from 'neuroglancer/util/data_type';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderCodePart, ShaderProgram, ShaderSamplerPrefix} from 'neuroglancer/webgl/shader';\nimport {getShaderType, glsl_float, glsl_uint16, glsl_uint32, glsl_uint64, glsl_uint8, glsl_unpackUint64leFromUint32} from 'neuroglancer/webgl/shader_lib';\nimport {setRawTexture3DParameters, setRawTextureParameters} from 'neuroglancer/webgl/texture';\n\nexport type TextureAccessCoefficients = vec3;\n\nexport class OneDimensionalTextureLayout {\n  /**\n   * The x index is computed as `(index & ((1 << textureXBits) - 1))`, while the y index is computed\n   * as `index >> textureXBits`.\n   */\n  textureXBits: number;\n  textureWidth: number;\n  textureHeight: number;\n}\n\nexport class TextureFormat {\n  /**\n   * Number of texels per multi-channel element.\n   */\n  texelsPerElement: number;\n\n  /**\n   * Texture internal format to specify when uploading the texture data.\n   */\n  textureInternalFormat: number;\n\n  /**\n   * Texture format to specify when uploading the texture data.\n   */\n  textureFormat: number;\n\n  /**\n   * Texel type to specify when uploading the texture data.\n   */\n  texelType: number;\n\n  /**\n   * Number of typed array elements per texel.\n   */\n  arrayElementsPerTexel: number;\n\n  /**\n   * TypedArray type that must be used when uploading the texture data.\n   */\n  arrayConstructor: TypedArrayConstructor;\n\n  samplerPrefix: ShaderSamplerPrefix;\n}\n\nexport const integerTextureFormatForNumComponents = [\n    -1,\n    WebGL2RenderingContext.RED_INTEGER,\n    WebGL2RenderingContext.RG_INTEGER,\n    WebGL2RenderingContext.RGB_INTEGER,\n    WebGL2RenderingContext.RGBA_INTEGER];\nexport const floatTextureFormatForNumComponents = [\n    -1,\n    WebGL2RenderingContext.RED,\n    WebGL2RenderingContext.RG,\n    WebGL2RenderingContext.RGB,\n    WebGL2RenderingContext.RGBA];\nexport const textureSelectorForNumComponents = ['', 'r', 'rg', 'rgb', 'rgba'];\nexport const internalUint8FormatForNumComponents = [\n    -1,\n    WebGL2RenderingContext.R8UI,\n    WebGL2RenderingContext.RG8UI,\n    WebGL2RenderingContext.RGB8UI,\n    WebGL2RenderingContext.RGBA8UI];\nexport const internalUint16FormatForNumComponents = [\n    -1,\n    WebGL2RenderingContext.R16UI,\n    WebGL2RenderingContext.RG16UI,\n    WebGL2RenderingContext.RGB16UI,\n    WebGL2RenderingContext.RGBA16UI];\nexport const internalUint32FormatForNumComponents = [\n    -1,\n    WebGL2RenderingContext.R32UI,\n    WebGL2RenderingContext.RG32UI,\n    WebGL2RenderingContext.RGB32UI,\n    WebGL2RenderingContext.RGBA32UI];\nexport const internalFloatFormatForNumComponents = [\n    -1,\n    WebGL2RenderingContext.R32F,\n    WebGL2RenderingContext.RG32F,\n    WebGL2RenderingContext.RGB32F,\n  WebGL2RenderingContext.RGBA32F];\n\nexport function getSamplerPrefixForDataType(dataType: DataType): ShaderSamplerPrefix {\n  return dataType === DataType.FLOAT32 ? '' : 'u';\n}\n\n/**\n * Fills in a OneDimensionalTextureFormat object with the suitable texture format for the specified\n * DataType and number of components.\n */\nexport function computeTextureFormat(\n    format: TextureFormat, dataType: DataType, numComponents: number = 1) {\n  switch (dataType) {\n    case DataType.UINT8:\n      if (numComponents < 1 || numComponents > 4) {\n        break;\n      }\n      format.texelsPerElement = 1;\n      format.textureInternalFormat = internalUint8FormatForNumComponents[numComponents];\n      format.textureFormat = integerTextureFormatForNumComponents[numComponents];\n      format.texelType = WebGL2RenderingContext.UNSIGNED_BYTE;\n      format.arrayElementsPerTexel = numComponents;\n      format.arrayConstructor = Uint8Array;\n      format.samplerPrefix = 'u';\n      return format;\n    case DataType.UINT16:\n      if (numComponents < 1 || numComponents > 4) {\n        break;\n      }\n      format.texelsPerElement = 1;\n      format.textureInternalFormat = internalUint16FormatForNumComponents[numComponents];\n      format.textureFormat = integerTextureFormatForNumComponents[numComponents];\n      format.texelType = WebGL2RenderingContext.UNSIGNED_SHORT;\n      format.arrayElementsPerTexel = numComponents;\n      format.arrayConstructor = Uint16Array;\n      format.samplerPrefix = 'u';\n      return format;\n    case DataType.UINT64:\n      if (numComponents < 1 || numComponents> 2) {\n        break;\n      }\n      format.texelsPerElement = 1;\n      format.textureInternalFormat = internalUint32FormatForNumComponents[numComponents * 2];\n      format.textureFormat = integerTextureFormatForNumComponents[numComponents * 2];\n      format.texelType = WebGL2RenderingContext.UNSIGNED_INT;\n      format.arrayElementsPerTexel = 2 * numComponents;\n      format.arrayConstructor = Uint32Array;\n      format.samplerPrefix = 'u';\n      return format;\n    case DataType.UINT32:\n      if (numComponents < 1 || numComponents > 4) {\n        break;\n      }\n      format.texelsPerElement = 1;\n      format.textureInternalFormat = internalUint32FormatForNumComponents[numComponents];\n      format.textureFormat = integerTextureFormatForNumComponents[numComponents];\n      format.texelType = WebGL2RenderingContext.UNSIGNED_INT;\n      format.arrayElementsPerTexel = 1;\n      format.arrayConstructor = Uint32Array;\n      format.samplerPrefix = 'u';\n      return format;\n    case DataType.FLOAT32:\n      if (numComponents < 1 || numComponents > 4) {\n        break;\n      }\n      format.texelsPerElement = 1;\n      format.textureInternalFormat = internalFloatFormatForNumComponents[numComponents];\n      format.textureFormat = floatTextureFormatForNumComponents[numComponents];\n      format.texelType = WebGL2RenderingContext.FLOAT;\n      format.arrayElementsPerTexel = numComponents;\n      format.arrayConstructor = Float32Array;\n      format.samplerPrefix = '';\n      return format;\n  }\n  throw new Error(`No supported texture format for ${DataType[dataType]}[${numComponents}].`);\n}\n\nexport function compute1dTextureLayout(\n    layout: OneDimensionalTextureLayout, gl: GL, texelsPerElement: number, numElements: number) {\n  const {maxTextureSize} = gl;\n  if (numElements * texelsPerElement > maxTextureSize * maxTextureSize) {\n    throw new Error(\n        'Number of elements exceeds maximum texture size: ' + texelsPerElement + ' * ' +\n        numElements);\n  }\n  const minX = Math.ceil(numElements / maxTextureSize);\n  const textureXBits = layout.textureXBits = Math.ceil(Math.log2(minX));\n  layout.textureWidth = (1 << textureXBits) * texelsPerElement;\n  layout.textureHeight = Math.ceil(numElements / (1 << textureXBits));\n}\n\nexport function setOneDimensionalTextureData(\n    gl: GL, textureLayout: OneDimensionalTextureLayout, format: TextureFormat, data: TypedArray) {\n  const {\n    arrayConstructor,\n    arrayElementsPerTexel,\n    textureInternalFormat,\n    textureFormat,\n  } = format;\n  const {textureWidth, textureHeight} = textureLayout;\n  const requiredSize = textureWidth * textureHeight * arrayElementsPerTexel;\n  if (data.constructor !== arrayConstructor) {\n    data = new arrayConstructor(\n        data.buffer, data.byteOffset, data.byteLength / arrayConstructor.BYTES_PER_ELEMENT);\n  }\n  let padded = maybePadArray(data, requiredSize);\n  gl.pixelStorei(WebGL2RenderingContext.UNPACK_ALIGNMENT, 1);\n  setRawTextureParameters(gl);\n  gl.texImage2D(\n      WebGL2RenderingContext.TEXTURE_2D,\n      /*level=*/0,textureInternalFormat,\n      /*width=*/textureWidth,\n      /*height=*/textureHeight,\n      /*border=*/0, textureFormat, format.texelType, padded);\n}\n\nexport function setThreeDimensionalTextureData(\n    gl: GL, format: TextureFormat, data: TypedArray, width: number, height: number, depth: number) {\n  const {\n    arrayConstructor,\n    textureInternalFormat,\n    textureFormat,\n    texelsPerElement,\n  } = format;\n  if (data.constructor !== arrayConstructor) {\n    data = new arrayConstructor(\n        data.buffer, data.byteOffset, data.byteLength / arrayConstructor.BYTES_PER_ELEMENT);\n  }\n  gl.pixelStorei(WebGL2RenderingContext.UNPACK_ALIGNMENT, 1);\n  setRawTexture3DParameters(gl);\n  gl.texImage3D(\n      WebGL2RenderingContext.TEXTURE_3D,\n      /*level=*/ 0, textureInternalFormat,\n      /*width=*/ width * texelsPerElement,\n      /*height=*/ height,\n      /*depth=*/ depth,\n      /*border=*/ 0, textureFormat, format.texelType, data);\n}\n\nfunction getShaderCodeForDataType(dataType: DataType): ShaderCodePart {\n  switch (dataType) {\n    case DataType.UINT8:\n      return glsl_uint8;\n    case DataType.UINT16:\n      return glsl_uint16;\n    case DataType.UINT32:\n      return glsl_uint32;\n    case DataType.UINT64:\n      return glsl_uint64;\n    case DataType.FLOAT32:\n      return glsl_float;\n  }\n}\n\nfunction getAccessorFunction(\n    functionName: string, readTextureValue: string, samplerName: string, indexType: string,\n    dataType: DataType, numComponents: number): ShaderCodePart[] {\n  const shaderType = getShaderType(dataType, numComponents);\n  let parts: ShaderCodePart[] = [getShaderCodeForDataType(dataType)];\n  let code = `\n${shaderType} ${functionName}(${indexType} index) {\n`;\n  switch (dataType) {\n    case DataType.UINT8:\n    case DataType.UINT16:\n    case DataType.UINT32:\n      code += `\n  ${shaderType} result;\n  highp uvec4 temp;\n  ${readTextureValue}(${samplerName}, index, temp);\n  result.value = temp.${textureSelectorForNumComponents[numComponents]};\n  return result;\n`;\n      break;\n    case DataType.UINT64:\n      parts.push(glsl_unpackUint64leFromUint32);\n      code += `\n  highp uvec4 temp;\n  ${readTextureValue}(${samplerName}, index, temp);\n  return unpackUint64leFromUint32(temp.${\n          textureSelectorForNumComponents[numComponents * 2]});\n`;\n      break;\n    case DataType.FLOAT32:\n      parts.push(glsl_float);\n      code += `\n  highp vec4 temp;\n  ${readTextureValue}(${samplerName}, index, temp);\n  return temp.${textureSelectorForNumComponents[numComponents]};\n`;\n      break;\n  }\n  code += `\n}\n`;\n  parts.push(code);\n  return parts;\n}\n\nexport class OneDimensionalTextureAccessHelper {\n  uniformName = `uTextureXBits_${this.key}`;\n  readTextureValue = `readTextureValue_${this.key}`;\n  constructor(public key: string) {}\n  defineShader(builder: ShaderBuilder) {\n    let {uniformName} = this;\n    builder.addUniform('highp uint', uniformName);\n  }\n\n  getReadTextureValueCode(texelsPerElement: number, samplerPrefix: ShaderSamplerPrefix) {\n    let {uniformName} = this;\n    let code = `\nvoid ${this.readTextureValue}(highp ${samplerPrefix}sampler2D sampler, highp uint index`;\n    for (let i = 0; i < texelsPerElement; ++i) {\n      code += `, out ${samplerPrefix}vec4 output${i}`;\n    }\n    code += `) {\n\n  highp int y = int(index >> ${uniformName});\n  highp int x = int((index - (uint(y) << ${uniformName})) * ${texelsPerElement}u);\n`;\n    for (let i = 0; i < texelsPerElement; ++i) {\n      code += `\n  output${i} = texelFetch(sampler, ivec2(x + ${i}, y), 0);\n`;\n    }\n    code += `\n}\n`;\n    return code;\n  }\n\n  getAccessor(\n      functionName: string, samplerName: string, dataType: DataType, numComponents: number = 1) {\n    const samplerPrefix = getSamplerPrefixForDataType(dataType);\n    return [\n      this.getReadTextureValueCode(1, samplerPrefix),\n      ...getAccessorFunction(\n          functionName, this.readTextureValue, samplerName, 'highp uint', dataType, numComponents)\n    ];\n  }\n\n  setupTextureLayout(gl: GL, shader: ShaderProgram, textureLayout: OneDimensionalTextureLayout) {\n    gl.uniform1ui(shader.uniform(this.uniformName), textureLayout.textureXBits);\n  }\n}\n\nexport class ThreeDimensionalTextureAccessHelper {\n  readTextureValue = `readTextureValue_${this.key}`;\n  constructor(public key: string) {}\n  getReadTextureValueCode(texelsPerElement: number, samplerPrefix: ShaderSamplerPrefix) {\n    let code = `\nvoid ${this.readTextureValue}(highp ${samplerPrefix}sampler3D sampler, highp ivec3 p`;\n    for (let i = 0; i < texelsPerElement; ++i) {\n      code += `, out ${samplerPrefix}vec4 output${i}`;\n    }\n    code += `) {\n`;\n    for (let i = 0; i < texelsPerElement; ++i) {\n      code += `\n  output${i} = texelFetch(sampler, ivec3(p.x * ${texelsPerElement} + ${i}, p.y, p.z), 0);\n`;\n    }\n    code += `\n}\n`;\n    return code;\n  }\n\n  getAccessor(\n      functionName: string, samplerName: string, dataType: DataType, numComponents: number = 1) {\n    const samplerPrefix = getSamplerPrefixForDataType(dataType);\n    return [\n      this.getReadTextureValueCode(1, samplerPrefix),\n      ...getAccessorFunction(\n          functionName, this.readTextureValue, samplerName, 'highp ivec3', dataType, numComponents)\n    ];\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nrequire('./status.css');\n\nlet statusContainer: HTMLElement|null = null;\n\nexport var DEFAULT_STATUS_DELAY = 200;\n\nexport type Delay = boolean | number;\n\nexport class StatusMessage {\n  element: HTMLElement;\n  private timer: number|null;\n  constructor(delay: Delay = false) {\n    if (statusContainer === null) {\n      statusContainer = document.createElement('ul');\n      statusContainer.id = 'statusContainer';\n      document.body.appendChild(statusContainer);\n    }\n    let element = document.createElement('li');\n    this.element = element;\n    if (delay === true) {\n      delay = DEFAULT_STATUS_DELAY;\n    }\n    if (delay !== false) {\n      this.setVisible(false);\n      this.timer = setTimeout(this.setVisible.bind(this, true), delay);\n    } else {\n      this.timer = null;\n    }\n    statusContainer.appendChild(element);\n  }\n  dispose() {\n    statusContainer!.removeChild(this.element);\n    this.element = <any>undefined;\n    if (this.timer !== null) {\n      clearTimeout(this.timer);\n    }\n  }\n  setText(text: string, makeVisible?: boolean) {\n    this.element.textContent = text;\n    if (makeVisible) {\n      this.setVisible(true);\n    }\n  }\n  setHTML(text: string, makeVisible?: boolean) {\n    this.element.innerHTML = text;\n    if (makeVisible) {\n      this.setVisible(true);\n    }\n  }\n  setVisible(value: boolean) {\n    if (this.timer !== null) {\n      clearTimeout(this.timer);\n      this.timer = null;\n    }\n    this.element.style.display = value ? 'block' : 'none';\n  }\n\n  static forPromise<T>(\n      promise: Promise<T>,\n      options: {initialMessage: string, delay?: Delay, errorPrefix: string}): Promise<T> {\n    let status = new StatusMessage(options.delay);\n    status.setText(options.initialMessage);\n    let dispose = status.dispose.bind(status);\n    promise.then(dispose, reason => {\n      let msg: string;\n      if (reason instanceof Error) {\n        msg = reason.message;\n      } else {\n        msg = '' + reason;\n      }\n      let {errorPrefix = ''} = options;\n      status.setErrorMessage(errorPrefix + msg);\n      status.setVisible(true);\n    });\n    return promise;\n  }\n\n  setErrorMessage(message: string) {\n    this.element.textContent = message + ' ';\n    let button = document.createElement('button');\n    button.textContent = 'Dismiss';\n    button.addEventListener('click', () => {\n      this.dispose();\n    });\n    this.element.appendChild(button);\n  }\n\n  static showMessage(message: string): StatusMessage {\n    const msg = new StatusMessage();\n    msg.element.textContent = message;\n    msg.setVisible(true);\n    return msg;\n  }\n\n  static showTemporaryMessage(message: string, closeAfter: number = 2000): StatusMessage {\n    const msg = this.showMessage(message);\n    setTimeout(() => msg.dispose(), closeAfter);\n    return msg;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {GL} from 'neuroglancer/webgl/context';\n\nconst DEBUG_SHADER = false;\n\nexport enum ShaderType {\n  VERTEX = WebGL2RenderingContext.VERTEX_SHADER,\n  FRAGMENT = WebGL2RenderingContext.FRAGMENT_SHADER\n}\n\nexport interface ShaderErrorMessage {\n  file?: number;\n  line?: number;\n  message: string;\n}\n\n/**\n * Parses the output of getShaderInfoLog into a list of messages.\n */\nexport function parseShaderErrors(log: string) {\n  log = log.replace('\\0', '');\n  let result: ShaderErrorMessage[] = [];\n  for (let line of log.split('\\n')) {\n    let m = line.match(/^ERROR:\\s*(\\d+):(\\d+)\\s*(.+)$/);\n    if (m !== null) {\n      result.push({message: m[3].trim(), file: parseInt(m[1], 10), line: parseInt(m[2], 10)});\n    } else {\n      m = line.match(/^ERROR:\\s*(.+)$/);\n      if (m !== null) {\n        result.push({message: m[1]});\n      } else {\n        line = line.trim();\n        if (line) {\n          result.push({message: line});\n        }\n      }\n    }\n  }\n  return result;\n}\n\nexport class ShaderCompilationError extends Error {\n  shaderType: ShaderType;\n  source: string;\n  log: string;\n  errorMessages: ShaderErrorMessage[];\n  constructor(\n      shaderType: ShaderType, source: string, log: string, errorMessages: ShaderErrorMessage[]) {\n    const message = `Error compiling ${ShaderType[shaderType].toLowerCase()} shader: ${log}`;\n    super(message);\n    this.name = 'ShaderCompilationError';\n    this.log = log;\n    this.message = message;\n    this.shaderType = shaderType;\n    this.source = source;\n    this.errorMessages = errorMessages;\n  }\n}\n\nexport class ShaderLinkError extends Error {\n  vertexSource: string;\n  fragmentSource: string;\n  log: string;\n  constructor(vertexSource: string, fragmentSource: string, log: string) {\n    const message = `Error linking shader: ${log}`;\n    super(message);\n    this.name = 'ShaderLinkError';\n    this.log = log;\n    this.message = message;\n    this.vertexSource = vertexSource;\n    this.fragmentSource = fragmentSource;\n  }\n}\n\nexport function getShader(gl: WebGL2RenderingContext, source: string, shaderType: ShaderType) {\n  var shader = gl.createShader(shaderType)!;\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    let log = gl.getShaderInfoLog(shader) || '';\n\n    if (DEBUG_SHADER) {\n      let lines = source.replace('<', '&lt;').replace('>', '&gt;').split('\\n');\n      let s = '<pre>';\n      s += log.replace('<', '&lt;').replace('>', '&gt;') + '\\n';\n      lines.forEach((line, i) => {\n        s += `${i + 1}: ${line}\\n`;\n      });\n      s += `\\n</pre>`;\n      let w = window.open('about:blank', '_blank');\n      if (w !== null) {\n        try {\n          w.document.write(s);\n        } catch (writeError) {\n        }\n      }\n    }\n\n    throw new ShaderCompilationError(shaderType, source, log, parseShaderErrors(log));\n  }\n\n  return shader!;\n}\n\nexport type AttributeIndex = number;\n\nexport class ShaderProgram extends RefCounted {\n  program: WebGLProgram;\n  vertexShader: WebGLShader;\n  fragmentShader: WebGLShader;\n  attributes = new Map<string, AttributeIndex>();\n  uniforms = new Map<string, WebGLUniformLocation|null>();\n  textureUnits: Map<any, number>;\n\n  constructor(\n      public gl: GL, public vertexSource: string, public fragmentSource: string,\n      uniformNames?: string[], attributeNames?: string[]) {\n    super();\n    let vertexShader = this.vertexShader = getShader(gl, vertexSource, gl.VERTEX_SHADER);\n    let fragmentShader = this.fragmentShader = getShader(gl, fragmentSource, gl.FRAGMENT_SHADER);\n\n    let shaderProgram = gl.createProgram()!;\n    gl.attachShader(shaderProgram, vertexShader);\n    gl.attachShader(shaderProgram, fragmentShader);\n    gl.linkProgram(shaderProgram);\n    if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\n      let log = gl.getProgramInfoLog(shaderProgram) || '';\n\n      // DEBUG\n      // {\n      //   let combinedSource = 'VERTEX SHADER\\n\\n' + vertexSource + '\\n\\n\\nFRAGMENT SHADER\\n\\n' +\n      //   fragmentSource + '\\n';\n      //   let w = window.open(\"about:blank\", \"_blank\");\n      //   w.document.write('<pre>' + combinedSource.replace('<', '&lt;').replace('>', '&gt;') +\n      //   '</pre>');\n      // }\n\n      throw new ShaderLinkError(vertexSource, fragmentSource, log);\n    }\n    this.program = shaderProgram!;\n\n    let {uniforms, attributes} = this;\n    if (uniformNames) {\n      for (let name of uniformNames) {\n        uniforms.set(name, gl.getUniformLocation(shaderProgram, name));\n      }\n    }\n\n    if (attributeNames) {\n      for (let name of attributeNames) {\n        attributes.set(name, gl.getAttribLocation(shaderProgram, name));\n      }\n    }\n  }\n\n  uniform(name: string): WebGLUniformLocation {\n    return this.uniforms.get(name)!;\n  }\n\n  attribute(name: string): number {\n    return this.attributes.get(name)!;\n  }\n\n  textureUnit(symbol: Symbol): number {\n    return this.textureUnits.get(symbol)!;\n  }\n\n  bind() {\n    this.gl.useProgram(this.program);\n  }\n\n  disposed() {\n    let {gl} = this;\n    gl.deleteShader(this.vertexShader);\n    this.vertexShader = <any>undefined;\n    gl.deleteShader(this.fragmentShader);\n    this.fragmentShader = <any>undefined;\n    gl.deleteProgram(this.program);\n    this.program = <any>undefined;\n    this.gl = <any>undefined;\n    this.attributes = <any>undefined;\n    this.uniforms = <any>undefined;\n  }\n}\n\nexport type ShaderCodePart = string|ShaderCodePartArray|ShaderCodePartFunction;\ninterface ShaderCodePartFunction {\n  (): ShaderCodePart;\n}\ninterface ShaderCodePartArray extends Array<ShaderCodePart> {}\n\nexport class ShaderCode {\n  code = '';\n  parts = new Set<ShaderCodePart>();\n  constructor() {}\n\n  add(x: ShaderCodePart) {\n    if (this.parts.has(x)) {\n      return;\n    }\n    this.parts.add(x);\n    switch (typeof x) {\n      case 'string':\n        this.code += x;\n        break;\n      case 'function':\n        this.add((<ShaderCodePartFunction>x)());\n        break;\n      default:\n        if (Array.isArray(x)) {\n          for (let y of x) {\n            this.add(y);\n          }\n        } else {\n          console.log('Invalid code type', x);\n          throw new Error('Invalid code type');\n        }\n    }\n  }\n\n  toString(): string {\n    return this.code;\n  }\n}\n\nexport type ShaderInitializer = ((x: ShaderProgram) => void);\nexport type ShaderModule = ((x: ShaderBuilder) => void);\n\nexport type ShaderSamplerPrefix = 'i'|'u'|'';\n\nexport type ShaderSamplerType =\n    'sampler2D'|'usampler2D'|'isampler2D'|'sampler3D'|'usampler3D'|'isampler3D';\n\nexport type ShaderInterpolationMode =\n    ''|'centroid'|'flat centroid'|'smooth centroid'|'flat'|'smooth';\n\nexport const textureTargetForSamplerType = {\n  'sampler2D': WebGL2RenderingContext.TEXTURE_2D,\n  'isampler2D': WebGL2RenderingContext.TEXTURE_2D,\n  'usampler2D': WebGL2RenderingContext.TEXTURE_2D,\n  'sampler3D': WebGL2RenderingContext.TEXTURE_3D,\n  'isampler3D': WebGL2RenderingContext.TEXTURE_3D,\n  'usampler3D': WebGL2RenderingContext.TEXTURE_3D,\n};\n\nexport class ShaderBuilder {\n  private nextSymbolID = 0;\n  private nextTextureUnit = 0;\n  private uniformsCode = '';\n  private attributesCode = '';\n  private varyingsCodeVS = '';\n  private varyingsCodeFS = '';\n  private fragmentExtensionsSet = new Set<string>();\n  private fragmentExtensions = '';\n  private vertexCode = new ShaderCode();\n  private vertexMain = '';\n  private fragmentCode = new ShaderCode();\n  private outputBufferCode = '';\n  private fragmentMain = '';\n  private required = new Set<ShaderModule>();\n  private uniforms = new Array<string>();\n  private attributes = new Array<string>();\n  private initializers: Array<ShaderInitializer> = [];\n  private textureUnits = new Map<Symbol, number>();\n  constructor(public gl: GL) {}\n\n  allocateTextureUnit(symbol: Symbol, count: number = 1) {\n    if (this.textureUnits.has(symbol)) {\n      throw new Error('Duplicate texture unit symbol: ' + symbol);\n    }\n    let old = this.nextTextureUnit;\n    this.nextTextureUnit += count;\n    this.textureUnits.set(symbol, old);\n    return old;\n  }\n\n  addTextureSampler(samplerType: ShaderSamplerType, name: string, symbol: Symbol, extent?: number) {\n    let textureUnit = this.allocateTextureUnit(symbol, extent);\n    this.addUniform(`highp ${samplerType}`, name, extent);\n    this.addInitializer(shader => {\n      if (extent) {\n        let textureUnits = new Int32Array(extent);\n        for (let i = 0; i < extent; ++i) {\n          textureUnits[i] = i + textureUnit;\n        }\n        shader.gl.uniform1iv(shader.uniform(name), textureUnits);\n      } else {\n        shader.gl.uniform1i(shader.uniform(name), textureUnit);\n      }\n    });\n    return textureUnit;\n  }\n\n  symbol(name: string) {\n    return name + (this.nextSymbolID++);\n  }\n\n  addAttribute(typeName: string, name: string) {\n    this.attributes.push(name);\n    this.attributesCode += `in ${typeName} ${name};\\n`;\n    return name;\n  }\n\n  addVarying(typeName: string, name: string, interpolationMode: ShaderInterpolationMode = '') {\n    this.varyingsCodeVS += `${interpolationMode} out ${typeName} ${name};\\n`;\n    this.varyingsCodeFS += `${interpolationMode} in ${typeName} ${name};\\n`;\n  }\n\n  addOutputBuffer(typeName: string, name: string, location: number|null) {\n    if (location !== null) {\n      this.outputBufferCode += `layout(location = ${location}) `;\n    }\n    this.outputBufferCode += `out ${typeName} ${name};\\n`;\n  }\n\n  addUniform(typeName: string, name: string, extent?: number) {\n    this.uniforms.push(name);\n    if (extent != null) {\n      this.uniformsCode += `uniform ${typeName} ${name}[${extent}];\\n`;\n    } else {\n      this.uniformsCode += `uniform ${typeName} ${name};\\n`;\n    }\n    return name;\n  }\n\n  addFragmentExtension(name: string) {\n    if (this.fragmentExtensionsSet.has(name)) {\n      return;\n    }\n    this.fragmentExtensionsSet.add(name);\n    this.fragmentExtensions += `#extension ${name} : require\\n`;\n  }\n\n  addVertexCode(code: ShaderCodePart) {\n    this.vertexCode.add(code);\n  }\n\n  addFragmentCode(code: ShaderCodePart) {\n    this.fragmentCode.add(code);\n  }\n\n  setVertexMain(code: string) {\n    this.vertexMain = code;\n  }\n  addVertexMain(code: string) {\n    this.vertexMain = (this.vertexMain || '') + code;\n  }\n\n  setFragmentMain(code: string) {\n    this.fragmentMain = `void main() {\n${code}\n}\n`;\n  }\n  setFragmentMainFunction(code: string) {\n    this.fragmentMain = code;\n  }\n\n  addInitializer(f: ShaderInitializer) {\n    this.initializers.push(f);\n  }\n\n  require(f: ShaderModule): void {\n    if (this.required.has(f)) {\n      return;\n    }\n    this.required.add(f);\n    f(this);\n  }\n\n  build() {\n    let vertexSource = `#version 300 es\nprecision highp float;\nprecision highp int;\n${this.uniformsCode}\n${this.attributesCode}\n${this.varyingsCodeVS}\n${this.vertexCode}\nvoid main() {\n${this.vertexMain}\n}\n`;\n    let fragmentSource = `#version 300 es\n${this.fragmentExtensions}\nprecision highp float;\nprecision highp int;\n${this.uniformsCode}\n${this.varyingsCodeFS}\n${this.outputBufferCode}\n${this.fragmentCode}\n${this.fragmentMain}\n`;\n    let shader =\n        new ShaderProgram(this.gl, vertexSource, fragmentSource, this.uniforms, this.attributes);\n    shader.textureUnits = this.textureUnits;\n    let {initializers} = this;\n    if (initializers.length > 0) {\n      shader.bind();\n      for (let initializer of initializers) {\n        initializer(shader);\n      }\n    }\n    return shader;\n  }\n}\n\nexport function shaderContainsIdentifiers(code: string, identifiers: Iterable<string>) {\n  let found = new Set<string>();\n  for (let identifier of identifiers) {\n    let pattern = new RegExp(`(?:^|[^a-zA-Z0-9_])${identifier}[^a-zA-Z0-9_])`);\n    if (code.match(pattern) !== null) {\n      found.add(identifier);\n    }\n  }\n  return found;\n}\n\nexport function emitterDependentShaderGetter(\n    refCounted: RefCounted, gl: GL,\n    defineShader: (builder: ShaderBuilder) => void): ((emitter: ShaderModule) => ShaderProgram) {\n  const shaders = new Map<ShaderModule, ShaderProgram>();\n  function getter(emitter: ShaderModule) {\n    let shader = shaders.get(emitter);\n    if (shader === undefined) {\n      const builder = new ShaderBuilder(gl);\n      builder.require(emitter);\n      defineShader(builder);\n      shader = refCounted.registerDisposer(builder.build());\n      shaders.set(emitter, shader);\n    }\n    return shader;\n  }\n  return getter;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CancellationToken, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nexport class HttpError extends Error {\n  url: string;\n  status: number;\n  statusText: string;\n\n  constructor(url: string, status: number, statusText: string) {\n    let message = `Fetching ${JSON.stringify(url)} resulted in HTTP error ${status}`;\n    if (statusText) {\n      message += `: ${statusText}`;\n    }\n    message += '.';\n    super(message);\n    this.name = 'HttpError';\n    this.message = message;\n    this.url = url;\n    this.status = status;\n    this.statusText = statusText;\n  }\n\n  static fromResponse(response: Response) {\n    return new HttpError(response.url, response.status, response.statusText);\n  }\n}\n\n/**\n * Issues a `fetch` request.\n *\n * If the request fails due to an HTTP status outside `[200, 300)`, throws an `HttpError`.  If the\n * request fails due to a network or CORS restriction, throws an `HttpError` with a `status` of `0`.\n */\nexport async function fetchOk(input: RequestInfo, init?: RequestInit): Promise<Response> {\n  let response: Response;\n  try {\n    response = await fetch(input, init);\n  } catch (error) {\n    if (error instanceof TypeError) {\n      throw new HttpError('', 0, '');\n    }\n    throw error;\n  }\n  if (!response.ok) throw HttpError.fromResponse(response);\n  return response;\n}\n\nexport function responseArrayBuffer(response: Response): Promise<ArrayBuffer> {\n  return response.arrayBuffer();\n}\n\nexport function responseJson(response: Response): Promise<any> {\n  return response.json();\n}\n\nexport type ResponseTransform<T> = (response: Response) => Promise<T>;\n\n/**\n * Issues a `fetch` request in the same way as `fetchOk`, and returns the result of the promise\n * returned by `transformResponse`.\n *\n * Additionally, the request may be cancelled through `cancellationToken`.\n *\n * The `transformResponse` function should not do anything with the `Response` object after its\n * result becomes ready; otherwise, cancellation may not work as expected.\n */\nexport async function cancellableFetchOk<T>(\n    input: RequestInfo, init: RequestInit, transformResponse: ResponseTransform<T>,\n    cancellationToken: CancellationToken = uncancelableToken): Promise<T> {\n  if (cancellationToken === uncancelableToken) {\n    const response = await fetchOk(input, init);\n    return await transformResponse(response);\n  }\n  const abortController = new AbortController();\n  const unregisterCancellation = cancellationToken.add(() => abortController.abort());\n  try {\n    const response = await fetchOk(input, init);\n    return await transformResponse(response);\n  } finally {\n    unregisterCancellation();\n  }\n}\n\nconst tempUint64 = new Uint64();\n\nexport function getByteRangeHeader(startOffset: Uint64|number, endOffset: Uint64|number) {\n  let endOffsetStr: string;\n  if (typeof endOffset === 'number') {\n    endOffsetStr = `${endOffset - 1}`;\n  } else {\n    Uint64.decrement(tempUint64, endOffset);\n    endOffsetStr = tempUint64.toString();\n  }\n  return {'Range': `bytes=${startOffset}-${endOffsetStr}`};\n}\n\n/**\n * Parses a URL that may have a special protocol designation into a real URL.\n *\n * If the protocol is 'http' or 'https', the input string is returned as is.\n *\n * The special 'gs://bucket/path' syntax is supported for accessing Google Storage buckets.\n */\nexport function parseSpecialUrl(url: string): string {\n  const urlProtocolPattern = /^([^:\\/]+):\\/\\/([^\\/]+)(\\/.*)?$/;\n  let match = url.match(urlProtocolPattern);\n  if (match === null) {\n    throw new Error(`Invalid URL: ${JSON.stringify(url)}`);\n  }\n  const protocol = match[1];\n  if (protocol === 'gs') {\n    const bucket = match[2];\n    let path = match[3];\n    if (path === undefined) path = '';\n    return `https://storage.googleapis.com/${bucket}${path}`;\n  }\n  return url;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SharedWatchableValue} from 'neuroglancer/shared_watchable_value';\nimport {WatchableValue} from 'neuroglancer/trackable_value';\nimport {RPC} from 'neuroglancer/worker_rpc';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\n/**\n * Numeric value specifying a visibility or prefetch priority.\n *\n * A value of `Number.POSITIVE_INFINITY` means visible.\n *\n * Any other finite value means not visible, and specifies the prefetch priority (higher means\n * higher priority); this should always be a small integer.\n *\n * A value of `Number.NEGATIVE_INFINITY` means ignored (not visible, and not prefetched).\n */\nexport type VisibilityPriority = number;\n\nexport class WatchableVisibilityPriority extends WatchableValue<VisibilityPriority> {\n  constructor(value = Number.NEGATIVE_INFINITY) {\n    super(value);\n  }\n\n  static VISIBLE = Number.POSITIVE_INFINITY;\n  static IGNORED = Number.NEGATIVE_INFINITY;\n  get visible() {\n    return this.value === Number.POSITIVE_INFINITY;\n  }\n\n  get ignored() {\n    return this.value === Number.NEGATIVE_INFINITY;\n  }\n}\n\nexport interface VisibilityPrioritySpecification { visibility: WatchableVisibilityPriority; }\n\n/**\n * Maintains the maximum value of multiple WatchableVisibilityPriority values.\n */\nexport class VisibilityPriorityAggregator extends WatchableVisibilityPriority {\n  private contributors = new Map<() => void, WatchableVisibilityPriority>();\n\n  /**\n   * Registers `x` to be included in the set of values to be aggregated.\n   *\n   * @returns A disposer function that unregisters the specified value.\n   */\n  add(x: WatchableVisibilityPriority) {\n    const {contributors} = this;\n    const changedDisposer = x.changed.add(() => {\n      this.update();\n    });\n    const disposer = () => {\n      contributors.delete(disposer);\n      changedDisposer();\n      this.update();\n    };\n    contributors.set(disposer, x);\n    this.update();\n    return disposer;\n  }\n\n  private update() {\n    let priority = Number.NEGATIVE_INFINITY;\n    for (const x of this.contributors.values()) {\n      priority = Math.max(priority, x.value);\n    }\n    this.value = priority;\n  }\n}\n\n/**\n * Mixin that adds a `visibility` property which is shared with the counterpart.\n */\nexport function withSharedVisibility<T extends{new (...args: any[]): SharedObject}>(Base: T) {\n  return class extends Base {\n    visibility = new VisibilityPriorityAggregator();\n\n    initializeCounterpart(rpc: RPC, options: any = {}) {\n      // Backend doesn't need to own a reference to SharedWatchableValue because frontend, which is\n      // the owner of this SharedObject, owns a reference.\n      options['visibility'] =\n          this.registerDisposer(SharedWatchableValue.makeFromExisting(rpc, this.visibility)).rpcId;\n      super.initializeCounterpart(rpc, options);\n    }\n  };\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DataType} from 'neuroglancer/util/data_type';\n\n// Hue, saturation, and value are in [0, 1] range.\nexport var glsl_hsvToRgb = `\nvec3 hueToRgb(float hue) {\n  float hue6 = hue * 6.0;\n  float r = abs(hue6 - 3.0) - 1.0;\n  float g = 2.0 - abs(hue6 - 2.0);\n  float b = 2.0 - abs(hue6 - 4.0);\n  return clamp(vec3(r, g, b), 0.0, 1.0);\n}\nvec3 hsvToRgb(vec3 c) {\n  vec3 hueRgb = hueToRgb(c.x);\n  return c.z * ((hueRgb - 1.0) * c.y + 1.0);\n}\n`;\n\nexport const glsl_uint64 = `\nstruct uint64_t {\n  highp uvec2 value;\n};\nstruct uint64x2_t {\n  highp uvec4 value;\n};\nuint64_t toUint64(uint64_t x) { return x; }\n`;\n\nexport const glsl_unpackUint64leFromUint32 = [\n  glsl_uint64, `\nuint64_t unpackUint64leFromUint32(highp uvec2 x) {\n  uint64_t result;\n  result.value = x;\n  return result;\n}\nuint64x2_t unpackUint64leFromUint32(highp uvec4 x) {\n  uint64x2_t result;\n  result.value = x;\n  return result;\n}\n`];\n\nexport const glsl_equalUint64 = [\n  glsl_uint64, `\nbool equals(uint64_t a, uint64_t b) {\n  return a.value == b.value;\n}\n`\n];\n\nexport const glsl_uint8 = [\n  glsl_uint64, `\nstruct uint8_t {\n  highp uint value;\n};\nstruct uint8x2_t {\n  highp uvec2 value;\n};\nstruct uint8x3_t {\n  highp uvec3 value;\n};\nstruct uint8x4_t {\n  highp uvec4 value;\n};\nhighp uint toRaw(uint8_t x) { return x.value; }\nhighp float toNormalized(uint8_t x) { return float(x.value) / 255.0; }\nhighp uvec2 toRaw(uint8x2_t x) { return x.value; }\nhighp vec2 toNormalized(uint8x2_t x) { return vec2(x.value) / 255.0; }\nhighp uvec3 toRaw(uint8x3_t x) { return x.value; }\nvec3 toNormalized(uint8x3_t x) { return vec3(x.value) / 255.0; }\nhighp uvec4 toRaw(uint8x4_t x) { return x.value; }\nvec4 toNormalized(uint8x4_t x) { return vec4(x.value) / 255.0; }\nuint64_t toUint64(uint8_t x) {\n  uint64_t result;\n  result.value[0] = x.value;\n  result.value[1] = 0u;\n  return result;\n}\n`\n];\n\nexport const glsl_float = `\nfloat toRaw(float x) { return x; }\nfloat toNormalized(float x) { return x; }\nvec2 toRaw(vec2 x) { return x; }\nvec2 toNormalized(vec2 x) { return x; }\nvec3 toRaw(vec3 x) { return x; }\nvec3 toNormalized(vec3 x) { return x; }\nvec4 toRaw(vec4 x) { return x; }\nvec4 toNormalized(vec4 x) { return x; }\n`;\n\nexport const glsl_uint16 = [\n  glsl_uint64, `\nstruct uint16_t {\n  highp uint value;\n};\nstruct uint16x2_t {\n  highp uvec2 value;\n};\nhighp uint toRaw(uint16_t x) { return x.value; }\nhighp float toNormalized(uint16_t x) { return float(toRaw(x)) / 65535.0; }\nhighp uvec2 toRaw(uint16x2_t x) { return x.value; }\nhighp vec2 toNormalized(uint16x2_t x) { return vec2(toRaw(x)) / 65535.0; }\nuint64_t toUint64(uint16_t x) {\n  uint64_t result;\n  result.value[0] = x.value;\n  result.value[1] = 0u;\n  return result;\n}\n`\n];\n\nexport const glsl_uint32 = [\n  glsl_uint64, `\nstruct uint32_t {\n  highp uint value;\n};\nhighp float toNormalized(uint32_t x) { return float(x.value) / 4294967295.0; }\nhighp uint toRaw(uint32_t x) { return x.value; }\nuint64_t toUint64(uint32_t x) {\n  uint64_t result;\n  result.value[0] = x.value;\n  result.value[1] = 0u;\n  return result;\n}\n`\n];\n\nexport var glsl_getFortranOrderIndex = `\nhighp int getFortranOrderIndex(ivec3 subscripts, ivec3 size) {\n  return subscripts.x + size.x * (subscripts.y + size.y * subscripts.z);\n}\n`;\n\nexport function getShaderType(dataType: DataType, numComponents: number = 1) {\n  switch (dataType) {\n    case DataType.FLOAT32:\n      if (numComponents === 1) {\n        return 'float';\n      }\n      if (numComponents > 1 && numComponents <= 4) {\n        return `vec${numComponents}`;\n      }\n      break;\n    case DataType.UINT8:\n      if (numComponents === 1) {\n        return 'uint8_t';\n      }\n      if (numComponents > 1 && numComponents <= 4) {\n        return `uint8x${numComponents}_t`;\n      }\n      break;\n    case DataType.UINT16:\n      if (numComponents === 1) {\n        return 'uint16_t';\n      }\n      if (numComponents === 2) {\n        return `uint16x2_t`;\n      }\n      break;\n    case DataType.UINT32:\n      if (numComponents === 1) {\n        return 'uint32_t';\n      }\n      break;\n    case DataType.UINT64:\n      if (numComponents === 1) {\n        return 'uint64_t';\n      }\n      break;\n  }\n  throw new Error(`No shader type for ${DataType[dataType]}[${numComponents}].`);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {identityMat4, mat4, transformVectorByMat4, vec3} from 'neuroglancer/util/geom';\n\nexport class ChunkLayout {\n  /**\n   * Size of each chunk in local spatial coordinates.\n   */\n  size: vec3;\n\n  /**\n   * Transform from local spatial coordinates to global coordinates (nm).\n   */\n  transform: mat4;\n\n  /**\n   * Inverse of transform.  Transform from global spatial coordinates to local spatial coordinates.\n   */\n  invTransform: mat4;\n\n  constructor(size: vec3, transform: mat4 = identityMat4) {\n    this.size = vec3.clone(size);\n    this.transform = mat4.clone(transform);\n    this.invTransform = mat4.invert(mat4.create(), transform)!;\n  }\n  static cache = new Map<string, ChunkLayout>();\n  toObject(msg: any) {\n    msg['size'] = this.size;\n    msg['transform'] = this.transform;\n  }\n\n  static get(size: vec3, transform = identityMat4) {\n    let cache = ChunkLayout.cache;\n    const key = JSON.stringify([Array.from(size), Array.from(transform)]);\n    let obj = cache.get(key);\n    if (obj === undefined) {\n      obj = new ChunkLayout(size, transform);\n      cache.set(key, obj);\n    }\n    return obj;\n  }\n\n  static fromObject(msg: any) {\n    return ChunkLayout.get(msg['size'], msg['transform']);\n  }\n\n  /**\n   * Transform local spatial coordinates to global spatial coordinates.\n   */\n  localSpatialToGlobal(out: vec3, localSpatial: vec3): vec3 {\n    return vec3.transformMat4(out, localSpatial, this.transform);\n  }\n\n  /**\n   * Transform global spatial coordinates to local spatial coordinates.\n   */\n  globalToLocalSpatial(out: vec3, globalSpatial: vec3): vec3 {\n    return vec3.transformMat4(out, globalSpatial, this.invTransform);\n  }\n\n  globalToLocalGrid(out: vec3, globalSpatial: vec3): vec3 {\n    this.globalToLocalSpatial(out, globalSpatial);\n    vec3.divide(out, out, this.size);\n    return out;\n  }\n\n  localSpatialVectorToGlobal(out: vec3, localVector: vec3): vec3 {\n    return transformVectorByMat4(out, localVector, this.transform);\n  }\n\n  globalToLocalSpatialVector(out: vec3, globalVector: vec3): vec3 {\n    return transformVectorByMat4(out, globalVector, this.invTransform);\n  }\n\n  assignLocalSpatialToGlobalMat4(out: mat4): mat4 {\n    return mat4.copy(out, this.transform);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {ChunkLayout} from 'neuroglancer/sliceview/chunk_layout';\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {partitionArray} from 'neuroglancer/util/array';\nimport {approxEqual} from 'neuroglancer/util/compare';\nimport {DATA_TYPE_BYTES, DataType} from 'neuroglancer/util/data_type';\nimport {effectiveScalingFactorFromMat4, identityMat4, kAxes, kInfinityVec, kZeroVec, mat4, rectifyTransformMatrixIfAxisAligned, transformVectorByMat4, vec3} from 'neuroglancer/util/geom';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\nexport {DATA_TYPE_BYTES, DataType};\n\nconst DEBUG_CHUNK_INTERSECTIONS = false;\nconst DEBUG_VISIBLE_SOURCES = false;\n\nconst tempVec3 = vec3.create();\n\n/**\n * Average cross-sectional area contained within a chunk of the specified size and rotation.\n *\n * This is estimated by taking the total volume of the chunk and dividing it by the total length of\n * the chunk along the z axis.\n */\nfunction estimateSliceAreaPerChunk(zAxis: vec3, chunkLayout: ChunkLayout) {\n  const chunkSize = chunkLayout.size;\n  const zAxisRotated = chunkLayout.globalToLocalSpatialVector(tempVec3, zAxis);\n\n  // Minimum and maximum dot product of zAxisRotated with each of the corners of the chunk.  Both\n  // are initialized to 0 because the origin of the chunk has a projection of 0.\n  let minProjection = 0, maxProjection = 0;\n  let chunkVolume = 1;\n  for (let i = 0; i < 3; ++i) {\n    const chunkSizeValue = chunkSize[i];\n    chunkVolume *= chunkSizeValue;\n    const projection = chunkSizeValue * zAxisRotated[i];\n    minProjection = Math.min(minProjection, projection);\n    maxProjection = Math.max(maxProjection, projection);\n  }\n  const projectionLength = maxProjection - minProjection;\n  return chunkVolume / projectionLength;\n}\n\n/**\n * All valid chunks are in the range [lowerBound, upperBound).\n *\n * @param lowerBound Output parameter for lowerBound.\n * @param upperBound Output parameter for upperBound.\n * @param sources Sources for which to compute the chunk bounds.\n */\nfunction computeSourcesChunkBounds(\n    sourcesLowerBound: vec3, sourcesUpperBound: vec3, sources: Iterable<SliceViewChunkSource>) {\n  for (let i = 0; i < 3; ++i) {\n    sourcesLowerBound[i] = Number.POSITIVE_INFINITY;\n    sourcesUpperBound[i] = Number.NEGATIVE_INFINITY;\n  }\n\n  for (let source of sources) {\n    let {spec} = source;\n    let {lowerChunkBound, upperChunkBound} = spec;\n    for (let i = 0; i < 3; ++i) {\n      sourcesLowerBound[i] = Math.min(sourcesLowerBound[i], lowerChunkBound[i]);\n      sourcesUpperBound[i] = Math.max(sourcesUpperBound[i], upperChunkBound[i]);\n    }\n  }\n}\n\nenum BoundsComparisonResult {\n  // Needle is fully outside haystack.\n  FULLY_OUTSIDE,\n  // Needle is fully inside haystack.\n  FULLY_INSIDE,\n  // Needle is partially inside haystack.\n  PARTIALLY_INSIDE\n}\n\nfunction compareBoundsSingleDimension(\n    needleLower: number, needleUpper: number, haystackLower: number, haystackUpper: number) {\n  if (needleLower >= haystackUpper || needleUpper <= haystackLower) {\n    return BoundsComparisonResult.FULLY_OUTSIDE;\n  }\n  if (needleLower >= haystackLower && needleUpper <= haystackUpper) {\n    return BoundsComparisonResult.FULLY_INSIDE;\n  }\n  return BoundsComparisonResult.PARTIALLY_INSIDE;\n}\n\nfunction compareBounds(\n    needleLowerBound: vec3, needleUpperBound: vec3, haystackLowerBound: vec3,\n    haystackUpperBound: vec3) {\n  let curResult = BoundsComparisonResult.FULLY_INSIDE;\n  for (let i = 0; i < 3; ++i) {\n    let newResult = compareBoundsSingleDimension(\n        needleLowerBound[i], needleUpperBound[i], haystackLowerBound[i], haystackUpperBound[i]);\n    switch (newResult) {\n      case BoundsComparisonResult.FULLY_OUTSIDE:\n        return newResult;\n      case BoundsComparisonResult.PARTIALLY_INSIDE:\n        curResult = newResult;\n        break;\n    }\n  }\n  return curResult;\n}\n\nexport interface TransformedSource<Source extends SliceViewChunkSource = SliceViewChunkSource> {\n  source: Source;\n  chunkLayout: ChunkLayout;\n  voxelSize: vec3;\n}\n\nexport interface RenderLayer<Source extends SliceViewChunkSource> {\n  sources: Source[][];\n  transform: CoordinateTransform;\n  transformedSources: TransformedSource<Source>[][]|undefined;\n  transformedSourcesGeneration: number;\n  renderScaleTarget: WatchableValueInterface<number>;\n}\n\nexport function getTransformedSources<Source extends SliceViewChunkSource>(\n    renderLayer: RenderLayer<Source>) {\n  const {transform} = renderLayer;\n  let {transformedSources} = renderLayer;\n  const generation = transform.changed.count;\n  if (generation !== renderLayer.transformedSourcesGeneration) {\n    renderLayer.transformedSourcesGeneration = generation;\n    if (mat4.equals(transform.transform, identityMat4)) {\n      transformedSources = renderLayer.sources.map(\n          alternatives => alternatives.map(source => ({\n                                             source,\n                                             chunkLayout: source.spec.chunkLayout,\n                                             voxelSize: source.spec.voxelSize\n                                           })));\n    } else {\n      transformedSources = renderLayer.sources.map(alternatives => alternatives.map(source => {\n        const chunkLayout = source.spec.chunkLayout;\n        const transformedChunkLayout = ChunkLayout.get(\n            chunkLayout.size, getCombinedTransform(chunkLayout.transform, transform));\n        return {\n          chunkLayout: transformedChunkLayout,\n          source,\n          voxelSize: transformedChunkLayout.localSpatialVectorToGlobal(\n              vec3.create(), source.spec.voxelSize),\n        };\n      }));\n    }\n    renderLayer.transformedSources = transformedSources;\n  }\n  return transformedSources!;\n}\n\nfunction pickBestAlternativeSource<Source extends SliceViewChunkSource>(\n    zAxis: vec3, alternatives: TransformedSource<Source>[]) {\n  let numAlternatives = alternatives.length;\n  let bestAlternativeIndex = 0;\n  if (DEBUG_VISIBLE_SOURCES) {\n    console.log(alternatives);\n  }\n  if (numAlternatives > 1) {\n    let bestSliceArea = 0;\n    for (let alternativeIndex = 0; alternativeIndex < numAlternatives; ++alternativeIndex) {\n      let alternative = alternatives[alternativeIndex];\n      const {chunkLayout} = alternative;\n      let sliceArea = estimateSliceAreaPerChunk(zAxis, chunkLayout);\n      if (DEBUG_VISIBLE_SOURCES) {\n        console.log(`zAxis = ${zAxis}, chunksize = ${chunkLayout.size}, sliceArea = ${sliceArea}`);\n      }\n      if (sliceArea > bestSliceArea) {\n        bestSliceArea = sliceArea;\n        bestAlternativeIndex = alternativeIndex;\n      }\n    }\n  }\n  return alternatives[bestAlternativeIndex];\n}\n\nconst tempCorners = [vec3.create(), vec3.create(), vec3.create(), vec3.create()];\n\nexport class SliceViewBase<Source extends SliceViewChunkSource,\n                                          RLayer extends RenderLayer<Source>> extends SharedObject {\n  width = -1;\n  height = -1;\n  hasViewportToData = false;\n  /**\n   * Specifies whether width, height, and viewportToData are valid.\n   */\n  hasValidViewport = false;\n\n  // Transforms (x,y) viewport coordinates in the range:\n  //\n  // x=[left: -width/2, right: width/2] and\n  //\n  // y=[top: -height/2, bottom: height/2],\n  //\n  // to data coordinates.\n  viewportToData = mat4.create();\n\n  // Normalized x, y, and z viewport axes in data coordinate space.\n  viewportAxes = [vec3.create(), vec3.create(), vec3.create()];\n\n  // Viewport axes used for selecting visible sources.\n  previousViewportAxes = [vec3.create(), vec3.create()];\n\n  centerDataPosition = vec3.create();\n\n  viewportPlaneDistanceToOrigin: number = 0;\n\n  /**\n   * For each visible ChunkLayout, maps each visible GenericVolumeChunkSource to its priority index.\n   * Overall chunk priority ordering is based on a lexicographical ordering of (priorityIndex,\n   * -distanceToCenter).\n   */\n  visibleChunkLayouts = new Map<ChunkLayout, Map<Source, number>>();\n\n  visibleLayers = new Map<RLayer, TransformedSource<Source>[]>();\n\n  visibleSourcesStale = true;\n\n  /**\n   * Size in spatial units (nm) of a single pixel.\n   */\n  pixelSize: number = 0;\n\n  constructor() {\n    super();\n    mat4.identity(this.viewportToData);\n  }\n\n  /**\n   * Called when hasValidViewport == true and the viewport width/height or data transform matrix\n   * changes.\n   */\n  onViewportChanged() {}\n  maybeSetHasValidViewport() {\n    if (!this.hasValidViewport && this.width !== -1 && this.height !== -1 &&\n        this.hasViewportToData) {\n      this.hasValidViewport = true;\n      this.onHasValidViewport();\n    }\n    if (this.hasValidViewport) {\n      this.onViewportChanged();\n    }\n  }\n  onHasValidViewport() {}\n  setViewportSize(width: number, height: number) {\n    if (width !== this.width || height !== this.height) {\n      this.width = width;\n      this.height = height;\n      this.maybeSetHasValidViewport();\n      return true;\n    }\n    return false;\n  }\n  setViewportToDataMatrix(mat: mat4) {\n    if (this.hasViewportToData && mat4.equals(this.viewportToData, mat)) {\n      return false;\n    }\n\n    this.hasViewportToData = true;\n\n    let {viewportToData} = this;\n    mat4.copy(viewportToData, mat);\n    rectifyTransformMatrixIfAxisAligned(viewportToData);\n    vec3.transformMat4(this.centerDataPosition, kZeroVec, mat);\n\n    // Initialize to zero to avoid confusing TypeScript compiler.\n    let newPixelSize = 0;\n\n    // Swap previousViewportAxes with viewportAxes.\n    let viewportAxes = this.viewportAxes;\n    let previousViewportAxes = this.previousViewportAxes;\n\n    // Compute axes.\n    for (var i = 0; i < 3; ++i) {\n      let a = viewportAxes[i];\n      transformVectorByMat4(a, kAxes[i], viewportToData);\n      // a[3] is guaranteed to be 0.\n      if (i === 0) {\n        newPixelSize = vec3.length(a);\n      }\n      vec3.normalize(a, a);\n    }\n\n    this.viewportAxes = viewportAxes;\n    this.previousViewportAxes = previousViewportAxes;\n\n    if (!approxEqual(newPixelSize, this.pixelSize) ||\n        (vec3.dot(viewportAxes[0], previousViewportAxes[0]) < 0.95) ||\n        (vec3.dot(viewportAxes[1], previousViewportAxes[1]) < 0.95)) {\n      vec3.copy(previousViewportAxes[0], viewportAxes[0]);\n      vec3.copy(previousViewportAxes[1], viewportAxes[1]);\n      this.visibleSourcesStale = true;\n      this.pixelSize = newPixelSize;\n    }\n\n    // Compute viewport plane distance to origin.\n    this.viewportPlaneDistanceToOrigin = vec3.dot(this.centerDataPosition, this.viewportAxes[2]);\n    this.onViewportToDataMatrixChanged();\n    this.maybeSetHasValidViewport();\n    return true;\n  }\n\n  onViewportToDataMatrixChanged() {}\n\n  /**\n   * Computes the list of sources to use for each visible layer, based on the\n   * current pixelSize.\n   */\n  updateVisibleSources() {\n    if (!this.visibleSourcesStale) {\n      return;\n    }\n    this.visibleSourcesStale = false;\n    // Increase pixel size by a small margin.\n    let pixelSize = this.pixelSize * 1.1;\n    // console.log(\"pixelSize\", pixelSize);\n\n    let visibleChunkLayouts = this.visibleChunkLayouts;\n    const zAxis = this.viewportAxes[2];\n\n    let visibleLayers = this.visibleLayers;\n    visibleChunkLayouts.clear();\n    for (let [renderLayer, visibleSources] of visibleLayers) {\n      visibleSources.length = 0;\n      let transformedSources = getTransformedSources(renderLayer);\n      let numSources = transformedSources.length;\n      let scaleIndex: number;\n\n      // At the smallest scale, all alternative sources must have the same voxel size, which is\n      // considered to be the base voxel size.\n      let smallestVoxelSize = transformedSources[0][0].voxelSize;\n\n      const renderScaleTarget = renderLayer.renderScaleTarget.value;\n\n      /**\n       * Determines whether we should continue to look for a finer-resolution source *after* one\n       * with the specified voxelSize.\n       */\n      const canImproveOnVoxelSize = (voxelSize: vec3) => {\n        const targetSize = pixelSize * renderScaleTarget;\n        for (let i = 0; i < 3; ++i) {\n          const size = voxelSize[i];\n          // If size <= pixelSize, no need for improvement.\n          // If size === smallestVoxelSize, also no need for improvement.\n          if (size > targetSize && size > 1.01 * smallestVoxelSize[i]) {\n            return true;\n          }\n        }\n        return false;\n      };\n\n      const improvesOnPrevVoxelSize = (voxelSize: vec3, prevVoxelSize: vec3) => {\n        const targetSize = pixelSize * renderScaleTarget;\n        for (let i = 0; i < 3; ++i) {\n          const size = voxelSize[i];\n          const prevSize = prevVoxelSize[i];\n          if (Math.abs(targetSize - size) < Math.abs(targetSize - prevSize) &&\n              size < 1.01 * prevSize) {\n            return true;\n          }\n        }\n        return false;\n      };\n\n      /**\n       * Registers a source as being visible.  This should be called with consecutively decreasing\n       * values of scaleIndex.\n       */\n      const addVisibleSource =\n          (transformedSource: TransformedSource<Source>, sourceScaleIndex: number) => {\n            // Add to end of visibleSources list.  We will reverse the list after all sources are\n            // added.\n            const {source, chunkLayout} = transformedSource;\n            visibleSources[visibleSources.length++] = transformedSource;\n            let existingSources = visibleChunkLayouts.get(chunkLayout);\n            if (existingSources === undefined) {\n              existingSources = new Map<Source, number>();\n              visibleChunkLayouts.set(chunkLayout, existingSources);\n            }\n            existingSources.set(source, sourceScaleIndex);\n          };\n\n      scaleIndex = numSources - 1;\n      let prevVoxelSize: vec3|undefined;\n      while (true) {\n        const transformedSource = pickBestAlternativeSource(zAxis, transformedSources[scaleIndex]);\n        if (prevVoxelSize !== undefined &&\n            !improvesOnPrevVoxelSize(transformedSource.voxelSize, prevVoxelSize)) {\n          break;\n        }\n        addVisibleSource(transformedSource, scaleIndex);\n\n        if (scaleIndex === 0 || !canImproveOnVoxelSize(transformedSource.voxelSize)) {\n          break;\n        }\n        prevVoxelSize = transformedSource.voxelSize;\n        --scaleIndex;\n      }\n      // Reverse visibleSources list since we added sources from coarsest to finest resolution, but\n      // we want them ordered from finest to coarsest.\n      visibleSources.reverse();\n    }\n  }\n  computeVisibleChunks<T>(\n      getLayoutObject: (chunkLayout: ChunkLayout) => T,\n      addChunk:\n          (chunkLayout: ChunkLayout, layoutObject: T, lowerBound: vec3,\n           fullyVisibleSources: SliceViewChunkSource[]) => void) {\n    this.updateVisibleSources();\n\n    // Lower and upper bound in global data coordinates.\n    const globalCorners = tempCorners;\n    let {width, height, viewportToData} = this;\n    for (let i = 0; i < 3; ++i) {\n      globalCorners[0][i] = -kAxes[0][i] * width / 2 - kAxes[1][i] * height / 2;\n      globalCorners[1][i] = -kAxes[0][i] * width / 2 + kAxes[1][i] * height / 2;\n      globalCorners[2][i] = kAxes[0][i] * width / 2 - kAxes[1][i] * height / 2;\n      globalCorners[3][i] = kAxes[0][i] * width / 2 + kAxes[1][i] * height / 2;\n    }\n    for (let i = 0; i < 4; ++i) {\n      vec3.transformMat4(globalCorners[i], globalCorners[i], viewportToData);\n    }\n    // console.log(\"data bounds\", dataLowerBound, dataUpperBound);\n\n    // These variables hold the lower and upper bounds on chunk grid positions that intersect the\n    // viewing plane.\n    var lowerChunkBound = vec3.create();\n    var upperChunkBound = vec3.create();\n\n    let sourcesLowerChunkBound = vec3.create();\n    let sourcesUpperChunkBound = vec3.create();\n\n    // Vertex with maximal dot product with the positive viewport plane normal.\n    // Implicitly, negativeVertex = 1 - positiveVertex.\n    var positiveVertex = vec3.create();\n\n    var planeNormal = vec3.create();\n\n    // Sources whose bounds partially contain the current bounding box.\n    let partiallyVisibleSources = new Array<SliceViewChunkSource>();\n\n    // Sources whose bounds fully contain the current bounding box.\n    let fullyVisibleSources = new Array<SliceViewChunkSource>();\n\n    this.visibleChunkLayouts.forEach((visibleSources, chunkLayout) => {\n      let layoutObject = getLayoutObject(chunkLayout);\n      computeSourcesChunkBounds(\n          sourcesLowerChunkBound, sourcesUpperChunkBound, visibleSources.keys());\n      if (DEBUG_CHUNK_INTERSECTIONS) {\n        console.log(\n            `Initial sources chunk bounds: ` +\n            `${vec3.str(sourcesLowerChunkBound)}, ${vec3.str(sourcesUpperChunkBound)}`);\n      }\n\n      vec3.set(\n          lowerChunkBound, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY,\n          Number.POSITIVE_INFINITY);\n      vec3.set(\n          upperChunkBound, Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY,\n          Number.NEGATIVE_INFINITY);\n\n      chunkLayout.globalToLocalSpatialVector(planeNormal, this.viewportAxes[2]);\n      for (let i = 0; i < 3; ++i) {\n        positiveVertex[i] = planeNormal[i] > 0 ? 1 : 0;\n      }\n\n      // Center position in chunk grid coordinates.\n      const planeDistanceToOrigin =\n          vec3.dot(chunkLayout.globalToLocalGrid(tempVec3, this.centerDataPosition), planeNormal);\n\n      for (let i = 0; i < 4; ++i) {\n        const localCorner = chunkLayout.globalToLocalGrid(tempVec3, globalCorners[i]);\n        for (let j = 0; j < 3; ++j) {\n          lowerChunkBound[j] = Math.min(lowerChunkBound[j], Math.floor(localCorner[j]));\n          upperChunkBound[j] = Math.max(upperChunkBound[j], Math.floor(localCorner[j]) + 1);\n        }\n      }\n      vec3.max(lowerChunkBound, lowerChunkBound, sourcesLowerChunkBound);\n      vec3.min(upperChunkBound, upperChunkBound, sourcesUpperChunkBound);\n\n      // console.log('chunkBounds', lowerBound, upperBound);\n\n      // Checks whether [lowerBound, upperBound) intersects the viewport plane.\n      //\n      // positiveVertexDistanceToOrigin = dot(planeNormal, lowerBound +\n      // positiveVertex * (upperBound - lowerBound)) - planeDistanceToOrigin;\n      // negativeVertexDistanceToOrigin = dot(planeNormal, lowerBound +\n      // negativeVertex * (upperBound - lowerBound)) - planeDistanceToOrigin;\n      //\n      // positive vertex must have positive distance, and negative vertex must\n      // have negative distance.\n      function intersectsPlane() {\n        var positiveVertexDistanceToOrigin = 0;\n        var negativeVertexDistanceToOrigin = 0;\n        // Check positive vertex.\n        for (let i = 0; i < 3; ++i) {\n          let normalValue = planeNormal[i];\n          let lowerValue = lowerChunkBound[i];\n          let upperValue = upperChunkBound[i];\n          let diff = upperValue - lowerValue;\n          let positiveOffset = positiveVertex[i] * diff;\n          // console.log(\n          //     normalValue, lowerValue, upperValue, diff, positiveOffset,\n          //     positiveVertexDistanceToOrigin, negativeVertexDistanceToOrigin);\n          positiveVertexDistanceToOrigin += normalValue * (lowerValue + positiveOffset);\n          negativeVertexDistanceToOrigin += normalValue * (lowerValue + diff - positiveOffset);\n        }\n        if (DEBUG_CHUNK_INTERSECTIONS) {\n          console.log(`    planeNormal = ${planeNormal}`);\n          console.log(\n              '    {positive,negative}VertexDistanceToOrigin: ', positiveVertexDistanceToOrigin,\n              negativeVertexDistanceToOrigin, planeDistanceToOrigin);\n          console.log(\n              '    intersectsPlane:', negativeVertexDistanceToOrigin, planeDistanceToOrigin,\n              positiveVertexDistanceToOrigin);\n        }\n        if (positiveVertexDistanceToOrigin < planeDistanceToOrigin) {\n          return false;\n        }\n\n        return negativeVertexDistanceToOrigin <= planeDistanceToOrigin;\n      }\n\n      fullyVisibleSources.length = 0;\n      partiallyVisibleSources.length = 0;\n      for (let source of visibleSources.keys()) {\n        let spec = source.spec;\n        let result = compareBounds(\n            lowerChunkBound, upperChunkBound, spec.lowerChunkBound, spec.upperChunkBound);\n        if (DEBUG_CHUNK_INTERSECTIONS) {\n          console.log(\n              `Comparing source bounds lowerBound=${vec3.str(lowerChunkBound)}, ` +\n                  `upperBound=${vec3.str(upperChunkBound)}, ` +\n                  `lowerChunkBound=${vec3.str(spec.lowerChunkBound)}, ` +\n                  `upperChunkBound=${vec3.str(spec.upperChunkBound)}, ` +\n                  `got ${BoundsComparisonResult[result]}`,\n              spec, source);\n        }\n        switch (result) {\n          case BoundsComparisonResult.FULLY_INSIDE:\n            fullyVisibleSources.push(source);\n            break;\n          case BoundsComparisonResult.PARTIALLY_INSIDE:\n            partiallyVisibleSources.push(source);\n            break;\n        }\n      }\n      let partiallyVisibleSourcesLength = partiallyVisibleSources.length;\n\n      // Mutates lowerBound and upperBound while running, but leaves them the\n      // same once finished.\n      function checkBounds(nextSplitDim: number) {\n        if (DEBUG_CHUNK_INTERSECTIONS) {\n          console.log(\n              `chunk bounds: ${lowerChunkBound} ${upperChunkBound} ` +\n              `fullyVisible: ${fullyVisibleSources} partiallyVisible: ` +\n              `${partiallyVisibleSources.slice(0, partiallyVisibleSourcesLength)}`);\n        }\n\n        if (fullyVisibleSources.length === 0 && partiallyVisibleSourcesLength === 0) {\n          if (DEBUG_CHUNK_INTERSECTIONS) {\n            console.log('  no visible sources');\n          }\n          return;\n        }\n\n        if (DEBUG_CHUNK_INTERSECTIONS) {\n          console.log(\n              `Check bounds: [ ${vec3.str(lowerChunkBound)}, ${vec3.str(upperChunkBound)} ]`);\n        }\n        var volume = 1;\n        for (let i = 0; i < 3; ++i) {\n          volume *= Math.max(0, upperChunkBound[i] - lowerChunkBound[i]);\n        }\n\n        if (volume === 0) {\n          if (DEBUG_CHUNK_INTERSECTIONS) {\n            console.log('  volume == 0');\n          }\n          return;\n        }\n\n        if (!intersectsPlane()) {\n          if (DEBUG_CHUNK_INTERSECTIONS) {\n            console.log('  doesn\\'t intersect plane');\n          }\n          return;\n        }\n\n        if (DEBUG_CHUNK_INTERSECTIONS) {\n          console.log(\n              'Within bounds: [' + vec3.str(lowerChunkBound) + ', ' + vec3.str(upperChunkBound) +\n              ']');\n        }\n\n        if (volume === 1) {\n          addChunk(chunkLayout, layoutObject, lowerChunkBound, fullyVisibleSources);\n          return;\n        }\n\n        var dimLower: number, dimUpper: number, diff: number;\n        while (true) {\n          dimLower = lowerChunkBound[nextSplitDim];\n          dimUpper = upperChunkBound[nextSplitDim];\n          diff = dimUpper - dimLower;\n          if (diff === 1) {\n            nextSplitDim = (nextSplitDim + 1) % 3;\n          } else {\n            break;\n          }\n        }\n\n        let splitPoint = dimLower + Math.floor(0.5 * diff);\n        let newNextSplitDim = (nextSplitDim + 1) % 3;\n        let fullyVisibleSourcesLength = fullyVisibleSources.length;\n\n        upperChunkBound[nextSplitDim] = splitPoint;\n\n        let oldPartiallyVisibleSourcesLength = partiallyVisibleSourcesLength;\n        function adjustSources() {\n          partiallyVisibleSourcesLength = partitionArray(\n              partiallyVisibleSources, 0, oldPartiallyVisibleSourcesLength, source => {\n                let spec = source.spec;\n                let result = compareBounds(\n                    lowerChunkBound, upperChunkBound, spec.lowerChunkBound, spec.upperChunkBound);\n                switch (result) {\n                  case BoundsComparisonResult.PARTIALLY_INSIDE:\n                    return true;\n                  case BoundsComparisonResult.FULLY_INSIDE:\n                    fullyVisibleSources.push(source);\n                  default:\n                    return false;\n                }\n              });\n        }\n\n        adjustSources();\n        checkBounds(newNextSplitDim);\n\n        // Truncate list of fully visible sources.\n        fullyVisibleSources.length = fullyVisibleSourcesLength;\n\n        // Restore partiallyVisibleSources.\n        partiallyVisibleSourcesLength = oldPartiallyVisibleSourcesLength;\n\n        upperChunkBound[nextSplitDim] = dimUpper;\n        lowerChunkBound[nextSplitDim] = splitPoint;\n\n        adjustSources();\n        checkBounds(newNextSplitDim);\n\n        lowerChunkBound[nextSplitDim] = dimLower;\n\n        // Truncate list of fully visible sources.\n        fullyVisibleSources.length = fullyVisibleSourcesLength;\n\n        // Restore partiallyVisibleSources.\n        partiallyVisibleSourcesLength = oldPartiallyVisibleSourcesLength;\n      }\n      checkBounds(0);\n    });\n  }\n}\n\n/**\n * By default, choose a chunk size with at most 2^18 = 262144 voxels.\n */\nexport const DEFAULT_MAX_VOXELS_PER_CHUNK_LOG2 = 18;\n\n/**\n * Specifies common options for getNearIsotropicBlockSize and getTwoDimensionalBlockSize.\n */\nexport interface BaseChunkLayoutOptions {\n  /**\n   * Voxel size in nanometers.\n   */\n  voxelSize: vec3;\n\n  /**\n   * This, together with upperVoxelBound, specifies the total volume dimensions, which serves as a\n   * bound on the maximum chunk size.  If not specified, defaults to (0, 0, 0).\n   */\n  lowerVoxelBound?: vec3;\n\n  /**\n   * Upper voxel bound.  If not specified, the total volume dimensions are not used to bound the\n   * chunk size.\n   */\n  upperVoxelBound?: vec3;\n\n  /**\n   * Base 2 logarithm of the maximum number of voxels per chunk.  Defaults to\n   * DEFAULT_MAX_VOXELS_PER_CHUNK_LOG2.\n   */\n  maxVoxelsPerChunkLog2?: number;\n\n  /**\n   * Specifies an optional transform from local spatial coordinates to global coordinates.\n   */\n  transform?: mat4;\n}\n\nexport interface GetNearIsotropicBlockSizeOptions extends BaseChunkLayoutOptions {\n  maxBlockSize?: vec3;\n}\n\n/**\n * Determines a near-isotropic (in global spatial coordinates) block size.  All dimensions will be\n * powers of 2, and will not exceed upperVoxelBound - lowerVoxelBound.  The total number of voxels\n * will not exceed maxVoxelsPerChunkLog2.\n */\nexport function getNearIsotropicBlockSize(options: GetNearIsotropicBlockSizeOptions) {\n  let {\n    voxelSize,\n    lowerVoxelBound = kZeroVec,\n    upperVoxelBound,\n    maxVoxelsPerChunkLog2 = DEFAULT_MAX_VOXELS_PER_CHUNK_LOG2,\n    transform = identityMat4,\n    maxBlockSize = kInfinityVec,\n  } = options;\n\n  // Adjust voxelSize by effective scaling factor.\n  let temp = effectiveScalingFactorFromMat4(vec3.create(), transform);\n  voxelSize = vec3.multiply(temp, temp, voxelSize);\n\n  let chunkDataSize = vec3.fromValues(1, 1, 1);\n  let maxChunkDataSize: vec3;\n  if (upperVoxelBound === undefined) {\n    maxChunkDataSize = maxBlockSize;\n  } else {\n    maxChunkDataSize = vec3.create();\n    for (let i = 0; i < 3; ++i) {\n      maxChunkDataSize[i] =\n          Math.pow(2, Math.floor(Math.log2(upperVoxelBound[i] - lowerVoxelBound[i])));\n    }\n    vec3.min(maxChunkDataSize, maxChunkDataSize, maxBlockSize);\n  }\n\n  // Determine the dimension in which chunkDataSize should be increased.  This is the smallest\n  // dimension (in nanometers) that is < maxChunkDataSize (in voxels).\n  //\n  // Returns -1 if there is no such dimension.\n  function findNextDimension() {\n    let minSize = Infinity;\n    let minDimension = -1;\n    for (let i = 0; i < 3; ++i) {\n      if (chunkDataSize[i] >= maxChunkDataSize[i]) {\n        continue;\n      }\n      let size = chunkDataSize[i] * voxelSize[i];\n      if (size < minSize) {\n        minSize = size;\n        minDimension = i;\n      }\n    }\n    return minDimension;\n  }\n\n  for (let i = 0; i < maxVoxelsPerChunkLog2; ++i) {\n    let nextDim = findNextDimension();\n    if (nextDim === -1) {\n      break;\n    }\n    chunkDataSize[nextDim] *= 2;\n  }\n  return chunkDataSize;\n}\n\n/**\n * Computes a 3-d block size that has depth 1 in flatDimension and is near-isotropic (in nanometers)\n * in the other two dimensions.  The remaining options are the same as for\n * getNearIsotropicBlockSize.\n */\nexport function getTwoDimensionalBlockSize(options: {flatDimension: number}&\n                                           BaseChunkLayoutOptions) {\n  let {\n    lowerVoxelBound = kZeroVec,\n    upperVoxelBound = kInfinityVec,\n    flatDimension,\n    voxelSize,\n    maxVoxelsPerChunkLog2,\n    transform\n  } = options;\n  vec3.subtract(tempVec3, upperVoxelBound, lowerVoxelBound);\n  tempVec3[flatDimension] = 1;\n  return getNearIsotropicBlockSize(\n      {voxelSize, upperVoxelBound: tempVec3, maxVoxelsPerChunkLog2, transform});\n}\n\n/**\n * Returns an array of [xy, xz, yz] 2-dimensional block sizes.\n */\nexport function getTwoDimensionalBlockSizes(options: BaseChunkLayoutOptions) {\n  let chunkDataSizes = new Array<vec3>();\n  for (let i = 0; i < 3; ++i) {\n    chunkDataSizes[i] = getTwoDimensionalBlockSize({\n      flatDimension: i,\n      voxelSize: options.voxelSize,\n      lowerVoxelBound: options.lowerVoxelBound,\n      upperVoxelBound: options.upperVoxelBound,\n      maxVoxelsPerChunkLog2: options.maxVoxelsPerChunkLog2,\n      transform: options.transform,\n    });\n  }\n  return chunkDataSizes;\n}\n\nexport enum ChunkLayoutPreference {\n  /**\n   * Indicates that isotropic chunks are desired.\n   */\n  ISOTROPIC = 0,\n\n  /**\n   * Indicates that 2-D chunks are desired.\n   */\n  FLAT = 1,\n}\n\nexport interface SliceViewSourceOptions {\n  /**\n   * Additional transform applied after the transform specified by the data source for transforming\n   * from local to global coordinates.\n   */\n  transform?: mat4;\n}\n\nexport function getCombinedTransform(transform: mat4|undefined, options: {transform?: mat4}) {\n  let additionalTransform = options.transform;\n  if (additionalTransform === undefined) {\n    if (transform === undefined) {\n      return identityMat4;\n    }\n    return transform;\n  }\n  if (transform === undefined) {\n    return additionalTransform;\n  }\n  return mat4.multiply(mat4.create(), additionalTransform, transform);\n}\n\n/**\n * Specifies parameters for getChunkDataSizes.\n */\nexport interface ChunkLayoutOptions {\n  /**\n   * Chunk sizes in voxels.\n   */\n  chunkDataSizes?: vec3[];\n\n  /**\n   * Preferred chunk layout, which determines chunk sizes to use if chunkDataSizes is not\n   * specified.\n   */\n  chunkLayoutPreference?: ChunkLayoutPreference;\n}\n\nexport function getChunkDataSizes(options: ChunkLayoutOptions&BaseChunkLayoutOptions) {\n  if (options.chunkDataSizes !== undefined) {\n    return options.chunkDataSizes;\n  }\n  const {chunkLayoutPreference = ChunkLayoutPreference.ISOTROPIC} = options;\n  switch (chunkLayoutPreference) {\n    case ChunkLayoutPreference.ISOTROPIC:\n      return [getNearIsotropicBlockSize(options)];\n    case ChunkLayoutPreference.FLAT:\n      let chunkDataSizes = getTwoDimensionalBlockSizes(options);\n      chunkDataSizes.push(getNearIsotropicBlockSize(options));\n      return chunkDataSizes;\n  }\n  throw new Error(`Invalid chunk layout preference: ${chunkLayoutPreference}.`);\n}\n\n/**\n * Generic specification for SliceView chunks specifying a layout and voxel size.\n */\nexport abstract class SliceViewChunkSpecification {\n  chunkLayout: ChunkLayout;\n  voxelSize: vec3;\n\n  // All valid chunks are in the range [lowerChunkBound, upperChunkBound).\n  lowerChunkBound: vec3;\n  upperChunkBound: vec3;\n\n  constructor(options: SliceViewChunkSpecificationOptions) {\n    let {\n      chunkSize,\n      voxelSize,\n      transform,\n      lowerChunkBound = kZeroVec,\n      upperChunkBound,\n    } = options;\n    this.voxelSize = voxelSize;\n    this.chunkLayout = ChunkLayout.get(chunkSize, transform);\n\n    this.lowerChunkBound = lowerChunkBound;\n    this.upperChunkBound = upperChunkBound;\n  }\n\n  toObject(): SliceViewChunkSpecificationOptions {\n    return {\n      transform: this.chunkLayout.transform,\n      chunkSize: this.chunkLayout.size,\n      voxelSize: this.voxelSize,\n      lowerChunkBound: this.lowerChunkBound,\n      upperChunkBound: this.upperChunkBound,\n    };\n  }\n}\n\n/**\n * Common parameters for SliceView Chunks.\n */\nexport interface SliceViewChunkSpecificationBaseOptions {\n  /**\n   * Transform local spatial coordinates to global coordinates.\n   */\n  transform?: mat4;\n\n  /**\n   * Voxel size in local spatial coordinates.\n   */\n  voxelSize: vec3;\n}\n\n\nexport interface SliceViewChunkSpecificationOptions extends SliceViewChunkSpecificationBaseOptions {\n  lowerChunkBound?: vec3;\n  upperChunkBound: vec3;\n\n  chunkSize: vec3;\n}\n\n\nexport interface SliceViewChunkSource {\n  spec: SliceViewChunkSpecification;\n}\n\nexport const SLICEVIEW_RPC_ID = 'SliceView';\nexport const SLICEVIEW_RENDERLAYER_RPC_ID = 'sliceview/RenderLayer';\nexport const SLICEVIEW_ADD_VISIBLE_LAYER_RPC_ID = 'SliceView.addVisibleLayer';\nexport const SLICEVIEW_REMOVE_VISIBLE_LAYER_RPC_ID = 'SliceView.removeVisibleLayer';\nexport const SLICEVIEW_UPDATE_VIEW_RPC_ID = 'SliceView.updateView';\nexport const SLICEVIEW_RENDERLAYER_UPDATE_TRANSFORM_RPC_ID = 'SliceView.updateTransform';\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function approxEqual(a: number, b: number): boolean {\n  if (a === b) {\n    return true;\n  }\n  return (Math.abs(a - b) / Math.min(Math.abs(a), Math.abs(b)) < 1e-6);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {DataSourceProvider, GetVolumeOptions} from 'neuroglancer/datasource';\nimport {LayerManager, LayerSelectedValues, ManagedUserLayer, UserLayer} from 'neuroglancer/layer';\nimport {VoxelSize} from 'neuroglancer/navigation_state';\nimport {VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {Owned, RefCounted, Borrowed} from 'neuroglancer/util/disposable';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {parseArray, verifyObject, verifyObjectProperty, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\nimport {NullarySignal, Signal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\nimport {RPC} from 'neuroglancer/worker_rpc';\n\nexport function getVolumeWithStatusMessage(\n    dataSourceProvider: DataSourceProvider, chunkManager: ChunkManager, x: string,\n    options: GetVolumeOptions = {}): Promise<MultiscaleVolumeChunkSource> {\n  return StatusMessage.forPromise(\n      new Promise(function(resolve) {\n        resolve(dataSourceProvider.getVolume(chunkManager, x, options));\n      }),\n      {\n        initialMessage: `Retrieving metadata for volume ${x}.`,\n        delay: true,\n        errorPrefix: `Error retrieving metadata for volume ${x}: `,\n      });\n}\n\nexport class ManagedUserLayerWithSpecification extends ManagedUserLayer {\n  sourceUrl: string|undefined;\n\n  constructor(\n      name: string, public initialSpecification: any, public manager: LayerListSpecification) {\n    super(name);\n  }\n\n  toJSON() {\n    let userLayer = this.layer;\n    if (!userLayer) {\n      return this.initialSpecification;\n    }\n    let layerSpec = userLayer.toJSON();\n    layerSpec.name = this.name;\n    if (!this.visible) {\n      layerSpec['visible'] = false;\n    }\n    return layerSpec;\n  }\n}\n\nexport interface LayerListSpecification extends RefCounted, Trackable {\n  changed: NullarySignal;\n  voxelCoordinatesSet: Signal<(coordinates: vec3) => void>;\n  spatialCoordinatesSet: Signal<(coordinates: vec3) => void>;\n\n  /**\n   * @deprecated\n   */\n  worker: RPC;\n\n  rpc: RPC;\n\n  dataSourceProvider: Borrowed<DataSourceProvider>;\n  layerManager: Borrowed<LayerManager>;\n  chunkManager: Borrowed<ChunkManager>;\n  layerSelectedValues: Borrowed<LayerSelectedValues>;\n  voxelSize: Borrowed<VoxelSize>;\n\n\n  initializeLayerFromSpec(managedLayer: ManagedUserLayerWithSpecification, spec: any): void;\n\n  getLayer(name: string, spec: any): ManagedUserLayerWithSpecification;\n\n  add(layer: Owned<ManagedUserLayer>, index?: number|undefined): void;\n\n  /**\n   * Called by user layers to indicate that a voxel position has been selected interactively.\n   */\n  setVoxelCoordinates(voxelCoordinates: vec3): void;\n  setSpatialCoordinates(spatialCoordinates: vec3): void;\n\n  rootLayers: Borrowed<LayerManager>;\n}\n\nexport class TopLevelLayerListSpecification extends RefCounted implements LayerListSpecification {\n  changed = new NullarySignal();\n  voxelCoordinatesSet = new Signal<(coordinates: vec3) => void>();\n  spatialCoordinatesSet = new Signal<(coordinates: vec3) => void>();\n\n  /**\n   * @deprecated\n   */\n  get worker() {\n    return this.chunkManager.rpc!;\n  }\n\n  get rpc() {\n    return this.chunkManager.rpc!;\n  }\n\n  constructor(\n      public dataSourceProvider: DataSourceProvider, public layerManager: LayerManager,\n      public chunkManager: ChunkManager, public layerSelectedValues: LayerSelectedValues,\n      public voxelSize: VoxelSize) {\n    super();\n    this.registerDisposer(layerManager.layersChanged.add(this.changed.dispatch));\n    this.registerDisposer(layerManager.specificationChanged.add(this.changed.dispatch));\n  }\n\n  reset() {\n    this.layerManager.clear();\n  }\n\n  restoreState(x: any) {\n    this.layerManager.clear();\n    if (Array.isArray(x)) {\n      // If array, layers have an order\n      for (const layerObj of x) {\n        verifyObject(layerObj);\n        const name = this.layerManager.getUniqueLayerName(verifyObjectProperty(layerObj, 'name', verifyString));\n        this.layerManager.addManagedLayer(this.getLayer(name, layerObj));\n      }\n    } else {\n      // Keep for backwards compatibility\n      verifyObject(x);\n      for (let key of Object.keys(x)) {\n        this.layerManager.addManagedLayer(this.getLayer(key, x[key]));\n      }\n    }\n  }\n\n  initializeLayerFromSpec(managedLayer: ManagedUserLayerWithSpecification, spec: any) {\n    managedLayer.initialSpecification = spec;\n    if (typeof spec === 'string') {\n      spec = {'source': spec};\n    }\n    verifyObject(spec);\n    let layerType = verifyObjectProperty(spec, 'type', verifyOptionalString);\n    managedLayer.visible = verifyObjectProperty(spec, 'visible', x => {\n      if (x === undefined || x === true) {\n        return true;\n      }\n      if (x === false) {\n        return false;\n      }\n      throw new Error(`Expected boolean, but received: ${JSON.stringify(x)}.`);\n    });\n\n    const makeUserLayer = (layerConstructor: UserLayerConstructor, spec: any) => {\n      const userLayer = new layerConstructor(this, spec);\n      userLayer.restoreState(spec);\n      managedLayer.layer = userLayer;\n    };\n    let sourceUrl = managedLayer.sourceUrl =\n        verifyObjectProperty(spec, 'source', verifyOptionalString);\n    if (layerType === undefined) {\n      if (sourceUrl === undefined) {\n        throw new Error(`Either layer 'type' or 'source' URL must be specified.`);\n      }\n      let volumeSourcePromise =\n          getVolumeWithStatusMessage(this.dataSourceProvider, this.chunkManager, sourceUrl);\n      volumeSourcePromise.then(source => {\n        if (this.layerManager.managedLayers.indexOf(managedLayer) === -1) {\n          // Layer was removed before promise became ready.\n          return;\n        }\n        let layerConstructor = volumeLayerTypes.get(source.volumeType);\n        if (layerConstructor !== undefined) {\n          makeUserLayer(layerConstructor, spec);\n        } else {\n          throw new Error(`Unsupported volume type: ${VolumeType[source.volumeType]}.`);\n        }\n      });\n    } else {\n      let layerConstructor = layerTypes.get(layerType);\n      if (layerConstructor !== undefined) {\n        makeUserLayer(layerConstructor, spec);\n      } else {\n        throw new Error(`Unsupported layer type: ${JSON.stringify(layerType)}.`);\n      }\n    }\n  }\n\n  getLayer(name: string, spec: any): ManagedUserLayerWithSpecification {\n    let managedLayer = new ManagedUserLayerWithSpecification(name, spec, this);\n    this.initializeLayerFromSpec(managedLayer, spec);\n    return managedLayer;\n  }\n\n  add(layer: ManagedUserLayer, index?: number|undefined) {\n    if (this.layerManager.managedLayers.indexOf(layer) === -1) {\n      layer.name = this.layerManager.getUniqueLayerName(layer.name);\n    }\n    this.layerManager.addManagedLayer(layer, index);\n  }\n\n  toJSON() {\n    const result = [];\n    let numResults = 0;\n    for (let managedLayer of this.layerManager.managedLayers) {\n      const layerJson = (<ManagedUserLayerWithSpecification>managedLayer).toJSON();\n      // A `null` layer specification is used to indicate a transient drag target, and should not be\n      // serialized.\n      if (layerJson != null) {\n        result.push(layerJson);\n        ++numResults;\n      }\n    }\n    if (numResults === 0) {\n      return undefined;\n    }\n    return result;\n  }\n\n  /**\n   * Called by user layers to indicate that a voxel position has been selected interactively.\n   */\n  setVoxelCoordinates(voxelCoordinates: vec3) {\n    this.voxelCoordinatesSet.dispatch(voxelCoordinates);\n  }\n\n  setSpatialCoordinates(spatialCoordinates: vec3) {\n    this.spatialCoordinatesSet.dispatch(spatialCoordinates);\n  }\n\n  get rootLayers() {\n    return this.layerManager;\n  }\n}\n\n/**\n * Class for specifying a subset of a TopLevelLayerListsSpecification.\n */\nexport class LayerSubsetSpecification extends RefCounted implements LayerListSpecification {\n  changed = new NullarySignal();\n\n  get voxelCoordinatesSet() { return this.master.voxelCoordinatesSet; }\n  get spatialCoordinatesSet() { return this.master.spatialCoordinatesSet; }\n\n  get worker() { return this.master.rpc; }\n  get rpc() { return this.master.rpc; }\n\n  get dataSourceProvider () { return this.master.dataSourceProvider; }\n  get chunkManager () { return this.master.chunkManager; }\n  get voxelSize () { return this.master.voxelSize; }\n  get layerSelectedValues () { return this.master.layerSelectedValues; }\n\n  layerManager = new LayerManager();\n\n  constructor (public master: Owned<LayerListSpecification>) {\n    super();\n    this.registerDisposer(master);\n    const {layerManager} = this;\n    this.registerDisposer(layerManager.layersChanged.add(this.changed.dispatch));\n    this.registerDisposer(layerManager.specificationChanged.add(this.changed.dispatch));\n  }\n\n  reset() {\n    this.layerManager.clear();\n  }\n\n  restoreState(x: any) {\n    const masterLayerManager = this.master.layerManager;\n    const layers: ManagedUserLayer[] = [];\n    for (const name of new Set(parseArray(x, verifyString))) {\n      const layer = masterLayerManager.getLayerByName(name);\n      if (layer === undefined) {\n        throw new Error(`Undefined layer referenced in subset specification: ${JSON.stringify(name)}`);\n      }\n      layers.push(layer);\n    }\n    this.layerManager.clear();\n    for (const layer of layers) {\n      this.layerManager.addManagedLayer(layer.addRef());\n    }\n  }\n\n  toJSON() {\n    return this.layerManager.managedLayers.map(x => x.name);\n  }\n\n  initializeLayerFromSpec(managedLayer: ManagedUserLayerWithSpecification, spec: any) {\n    this.master.initializeLayerFromSpec(managedLayer, spec);\n  }\n\n  getLayer(name: string, spec: any): ManagedUserLayerWithSpecification {\n    return this.master.getLayer(name, spec);\n  }\n\n  add(layer: ManagedUserLayer, index?: number|undefined) {\n    if (this.master.layerManager.managedLayers.indexOf(layer) === -1) {\n      layer.name = this.master.layerManager.getUniqueLayerName(layer.name);\n      this.master.layerManager.addManagedLayer(layer.addRef());\n    }\n    this.layerManager.addManagedLayer(layer, index);\n  }\n\n  setVoxelCoordinates(voxelCoordinates: vec3) {\n    this.master.setVoxelCoordinates(voxelCoordinates);\n  }\n\n  setSpatialCoordinates(spatialCoordinates: vec3) {\n    this.master.setSpatialCoordinates(spatialCoordinates);\n  }\n\n  get rootLayers () { return this.master.rootLayers; }\n}\n\ninterface UserLayerConstructor {\n  new(manager: LayerListSpecification, x: any): UserLayer;\n}\n\nconst layerTypes = new Map<string, UserLayerConstructor>();\nconst volumeLayerTypes = new Map<VolumeType, UserLayerConstructor>();\n\nexport function registerLayerType(name: string, layerConstructor: UserLayerConstructor) {\n  layerTypes.set(name, layerConstructor);\n}\n\nexport function registerVolumeLayerType(\n    volumeType: VolumeType, layerConstructor: UserLayerConstructor) {\n  volumeLayerTypes.set(volumeType, layerConstructor);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {mat3, mat4, quat, vec3} from 'neuroglancer/util/geom';\nimport {parseFiniteVec, verifyObject, verifyObjectProperty} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\nimport {TrackableEnum} from 'neuroglancer/util/trackable_enum';\n\nexport enum NavigationLinkType {\n  LINKED,\n  RELATIVE,\n  UNLINKED,\n}\n\nexport class TrackableNavigationLink extends TrackableEnum<NavigationLinkType> {\n  constructor(value = NavigationLinkType.LINKED) {\n    super(NavigationLinkType, value);\n  }\n}\n\nexport class VoxelSize extends RefCounted {\n  size: vec3;\n  valid: boolean;\n  changed = new NullarySignal();\n  constructor(voxelSize?: vec3) {\n    super();\n    let valid = true;\n    if (voxelSize == null) {\n      voxelSize = vec3.create();\n      valid = false;\n    }\n    this.size = voxelSize;\n    this.valid = valid;\n  }\n\n  reset() {\n    this.valid = false;\n    this.changed.dispatch();\n  }\n\n  /**\n   * This should be called after setting the voxel size initially.  The voxel\n   * size should not be changed once it is valid.\n   */\n  setValid() {\n    if (!this.valid) {\n      this.valid = true;\n      this.changed.dispatch();\n    }\n  }\n\n  toJSON() {\n    if (!this.valid) {\n      return undefined;\n    }\n    return Array.prototype.slice.call(this.size);\n  }\n\n  restoreState(obj: any) {\n    try {\n      parseFiniteVec(this.size, obj);\n      this.valid = true;\n      this.changed.dispatch();\n    } catch (e) {\n      this.valid = false;\n      this.changed.dispatch();\n    }\n  }\n\n  toString() {\n    if (!this.valid) {\n      return null;\n    }\n    return this.size.toString();\n  }\n\n  voxelFromSpatial(voxel: vec3, spatial: vec3) {\n    return vec3.divide(voxel, spatial, this.size);\n  }\n\n  spatialFromVoxel(spatial: vec3, voxel: vec3) {\n    return vec3.multiply(spatial, voxel, this.size);\n  }\n}\n\nconst tempVec3 = vec3.create();\nconst tempQuat = quat.create();\n\nfunction makeLinked<T extends RefCounted&{changed: NullarySignal}, Difference>(\n    self: T, peer: T, link: TrackableNavigationLink, operations: {\n      assign: (target: T, source: T) => void,\n      isValid: (a: T) => boolean,\n      difference: (a: T, b: T) => Difference,\n      add: (target: T, source: T, amount: Difference) => void,\n      subtract: (target: T, source: T, amount: Difference) => void\n    }) {\n  let updatingSelf = false;\n  let updatingPeer = false;\n  let selfMinusPeer: Difference|undefined;\n  self.registerDisposer(peer);\n  const handlePeerUpdate = () => {\n    if (updatingPeer) {\n      return;\n    }\n    updatingSelf = true;\n    switch (link.value) {\n      case NavigationLinkType.UNLINKED:\n        if (operations.isValid(self)) {\n          break;\n        } else {\n          // Fallthrough to LINKED case.\n        }\n      case NavigationLinkType.LINKED:\n        operations.assign(self, peer);\n        break;\n      case NavigationLinkType.RELATIVE:\n        operations.add(self, peer, selfMinusPeer!);\n        break;\n    }\n    updatingSelf = false;\n  };\n  const handleSelfUpdate = () => {\n    if (updatingSelf) {\n      return;\n    }\n    switch (link.value) {\n      case NavigationLinkType.UNLINKED:\n        break;\n      case NavigationLinkType.LINKED:\n        operations.assign(peer, self);\n        break;\n      case NavigationLinkType.RELATIVE:\n        operations.subtract(peer, self, selfMinusPeer!);\n        break;\n    }\n  };\n  let previousLinkValue = NavigationLinkType.UNLINKED;\n  const handleLinkUpdate = () => {\n    const linkValue = link.value;\n    if (linkValue !== previousLinkValue) {\n      switch (linkValue) {\n        case NavigationLinkType.UNLINKED:\n          selfMinusPeer = undefined;\n          break;\n        case NavigationLinkType.LINKED:\n          selfMinusPeer = undefined;\n          operations.assign(self, peer);\n          break;\n        case NavigationLinkType.RELATIVE:\n          selfMinusPeer = operations.difference(self, peer);\n          break;\n      }\n    }\n    previousLinkValue = linkValue;\n    self.changed.dispatch();\n  };\n  self.registerDisposer(self.changed.add(handleSelfUpdate));\n  self.registerDisposer(peer.changed.add(handlePeerUpdate));\n  self.registerDisposer(link.changed.add(handleLinkUpdate));\n  handleLinkUpdate();\n  return self;\n}\n\ninterface SpatialPositionOffset {\n  spatialOffset?: vec3;\n  voxelOffset?: vec3;\n}\n\nexport class SpatialPosition extends RefCounted {\n  voxelSize: VoxelSize;\n  spatialCoordinates: vec3;\n  spatialCoordinatesValid: boolean;\n  protected voxelCoordinates: vec3|null = null;\n  changed = new NullarySignal();\n  constructor(voxelSize?: Owned<VoxelSize>, spatialCoordinates?: vec3) {\n    super();\n    if (voxelSize == null) {\n      voxelSize = new VoxelSize();\n    }\n    this.voxelSize = voxelSize;\n\n    let spatialCoordinatesValid = true;\n    if (spatialCoordinates == null) {\n      spatialCoordinates = vec3.create();\n      spatialCoordinatesValid = false;\n    }\n    this.spatialCoordinates = spatialCoordinates;\n    this.spatialCoordinatesValid = spatialCoordinatesValid;\n\n    this.registerDisposer(voxelSize);\n    this.registerDisposer(voxelSize.changed.add(() => {\n      this.handleVoxelSizeChanged();\n    }));\n  }\n\n  get valid() {\n    return this.spatialCoordinatesValid && this.voxelSize.valid;\n  }\n\n  get voxelCoordinatesValid() {\n    return this.valid || this.voxelCoordinates != null;\n  }\n\n  reset() {\n    this.spatialCoordinatesValid = false;\n    this.voxelCoordinates = null;\n    this.voxelSize.reset();\n    this.changed.dispatch();\n  }\n\n  getVoxelCoordinates(out: vec3) {\n    let {voxelCoordinates} = this;\n    if (voxelCoordinates) {\n      vec3.copy(out, voxelCoordinates);\n    } else if (this.valid) {\n      this.voxelSize.voxelFromSpatial(out, this.spatialCoordinates);\n    } else {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Sets this position to the spatial coordinats corresponding to the specified\n   * voxelPosition.  If this.voxelSize.valid == false, then this position won't\n   * be set until it is.\n   */\n  setVoxelCoordinates(voxelCoordinates: vec3) {\n    let voxelSize = this.voxelSize;\n    if (voxelSize.valid) {\n      voxelSize.spatialFromVoxel(this.spatialCoordinates, voxelCoordinates);\n      this.markSpatialCoordinatesChanged();\n    } else {\n      let voxelCoordinates_ = this.voxelCoordinates;\n      if (!voxelCoordinates_) {\n        this.voxelCoordinates = voxelCoordinates_ = vec3.clone(voxelCoordinates);\n      } else {\n        vec3.copy(voxelCoordinates_, voxelCoordinates);\n      }\n    }\n    this.changed.dispatch();\n  }\n\n  markSpatialCoordinatesChanged() {\n    this.spatialCoordinatesValid = true;\n    this.voxelCoordinates = null;\n    this.changed.dispatch();\n  }\n\n  private handleVoxelSizeChanged() {\n    if (this.voxelCoordinates != null && !this.spatialCoordinatesValid) {\n      this.voxelSize.spatialFromVoxel(this.spatialCoordinates, this.voxelCoordinates);\n      this.spatialCoordinatesValid = true;\n    }\n    this.voxelCoordinates = null;\n    this.changed.dispatch();\n  }\n\n  toJSON() {\n    let empty = true;\n    let voxelSizeJson = this.voxelSize.toJSON();\n    let obj: any = {};\n    if (voxelSizeJson !== undefined) {\n      empty = false;\n      obj['voxelSize'] = voxelSizeJson;\n    }\n    if (this.voxelCoordinatesValid) {\n      let voxelCoordinates = tempVec3;\n      this.getVoxelCoordinates(voxelCoordinates);\n      obj['voxelCoordinates'] = Array.prototype.slice.call(voxelCoordinates);\n      empty = false;\n    } else if (this.spatialCoordinatesValid) {\n      obj['spatialCoordinates'] = Array.prototype.slice.call(this.spatialCoordinates);\n      empty = false;\n    }\n    if (empty) {\n      return undefined;\n    }\n    return obj;\n  }\n\n  restoreState(obj: any) {\n    verifyObject(obj);\n    verifyObjectProperty(obj, 'voxelSize', x => {\n      if (x !== undefined) {\n        this.voxelSize.restoreState(x);\n      }\n    });\n    this.spatialCoordinatesValid = false;\n    verifyObjectProperty(obj, 'voxelCoordinates', x => {\n      if (x !== undefined) {\n        this.setVoxelCoordinates(parseFiniteVec(vec3.create(), x));\n      }\n    });\n    verifyObjectProperty(obj, 'spatialCoordinates', x => {\n      if (x !== undefined) {\n        parseFiniteVec(this.spatialCoordinates, x);\n        this.markSpatialCoordinatesChanged();\n      }\n    });\n  }\n\n  snapToVoxel() {\n    if (!this.valid) {\n      let {voxelCoordinates} = this;\n      if (voxelCoordinates != null) {\n        for (let i = 0; i < 3; ++i) {\n          voxelCoordinates[i] = Math.round(voxelCoordinates[i]);\n        }\n        this.changed.dispatch();\n      }\n    } else {\n      let spatialCoordinates = this.spatialCoordinates;\n      let voxelSize = this.voxelSize.size;\n      for (let i = 0; i < 3; ++i) {\n        let voxelSizeValue = voxelSize[i];\n        spatialCoordinates[i] = Math.round(spatialCoordinates[i] / voxelSizeValue) * voxelSizeValue;\n      }\n      this.changed.dispatch();\n    }\n  }\n\n  assign(other: Borrowed<SpatialPosition>) {\n    this.spatialCoordinatesValid = other.spatialCoordinatesValid;\n    vec3.copy(this.spatialCoordinates, other.spatialCoordinates);\n    const {voxelCoordinates} = other;\n    this.voxelCoordinates = voxelCoordinates && vec3.clone(voxelCoordinates);\n    this.changed.dispatch();\n  }\n\n  /**\n   * Get the offset of `a` relative to `b`.\n   */\n  static getOffset(a: SpatialPosition, b: SpatialPosition): SpatialPositionOffset {\n    if (a.spatialCoordinatesValid && b.spatialCoordinatesValid) {\n      return {\n        spatialOffset: vec3.subtract(vec3.create(), a.spatialCoordinates, b.spatialCoordinates)\n      };\n    }\n    if (a.voxelCoordinates && b.voxelCoordinates) {\n      if (a.voxelSize !== b.voxelSize) {\n        throw new Error('Voxel offsets are only meaningful with identical voxelSize.');\n      }\n      return {voxelOffset: vec3.subtract(vec3.create(), a.voxelCoordinates, b.voxelCoordinates)};\n    }\n    return {};\n  }\n  static addOffset(\n      target: SpatialPosition, source: SpatialPosition, offset: SpatialPositionOffset,\n      scale: number = 1): void {\n    const {spatialOffset, voxelOffset} = offset;\n    if (spatialOffset !== undefined && source.spatialCoordinatesValid) {\n      vec3.scaleAndAdd(target.spatialCoordinates, source.spatialCoordinates, spatialOffset, scale);\n      target.markSpatialCoordinatesChanged();\n    } else if (voxelOffset !== undefined && source.getVoxelCoordinates(tempVec3)) {\n      target.setVoxelCoordinates(vec3.scaleAndAdd(tempVec3, tempVec3, voxelOffset, scale));\n    }\n  }\n}\n\nabstract class LinkedBase<T extends RefCounted&Trackable&{assign(other: T): void}> implements\n    Trackable {\n  value: T;\n  get changed() {\n    return this.value.changed;\n  }\n  constructor(public peer: Owned<T>, public link = new TrackableNavigationLink()) {}\n\n  toJSON() {\n    const {link} = this;\n    if (link.value === NavigationLinkType.LINKED) {\n      return undefined;\n    }\n    return {link: link.toJSON(), value: this.getValueJson()};\n  }\n\n  protected getValueJson(): any {\n    return this.value.toJSON();\n  }\n\n  reset() {\n    this.link.value = NavigationLinkType.LINKED;\n  }\n\n  restoreState(obj: any) {\n    if (obj === undefined || Object.keys(obj).length === 0) {\n      this.link.value = NavigationLinkType.LINKED;\n      return;\n    }\n    verifyObject(obj);\n    this.link.value = NavigationLinkType.UNLINKED;\n    verifyObjectProperty(obj, 'value', x => {\n      if (x !== undefined) {\n        this.value.restoreState(x);\n      }\n    });\n    verifyObjectProperty(obj, 'link', x => this.link.restoreState(x));\n  }\n\n  copyToPeer() {\n    if (this.link.value !== NavigationLinkType.LINKED) {\n      this.link.value = NavigationLinkType.UNLINKED;\n      this.peer.assign(this.value);\n      this.link.value = NavigationLinkType.LINKED;\n    }\n  }\n}\n\nexport class LinkedSpatialPosition extends LinkedBase<SpatialPosition> {\n  value = makeLinked(new SpatialPosition(this.peer.voxelSize.addRef()), this.peer, this.link, {\n    assign: (a: SpatialPosition, b: SpatialPosition) => a.assign(b),\n    isValid:\n        (a: SpatialPosition) => {\n          return a.spatialCoordinatesValid || a.voxelCoordinatesValid;\n        },\n    difference: SpatialPosition.getOffset,\n    add: SpatialPosition.addOffset,\n    subtract:\n        (target: SpatialPosition, source: SpatialPosition, amount: SpatialPositionOffset) => {\n          SpatialPosition.addOffset(target, source, amount, -1);\n        },\n  });\n\n  protected getValueJson() {\n    const value = this.value.toJSON() || {};\n    delete value['voxelSize'];\n    return value;\n  }\n}\n\nfunction quaternionIsIdentity(q: quat) {\n  return q[0] === 0 && q[1] === 0 && q[2] === 0 && q[3] === 1;\n}\n\nexport class OrientationState extends RefCounted {\n  orientation: quat;\n  changed = new NullarySignal();\n\n  constructor(orientation?: quat) {\n    super();\n    if (orientation == null) {\n      orientation = quat.create();\n    }\n    this.orientation = orientation;\n  }\n  toJSON() {\n    let {orientation} = this;\n    quat.normalize(this.orientation, this.orientation);\n    if (quaternionIsIdentity(orientation)) {\n      return undefined;\n    }\n    return Array.prototype.slice.call(this.orientation);\n  }\n  restoreState(obj: any) {\n    try {\n      parseFiniteVec(this.orientation, obj);\n      quat.normalize(this.orientation, this.orientation);\n    } catch (ignoredError) {\n      quat.identity(this.orientation);\n    }\n    this.changed.dispatch();\n  }\n\n  reset() {\n    quat.identity(this.orientation);\n    this.changed.dispatch();\n  }\n\n  snap() {\n    let mat = mat3.create();\n    mat3.fromQuat(mat, this.orientation);\n    let usedAxes = [false, false, false];\n    for (let i = 0; i < 3; ++i) {\n      let maxComponent = 0;\n      let argmaxComponent = 0;\n      for (let j = 0; j < 3; ++j) {\n        let value = mat[i * 3 + j];\n        mat[i * 3 + j] = 0;\n        if (usedAxes[j]) {\n          continue;\n        }\n        if (Math.abs(value) > Math.abs(maxComponent)) {\n          maxComponent = value;\n          argmaxComponent = j;\n        }\n      }\n      mat[i * 3 + argmaxComponent] = Math.sign(maxComponent);\n      usedAxes[argmaxComponent] = true;\n    }\n    quat.fromMat3(this.orientation, mat);\n    this.changed.dispatch();\n  }\n\n  /**\n   * Returns a new OrientationState with orientation fixed to peerToSelf * peer.orientation.  Any\n   * changes to the returned OrientationState will cause a corresponding change in peer, and vice\n   * versa.\n   */\n  static makeRelative(peer: OrientationState, peerToSelf: quat) {\n    let self = new OrientationState(quat.multiply(quat.create(), peer.orientation, peerToSelf));\n    let updatingPeer = false;\n    self.registerDisposer(peer.changed.add(() => {\n      if (!updatingPeer) {\n        updatingSelf = true;\n        quat.multiply(self.orientation, peer.orientation, peerToSelf);\n        self.changed.dispatch();\n        updatingSelf = false;\n      }\n    }));\n    let updatingSelf = false;\n    const selfToPeer = quat.invert(quat.create(), peerToSelf);\n    self.registerDisposer(self.changed.add(() => {\n      if (!updatingSelf) {\n        updatingPeer = true;\n        quat.multiply(peer.orientation, self.orientation, selfToPeer);\n        peer.changed.dispatch();\n        updatingPeer = false;\n      }\n    }));\n    return self;\n  }\n\n  assign(other: Borrowed<OrientationState>) {\n    quat.copy(this.orientation, other.orientation);\n    this.changed.dispatch();\n  }\n}\n\nexport class LinkedOrientationState extends LinkedBase<OrientationState> {\n  value = makeLinked(new OrientationState(), this.peer, this.link, {\n    assign: (a: OrientationState, b: OrientationState) => a.assign(b),\n    isValid: () => true,\n    difference:\n        (a: OrientationState, b: OrientationState) => {\n          const temp = quat.create();\n          return quat.multiply(temp, quat.invert(temp, b.orientation), a.orientation);\n        },\n    add:\n        (target: OrientationState, source: OrientationState, amount: quat) => {\n          quat.multiply(target.orientation, source.orientation, amount);\n          target.changed.dispatch();\n        },\n    subtract:\n        (target: OrientationState, source: OrientationState, amount: quat) => {\n          quat.multiply(target.orientation, source.orientation, quat.invert(tempQuat, amount));\n          target.changed.dispatch();\n        }\n  });\n}\n\nexport class Pose extends RefCounted {\n  position: SpatialPosition;\n  orientation: OrientationState;\n  changed = new NullarySignal();\n  constructor(position?: Owned<SpatialPosition>, orientation?: Owned<OrientationState>) {\n    super();\n    if (position == null) {\n      position = new SpatialPosition();\n    }\n    this.position = position;\n    if (orientation == null) {\n      orientation = new OrientationState();\n    }\n    this.orientation = orientation;\n    this.registerDisposer(this.position);\n    this.registerDisposer(this.orientation);\n    this.registerDisposer(this.position.changed.add(this.changed.dispatch));\n    this.registerDisposer(this.orientation.changed.add(this.changed.dispatch));\n  }\n\n  get valid() {\n    return this.position.valid;\n  }\n\n  /**\n   * Resets everything.\n   */\n  reset() {\n    this.position.reset();\n    this.orientation.reset();\n  }\n\n  toMat4(mat: mat4) {\n    mat4.fromRotationTranslation(\n        mat, this.orientation.orientation, this.position.spatialCoordinates);\n  }\n\n  toJSON() {\n    let positionJson = this.position.toJSON();\n    let orientationJson = this.orientation.toJSON();\n    if (positionJson === undefined && orientationJson === undefined) {\n      return undefined;\n    }\n    return {'position': positionJson, 'orientation': orientationJson};\n  }\n\n  restoreState(obj: any) {\n    verifyObject(obj);\n    verifyObjectProperty(obj, 'position', x => {\n      if (x !== undefined) {\n        this.position.restoreState(x);\n      }\n    });\n    verifyObjectProperty(obj, 'orientation', x => {\n      if (x !== undefined) {\n        this.orientation.restoreState(x);\n      }\n    });\n  }\n\n  /**\n   * Snaps the orientation to the nearest axis-aligned orientation, and\n   * snaps the position to the nearest voxel.\n   */\n  snap() {\n    this.orientation.snap();\n    this.position.snapToVoxel();\n    this.changed.dispatch();\n  }\n  translateAbsolute(translation: vec3) {\n    vec3.add(this.position.spatialCoordinates, this.position.spatialCoordinates, translation);\n    this.position.changed.dispatch();\n  }\n  translateRelative(translation: vec3) {\n    if (!this.valid) {\n      return;\n    }\n    const temp = tempVec3;\n    vec3.transformQuat(temp, translation, this.orientation.orientation);\n    vec3.add(this.position.spatialCoordinates, this.position.spatialCoordinates, temp);\n    this.position.changed.dispatch();\n  }\n  translateVoxelsRelative(translation: vec3) {\n    if (!this.valid) {\n      return;\n    }\n    var temp = vec3.create();\n    vec3.transformQuat(temp, translation, this.orientation.orientation);\n    vec3.multiply(temp, temp, this.position.voxelSize.size);\n    vec3.add(this.position.spatialCoordinates, this.position.spatialCoordinates, temp);\n    this.position.changed.dispatch();\n  }\n  rotateRelative(axis: vec3, angle: number) {\n    var temp = quat.create();\n    quat.setAxisAngle(temp, axis, angle);\n    var orientation = this.orientation.orientation;\n    quat.multiply(orientation, orientation, temp);\n    this.orientation.changed.dispatch();\n  }\n\n  rotateAbsolute(axis: vec3, angle: number, fixedPoint?: vec3) {\n    var temp = quat.create();\n    quat.setAxisAngle(temp, axis, angle);\n    var orientation = this.orientation.orientation;\n    if (fixedPoint !== undefined) {\n      // We want the coordinates in the transformed coordinate frame of the fixed point to remain\n      // the same after the rotation.\n\n      // We have the invariants:\n      // oldOrienation * fixedPointLocal + oldPosition == fixedPoint.\n      // newOrientation * fixedPointLocal + newPosition == fixedPoint.\n\n      // Therefore, we compute fixedPointLocal by:\n      // fixedPointLocal == inverse(oldOrientation) * (fixedPoint - oldPosition).\n      let {spatialCoordinates} = this.position;\n      let fixedPointLocal = vec3.subtract(tempVec3, fixedPoint, spatialCoordinates);\n      let invOrientation = quat.invert(tempQuat, orientation);\n      vec3.transformQuat(fixedPointLocal, fixedPointLocal, invOrientation);\n\n      // We then compute the newPosition by:\n      // newPosition := fixedPoint - newOrientation * fixedPointLocal.\n      quat.multiply(orientation, temp, orientation);\n      vec3.transformQuat(spatialCoordinates, fixedPointLocal, orientation);\n      vec3.subtract(spatialCoordinates, fixedPoint, spatialCoordinates);\n\n      this.position.changed.dispatch();\n    } else {\n      quat.multiply(orientation, temp, orientation);\n    }\n    this.orientation.changed.dispatch();\n  }\n}\n\nexport class TrackableZoomState extends RefCounted {\n  constructor(private value_ = Number.NaN, public defaultValue = value_) {\n    super();\n  }\n  get value() {\n    return this.value_;\n  }\n  set value(newValue: number) {\n    if (newValue !== this.value_) {\n      this.value_ = newValue;\n      this.changed.dispatch();\n    }\n  }\n  changed = new NullarySignal();\n\n  toJSON() {\n    let {value_, defaultValue} = this;\n    if (Number.isNaN(value_) && Number.isNaN(defaultValue) || value_ === defaultValue) {\n      return undefined;\n    }\n    return value_;\n  }\n\n  restoreState(obj: any) {\n    if (typeof obj === 'number' && Number.isFinite(obj) && obj > 0) {\n      this.value = obj;\n    } else {\n      this.value = this.defaultValue;\n    }\n  }\n\n  reset() {\n    this.value = this.defaultValue;\n  }\n\n  zoomBy(factor: number) {\n    let {value_} = this;\n    if (Number.isNaN(value_)) {\n      return;\n    }\n    this.value = value_ * factor;\n  }\n\n  assign(other: TrackableZoomState) {\n    this.value = other.value;\n  }\n\n  get valid() {\n    return !Number.isNaN(this.value);\n  }\n}\n\nexport class LinkedZoomState extends LinkedBase<TrackableZoomState> {\n  value = (() => {\n    const self = new TrackableZoomState();\n    const assign = (target: TrackableZoomState, source: TrackableZoomState) =>\n        target.assign(source);\n    const difference = (a: TrackableZoomState, b: TrackableZoomState) => {\n      return a.value / b.value;\n    };\n    const add = (target: TrackableZoomState, source: TrackableZoomState, amount: number) => {\n      target.value = source.value * amount;\n    };\n    const subtract = (target: TrackableZoomState, source: TrackableZoomState, amount: number) => {\n      target.value = source.value / amount;\n    };\n    const isValid = (x: TrackableZoomState) => x.valid;\n    return makeLinked(self, this.peer, this.link, {assign, isValid, difference, add, subtract});\n  })();\n}\n\nexport class NavigationState extends RefCounted {\n  changed = new NullarySignal();\n  zoomFactor: TrackableZoomState;\n\n  constructor(\n      public pose: Owned<Pose> = new Pose(),\n      zoomFactor: number|Owned<TrackableZoomState> = Number.NaN) {\n    super();\n    if (typeof zoomFactor === 'number') {\n      this.zoomFactor = new TrackableZoomState(zoomFactor);\n    } else {\n      this.zoomFactor = zoomFactor;\n    }\n    this.registerDisposer(this.zoomFactor);\n    this.registerDisposer(pose);\n    this.registerDisposer(this.pose.changed.add(() => {\n      this.changed.dispatch();\n    }));\n    this.registerDisposer(this.zoomFactor.changed.add(() => {\n      this.changed.dispatch();\n    }));\n    this.registerDisposer(this.voxelSize.changed.add(() => {\n      this.handleVoxelSizeChanged();\n    }));\n    this.handleVoxelSizeChanged();\n  }\n  get voxelSize() {\n    return this.pose.position.voxelSize;\n  }\n\n  /**\n   * Resets everything.\n   */\n  reset() {\n    this.pose.reset();\n    this.zoomFactor.reset();\n  }\n\n  private setZoomFactorFromVoxelSize() {\n    let {voxelSize} = this;\n    if (voxelSize.valid) {\n      this.zoomFactor.value = Math.min.apply(null, this.voxelSize.size);\n    }\n  }\n\n  /**\n   * Sets the zoomFactor to the minimum voxelSize if it is not already set.\n   */\n  private handleVoxelSizeChanged() {\n    if (!this.zoomFactor.valid) {\n      this.setZoomFactorFromVoxelSize();\n    }\n  }\n  get position() {\n    return this.pose.position;\n  }\n  toMat4(mat: mat4) {\n    this.pose.toMat4(mat);\n    let zoom = this.zoomFactor.value;\n    mat4.scale(mat, mat, vec3.fromValues(zoom, zoom, zoom));\n  }\n\n  get valid() {\n    return this.pose.valid;\n  }\n\n  toJSON() {\n    let poseJson = this.pose.toJSON();\n    let zoomFactorJson = this.zoomFactor.toJSON();\n    if (poseJson === undefined && zoomFactorJson === undefined) {\n      return undefined;\n    }\n    return {'pose': poseJson, 'zoomFactor': zoomFactorJson};\n  }\n\n  restoreState(obj: any) {\n    try {\n      verifyObject(obj);\n      verifyObjectProperty(obj, 'pose', x => {\n        if (x !== undefined) {\n          this.pose.restoreState(x);\n        }\n      });\n      verifyObjectProperty(obj, 'zoomFactor', x => {\n        if (x !== undefined) {\n          this.zoomFactor.restoreState(x);\n        }\n      });\n      this.handleVoxelSizeChanged();\n      this.changed.dispatch();\n    } catch (parseError) {\n      this.reset();\n    }\n  }\n\n  zoomBy(factor: number) {\n    this.zoomFactor.zoomBy(factor);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {verifyFinitePositiveFloat} from 'neuroglancer/util/json';\nimport {VisibilityPriorityAggregator} from 'neuroglancer/visibility_priority/frontend';\nimport { NullarySignal } from './util/signal';\n\nexport const numRenderScaleHistogramBins = 40;\nexport const renderScaleHistogramBinSize = 0.5;\nexport const renderScaleHistogramOrigin = -4;\n\nexport function getRenderScaleHistogramOffset(renderScale: number): number {\n  return (Math.log2(renderScale) - renderScaleHistogramOrigin) / renderScaleHistogramBinSize;\n}\n\nexport function getRenderScaleFromHistogramOffset(offset: number): number {\n  return 2 ** (offset * renderScaleHistogramBinSize + renderScaleHistogramOrigin);\n}\n\nexport function trackableRenderScaleTarget(initialValue: number) {\n  return new TrackableValue<number>(initialValue, verifyFinitePositiveFloat);\n}\n\nexport class RenderScaleHistogram {\n  visibility = new VisibilityPriorityAggregator();\n  changed = new NullarySignal();\n\n  /**\n   * Frame number corresponding to the current histogram.\n   */\n  frameNumber = -1;\n\n  /**\n   * Maps from spatial scale (nanometers) to histogram row index in the range\n   * `[0, spatialScales.size)`.\n   */\n  spatialScales = new Map<number, number>();\n\n  /**\n   * Current number of rows allocated for the histogram.\n   */\n  numHistogramRows = 1;\n\n  /**\n   * Initially allocate one row.\n   */\n  value = new Uint32Array(numRenderScaleHistogramBins * this.numHistogramRows * 2);\n\n  begin(frameNumber: number) {\n    if (frameNumber !== this.frameNumber) {\n      this.value.fill(0);\n      this.frameNumber = frameNumber;\n      this.spatialScales.clear();\n      this.changed.dispatch();\n    }\n  }\n\n  /**\n   * Adds a count to the histogram.\n   *\n   * @param spatialScale Spatial resolution of data in nanometers.\n   * @param renderScale Rendered scale of data in screen pixels.\n   * @param presentCount Number of present chunks.\n   * @param notPresentCount Number of desired but not-present chunks.\n   */\n  add(spatialScale: number, renderScale: number, presentCount: number, notPresentCount: number) {\n    let {spatialScales, numHistogramRows, value} = this;\n    let spatialScaleIndex = spatialScales.get(spatialScale);\n    if (spatialScaleIndex === undefined) {\n      spatialScaleIndex = spatialScales.size;\n      spatialScales.set(spatialScale, spatialScaleIndex);\n    }\n    if (spatialScaleIndex >= numHistogramRows) {\n      this.numHistogramRows = numHistogramRows *= 2;\n      const newValue = new Uint32Array(numHistogramRows * numRenderScaleHistogramBins * 2);\n      newValue.set(value);\n      this.value = value = newValue;\n    }\n    const index = spatialScaleIndex * numRenderScaleHistogramBins * 2 +\n        Math.min(\n            Math.max(0, Math.round(getRenderScaleHistogramOffset(renderScale))),\n            numRenderScaleHistogramBins - 1);\n    value[index] += presentCount;\n    value[index + numRenderScaleHistogramBins] += notPresentCount;\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Tabbed view widget.\n */\n\nimport 'neuroglancer/widget/tab_view.css';\n\nimport {Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren, removeFromParent} from 'neuroglancer/util/dom';\nimport {NullarySignal, Signal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\nimport {WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\n\nexport class Tab extends RefCounted {\n  element = document.createElement('div');\n\n  get visible() {\n    return this.visibility.visible;\n  }\n\n  constructor(public visibility = new WatchableVisibilityPriority()) {\n    super();\n    const {element} = this;\n    element.classList.add('neuroglancer-tab-content');\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n\nexport class OptionSpecification<T> extends RefCounted implements Trackable {\n  changed = new NullarySignal();\n  options = new Map<string, T>();\n  optionsChanged = new NullarySignal();\n\n  private selectedValue: string|undefined = undefined;\n  private defaultValue: string|undefined = undefined;\n\n  get value() {\n    const {selectedValue} = this;\n    if (selectedValue !== undefined) {\n      return selectedValue;\n    }\n    return this.defaultValue;\n  }\n\n  set default(value: string|undefined) {\n    if (this.defaultValue !== value) {\n      this.defaultValue = value;\n      this.changed.dispatch();\n    }\n  }\n\n  get default() {\n    return this.defaultValue;\n  }\n\n  set value(value: string|undefined) {\n    if (value !== undefined && this.ready_ && !this.options.has(value)) {\n      value = undefined;\n    }\n    const {selectedValue} = this;\n    if (selectedValue !== value) {\n      this.selectedValue = value;\n      this.changed.dispatch();\n    }\n  }\n\n  get validValue() {\n    const value = this.selectedValue;\n    if (value === undefined || !this.options.has(value)) {\n      return this.defaultValue;\n    }\n    return value;\n  }\n\n  add(id: string, value: T) {\n    const {options} = this;\n    if (options.has(id)) {\n      throw new Error(`Option already defined: ${JSON.stringify(id)}.`);\n    }\n    options.set(id, value);\n    this.optionsChanged.dispatch();\n    if (this.defaultValue === undefined) {\n      this.default = id;\n    }\n  }\n\n  toJSON() {\n    const {value, defaultValue} = this;\n    if (value === defaultValue) {\n      return undefined;\n    }\n    return value;\n  }\n\n  reset() {\n    this.value = undefined;\n  }\n\n  ready_ = true;\n\n  /**\n   * When `ready` is `false`, the selected `value` may be set to an unknown option.\n   */\n  get ready() {\n    return this.ready_;\n  }\n\n  set ready(value: boolean) {\n    if (value !== this.ready_) {\n      this.ready_ = value;\n      if (value) {\n        this.value = this.value;\n      }\n      this.changed.dispatch();\n    }\n  }\n\n  restoreState(obj: any) {\n    if (typeof obj !== 'string') {\n      obj = undefined;\n    }\n    this.value = obj;\n  }\n}\n\nexport class StackView<TabId, TabType extends Tab = Tab> extends RefCounted {\n  element = document.createElement('div');\n  tabs = new Map<TabId, Owned<TabType>>();\n  tabVisibilityChanged = new Signal<(id: TabId, visible: boolean) => void>();\n\n  private selectedTabValue: TabId|undefined;\n  private displayedTab: TabId|undefined;\n\n  get visible() {\n    return this.visibility.visible;\n  }\n\n  get selected() {\n    return this.selectedTabValue;\n  }\n\n  set selected(id: TabId|undefined) {\n    this.selectedTabValue = id;\n    this.updateSelectedTab();\n  }\n\n  constructor(\n      public getter: (id: TabId) => Owned<TabType>,\n      public visibility = new WatchableVisibilityPriority()) {\n    super();\n\n    const {element} = this;\n    element.className = 'neuroglancer-stack-view';\n    this.registerDisposer(visibility.changed.add(() => this.updateSelectedTab()));\n    this.updateSelectedTab();\n  }\n\n  invalidate(id: TabId) {\n    const {tabs} = this;\n    const tab = tabs.get(id);\n    if (tab === undefined) {\n      return;\n    }\n    tab.dispose();\n    tabs.delete(id);\n    if (id === this.displayedTab) {\n      this.displayedTab = undefined;\n      this.updateSelectedTab();\n    }\n  }\n\n  private hideTab(id: TabId) {\n    const tab = this.tabs.get(id);\n    if (tab !== undefined) {\n      tab.visibility.value = WatchableVisibilityPriority.IGNORED;\n      tab.element.style.display = 'none';\n    }\n    this.tabVisibilityChanged.dispatch(id, false);\n  }\n\n  private showTab(id: TabId) {\n    const {tabs} = this;\n    let tab = tabs.get(id);\n    if (tab === undefined) {\n      tab = this.getter(id);\n      this.element.appendChild(tab.element);\n      tabs.set(id, tab);\n    }\n    tab.element.style.display = null;\n    tab.visibility.value = WatchableVisibilityPriority.VISIBLE;\n    this.tabVisibilityChanged.dispatch(id, true);\n  }\n\n  private updateSelectedTab() {\n    const {displayedTab} = this;\n    const newTab = this.visible ? this.selectedTabValue : undefined;\n    if (newTab === displayedTab) {\n      return;\n    }\n    if (displayedTab !== undefined) {\n      this.hideTab(displayedTab);\n    }\n    this.displayedTab = newTab;\n    if (newTab === undefined) {\n      return;\n    }\n    this.showTab(newTab);\n  }\n\n  invalidateAll() {\n    const {tabs} = this;\n    for (const tab of tabs.values()) {\n      tab.dispose();\n    }\n    tabs.clear();\n    this.updateSelectedTab();\n  }\n\n  disposed() {\n    this.selectedTabValue = undefined;\n    this.invalidateAll();\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n\nexport class TabSpecification extends\n    OptionSpecification<{label: string, order?: number, getter: () => Owned<Tab>}> {}\n\nexport class TabView extends RefCounted {\n  element = document.createElement('div');\n  tabBar = document.createElement('div');\n\n  private stack: StackView<string>;\n  private tabLabels = new Map<string, HTMLElement>();\n\n  private tabsGeneration = -1;\n\n  get visible() {\n    return this.visibility.visible;\n  }\n\n  constructor(\n      public state: TabSpecification, public visibility = new WatchableVisibilityPriority()) {\n    super();\n\n    const {element, tabBar} = this;\n    element.className = 'neuroglancer-tab-view';\n    tabBar.className = 'neuroglancer-tab-view-bar';\n    element.appendChild(tabBar);\n    // It is important to register our visibility changed handler before the StackView registers its\n    // visibility changed handler, so that tab labels are created before tabVisibilityChanged\n    // signals are received.\n    this.registerDisposer(visibility.changed.add(() => {\n      this.updateTabs();\n    }));\n    const stack = this.stack = this.registerDisposer(\n        new StackView<string>(id => this.state.options.get(id)!.getter(), this.visibility));\n    element.appendChild(stack.element);\n\n    this.registerDisposer(this.state.changed.add(() => this.updateSelectedTab()));\n    this.registerDisposer(this.state.optionsChanged.add(() => this.updateTabs()));\n    this.stack.tabVisibilityChanged.add((id, visible) => {\n      const labelElement = this.tabLabels.get(id)!;\n      const className = 'neuroglancer-selected-tab-label';\n      if (visible) {\n        labelElement.classList.add(className);\n      } else {\n        labelElement.classList.remove(className);\n      }\n    });\n    this.updateTabs();\n  }\n\n  private updateTabs() {\n    if (this.tabsGeneration !== this.state.optionsChanged.count) {\n      this.destroyTabs();\n      if (this.visible) {\n        this.makeTabs();\n      }\n      this.updateSelectedTab();\n    }\n  }\n\n  private updateSelectedTab() {\n    this.stack.selected = this.state.value;\n  }\n\n  private destroyTabs() {\n    if (this.tabsGeneration === -1) {\n      return;\n    }\n    this.stack.selected = undefined;\n    this.tabLabels.clear();\n    removeChildren(this.tabBar);\n    this.tabsGeneration = -1;\n    this.stack.invalidateAll();\n  }\n\n  private makeTabs() {\n    const {tabBar, tabLabels} = this;\n    const optionsArray = Array.from(this.state.options);\n    optionsArray.sort(([, {order: aOrder = 0}], [, {order: bOrder = 0}]) => {\n      return aOrder - bOrder;\n    });\n    for (const [id, {label}] of optionsArray) {\n      const labelElement = document.createElement('div');\n      labelElement.classList.add('neuroglancer-tab-label');\n      labelElement.textContent = label;\n      labelElement.addEventListener('click', () => {\n        this.state.value = id;\n      });\n      tabLabels.set(id, labelElement);\n      tabBar.appendChild(labelElement);\n    }\n    this.tabsGeneration = this.state.optionsChanged.count;\n  }\n\n  disposed() {\n    removeChildren(this.tabBar);\n    this.tabLabels.clear();\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Annotation, AnnotationType} from 'neuroglancer/annotation';\nimport {AnnotationLayer} from 'neuroglancer/annotation/frontend';\nimport {PerspectiveViewRenderContext} from 'neuroglancer/perspective_view/render_layer';\nimport {SliceViewPanelRenderContext} from 'neuroglancer/sliceview/panel';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nexport interface AnnotationRenderContext {\n  buffer: Buffer;\n  annotationLayer: AnnotationLayer;\n  renderContext: SliceViewPanelRenderContext|PerspectiveViewRenderContext;\n  bufferOffset: number;\n  count: number;\n  basePickId: number;\n  selectedIndex: number;\n  projectionMatrix: mat4;\n}\n\nconst tempPickID = new Float32Array(4);\n\nexport abstract class AnnotationRenderHelper extends RefCounted {\n  pickIdsPerInstance: number;\n  targetIsSliceView: boolean;\n\n  constructor(public gl: GL) {\n    super();\n  }\n\n  setPartIndex(builder: ShaderBuilder, ...partIndexExpressions: string[]) {\n    let s = `\nvoid setPartIndex(${partIndexExpressions.map((_, i) => `highp uint partIndex${i}`).join()}) {\n  highp uint pickID = uPickID;\n  highp uint pickBaseOffset = getPickBaseOffset();\n${\n        partIndexExpressions\n            .map((_, i) => `highp uint pickOffset${i} = pickBaseOffset + partIndex${i};`)\n            .join('\\n')}\n`;\n    if (partIndexExpressions.length === 0) {\n      s += `\n  highp uint pickOffset0 = pickBaseOffset;\n`;\n    }\n    s += `\n  vPickID = pickID + pickOffset0;\n  highp uint selectedIndex = uSelectedIndex;\nif (selectedIndex == pickBaseOffset${\n        partIndexExpressions.map((_, i) => ` || selectedIndex == pickOffset${i}`).join('')}) {\n    vColor = uColorSelected;\n  } else {\n    vColor = uColor;\n  }\n}\n`;\n    builder.addVertexCode(s);\n    return `setPartIndex(${partIndexExpressions.join()})`;\n  }\n\n  getCrossSectionFadeFactor() {\n    if (this.targetIsSliceView) {\n      return `(clamp(1.0 - 2.0 * abs(0.5 - gl_FragCoord.z), 0.0, 1.0))`;\n    } else {\n      return `(1.0)`;\n    }\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    builder.addUniform('highp vec4', 'uColor');\n    builder.addUniform('highp vec4', 'uColorSelected');\n    builder.addUniform('highp uint', 'uSelectedIndex');\n    builder.addVarying('highp vec4', 'vColor');\n    // Transform from camera to clip coordinates.\n    builder.addUniform('highp mat4', 'uProjection');\n    builder.addUniform('highp uint', 'uPickID');\n    builder.addVarying('highp uint', 'vPickID', 'flat');\n\n    builder.addVertexCode(`\nhighp uint getPickBaseOffset() { return uint(gl_InstanceID) * ${this.pickIdsPerInstance}u; }\n`);\n\n    builder.addFragmentCode(`\nvoid emitAnnotation(vec4 color) {\n  emit(color, vPickID);\n}\n`);\n  }\n\n  enable(shader: ShaderProgram, context: AnnotationRenderContext, callback: () => void) {\n    shader.bind();\n    const {gl} = this;\n    const {renderContext} = context;\n    const {annotationLayer} = context;\n    gl.uniformMatrix4fv(shader.uniform('uProjection'), false, context.projectionMatrix);\n    if (renderContext.emitPickID) {\n      gl.uniform1ui(shader.uniform('uPickID'), context.basePickId);\n    }\n    if (renderContext.emitColor) {\n      const colorVec4 = tempPickID;\n      const color = annotationLayer.state.color.value;\n      colorVec4[0] = color[0];\n      colorVec4[1] = color[1];\n      colorVec4[2] = color[2];\n      colorVec4[3] = 1;\n      gl.uniform4fv(shader.uniform('uColor'), colorVec4);\n      const saturationAmount = 0.75;\n      for (let i = 0; i < 3; ++i) {\n        colorVec4[i] = saturationAmount + (1 - saturationAmount) * colorVec4[i];\n      }\n      gl.uniform4fv(shader.uniform('uColorSelected'), colorVec4);\n      gl.uniform1ui(shader.uniform('uSelectedIndex'), context.selectedIndex);\n    }\n\n    callback();\n  }\n\n  abstract draw(context: AnnotationRenderContext): void;\n}\n\ninterface AnnotationTypeRenderHandler<T extends Annotation> {\n  bytes: number;\n  serializer:\n      (buffer: ArrayBuffer, offset: number,\n       numAnnotations: number) => ((annotation: T, index: number) => void);\n  perspectiveViewRenderHelper: {\n    new(\n        gl: GL,\n        ): AnnotationRenderHelper;\n  };\n  sliceViewRenderHelper: {new(gl: GL): AnnotationRenderHelper;};\n  pickIdsPerInstance: number;\n  getRepresentativePoint: (objectToData: mat4, annotation: T, partIndex: number) => vec3;\n  updateViaRepresentativePoint:\n      (oldAnnotation: T, position: vec3, dataToObject: mat4, partIndex: number) => T;\n  snapPosition:\n      (position: vec3, objectToData: mat4, data: ArrayBuffer, offset: number,\n       partIndex: number) => void;\n}\n\nconst annotationTypeRenderHandlers =\n    new Map<AnnotationType, AnnotationTypeRenderHandler<Annotation>>();\n\nexport function registerAnnotationTypeRenderHandler<T extends Annotation>(\n    type: AnnotationType, handler: AnnotationTypeRenderHandler<T>) {\n  annotationTypeRenderHandlers.set(type, handler);\n}\n\nexport function getAnnotationTypeRenderHandler(type: AnnotationType):\n    AnnotationTypeRenderHandler<Annotation> {\n  return annotationTypeRenderHandlers.get(type)!;\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facility for triggering named actions in response to touch events.\n */\n\nimport throttle from 'lodash/throttle';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {ActionEvent, dispatchEvent, EventActionMap, EventActionMapInterface, registerActionListener} from 'neuroglancer/util/event_action_map';\n\nexport interface TouchTapInfo {\n  event: TouchEvent;\n  centerX: number;\n  centerY: number;\n}\n\nexport interface TouchTranslateInfo {\n  event: TouchEvent;\n  centerX: number;\n  centerY: number;\n  deltaX: number;\n  deltaY: number;\n}\n\nexport interface TouchPinchInfo {\n  event: TouchEvent;\n  centerX: number;\n  centerY: number;\n  distance: number;\n  prevDistance: number;\n}\n\nexport interface TouchRotateInfo {\n  event: TouchEvent;\n  centerX: number;\n  centerY: number;\n  angle: number;\n  prevAngle: number;\n}\n\nexport interface TouchHoldInfo {\n  event: TouchEvent;\n  centerX: number;\n  centerY: number;\n}\n\n/**\n * Minimum number of pixels in x and y that a touch point must move to trigger a\n * translate/rotate/pinch action.  This helps filter out spurious tiny movements that are hard to\n * avoid, especially with one finger touches.\n **/\nconst moveThreshold = 10;\n\n/**\n * Number of milliseconds that a set of touch points must be held without moving (per moveThreshold)\n * to trigger a touchhold action.\n **/\nconst holdThreshold = 1000;\n\n/**\n * Maximum duration of a tap.\n */\nconst maxTapDuration = 400;\n\n/**\n * Maximum number of milliseconds delay between two taps to trigger a multitap action.\n */\nconst multiTapMaxInterval = 500;\n\nconst rotateThreshold = Math.PI / 20;\nconst pinchThreshold = 20\nconst translateThreshold = 10;\n\nfunction norm2(deltaX: number, deltaY: number) {\n  return Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n}\n\nfunction getTwoFingerDistanceAndAngle(touches: Iterable<Touch>) {\n  let [t0,t1] = touches;\n  if (t0.identifier > t1.identifier) {\n    [t1, t0] = [t0, t1];\n  }\n  const offsetX = t0.clientX - t1.clientX;\n  const offsetY = t0.clientY - t1.clientY;\n  const distance = norm2(offsetX, offsetY);\n  const angle = Math.atan2(offsetX, offsetY);\n  return {distance, angle};\n}\n\nfunction getAngleDifference(x: number, y: number) {\n  const TAU = Math.PI * 2;\n  const d = Math.abs(x - y) % TAU;\n  return Math.min(d, TAU - d);\n}\n\nexport class TouchEventBinder<EventMap extends EventActionMapInterface> extends RefCounted {\n  private dispatch(\n      eventIdentifier: string, event: Event, detail: any, eventPhase: number = event.eventPhase) {\n    dispatchEvent(eventIdentifier, event, eventPhase, detail, this.eventMap);\n  }\n  private prevTouches = new Map<number, Touch>();\n  private prevEvent?: TouchEvent;\n  private moved = false;\n\n  /**\n   * Initial angle for two-finger touch.  Once the difference between this ange the current angle\n   * exceeds `rotateThreshold`, `touchrotate` events are dispatched.\n   **/\n  private prevAngle = 0;\n  private rotated = false;\n\n  /**\n   * Initial distance for two-finger touch.  Once the difference between this ange the current\n   * distance exceeds `pinchThreshold`, `touchpinich` events are dispatched.\n   **/\n  private prevDistance = 0;\n  private pinched = false;\n\n  private prevCenterX = 0;\n  private prevCenterY = 0;\n  private translated = false;\n  \n  private startHold = this.registerCancellable(\n      throttle((event: TouchEvent, eventPhase: number, centerX: number, centerY: number) => {\n        const info = {event, centerX, centerY};\n        this.dispatch(`touchhold${event.targetTouches.length}`, event, info, eventPhase);\n      }, holdThreshold, {leading: false, trailing: true}));\n  private numPriorTaps = 0;\n  private priorTapNumTouches = 0;\n  private tapStartTime = 0;\n  private tapEndTime = 0;\n  private curTapNumTouches = 0;\n\n  private handleTouchEvent(event: TouchEvent) {\n    if (event.target === this.target) {\n      event.preventDefault();\n    } else {\n      return;\n    }\n    const newTouches = new Map<number, Touch>();\n    const {prevTouches, prevEvent} = this;\n    \n    // Compute average movement.\n    let centerX = 0, centerY = 0;\n    \n    for (const touch of event.targetTouches) {\n      newTouches.set(touch.identifier, touch);\n      centerX += touch.clientX;\n      centerY += touch.clientY;\n    }\n    centerX /= newTouches.size;\n    centerY /= newTouches.size;\n    // Remove touches that are no longer matched.\n    for (const [key, touch] of prevTouches.entries()) {\n      const newTouch = newTouches.get(key);\n      if (newTouch === undefined) {\n        prevTouches.delete(key);\n      } else {\n        const deltaX = newTouch.clientX - touch.clientX;\n        const deltaY = newTouch.clientY - touch.clientY;\n        if (Math.abs(deltaX) >= moveThreshold || Math.abs(deltaY) >= moveThreshold) {\n          this.moved = true;\n        }\n      }\n    }\n\n    if (prevEvent === undefined || prevEvent.targetTouches.length !== newTouches.size ||\n        newTouches.size == 0) {\n      this.moved = false;\n\n      if (event.type === 'touchstart') {\n        this.startHold(event, event.eventPhase, centerX, centerY);\n        if (prevEvent === undefined || prevEvent.targetTouches.length === 0) {\n          this.tapStartTime = Date.now();\n          this.curTapNumTouches = 0;\n        }\n        this.curTapNumTouches = Math.max(this.curTapNumTouches, event.targetTouches.length);\n      } else {\n        if (event.type == 'touchend') {\n          const now = Date.now();\n          if (event.targetTouches.length === 0 && now - this.tapStartTime < maxTapDuration) {\n            if (this.curTapNumTouches !== this.priorTapNumTouches ||\n                now - this.tapEndTime >= multiTapMaxInterval) {\n              this.numPriorTaps = 0;\n            }\n            ++this.numPriorTaps;\n            this.tapEndTime = now;\n            this.priorTapNumTouches = this.curTapNumTouches;\n            const info: TouchTapInfo = {event, centerX, centerY};\n            this.dispatch(`touchtap${this.curTapNumTouches}x${this.numPriorTaps}`, event, info);\n          }\n        }\n        this.startHold.cancel();\n      }\n      // Number of touches has changed.  Don't dispatch any events.\n      // TODO: handle tap events\n      this.prevTouches = newTouches;\n      this.prevEvent = event;\n\n      this.prevCenterX = centerX;\n      this.prevCenterY = centerY;\n      this.translated = false;\n\n      if (newTouches.size === 2) {\n        const {distance, angle} = getTwoFingerDistanceAndAngle(newTouches.values());\n        this.prevDistance = distance;\n        this.prevAngle = angle;\n        this.rotated = false;\n        this.pinched = false;\n      }\n      return;\n    }\n\n    if (!this.moved) {\n      return;\n    }\n    this.tapStartTime = 0;\n    this.startHold.cancel();\n    this.prevTouches = newTouches;\n    this.prevEvent = event;\n\n    let {prevCenterX, prevCenterY, translated} = this;\n    const deltaX = centerX - prevCenterX;\n    const deltaY = centerY - prevCenterY;\n    if (translated === false && norm2(deltaX, deltaY) >= translateThreshold) {\n      translated = this.translated = true;\n    }\n    if (translated === true && (deltaX !== 0 || deltaY !== 0)) {\n      this.prevCenterX = centerX;\n      this.prevCenterY = centerY;\n      const info: TouchTranslateInfo = {event, deltaX, deltaY, centerX, centerY};\n      this.dispatch(`touchtranslate${newTouches.size}`, event, info);\n    }\n\n    if (newTouches.size === 2) {\n      const {distance, angle} = getTwoFingerDistanceAndAngle(newTouches.values());\n      let {pinched, rotated, prevDistance, prevAngle} = this;\n      if (pinched === false && Math.abs(distance - prevDistance) >= pinchThreshold) {\n        this.pinched = pinched = true;\n      }\n\n      const angleDiff = getAngleDifference(angle, prevAngle);\n\n      if (rotated === false && angleDiff >= rotateThreshold) {\n        this.rotated = rotated = true;\n      }\n\n      if (pinched === true && distance != prevDistance) {\n        this.prevDistance = distance;\n        const info: TouchPinchInfo = {event, distance, prevDistance, centerX, centerY};\n        this.dispatch(`touchpinch`, event, info);\n      }\n\n      if (rotated === true && angle !== prevAngle) {\n        this.prevAngle = angle;\n        this.dispatch(`touchrotate`, event, {event, centerX, centerY, angle, prevAngle});\n      }\n    }\n  }\n  constructor(public target: HTMLElement, public eventMap: EventMap) {\n    super();\n    this.registerEventListener(target, 'touchstart', (event: TouchEvent) => {\n      this.handleTouchEvent(event);\n    });\n    this.registerEventListener(target, 'touchmove', (event: TouchEvent) => {\n      this.handleTouchEvent(event);\n    });\n    this.registerEventListener(target, 'touchend', (event: TouchEvent) => {\n      this.handleTouchEvent(event);\n    });\n  }\n}\n\nexport {EventActionMapInterface, EventActionMap, registerActionListener, ActionEvent};\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst DOM_DELTA_PIXEL = 0;\nconst DOM_DELTA_LINE = 1;\nconst DOM_DELTA_PAGE = 2;\n\nexport function getWheelZoomAmount(event: WheelEvent) {\n  let multiplier = 0;\n  let {deltaMode} = event;\n  switch (deltaMode) {\n    case DOM_DELTA_PIXEL:\n      multiplier = 1 / 200.0;\n      break;\n    case DOM_DELTA_LINE:\n      multiplier = 1 / 10.0;\n      break;\n    case DOM_DELTA_PAGE:\n      multiplier = 2;\n      break;\n  }\n  return Math.exp(event.deltaY * multiplier);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/rendered_data_panel.css';\nimport 'neuroglancer/noselect.css';\n\nimport {Annotation} from 'neuroglancer/annotation';\nimport {getSelectedAnnotation} from 'neuroglancer/annotation/selection';\nimport {getAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {DisplayContext, RenderedPanel} from 'neuroglancer/display_context';\nimport {NavigationState} from 'neuroglancer/navigation_state';\nimport {PickIDManager} from 'neuroglancer/object_picking';\nimport {UserLayerWithAnnotations} from 'neuroglancer/ui/annotations';\nimport {AutomaticallyFocusedElement} from 'neuroglancer/util/automatic_focus';\nimport {ActionEvent, EventActionMap, registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {AXES_NAMES, kAxes, mat4, vec2, vec3} from 'neuroglancer/util/geom';\nimport {KeyboardEventBinder} from 'neuroglancer/util/keyboard_bindings';\nimport {MouseEventBinder} from 'neuroglancer/util/mouse_bindings';\nimport {startRelativeMouseDrag} from 'neuroglancer/util/mouse_drag';\nimport {TouchEventBinder, TouchPinchInfo, TouchTranslateInfo} from 'neuroglancer/util/touch_bindings';\nimport {getWheelZoomAmount} from 'neuroglancer/util/wheel_zoom';\nimport {ViewerState} from 'neuroglancer/viewer_state';\n\nconst tempVec3 = vec3.create();\n\nexport interface RenderedDataViewerState extends ViewerState {\n  inputEventMap: EventActionMap;\n}\n\nexport class FramePickingData {\n  pickIDs = new PickIDManager();\n  viewportWidth: number = 0;\n  viewportHeight: number = 0;\n  invTransform = mat4.create();\n  frameNumber: number = -1;\n}\n\nexport class PickRequest {\n  buffer: WebGLBuffer|null = null;\n  glWindowX: number = 0;\n  glWindowY: number = 0;\n  frameNumber: number;\n  sync: WebGLSync|null;\n}\n\nconst pickRequestInterval = 30;\n\nexport const pickRadius = 12;\nexport const pickDiameter = 1 + pickRadius * 2;\n\n/**\n * Sequence of offsets into C order (pickDiamater, pickDiamater) array in order of increasing\n * distance from center.\n */\nexport const pickOffsetSequence = (() => {\n  const maxDist2 = pickRadius ** 2;\n  const getDist2 = (x: number, y: number) => (x - pickRadius) ** 2 + (y - pickRadius) ** 2;\n\n  let offsets = new Uint32Array(pickDiameter * pickDiameter);\n  let count = 0;\n  for (let x = 0; x < pickDiameter; ++x) {\n    for (let y = 0; y < pickDiameter; ++y) {\n      if (getDist2(x, y) > maxDist2) continue;\n      offsets[count++] = y * pickDiameter + x;\n    }\n  }\n  offsets = offsets.subarray(0, count);\n  offsets.sort((a, b) => {\n    const x1 = a % pickDiameter;\n    const y1 = (a - x1) / pickDiameter;\n    const x2 = b % pickDiameter;\n    const y2 = (b - x2) / pickDiameter;\n    return getDist2(x1, y1) - getDist2(x2, y2);\n  });\n\n  return offsets;\n})();\n\n/**\n * Sets array elements to 0 that would be outside the viewport.\n *\n * @param buffer Array view, which contains a C order (pickDiameter, pickDiameter) array.\n * @param baseOffset Offset into `buffer` corresponding to (0, 0).\n * @param stride Stride between consecutive elements of the array.\n * @param glWindowX Center x position, must be integer.\n * @param glWindowY Center y position, must be integer.\n * @param viewportWidth Width of viewport in pixels.\n * @param viewportHeight Width of viewport in pixels.\n */\nexport function clearOutOfBoundsPickData(\n    buffer: Float32Array, baseOffset: number, stride: number, glWindowX: number, glWindowY: number,\n    viewportWidth: number, viewportHeight: number) {\n  const startX = glWindowX - pickRadius;\n  const startY = glWindowY - pickRadius;\n  if (startX >= 0 && startY >= 0 && startX + pickDiameter <= viewportWidth &&\n      startY + pickDiameter <= viewportHeight) {\n    return;\n  }\n  for (let relativeY = 0; relativeY < pickDiameter; ++relativeY) {\n    for (let relativeX = 0; relativeX < pickDiameter; ++relativeX) {\n      const x = startX + relativeX;\n      const y = startY + relativeY;\n      if (x < 0 || y < 0 || x >= viewportWidth || y >= viewportHeight) {\n        buffer[baseOffset + (y * pickDiameter + x) * stride] = 0;\n      }\n    }\n  }\n}\n\nexport abstract class RenderedDataPanel extends RenderedPanel {\n  /**\n   * Current mouse position within the viewport, or -1 if the mouse is not in the viewport.\n   */\n  mouseX = -1;\n  mouseY = -1;\n\n  /**\n   * Equal to last-seen value of `this.element.clientWidth` and `this.element.clientHeight`.  If the\n   * size changed since the last frame, may not correspond to the last frame.\n   */\n  width: number;\n  height: number;\n\n  /**\n   * If `false`, either the mouse is not within the viewport, or a picking request was already\n   * issued for the current mouseX and mouseY after the most recent frame was rendered; when the\n   * current pick requests complete, no additional pick requests will be issued.\n   *\n   * If `true`, a picking request was not issued for the current mouseX and mouseY due to all pick\n   * buffers being in use; when a pick buffer becomes available, an additional pick request will be\n   * issued.\n   */\n  pickRequestPending = false;\n\n  private mouseStateForcer = () => this.blockOnPickRequest();\n\n  inputEventMap: EventActionMap;\n\n  navigationState: NavigationState;\n\n  pickingData = [new FramePickingData(), new FramePickingData()];\n  pickRequests = [new PickRequest(), new PickRequest()];\n  pickBufferContents: Float32Array = new Float32Array(2 * 4 * pickDiameter * pickDiameter);\n\n  /**\n   * Reads pick data for the current mouse position into the currently-bound pixel pack buffer.\n   */\n  abstract issuePickRequest(glWindowX: number, glWindowY: number): void;\n\n  /**\n   * Timer id for checking if outstanding pick requests have completed.\n   */\n  private pickTimerId = -1;\n\n  private cancelPickRequests() {\n    const {gl} = this;\n    for (const request of this.pickRequests) {\n      const {sync} = request;\n      if (sync !== null) {\n        gl.deleteSync(sync);\n      }\n      request.sync = null;\n    }\n    clearTimeout(this.pickTimerId);\n    this.pickTimerId = -1;\n  }\n\n  checkForResize() {\n    const {clientWidth, clientHeight} = this.element;\n    if (clientWidth !== this.width || clientHeight !== this.height) {\n      this.width = clientWidth;\n      this.height = clientHeight;\n      this.panelSizeChanged();\n    }\n  }\n\n  abstract panelSizeChanged(): void;\n\n  private issuePickRequestInternal(pickRequest: PickRequest) {\n    const {gl} = this;\n    let {buffer} = pickRequest;\n    if (buffer === null) {\n      buffer = pickRequest.buffer = gl.createBuffer();\n      gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER, buffer);\n      gl.bufferData(\n          WebGL2RenderingContext.PIXEL_PACK_BUFFER, 2 * 4 * 4 * pickDiameter * pickDiameter,\n          WebGL2RenderingContext.STREAM_READ);\n    } else {\n      gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER, buffer);\n    }\n    let glWindowX = this.mouseX;\n    let glWindowY = this.height - this.mouseY;\n    this.issuePickRequest(glWindowX, glWindowY);\n    pickRequest.sync = gl.fenceSync(WebGL2RenderingContext.SYNC_GPU_COMMANDS_COMPLETE, 0);\n    pickRequest.frameNumber = this.context.frameNumber;\n    pickRequest.glWindowX = glWindowX;\n    pickRequest.glWindowY = glWindowY;\n    gl.flush();\n    // TODO(jbms): maybe call gl.flush to ensure fence is submitted\n    gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER, null);\n    if (this.pickTimerId === -1) {\n      this.scheduleCheckForPickRequestCompletion();\n    }\n    this.pickRequestPending = false;\n    const {pickRequests} = this;\n    if (pickRequest !== pickRequests[0]) {\n      pickRequests[1] = pickRequests[0];\n      pickRequests[0] = pickRequest;\n    }\n    this.nextPickRequestTime = Date.now() + pickRequestInterval;\n  }\n\n  abstract completePickRequest(\n      glWindowX: number, glWindowY: number, data: Float32Array,\n      pickingData: FramePickingData): void;\n\n  private completePickInternal(pickRequest: PickRequest) {\n    const {gl} = this;\n    const {pickBufferContents} = this;\n    gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER, pickRequest.buffer);\n    gl.getBufferSubData(WebGL2RenderingContext.PIXEL_PACK_BUFFER, 0, pickBufferContents);\n    gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER, null);\n    const {pickingData} = this;\n    const {frameNumber} = pickRequest;\n    this.completePickRequest(\n        pickRequest.glWindowX, pickRequest.glWindowY, pickBufferContents,\n        pickingData[0].frameNumber === frameNumber ? pickingData[0] : pickingData[1]);\n  }\n\n  private scheduleCheckForPickRequestCompletion() {\n    this.pickTimerId = setTimeout(() => {\n      this.pickTimerId = -1;\n      this.checkForPickRequestCompletion();\n    }, 0);\n  }\n\n  private checkForPickRequestCompletion(checkingBeforeDraw = false, block = false) {\n    let currentFrameNumber = this.context.frameNumber;\n    let cancelIfNotReadyFrameNumber = -1;\n    if (checkingBeforeDraw) {\n      --currentFrameNumber;\n      cancelIfNotReadyFrameNumber = currentFrameNumber - 1;\n    }\n    const {pickRequests} = this;\n    const {gl} = this;\n    let remaining = false;\n    let cancelRemaining = false;\n    let available: PickRequest|undefined;\n    for (const pickRequest of pickRequests) {\n      const {sync} = pickRequest;\n      if (sync === null) continue;\n      const {frameNumber} = pickRequest;\n      if (!cancelRemaining && frameNumber >= currentFrameNumber - 1) {\n        if (block ||\n            gl.getSyncParameter(sync, WebGL2RenderingContext.SYNC_STATUS) ===\n                WebGL2RenderingContext.SIGNALED) {\n          this.completePickInternal(pickRequest);\n          cancelRemaining = true;\n        } else if (frameNumber !== cancelIfNotReadyFrameNumber) {\n          remaining = true;\n          continue;\n        }\n      }\n      gl.deleteSync(sync);\n      pickRequest.sync = null;\n      available = pickRequest;\n    }\n    const {pickTimerId} = this;\n    if (remaining && pickTimerId === -1) {\n      this.scheduleCheckForPickRequestCompletion();\n    } else if (!remaining && pickTimerId !== -1) {\n      clearTimeout(pickTimerId);\n      this.pickTimerId = -1;\n    }\n    if (!checkingBeforeDraw && available !== undefined && this.pickRequestPending &&\n        this.canIssuePickRequest()) {\n      this.issuePickRequestInternal(available);\n    }\n  }\n\n  private blockOnPickRequest() {\n    if (this.pickRequestPending) {\n      this.cancelPickRequests();\n      this.nextPickRequestTime = 0;\n      this.attemptToIssuePickRequest();\n    }\n    this.checkForPickRequestCompletion(/*checkingBeforeDraw=*/ false, /*block=*/ true);\n  }\n\n  draw() {\n    this.checkForResize();\n    const {width, height} = this;\n    if (width === 0 || height === 0) return;\n    this.checkForPickRequestCompletion(true);\n    const {pickingData} = this;\n    pickingData[0] = pickingData[1];\n    const currentFrameNumber = this.context.frameNumber;\n    const newPickingData = pickingData[1];\n    newPickingData.frameNumber = currentFrameNumber;\n    newPickingData.viewportWidth = width;\n    newPickingData.viewportHeight = height;\n    newPickingData.pickIDs.clear();\n    if (!this.drawWithPicking(newPickingData)) {\n      newPickingData.frameNumber = -1;\n      return;\n    }\n    // For the new frame, allow new pick requests regardless of interval since last request.\n    this.nextPickRequestTime = 0;\n    if (this.mouseX > 0) {\n      this.attemptToIssuePickRequest();\n    }\n  }\n\n  abstract drawWithPicking(pickingData: FramePickingData): boolean;\n\n  private nextPickRequestTime = 0;\n  private pendingPickRequestTimerId = -1;\n\n  private pendingPickRequestTimerExpired = () => {\n    this.pendingPickRequestTimerId = -1;\n    if (!this.pickRequestPending) return;\n    this.attemptToIssuePickRequest();\n  };\n\n  private canIssuePickRequest(): boolean {\n    const time = Date.now();\n    const {nextPickRequestTime, pendingPickRequestTimerId} = this;\n    if (time < nextPickRequestTime) {\n      if (pendingPickRequestTimerId == -1) {\n        this.pendingPickRequestTimerId =\n            setTimeout(this.pendingPickRequestTimerExpired, nextPickRequestTime - time);\n      }\n      return false;\n    }\n    return true;\n  }\n\n  private attemptToIssuePickRequest() {\n    if (!this.canIssuePickRequest()) return;\n    const currentFrameNumber = this.context.frameNumber;\n    const {gl} = this;\n\n    const {pickRequests} = this;\n\n    // Try to find an available PickRequest object.\n\n    for (const pickRequest of pickRequests) {\n      let {sync} = pickRequest;\n      if (sync !== null) {\n        if (pickRequest.frameNumber < currentFrameNumber - 1) {\n          gl.deleteSync(sync);\n        } else {\n          continue;\n        }\n      }\n      this.issuePickRequestInternal(pickRequest);\n      return;\n    }\n  }\n\n  /**\n   * Called each time the mouse position relative to the top level of the rendered viewport changes.\n   */\n  private updateMousePosition(mouseX: number, mouseY: number): void {\n    if (mouseX === this.mouseX && mouseY === this.mouseY) {\n      return;\n    }\n    this.mouseX = mouseX;\n    this.mouseY = mouseY;\n    if (mouseX < 0) {\n      // Mouse moved out of the viewport.\n      this.pickRequestPending = false;\n      this.cancelPickRequests();\n      return;\n    }\n    const currentFrameNumber = this.context.frameNumber;\n    const pickingData = this.pickingData[1];\n    if (pickingData.frameNumber !== currentFrameNumber ||\n        this.width !== pickingData.viewportWidth || this.height !== pickingData.viewportHeight) {\n      // Viewport size has changed since the last frame, which means a redraw is pending.  Don't\n      // issue pick request now.  Once will be issued automatically after the redraw.\n      return;\n    }\n    this.pickRequestPending = true;\n    this.attemptToIssuePickRequest();\n  }\n\n  constructor(\n      context: DisplayContext, element: HTMLElement, public viewer: RenderedDataViewerState) {\n    super(context, element, viewer.visibility);\n    this.inputEventMap = viewer.inputEventMap;\n\n    element.classList.add('neuroglancer-rendered-data-panel');\n    element.classList.add('neuroglancer-panel');\n    element.classList.add('neuroglancer-noselect');\n\n    this.registerDisposer(new AutomaticallyFocusedElement(element));\n    this.registerDisposer(new KeyboardEventBinder(element, this.inputEventMap));\n    this.registerDisposer(new MouseEventBinder(element, this.inputEventMap));\n    this.registerDisposer(new TouchEventBinder(element, this.inputEventMap));\n\n    this.registerEventListener(element, 'mousemove', this.onMousemove.bind(this));\n    this.registerEventListener(element, 'touchstart', this.onTouchstart.bind(this));\n    this.registerEventListener(element, 'mouseleave', this.onMouseout.bind(this));\n\n    registerActionListener(element, 'snap', () => {\n      this.navigationState.pose.snap();\n    });\n\n    registerActionListener(element, 'zoom-in', () => {\n      this.navigationState.zoomBy(0.5);\n    });\n\n    registerActionListener(element, 'zoom-out', () => {\n      this.navigationState.zoomBy(2.0);\n    });\n\n    registerActionListener(element, 'highlight', () => {\n      this.viewer.layerManager.invokeAction('highlight');\n    });\n\n    for (let axis = 0; axis < 3; ++axis) {\n      let axisName = AXES_NAMES[axis];\n      for (let sign of [-1, +1]) {\n        let signStr = (sign < 0) ? '-' : '+';\n        registerActionListener(element, `rotate-relative-${axisName}${signStr}`, () => {\n          this.navigationState.pose.rotateRelative(kAxes[axis], sign * 0.1);\n        });\n        let tempOffset = vec3.create();\n        registerActionListener(element, `${axisName}${signStr}`, () => {\n          let {navigationState} = this;\n          let offset = tempOffset;\n          offset[0] = 0;\n          offset[1] = 0;\n          offset[2] = 0;\n          offset[axis] = sign;\n          navigationState.pose.translateVoxelsRelative(offset);\n        });\n      }\n    }\n\n    registerActionListener(element, 'zoom-via-wheel', (event: ActionEvent<WheelEvent>) => {\n      const e = event.detail;\n      this.onMousemove(e);\n      this.zoomByMouse(getWheelZoomAmount(e));\n    });\n\n    registerActionListener(element, 'translate-via-mouse-drag', (e: ActionEvent<MouseEvent>) => {\n      startRelativeMouseDrag(e.detail, (_event, deltaX, deltaY) => {\n        this.translateByViewportPixels(deltaX, deltaY);\n      });\n    });\n\n    registerActionListener(\n        element, 'translate-in-plane-via-touchtranslate', (e: ActionEvent<TouchTranslateInfo>) => {\n          const {detail} = e;\n          this.translateByViewportPixels(detail.deltaX, detail.deltaY);\n        });\n\n    registerActionListener(\n        element, 'translate-z-via-touchtranslate', (e: ActionEvent<TouchTranslateInfo>) => {\n          const {detail} = e;\n          let {navigationState} = this;\n          let offset = tempVec3;\n          offset[0] = 0;\n          offset[1] = 0;\n          offset[2] = detail.deltaY + detail.deltaX;\n          navigationState.pose.translateVoxelsRelative(offset);\n        });\n\n    for (const amount of [1, 10]) {\n      registerActionListener(element, `z+${amount}-via-wheel`, (event: ActionEvent<WheelEvent>) => {\n        const e = event.detail;\n        let {navigationState} = this;\n        let offset = tempVec3;\n        let delta = e.deltaY !== 0 ? e.deltaY : e.deltaX;\n        offset[0] = 0;\n        offset[1] = 0;\n        offset[2] = (delta > 0 ? -1 : 1) * amount;\n        navigationState.pose.translateVoxelsRelative(offset);\n      });\n    }\n\n    registerActionListener(element, 'move-to-mouse-position', () => {\n      let {mouseState} = this.viewer;\n      if (mouseState.updateUnconditionally()) {\n        let position = this.navigationState.pose.position;\n        vec3.copy(position.spatialCoordinates, mouseState.position);\n        position.changed.dispatch();\n      }\n    });\n\n    registerActionListener(element, 'snap', () => this.navigationState.pose.snap());\n\n    registerActionListener(element, 'select-annotation', () => {\n      const {mouseState, layerManager} = this.viewer;\n      const state = getSelectedAnnotation(mouseState, layerManager);\n      if (state === undefined) {\n        return;\n      }\n      const userLayer = state.layer.layer;\n      if (userLayer !== null) {\n        this.viewer.selectedLayer.layer = state.layer;\n        this.viewer.selectedLayer.visible = true;\n        userLayer.tabs.value = 'annotations';\n        (<UserLayerWithAnnotations>userLayer).selectedAnnotation.value = {\n          id: state.id,\n          partIndex: state.partIndex\n        };\n      }\n    });\n\n    registerActionListener(element, 'move-annotation', (e: ActionEvent<MouseEvent>) => {\n      const {mouseState} = this.viewer;\n      const selectedAnnotationId = mouseState.pickedAnnotationId;\n      const annotationLayer = mouseState.pickedAnnotationLayer;\n      if (annotationLayer !== undefined) {\n        if (selectedAnnotationId !== undefined) {\n          e.stopPropagation();\n          let annotationRef = annotationLayer.source.getReference(selectedAnnotationId)!;\n          let ann = <Annotation>annotationRef.value;\n\n          const handler = getAnnotationTypeRenderHandler(ann.type);\n          const pickedOffset = mouseState.pickedOffset;\n          let repPoint = handler.getRepresentativePoint(\n              annotationLayer.objectToGlobal, ann, mouseState.pickedOffset);\n          let totDeltaVec = vec2.set(vec2.create(), 0, 0);\n          if (mouseState.updateUnconditionally()) {\n            startRelativeMouseDrag(\n                e.detail,\n                (_event, deltaX, deltaY) => {\n                  vec2.add(totDeltaVec, totDeltaVec, [deltaX, deltaY]);\n                  let newRepPt = this.translateDataPointByViewportPixels(\n                      vec3.create(), repPoint, totDeltaVec[0], totDeltaVec[1]);\n                  let newAnnotation = handler.updateViaRepresentativePoint(\n                      ann, newRepPt, annotationLayer.globalToObject, pickedOffset);\n                  annotationLayer.source.update(annotationRef, newAnnotation);\n                },\n                (_event) => {\n                  annotationRef.dispose();\n                });\n          }\n        }\n      }\n    });\n\n    registerActionListener(element, 'delete-annotation', () => {\n      const {mouseState} = this.viewer;\n      const selectedAnnotationId = mouseState.pickedAnnotationId;\n      const annotationLayer = mouseState.pickedAnnotationLayer;\n      if (annotationLayer !== undefined && !annotationLayer.source.readonly &&\n          selectedAnnotationId !== undefined) {\n        const ref = annotationLayer.source.getReference(selectedAnnotationId);\n        try {\n          annotationLayer.source.delete(ref);\n        } finally {\n          ref.dispose();\n        }\n      }\n    });\n\n    registerActionListener(element, 'zoom-via-touchpinch', (e: ActionEvent<TouchPinchInfo>) => {\n      const {detail} = e;\n      this.handleMouseMove(detail.centerX, detail.centerY);\n      const ratio = detail.prevDistance / detail.distance;\n      if (ratio > 0.1 && ratio < 10) {\n        this.zoomByMouse(ratio);\n      }\n    });\n  }\n\n  onMouseout(_event: MouseEvent) {\n    this.updateMousePosition(-1, -1);\n    this.viewer.mouseState.setForcer(undefined);\n  }\n\n  abstract translateByViewportPixels(deltaX: number, deltaY: number): void;\n\n  handleMouseMove(clientX: number, clientY: number) {\n    let {element} = this;\n    const bounds = element.getBoundingClientRect();\n    const mouseX = clientX - bounds.left;\n    const mouseY = clientY - bounds.top;\n    const {mouseState} = this.viewer;\n    mouseState.pageX = clientX + window.scrollX;\n    mouseState.pageY = clientY + window.scrollY;\n    mouseState.setForcer(this.mouseStateForcer);\n    this.updateMousePosition(mouseX, mouseY);\n  }\n\n  onMousemove(event: MouseEvent) {\n    let {element} = this;\n    if (event.target !== element) {\n      return;\n    }\n    this.handleMouseMove(event.clientX, event.clientY);\n  }\n\n  onTouchstart(event: TouchEvent) {\n    let {element} = this;\n    if (event.target !== element || event.targetTouches.length !== 1) {\n      return;\n    }\n    const {clientX, clientY} = event.targetTouches[0];\n    this.handleMouseMove(clientX, clientY);\n  }\n\n  disposed() {\n    let {mouseState} = this.viewer;\n    mouseState.removeForcer(this.mouseStateForcer);\n    const {gl} = this;\n    this.cancelPickRequests();\n    const {pendingPickRequestTimerId} = this;\n    if (pendingPickRequestTimerId !== -1) {\n      clearTimeout(pendingPickRequestTimerId);\n    }\n    for (const request of this.pickRequests) {\n      gl.deleteBuffer(request.buffer);\n    }\n    super.disposed();\n  }\n\n  abstract zoomByMouse(factor: number): void;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationSource} from 'neuroglancer/annotation';\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {MeshSource, MultiscaleMeshSource} from 'neuroglancer/mesh/frontend';\nimport {SkeletonSource} from 'neuroglancer/skeleton/frontend';\nimport {DataType} from 'neuroglancer/sliceview/base';\nimport {MultiscaleSliceViewChunkSource, SliceViewChunk, SliceViewChunkSource} from 'neuroglancer/sliceview/frontend';\nimport {VolumeChunkSource as VolumeChunkSourceInterface, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {Disposable} from 'neuroglancer/util/disposable';\nimport {vec3, vec3Key} from 'neuroglancer/util/geom';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nexport type VolumeChunkKey = string;\n\nconst tempChunkGridPosition = vec3.create();\nconst tempLocalPosition = vec3.create();\n\n\nexport interface ChunkFormat {\n  shaderKey: string;\n\n  /**\n   * Called on the ChunkFormat of the first source of a RenderLayer.\n   *\n   * This should define a fragment shader function:\n   *\n   *   value_type getDataValue(int channelIndex);\n   *\n   * where value_type is the shader data type corresponding to the chunk data type.  This function\n   * should retrieve the value for channel `channelIndex` at position `getPositionWithinChunk()`\n   * within the chunk.\n   */\n  defineShader: (builder: ShaderBuilder) => void;\n\n  /**\n   * Called once per RenderLayer when starting to draw chunks, on the ChunkFormat of the first\n   * source.  This is not called before each source is drawn.\n   */\n  beginDrawing: (gl: GL, shader: ShaderProgram) => void;\n\n  /**\n   * Called once after all chunks have been drawn, on the ChunkFormat of the first source.\n   */\n  endDrawing: (gl: GL, shader: ShaderProgram) => void;\n\n  /**\n   * Called just before drawing each chunk, on the ChunkFormat .\n   */\n  bindChunk: (gl: GL, shader: ShaderProgram, chunk: SliceViewChunk) => void;\n\n  /**\n   * Called just before drawing chunks for the source.\n   */\n  beginSource: (gl: GL, shader: ShaderProgram) => void;\n}\n\nexport interface ChunkFormatHandler extends Disposable {\n  chunkFormat: ChunkFormat;\n  getChunk(source: SliceViewChunkSource, x: any): SliceViewChunk;\n}\n\nexport type ChunkFormatHandlerFactory = (gl: GL, spec: VolumeChunkSpecification) =>\n    ChunkFormatHandler|null;\n\nvar chunkFormatHandlers = new Array<ChunkFormatHandlerFactory>();\n\nexport function registerChunkFormatHandler(factory: ChunkFormatHandlerFactory) {\n  chunkFormatHandlers.push(factory);\n}\n\nexport function getChunkFormatHandler(gl: GL, spec: VolumeChunkSpecification) {\n  for (let handler of chunkFormatHandlers) {\n    let result = handler(gl, spec);\n    if (result != null) {\n      return result;\n    }\n  }\n  throw new Error('No chunk format handler found.');\n}\n\n\nexport class VolumeChunkSource extends SliceViewChunkSource implements VolumeChunkSourceInterface {\n  chunkFormatHandler: ChunkFormatHandler;\n\n  chunks: Map<string, VolumeChunk>;\n\n  spec: VolumeChunkSpecification;\n\n  constructor(chunkManager: ChunkManager, options: {spec: VolumeChunkSpecification}) {\n    super(chunkManager, options);\n    this.chunkFormatHandler =\n        this.registerDisposer(getChunkFormatHandler(chunkManager.chunkQueueManager.gl, this.spec));\n  }\n\n  get chunkFormat() {\n    return this.chunkFormatHandler.chunkFormat;\n  }\n\n  getValueAt(position: vec3, chunkLayout = this.spec.chunkLayout) {\n    const chunkGridPosition = tempChunkGridPosition;\n    const localPosition = tempLocalPosition;\n    let spec = this.spec;\n    let chunkSize = chunkLayout.size;\n    chunkLayout.globalToLocalSpatial(localPosition, position);\n    for (let i = 0; i < 3; ++i) {\n      const chunkSizeValue = chunkSize[i];\n      const localPositionValue = localPosition[i];\n      chunkGridPosition[i] = Math.floor(localPositionValue / chunkSizeValue);\n    }\n    let key = vec3Key(chunkGridPosition);\n    let chunk = <VolumeChunk>this.chunks.get(key);\n    if (!chunk) {\n      return null;\n    }\n    // Reuse temporary variable.\n    const dataPosition = chunkGridPosition;\n    const voxelSize = spec.voxelSize;\n    for (let i = 0; i < 3; ++i) {\n      dataPosition[i] =\n          Math.floor((localPosition[i] - chunkGridPosition[i] * chunkSize[i]) / voxelSize[i]);\n    }\n    let chunkDataSize = chunk.chunkDataSize;\n    for (let i = 0; i < 3; ++i) {\n      if (dataPosition[i] >= chunkDataSize[i]) {\n        return undefined;\n      }\n    }\n    let {numChannels} = spec;\n    if (numChannels === 1) {\n      return chunk.getChannelValueAt(dataPosition, 0);\n    } else {\n      let result = new Array<number|Uint64>(numChannels);\n      for (let i = 0; i < numChannels; ++i) {\n        result[i] = chunk.getChannelValueAt(dataPosition, i);\n      }\n      return result;\n    }\n  }\n\n  getChunk(x: any): VolumeChunk {\n    return <VolumeChunk>this.chunkFormatHandler.getChunk(this, x);\n  }\n}\n\nexport abstract class VolumeChunk extends SliceViewChunk {\n  source: VolumeChunkSource;\n  chunkDataSize: vec3;\n\n  get chunkFormat() {\n    return this.source.chunkFormat;\n  }\n\n  constructor(source: VolumeChunkSource, x: any) {\n    super(source, x);\n    this.chunkDataSize = x['chunkDataSize'] || source.spec.chunkDataSize;\n  }\n  abstract getChannelValueAt(dataPosition: vec3, channel: number): any;\n}\n\nexport type OptionalMeshSource = MeshSource|SkeletonSource|MultiscaleMeshSource|null;\n\n\nexport interface MultiscaleVolumeChunkSource extends MultiscaleSliceViewChunkSource {\n  /**\n   * @return Chunk sources for each scale, ordered by increasing minVoxelSize.  For each scale,\n   * there may be alternative sources with different chunk layouts.\n   */\n  getSources: (options: VolumeSourceOptions) => VolumeChunkSource[][];\n\n  numChannels: number;\n  dataType: DataType;\n  volumeType: VolumeType;\n\n  /**\n   * Returns the associated mesh source or skeleton source, if there is one.\n   *\n   * This only makes sense if volumeType === VolumeType.SEGMENTATION.\n   */\n  getMeshSource: () => Promise<OptionalMeshSource>| OptionalMeshSource;\n\n  getStaticAnnotations?: () => AnnotationSource;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst OBJECT_ID_SYMBOL = Symbol('objectId');\nlet nextObjectId = 0;\n\n/**\n * Returns a string that uniquely identifies a particular primitive value or object instance.\n */\nexport function getObjectId(x: any) {\n  if (x instanceof Object) {\n    let id = x[OBJECT_ID_SYMBOL];\n    if (id === undefined) {\n      id = x[OBJECT_ID_SYMBOL] = nextObjectId++;\n    }\n    return `o${id}`;\n  } else {\n    return '' + JSON.stringify(x);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facility for triggering named actions in response to keyboard events.\n */\n\n// This is based on goog/ui/keyboardshortcuthandler.js in the Google Closure library.\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {ActionEvent, dispatchEventWithModifiers, EventActionMap, EventActionMapInterface, registerActionListener} from 'neuroglancer/util/event_action_map';\n\nconst globalKeys = new Set(\n    ['f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9', 'f10', 'f11', 'f12', 'escape', 'pause']);\nconst DEFAULT_TEXT_INPUTS = new Set([\n  'color', 'date', 'datetime', 'datetime-local', 'email', 'month', 'number', 'password', 'search',\n  'tel', 'text', 'time', 'url', 'week'\n]);\n\nexport class KeyboardEventBinder<EventMap extends EventActionMapInterface> extends RefCounted {\n  modifierShortcutsAreGlobal = true;\n  allShortcutsAreGlobal = false;\n  allowSpaceKeyOnButtons = false;\n  constructor(public target: EventTarget, public eventMap: EventMap) {\n    super();\n    this.registerEventListener(\n        target, 'keydown', this.handleKeyDown.bind(this), /*useCapture=*/false);\n  }\n\n  private shouldIgnoreEvent(key: string, event: KeyboardEvent) {\n    var el = <HTMLElement>event.target;\n    let {tagName} = el;\n    if (el === this.target) {\n      // If the event is directly on the target element, we never ignore it.\n      return false;\n    }\n    var isFormElement = tagName === 'TEXTAREA' || tagName === 'INPUT' || tagName === 'BUTTON' ||\n        tagName === 'SELECT';\n\n    var isContentEditable = !isFormElement &&\n        (el.isContentEditable || (el.ownerDocument && el.ownerDocument.designMode === 'on'));\n\n    if (!isFormElement && !isContentEditable) {\n      return false;\n    }\n    // Always allow keys registered as global to be used (typically Esc, the\n    // F-keys and other keys that are not typically used to manipulate text).\n    if (this.allShortcutsAreGlobal || globalKeys.has(key)) {\n      return false;\n    }\n    if (isContentEditable) {\n      // For events originating from an element in editing mode we only let\n      // global key codes through.\n      return true;\n    }\n    // Event target is one of (TEXTAREA, INPUT, BUTTON, SELECT).\n    // Allow modifier shortcuts, unless we shouldn't.\n    if (this.modifierShortcutsAreGlobal && (event.altKey || event.ctrlKey || event.metaKey)) {\n      return true;\n    }\n    // Allow ENTER to be used as shortcut for text inputs.\n    if (tagName === 'INPUT' && DEFAULT_TEXT_INPUTS.has((<HTMLInputElement>el).type)) {\n      return key !== 'enter';\n    }\n    // Checkboxes, radiobuttons and buttons. Allow all but SPACE as shortcut.\n    if (tagName === 'INPUT' || tagName === 'BUTTON') {\n      // TODO(gboyer): If more flexibility is needed, create protected helper\n      // methods for each case (e.g. button, input, etc).\n      if (this.allowSpaceKeyOnButtons) {\n        return false;\n      } else {\n        return key === 'space';\n      }\n    }\n    // Don't allow any additional shortcut keys for textareas or selects.\n    return true;\n  }\n\n  private handleKeyDown(event: KeyboardEvent) {\n    const key = getEventKeyName(event);\n    if (this.shouldIgnoreEvent(key, event)) {\n      return;\n    }\n    dispatchEventWithModifiers(key, event, event, this.eventMap);\n  }\n}\n\nexport function getEventKeyName(event: KeyboardEvent): string {\n  return event.code.toLowerCase();\n}\n\nexport {EventActionMapInterface, EventActionMap, registerActionListener, ActionEvent};\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface Completion { value: string; }\n\nexport interface CompletionWithDescription extends Completion { description?: string; }\n\nexport interface BasicCompletionResult {\n  completions: Completion[];\n  offset: number;\n}\n\nexport function applyCompletionOffset<T extends{offset: number}>(\n    offset: number, completionResult: T) {\n  completionResult.offset += offset;\n  return completionResult;\n}\n\nexport function getPrefixMatches(prefix: string, options: Iterable<string>) {\n  let result: Completion[] = [];\n  for (let option of options) {\n    if (option.startsWith(prefix)) {\n      result.push({value: option});\n    }\n  }\n  return result;\n}\n\nexport function getPrefixMatchesWithDescriptions<T>(\n    prefix: string, options: Iterable<T>, getValue: (x: T) => string,\n    getDescription: (x: T) => string | undefined) {\n  let result: CompletionWithDescription[] = [];\n  for (let option of options) {\n    let key = getValue(option);\n    if (key.startsWith(prefix)) {\n      result.push({value: key, description: getDescription(option)});\n    }\n  }\n  return result;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {identityMat4} from 'neuroglancer/util/geom';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderModule, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {getSquareCornersBuffer} from 'neuroglancer/webgl/square_corners_buffer';\nimport {resizeTexture} from 'neuroglancer/webgl/texture';\nimport {defineCopyFragmentShader, elementWiseTextureShader} from 'neuroglancer/webgl/trivial_shaders';\n\nexport abstract class SizeManaged extends RefCounted {\n  width = Number.NaN;\n  height = Number.NaN;\n\n  hasSize(width: number, height: number) {\n    return this.width === width && this.height === height;\n  }\n\n  resize(width: number, height: number) {\n    if (this.hasSize(width, height)) {\n      return;\n    }\n    this.width = width;\n    this.height = height;\n\n    this.performResize();\n  }\n  protected abstract performResize(): void;\n}\n\nexport class Renderbuffer extends SizeManaged {\n  renderbuffer: WebGLRenderbuffer|null = null;\n\n  constructor(public gl: GL, public internalformat: number) {\n    super();\n    this.renderbuffer = gl.createRenderbuffer();\n  }\n\n  protected performResize() {\n    let {gl} = this;\n    gl.bindRenderbuffer(gl.RENDERBUFFER, this.renderbuffer);\n    gl.renderbufferStorage(gl.RENDERBUFFER, this.internalformat, this.width, this.height);\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n  }\n\n  disposed() {\n    this.gl.deleteRenderbuffer(this.renderbuffer);\n  }\n\n  attachToFramebuffer(attachment: number) {\n    let {gl} = this;\n    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, attachment, gl.RENDERBUFFER, this.renderbuffer);\n  }\n}\n\nexport class DepthBuffer extends Renderbuffer {\n  constructor(public gl: GL, public includeStencilBuffer = false) {\n    super(gl, includeStencilBuffer ? gl.DEPTH_STENCIL : gl.DEPTH_COMPONENT16);\n  }\n  attachToFramebuffer() {\n    let {gl} = this;\n    super.attachToFramebuffer(\n        this.includeStencilBuffer ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT);\n  }\n}\n\nexport class DepthStencilBuffer extends DepthBuffer {\n  constructor(gl: GL) {\n    super(gl, /*includeStencilBuffer=*/true);\n  }\n}\n\nexport const StencilBuffer = DepthStencilBuffer;\n\nexport class Framebuffer extends RefCounted {\n  framebuffer = this.gl.createFramebuffer();\n  constructor(public gl: GL) {\n    super();\n  }\n  disposed() {\n    let {gl} = this;\n    gl.deleteFramebuffer(this.framebuffer);\n  }\n  bind() {\n    let {gl} = this;\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\n  }\n  unbind() {\n    let {gl} = this;\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n  }\n}\n\nexport class TextureBuffer extends SizeManaged {\n  texture: WebGLTexture|null;\n\n  constructor(public gl: GL, public internalFormat: number, public format: number, public dataType: number) {\n    super();\n    this.texture = gl.createTexture();\n  }\n\n  protected performResize() {\n    resizeTexture(this.gl, this.texture, this.width, this.height, this.internalFormat, this.format, this.dataType);\n  }\n\n  disposed() {\n    this.gl.deleteTexture(this.texture);\n  }\n\n  attachToFramebuffer(attachment: number) {\n    let {gl} = this;\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, attachment, gl.TEXTURE_2D, this.texture, /*level=*/0);\n  }\n}\n\nexport function makeTextureBuffers(\n    gl: GL, count: number, internalFormat: number = WebGL2RenderingContext.RGBA8,\n    format: number = WebGL2RenderingContext.RGBA,\n    dataType: number = WebGL2RenderingContext.UNSIGNED_BYTE) {\n  let result = new Array<TextureBuffer>();\n  for (let i = 0; i < count; ++i) {\n    result[i] = new TextureBuffer(gl, internalFormat, format, dataType);\n  }\n  return result;\n}\n\nconst tempPixel = new Uint8Array(4);\nconst tempPixelUint32 = new Uint32Array(1);\nconst tempPixelFloat32 = new Float32Array(4);\nexport class FramebufferConfiguration<ColorBuffer extends TextureBuffer|Renderbuffer> extends\n    RefCounted {\n  width = Number.NaN;\n  height = Number.NaN;\n\n  colorBuffers: ColorBuffer[];\n  framebuffer: Framebuffer;\n  depthBuffer: DepthBuffer|undefined;\n  private fullAttachmentList = new Array<number>();\n  private attachmentVerified = false;\n  private singleAttachmentList = [this.gl.COLOR_ATTACHMENT0];\n\n  constructor(public gl: GL, configuration: {\n    framebuffer?: Framebuffer,\n    colorBuffers: ColorBuffer[],\n    depthBuffer?: DepthBuffer\n  }) {\n    super();\n    let {framebuffer = new Framebuffer(gl), colorBuffers, depthBuffer} = configuration;\n    this.framebuffer = this.registerDisposer(framebuffer);\n    this.colorBuffers = colorBuffers;\n    this.depthBuffer = depthBuffer;\n    if (depthBuffer !== undefined) {\n      this.registerDisposer(depthBuffer);\n    }\n    let {fullAttachmentList} = this;\n    colorBuffers.forEach((buffer, i) => {\n      this.registerDisposer(buffer);\n      fullAttachmentList[i] = gl.COLOR_ATTACHMENT0 + i;\n    });\n  }\n\n  hasSize(width: number, height: number) {\n    return this.width === width && this.height === height;\n  }\n\n  bind(width: number, height: number) {\n    this.width = width;\n    this.height = height;\n    this.framebuffer.bind();\n    let {gl, depthBuffer} = this;\n    if (depthBuffer !== undefined) {\n      depthBuffer.resize(width, height);\n      depthBuffer.attachToFramebuffer();\n    }\n    this.colorBuffers.forEach((buffer, i) => {\n      buffer.resize(width, height);\n      buffer.attachToFramebuffer(gl.COLOR_ATTACHMENT0 + i);\n    });\n    gl.drawBuffers(this.fullAttachmentList);\n    this.verifyAttachment();\n    gl.viewport(0, 0, width, height);\n  }\n\n  bindSingle(textureIndex: number) {\n    let {gl} = this;\n    this.framebuffer.bind();\n\n    // If this texture is still be bound to color attachment textureIndex, the attachment will fail\n    // (at least on some browsers).  Therefore, if textureIndex is not 0, we clear the attachment.\n    // In the case that textureIndex is 0, the attachment will be overridden anyway.\n    if (textureIndex !== 0) {\n      gl.framebufferTexture2D(\n          gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0 + textureIndex, gl.TEXTURE_2D, null, /*level=*/0);\n    }\n\n    gl.bindTexture(gl.TEXTURE_2D, null);\n    this.colorBuffers[textureIndex].attachToFramebuffer(gl.COLOR_ATTACHMENT0);\n    gl.drawBuffers(this.singleAttachmentList);\n  }\n\n  unbind() {\n    this.framebuffer.unbind();\n  }\n\n  /**\n   * Only supports UNSIGNED_BYTE RGBA textures.\n   */\n  readPixel(textureIndex: number, glWindowX: number, glWindowY: number): Uint8Array {\n    let {gl} = this;\n    try {\n      this.bindSingle(textureIndex);\n      gl.readPixels(glWindowX, glWindowY, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, tempPixel);\n    } finally {\n      this.framebuffer.unbind();\n    }\n    return tempPixel;\n  }\n\n  readPixelUint32(textureIndex: number, glWindowX: number, glWindowY: number): number {\n    let {gl} = this;\n    try {\n      this.bindSingle(textureIndex);\n      gl.readPixels(\n          glWindowX, glWindowY, 1, 1, WebGL2RenderingContext.RED_INTEGER,\n        WebGL2RenderingContext.UNSIGNED_INT, tempPixelUint32);\n    } finally {\n      this.framebuffer.unbind();\n    }\n    return tempPixelUint32[0];\n  }\n\n  readPixelFloat32(textureIndex: number, glWindowX: number, glWindowY: number): number {\n    let {gl} = this;\n    try {\n      this.bindSingle(textureIndex);\n      // Reading just the red channel using a format of RED fails with certain WebGL\n      // implementations.  Using RGBA seems to have better compatibility.\n      gl.readPixels(\n          glWindowX, glWindowY, 1, 1, WebGL2RenderingContext.RGBA, WebGL2RenderingContext.FLOAT,\n          tempPixelFloat32);\n    } finally {\n      this.framebuffer.unbind();\n    }\n    return tempPixelFloat32[0];\n  }\n\n  readPixelFloat32IntoBuffer(\n      textureIndex: number, glWindowX: number, glWindowY: number, offset: number, width: number = 1,\n      height: number = 1) {\n    let {gl} = this;\n    try {\n      this.bindSingle(textureIndex);\n      // Reading just the red channel using a format of RED fails with certain WebGL\n      // implementations.  Using RGBA seems to have better compatibility.\n      gl.readPixels(\n          glWindowX, glWindowY, width, height, WebGL2RenderingContext.RGBA,\n          WebGL2RenderingContext.FLOAT, offset);\n    } finally {\n      this.framebuffer.unbind();\n    }\n  }\n\n  verifyAttachment() {\n    if (this.attachmentVerified) {\n      return;\n    }\n    let {gl} = this;\n    let framebufferStatus = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n    if (framebufferStatus !== gl.FRAMEBUFFER_COMPLETE) {\n      throw new Error(`Framebuffer configuration not supported`);\n    }\n    this.attachmentVerified = true;\n  }\n}\n\nexport class OffscreenCopyHelper extends RefCounted {\n  constructor(public gl: GL, public shader: ShaderProgram) {\n    super();\n    this.registerDisposer(shader);\n  }\n  private copyVertexPositionsBuffer = getSquareCornersBuffer(this.gl);\n  private copyTexCoordsBuffer = getSquareCornersBuffer(this.gl, 0, 0, 1, 1);\n\n  draw(...textures: (WebGLTexture|null)[]) {\n    let {gl, shader} = this;\n    shader.bind();\n\n    let numTextures = textures.length;\n    for (let i = 0; i < numTextures; ++i) {\n      gl.activeTexture(gl.TEXTURE0 + i);\n      gl.bindTexture(gl.TEXTURE_2D, textures[i]);\n    }\n\n    gl.uniformMatrix4fv(shader.uniform('uProjectionMatrix'), false, identityMat4);\n\n    let aVertexPosition = shader.attribute('aVertexPosition');\n    this.copyVertexPositionsBuffer.bindToVertexAttrib(aVertexPosition, /*components=*/2);\n\n    let aTexCoord = shader.attribute('aTexCoord');\n    this.copyTexCoordsBuffer.bindToVertexAttrib(aTexCoord, /*components=*/2);\n\n    gl.drawArrays(gl.TRIANGLE_FAN, 0, 4);\n\n    gl.disableVertexAttribArray(aVertexPosition);\n    gl.disableVertexAttribArray(aTexCoord);\n\n    for (let i = 0; i < numTextures; ++i) {\n      gl.activeTexture(gl.TEXTURE0 + i);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n    }\n  }\n\n  static get(\n      gl: GL, shaderModule: ShaderModule = defineCopyFragmentShader, numTextures: number = 1) {\n    return gl.memoize.get(\n        `OffscreenCopyHelper:${numTextures}:${getObjectId(shaderModule)}`,\n        () => new OffscreenCopyHelper(gl, elementWiseTextureShader(gl, shaderModule, numTextures)));\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SharedDisjointUint64Sets} from 'neuroglancer/shared_disjoint_sets';\nimport {Uint64Set} from 'neuroglancer/uint64_set';\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nexport interface VisibleSegmentsState {\n  visibleSegments: Uint64Set;\n  segmentEquivalences: SharedDisjointUint64Sets;\n}\n\n/**\n * Returns a string key for identifying a uint64 object id.  This is faster than\n * Uint64.prototype.toString().\n */\nexport function getObjectKey(objectId: Uint64): string {\n  return `${objectId.low},${objectId.high}`;\n}\n\nexport function forEachVisibleSegment(\n    state: VisibleSegmentsState, callback: (objectId: Uint64, rootObjectId: Uint64) => void) {\n  let {visibleSegments, segmentEquivalences} = state;\n  for (let rootObjectId of visibleSegments) {\n    // TODO(jbms): Remove this check if logic is added to ensure that it always holds.\n    if (!segmentEquivalences.disjointSets.isMinElement(rootObjectId)) {\n      continue;\n    }\n    for (let objectId of segmentEquivalences.setElements(rootObjectId)) {\n      callback(objectId, rootObjectId);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {MultiscaleAnnotationSource} from 'neuroglancer/annotation/frontend_source';\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {MeshSource, MultiscaleMeshSource} from 'neuroglancer/mesh/frontend';\nimport {SkeletonSource} from 'neuroglancer/skeleton/frontend';\nimport {VectorGraphicsType} from 'neuroglancer/sliceview/vector_graphics/base';\nimport {MultiscaleVectorGraphicsChunkSource} from 'neuroglancer/sliceview/vector_graphics/frontend';\nimport {VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {CancellationToken, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {applyCompletionOffset, CompletionWithDescription} from 'neuroglancer/util/completion';\nimport {Owned, RefCounted} from 'neuroglancer/util/disposable';\n\nexport type Completion = CompletionWithDescription;\n\nexport interface CompletionResult {\n  offset: number;\n  completions: Completion[];\n}\n\n/**\n * Returns the length of the prefix of path that corresponds to the \"group\", according to the\n * specified separator.\n *\n * If the separator is not specified, gueses whether it is '/' or ':'.\n */\nexport function findSourceGroupBasedOnSeparator(path: string, separator?: string) {\n  if (separator === undefined) {\n    // Try to guess whether '/' or ':' is the separator.\n    if (path.indexOf('/') === -1) {\n      separator = ':';\n    } else {\n      separator = '/';\n    }\n  }\n  let index = path.lastIndexOf(separator);\n  if (index === -1) {\n    return 0;\n  }\n  return index + 1;\n}\n\n\n/**\n * Returns the last \"component\" of path, according to the specified separator.\n * If the separator is not specified, gueses whether it is '/' or ':'.\n */\nexport function suggestLayerNameBasedOnSeparator(path: string, separator?: string) {\n  let groupIndex = findSourceGroupBasedOnSeparator(path, separator);\n  return path.substring(groupIndex);\n}\n\nexport interface GetVolumeOptions {\n  /**\n   * Hint regarding the usage of the volume.\n   */\n  volumeType?: VolumeType;\n\n  dataSourceProvider?: DataSourceProvider;\n}\n\nexport interface GetVectorGraphicsOptions {\n  vectorGraphicsType?: VectorGraphicsType;\n}\n\nexport interface DataSource {\n  getVolume?\n      (chunkManager: ChunkManager, path: string, options: GetVolumeOptions,\n       cancellationToken: CancellationToken):\n          Promise<MultiscaleVolumeChunkSource>|MultiscaleVolumeChunkSource;\n  getVectorGraphicsSource?\n      (chunkManager: ChunkManager, path: string, options: GetVectorGraphicsOptions,\n       cancellationToken: CancellationToken):\n          Promise<MultiscaleVectorGraphicsChunkSource>|MultiscaleVectorGraphicsChunkSource;\n  getMeshSource?(chunkManager: ChunkManager, path: string, cancellationToken: CancellationToken):\n      Promise<MeshSource|MultiscaleMeshSource>|MeshSource|MultiscaleMeshSource;\n  getSkeletonSource?\n      (chunkManager: ChunkManager, path: string, cancellationToken: CancellationToken):\n          Promise<SkeletonSource>|SkeletonSource;\n  volumeCompleter?(value: string, chunkManager: ChunkManager, cancellationToken: CancellationToken):\n      Promise<CompletionResult>;\n\n  getAnnotationSource?\n      (chunkManager: ChunkManager, path: string, cancellationToken: CancellationToken):\n          Promise<MultiscaleAnnotationSource>|MultiscaleAnnotationSource;\n\n  /**\n   * Returns a suggested layer name for the given volume source.\n   */\n  suggestLayerName?(path: string): string;\n\n  /**\n   * Returns the length of the prefix of path that is its 'group'.  This is used for suggesting a\n   * default URL for adding a new layer.\n   */\n  findSourceGroup?(path: string): number;\n}\n\nexport class DataSource extends RefCounted {\n  description?: string;\n}\n\nconst protocolPattern = /^(?:([a-zA-Z][a-zA-Z0-9-+_]*):\\/\\/)?(.*)$/;\n\nexport class DataSourceProvider extends RefCounted {\n  dataSources = new Map<string, Owned<DataSource>>();\n\n  register(name: string, dataSource: Owned<DataSource>) {\n    this.dataSources.set(name, this.registerDisposer(dataSource));\n  }\n\n  getDataSource(url: string): [DataSource, string, string] {\n    let m = url.match(protocolPattern);\n    if (m === null || m[1] === undefined) {\n      throw new Error(`Data source URL must have the form \"<protocol>://<path>\".`);\n    }\n    let dataSource = m[1];\n    let factory = this.dataSources.get(dataSource);\n    if (factory === undefined) {\n      throw new Error(`Unsupported data source: ${JSON.stringify(dataSource)}.`);\n    }\n    return [factory, m[2], dataSource];\n  }\n\n  getVolume(\n      chunkManager: ChunkManager, url: string, options: GetVolumeOptions = {},\n      cancellationToken = uncancelableToken) {\n    let [dataSource, path] = this.getDataSource(url);\n    if (options === undefined) {\n      options = {};\n    }\n    options.dataSourceProvider = this;\n    return new Promise<MultiscaleVolumeChunkSource>(resolve => {\n      resolve(dataSource.getVolume!(chunkManager, path, options, cancellationToken));\n    });\n  }\n\n  getAnnotationSource(\n      chunkManager: ChunkManager, url: string, cancellationToken = uncancelableToken) {\n    let [dataSource, path] = this.getDataSource(url);\n    return new Promise<MultiscaleAnnotationSource>(resolve => {\n      resolve(dataSource.getAnnotationSource!(chunkManager, path, cancellationToken));\n    });\n  }\n\n  getVectorGraphicsSource(\n      chunkManager: ChunkManager, url: string, options: GetVectorGraphicsOptions = {},\n      cancellationToken = uncancelableToken) {\n    let [dataSource, path] = this.getDataSource(url);\n    return new Promise<MultiscaleVectorGraphicsChunkSource>(resolve => {\n      resolve(dataSource.getVectorGraphicsSource!(chunkManager, path, options, cancellationToken));\n    });\n  }\n\n  getMeshSource(chunkManager: ChunkManager, url: string, cancellationToken = uncancelableToken) {\n    let [dataSource, path] = this.getDataSource(url);\n    return new Promise<MeshSource|MultiscaleMeshSource>(resolve => {\n      resolve(dataSource.getMeshSource!(chunkManager, path, cancellationToken));\n    });\n  }\n\n  getSkeletonSource(\n      chunkManager: ChunkManager, url: string, cancellationToken = uncancelableToken) {\n    let [dataSource, path] = this.getDataSource(url);\n    return new Promise<SkeletonSource>(resolve => {\n      resolve(dataSource.getSkeletonSource!(chunkManager, path, cancellationToken));\n    });\n  }\n\n  volumeCompleter(url: string, chunkManager: ChunkManager, cancellationToken = uncancelableToken):\n      Promise<CompletionResult> {\n    // Check if url matches a protocol.  Note that protocolPattern always matches.\n    let protocolMatch = url.match(protocolPattern)!;\n    let protocol = protocolMatch[1];\n    if (protocol === undefined) {\n      // Return protocol completions.\n      let completions: Completion[] = [];\n      for (let [name, factory] of this.dataSources) {\n        name = name + '://';\n        if (name.startsWith(url)) {\n          completions.push({value: name, description: factory.description});\n        }\n      }\n      return Promise.resolve({offset: 0, completions});\n    } else {\n      const factory = this.dataSources.get(protocol);\n      if (factory !== undefined) {\n        if (factory.volumeCompleter !== undefined) {\n          return factory.volumeCompleter!(protocolMatch[2], chunkManager, cancellationToken)\n              .then(completions => applyCompletionOffset(protocol.length + 3, completions));\n        }\n      }\n      return Promise.reject<CompletionResult>(null);\n    }\n  }\n\n  suggestLayerName(url: string) {\n    let [dataSource, path] = this.getDataSource(url);\n    let suggestor = dataSource.suggestLayerName;\n    if (suggestor !== undefined) {\n      return suggestor(path);\n    }\n    return suggestLayerNameBasedOnSeparator(path);\n  }\n\n  findSourceGroup(url: string) {\n    let [dataSource, path, dataSourceName] = this.getDataSource(url);\n    let helper = dataSource.findSourceGroup || findSourceGroupBasedOnSeparator;\n    return helper(path) + dataSourceName.length + 3;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facility for registering default data sources.\n */\n\nimport {CredentialsManager} from 'neuroglancer/credentials_provider';\nimport {DataSource, DataSourceProvider} from 'neuroglancer/datasource';\nimport {Owned} from 'neuroglancer/util/disposable';\n\nexport interface ProviderOptions {\n  credentialsManager: CredentialsManager;\n}\n\nexport type ProviderFactory = (options: ProviderOptions) => Owned<DataSource>;\nconst providerFactories = new Map<string, ProviderFactory>();\n\nexport function registerProvider(name: string, factory: ProviderFactory) {\n  providerFactories.set(name, factory);\n}\n\nexport function getDefaultDataSourceProvider(options: ProviderOptions) {\n  const provider = new DataSourceProvider();\n  for (const [name, factory] of providerFactories) {\n    provider.register(name, factory(options));\n  }\n  return provider;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface WritableArrayLike<T> {\n  length: number;\n  [n: number]: T;\n}\n\n/**\n * Partitions array[start:end] such that all elements for which predicate\n * returns true are before the elements for which predicate returns false.\n *\n * predicate will be called exactly once for each element in array[start:end],\n * in order.\n *\n * @returns {number} The index of the first element for which predicate returns\n * false, or end if there is no such element.\n */\nexport function partitionArray<T>(\n    array: T[], start: number, end: number, predicate: (x: T) => boolean): number {\n  while (start < end) {\n    let x = array[start];\n    if (predicate(x)) {\n      ++start;\n      continue;\n    }\n    --end;\n    array[start] = array[end];\n    array[end] = x;\n  }\n  return end;\n}\n\nexport interface TypedArrayConstructor {\n  new(n: number): TypedArray;\n  new(buffer: ArrayBuffer, byteOffset: number, length: number): TypedArray;\n  BYTES_PER_ELEMENT: number;\n}\n\nexport type TypedArray = Int8Array | Uint8Array | Int16Array | Uint16Array | Int32Array |\n    Uint32Array | Float32Array | Float64Array;\n\n/**\n * Returns an array of size newSize that starts with the contents of array.\n * Either returns array if it has the correct size, or a new array with zero\n * padding at the end.\n */\nexport function maybePadArray<T extends TypedArray>(array: T, newSize: number): T {\n  if (array.length === newSize) {\n    return array;\n  }\n  let newArray = new (<any>array.constructor)(newSize);\n  newArray.set(array);\n  return newArray;\n}\n\nexport function getFortranOrderStrides(size: ArrayLike<number>, baseStride = 1) {\n  let length = size.length;\n  let strides = new Array<number>(length);\n  let stride = strides[0] = baseStride;\n  for (let i = 1; i < length; ++i) {\n    stride *= size[i - 1];\n    strides[i] = stride;\n  }\n  return strides;\n}\n\n/**\n * Converts an array of shape [majorSize, minorSize] to\n * [minorSize, majorSize].\n */\nexport function transposeArray2d<T extends TypedArray>(\n    array: T, majorSize: number, minorSize: number): T {\n  let transpose = new (<any>array.constructor)(array.length);\n  for (let i = 0; i < majorSize * minorSize; i += minorSize) {\n    for (let j = 0; j < minorSize; j++) {\n      let index: number = i / minorSize;\n      transpose[j * majorSize + index] = array[i + j];\n    }\n  }\n  return transpose;\n}\n\nexport function tile2dArray<T extends TypedArray>(\n    array: T, majorDimension: number, minorTiles: number, majorTiles: number) {\n  const minorDimension = array.length / majorDimension;\n  const length = array.length * minorTiles * majorTiles;\n  const result: T = new (<any>array.constructor)(length);\n  const minorTileStride = array.length * majorTiles;\n  const majorTileStride = majorDimension;\n  const minorStride = majorDimension * majorTiles;\n  for (let minor = 0; minor < minorDimension; ++minor) {\n    for (let major = 0; major < majorDimension; ++major) {\n      const inputValue = array[minor * majorDimension + major];\n      const baseOffset = minor * minorStride + major;\n      for (let minorTile = 0; minorTile < minorTiles; ++minorTile) {\n        for (let majorTile = 0; majorTile < majorTiles; ++majorTile) {\n          result[minorTile * minorTileStride + majorTile * majorTileStride + baseOffset] =\n              inputValue;\n        }\n      }\n    }\n  }\n  return result;\n}\n\nexport function binarySearch<T>(\n    haystack: ArrayLike<T>, needle: T, compare: (a: T, b: T) => number, low = 0,\n    high = haystack.length) {\n  while (low < high) {\n    const mid = (low + high - 1) >> 1;\n    const compareResult = compare(needle, haystack[mid]);\n    if (compareResult > 0) {\n      low = mid + 1;\n    } else if (compareResult < 0) {\n      high = mid;\n    } else {\n      return mid;\n    }\n  }\n  return ~low;\n}\n\n\n/**\n * Returns the first index in `[begin, end)` for which `predicate` is `true`, or returns `end` if no\n * such index exists.\n *\n * For any index `i` in `(begin, end)`, it must be the case that `predicate(i) >= predicate(i - 1)`.\n */\nexport function binarySearchLowerBound(\n    begin: number, end: number, predicate: (index: number) => boolean): number {\n  let count = end - begin;\n  while (count > 0) {\n    let step = Math.floor(count / 2);\n    let i = begin + step;\n    if (predicate(i)) {\n      count = step;\n    } else {\n      begin = i + 1;\n      count -= step + 1;\n    }\n  }\n  return begin;\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {isAABBVisible, mat4, vec3} from 'neuroglancer/util/geom';\nimport {getOctreeChildIndex} from 'neuroglancer/util/zorder';\n\nexport interface MultiscaleMeshManifest {\n  /**\n   * Size of finest-resolution (base) chunk in object coordinates.\n   */\n  chunkShape: vec3;\n\n  /**\n   * Starting corner position of (0, 0, 0) chunk in object coordinates.\n   */\n  chunkGridSpatialOrigin: vec3;\n\n  /**\n   * Axis-aligned bounding box lower bound of object in object coordinates to use for clipping and\n   * level-of-detail calculations.\n   */\n  clipLowerBound: vec3;\n\n  /**\n   * Axis-aligned bounding box upper bound of object in object coordinates to use for clipping and\n   * level-of-detail calculations.\n   */\n  clipUpperBound: vec3;\n\n  /**\n   * Specifies the number of levels of detail (as `lodScales.length`), and the resolution in object\n   * coordinates for each level of detail.  If `lodScales[lod] === 0`, then level-of-detail `lod`\n   * does not exist.\n   *\n   * Level of detail `0` is the finest resolution.\n   *\n   * The non-zero values must be non-decreasing.\n   *\n   * For each chunk, the chosen `lod` is the largest value such that\n   * `lodScales[lod] <= detailCutoff * pixelSize`, where `pixelSize` is the maximum spatial distance\n   * spanned by a single viewport pixel within the projected image of the chunk.\n   */\n  lodScales: Float32Array;\n\n  /**\n   * C order `[numLods, 3]` array specifying the xyz vertex position offset in object coordinates\n   * for each level of detail.\n   */\n  vertexOffsets: Float32Array;\n\n  /**\n   * Row-major `[n, 5]` array where each row is of the form `[x, y, z, start, end_and_empty]`, where\n   * `x`, `y`, and `z` are the chunk grid coordinates of the entry at a particular level of detail.\n   * Row `n-1` corresponds to level of detail `lodScales.length - 1`, the root of the octree.  Given\n   * a row corresponding to an octree node at level of detail `lod`, bits `start` specifies the row\n   * number of the first child octree node at level of detail `lod-1`, and bits `[0,30]` of\n   * `end_and_empty` specify one past the row number of the last child octree node.  Bit `31` of\n   * `end_and_empty` is set to `1` if the mesh for the octree node is empty and should not be\n   * requested/rendered.\n   */\n  octree: Uint32Array;\n}\n\n/**\n * @param detailCutoff Factor by which the spatial resolution of the mesh may be worse than the\n *     spatial resolution of a single viewport pixel.  For example, a value of 10 means that if a\n *     given portion of the object will be rendered such that a pixel corresponds to 50 nm, then a\n *     mesh level of detail down to 500 nm will be requested for that portion of the object.\n */\nexport function getDesiredMultiscaleMeshChunks(\n    manifest: MultiscaleMeshManifest, modelViewProjection: mat4, clippingPlanes: Float32Array,\n    detailCutoff: number, viewportWidth: number, viewportHeight: number,\n    callback: (lod: number, row: number, renderScale: number, empty: number) => void) {\n  const {octree, lodScales, chunkGridSpatialOrigin, chunkShape} = manifest;\n  const maxLod = lodScales.length - 1;\n  const m00 = modelViewProjection[0], m01 = modelViewProjection[4], m02 = modelViewProjection[8],\n        m10 = modelViewProjection[1], m11 = modelViewProjection[5], m12 = modelViewProjection[9],\n        m30 = modelViewProjection[3], m31 = modelViewProjection[7], m32 = modelViewProjection[11],\n        m33 = modelViewProjection[15];\n\n  const minWXcoeff = m30 > 0 ? 0 : 1;\n  const minWYcoeff = m31 > 0 ? 0 : 1;\n  const minWZcoeff = m32 > 0 ? 0 : 1;\n\n\n  const nearA = clippingPlanes[4 * 4], nearB = clippingPlanes[4 * 4 + 1],\n        nearC = clippingPlanes[4 * 4 + 2], nearD = clippingPlanes[4 * 4 + 3];\n\n  function getPointW(x: number, y: number, z: number) {\n    return m30 * x + m31 * y + m32 * z + m33;\n  }\n\n  function getBoxW(\n      xLower: number, yLower: number, zLower: number, xUpper: number, yUpper: number,\n      zUpper: number) {\n    return getPointW(\n        xLower + minWXcoeff * (xUpper - xLower), yLower + minWYcoeff * (yUpper - yLower),\n        zLower + minWZcoeff * (zUpper - zLower));\n  }\n\n  /**\n   * Minimum value of w within clipping frustrum (under the assumption that the minimum value is\n   * occurs occurs on the near clipping plane).\n   */\n  const minWClip = getPointW(-nearD * nearA, -nearD * nearB, -nearD * nearC);\n\n  const objectXLower = manifest.clipLowerBound[0], objectYLower = manifest.clipLowerBound[1],\n        objectZLower = manifest.clipLowerBound[2];\n  const objectXUpper = manifest.clipUpperBound[0], objectYUpper = manifest.clipUpperBound[1],\n        objectZUpper = manifest.clipUpperBound[2];\n\n  const xScale = Math.sqrt((m00 * viewportWidth) ** 2 + (m10 * viewportHeight) ** 2);\n  const yScale = Math.sqrt((m01 * viewportWidth) ** 2 + (m11 * viewportHeight) ** 2);\n  const zScale = Math.sqrt((m02 * viewportWidth) ** 2 + (m12 * viewportHeight) ** 2);\n\n  const scaleFactor = Math.max(xScale, yScale, zScale);\n\n  function handleChunk(lod: number, row: number, priorLodScale: number) {\n    const size = 1 << lod;\n    const rowOffset = row * 5;\n    const gridX = octree[rowOffset], gridY = octree[rowOffset + 1], gridZ = octree[rowOffset + 2],\n          childBegin = octree[rowOffset + 3], childEndAndEmpty = octree[rowOffset + 4];\n    let xLower = gridX * size * chunkShape[0] + chunkGridSpatialOrigin[0],\n        yLower = gridY * size * chunkShape[1] + chunkGridSpatialOrigin[1],\n        zLower = gridZ * size * chunkShape[2] + chunkGridSpatialOrigin[2];\n    let xUpper = xLower + size * chunkShape[0], yUpper = yLower + size * chunkShape[1],\n        zUpper = zLower + size * chunkShape[2];\n    xLower = Math.max(xLower, objectXLower);\n    yLower = Math.max(yLower, objectYLower);\n    zLower = Math.max(zLower, objectZLower);\n    xUpper = Math.min(xUpper, objectXUpper);\n    yUpper = Math.min(yUpper, objectYUpper);\n    zUpper = Math.min(zUpper, objectZUpper);\n\n    if (isAABBVisible(xLower, yLower, zLower, xUpper, yUpper, zUpper, clippingPlanes)) {\n      const minW = Math.max(minWClip, getBoxW(xLower, yLower, zLower, xUpper, yUpper, zUpper));\n      const pixelSize = minW / scaleFactor;\n\n      if (priorLodScale === 0 || pixelSize * detailCutoff < priorLodScale) {\n        const lodScale = lodScales[lod];\n        if (lodScale !== 0) {\n          callback(lod, row, lodScale / pixelSize, (childEndAndEmpty >>> 31));\n        }\n\n        if (lod > 0 && (lodScale === 0 || pixelSize * detailCutoff < lodScale)) {\n          const nextPriorLodScale = lodScale === 0 ? priorLodScale : lodScale;\n          const childEnd = (childEndAndEmpty & 0x7FFFFFFF) >>> 0;\n          for (let childRow = childBegin; childRow < childEnd; ++childRow) {\n            handleChunk(lod - 1, childRow, nextPriorLodScale);\n          }\n        }\n      }\n    }\n  }\n  handleChunk(maxLod, octree.length / 5 - 1, 0);\n}\n\nexport function getMultiscaleChunksToDraw(\n    manifest: MultiscaleMeshManifest, modelViewProjection: mat4, clippingPlanes: Float32Array,\n    detailCutoff: number, viewportWidth: number, viewportHeight: number,\n    hasChunk: (lod: number, row: number, renderScale: number) => boolean,\n    callback: (\n        lod: number, row: number, subChunkBegin: number, subChunkEnd: number,\n        renderScale: number) => void) {\n  const {lodScales} = manifest;\n  let maxLod = 0;\n  while (maxLod + 1 < lodScales.length && lodScales[maxLod + 1] !== 0) {\n    ++maxLod;\n  }\n  const stackEntryStride = 3;\n\n  // [row, parentSubChunkIndex, renderScale]\n  const stack: number[] = [];\n  let stackDepth = 0;\n  let priorSubChunkIndex = 0;\n  function emitChunksUpTo(targetStackIndex: number, subChunkIndex: number) {\n    while (true) {\n      if (stackDepth === 0) return;\n\n      // Finish last chunk of last (finest) lod.\n      const stackIndex = stackDepth - 1;\n      const entryLod = maxLod - stackIndex;\n      const entryRow = stack[stackIndex * stackEntryStride];\n      const numSubChunks = entryLod === 0 ? 1 : 8;\n      const entrySubChunkIndex = stack[stackIndex * stackEntryStride + 1];\n      const entryRenderScale = stack[stackIndex * stackEntryStride + 2];\n      if (targetStackIndex === stackDepth) {\n        const endSubChunk = subChunkIndex & (numSubChunks - 1);\n\n        if (priorSubChunkIndex !== endSubChunk && entryRow !== -1) {\n          callback(entryLod, entryRow, priorSubChunkIndex, endSubChunk, entryRenderScale);\n        }\n        priorSubChunkIndex = endSubChunk + 1;\n        return;\n      }\n      if (priorSubChunkIndex !== numSubChunks && entryRow !== -1) {\n        callback(entryLod, entryRow, priorSubChunkIndex, numSubChunks, entryRenderScale);\n      }\n      priorSubChunkIndex = entrySubChunkIndex + 1;\n      --stackDepth;\n    }\n  }\n\n  let priorMissingLod = 0;\n\n  const {octree} = manifest;\n  getDesiredMultiscaleMeshChunks(\n      manifest, modelViewProjection, clippingPlanes, detailCutoff, viewportWidth, viewportHeight,\n      (lod, row, renderScale, empty) => {\n        if (!empty && !hasChunk(lod, row, renderScale)) {\n          priorMissingLod = Math.max(lod, priorMissingLod);\n          return;\n        }\n        if (lod < priorMissingLod) return;\n        priorMissingLod = 0;\n        const rowOffset = row * 5;\n        const x = octree[rowOffset], y = octree[rowOffset + 1], z = octree[rowOffset + 2];\n        const subChunkIndex = getOctreeChildIndex(x, y, z);\n        const stackIndex = maxLod - lod;\n        emitChunksUpTo(stackIndex, subChunkIndex);\n        const stackOffset = stackIndex * stackEntryStride;\n        stack[stackOffset] = empty ? -1 : row;\n        stack[stackOffset + 1] = subChunkIndex;\n        stack[stackOffset + 2] = renderScale;\n        priorSubChunkIndex = 0;\n        stackDepth = stackIndex + 1;\n      });\n\n  emitChunksUpTo(0, 0);\n}\n\nexport function validateOctree(octree: Uint32Array) {\n  if (octree.length % 5 !== 0) {\n    throw new Error('Invalid length');\n  }\n  const numNodes = octree.length / 5;\n  const seenNodes = new Set<number>();\n  function exploreNode(node: number) {\n    if (seenNodes.has(node)) {\n      throw new Error('Previously seen node');\n    }\n    seenNodes.add(node);\n    if (node < 0 || node >= numNodes) {\n      throw new Error('Invalid node reference');\n    }\n    const x = octree[node * 5], y = octree[node * 5 + 1], z = octree[node * 5 + 2],\n          beginChild = octree[node * 5 + 3], endChild = octree[node * 5 + 4];\n    if (beginChild < 0 || endChild < 0 || endChild < beginChild || endChild > numNodes ||\n        beginChild + 8 < endChild) {\n      throw new Error('Invalid child references');\n    }\n    for (let child = beginChild; child < endChild; ++child) {\n      const childX = octree[child * 5], childY = octree[child * 5 + 1],\n            childZ = octree[child * 5 + 2];\n      if ((childX >>> 1) !== x || (childY >>> 1) !== y || (childZ >>> 1) != z) {\n        throw new Error('invalid child');\n      }\n      exploreNode(child);\n    }\n  }\n  if (numNodes === 0) return;\n  exploreNode(numNodes - 1);\n}\n\nexport function getMultiscaleFragmentKey(objectKey: string, lod: number, chunkIndex: number) {\n  return `${objectKey}/${lod}:${chunkIndex}`;\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Uint64} from './uint64';\n\nexport function getOctreeChildIndex(x: number, y: number, z: number) {\n  return (x & 1) | ((y << 1) & 2) | ((z << 2) & 4);\n}\n\n/**\n * Decodes a \"compressed\" 3-d morton index.\n *\n * Decoded bit `i` of `x`, `y`, and `z` is at bit `i + min(i, yBits) + min(i, zBits)`, `i + min(i +\n * 1, xBits) + min(i, zBits)`, and `i + min(i + 1, xBits) + min(i + 1, zBits)` of `zindex`,\n * respectively, for `i` in `[0, xBits)`, `[0, yBits)`, `[0, zBits)`, respectively.\n */\nexport function decodeZIndexCompressed(\n    zindex: Uint64, xBits: number, yBits: number, zBits: number): Uint32Array {\n  const maxCoordBits = Math.max(xBits, yBits, zBits);\n  let inputBit = 0;\n  let inputValue = zindex.low;\n  let x = 0, y = 0, z = 0;\n  for (let coordBit = 0; coordBit < maxCoordBits; ++coordBit) {\n    if (coordBit < xBits) {\n      const bit = (inputValue >>> inputBit) & 1;\n      x |= (bit << coordBit);\n      if (inputBit === 31) {\n        inputBit = 0;\n        inputValue = zindex.high;\n      } else {\n        ++inputBit;\n      }\n    }\n    if (coordBit < yBits) {\n      const bit = (inputValue >>> inputBit) & 1;\n      y |= (bit << coordBit);\n      if (inputBit === 31) {\n        inputBit = 0;\n        inputValue = zindex.high;\n      } else {\n        ++inputBit;\n      }\n    }\n    if (coordBit < zBits) {\n      const bit = (inputValue >>> inputBit) & 1;\n      z |= (bit << coordBit);\n      if (inputBit === 31) {\n        inputBit = 0;\n        inputValue = zindex.high;\n      } else {\n        ++inputBit;\n      }\n    }\n  }\n  return Uint32Array.of(x, y, z);\n}\n\nexport function encodeZIndexCompressed(\n    zindex: Uint64, xBits: number, yBits: number, zBits: number, x: number, y: number,\n    z: number): Uint64 {\n  const maxBits = Math.max(xBits, yBits, zBits);\n  let outputBit = 0;\n  let outputNum = 0;\n  let isHigh = false;\n  function writeBit(b: number): void {\n    outputNum |= (b & 1) << outputBit;\n    if (++outputBit === 32) {\n      zindex.low = outputNum;\n      outputNum = 0;\n      outputBit = 0;\n      isHigh = true;\n    }\n  }\n  for (let bit = 0; bit < maxBits; ++bit) {\n    if (bit < xBits) {\n      writeBit((x >> bit) & 1);\n    }\n    if (bit < yBits) {\n      writeBit((y >> bit) & 1);\n    }\n    if (bit < zBits) {\n      writeBit((z >> bit) & 1);\n    }\n  }\n  if (isHigh) {\n    zindex.high = outputNum;\n  } else {\n    zindex.high = 0;\n    zindex.low = outputNum;\n  }\n  return zindex;\n}\n\nfunction lessMsb(a: number, b: number) {\n  return a < b && a < (a ^ b);\n}\n\n/**\n * Returns `true` if `(x0, y0, z0)` occurs before `(x1, y1, z1)` in Z-curve order.\n */\nexport function zorder3LessThan(\n    x0: number, y0: number, z0: number, x1: number, y1: number, z1: number): boolean {\n  let mostSignificant0 = z0, mostSignificant1 = z1;\n\n  if (lessMsb(mostSignificant0 ^ mostSignificant1, y0 ^ y1)) {\n    mostSignificant0 = y0;\n    mostSignificant1 = y1;\n  }\n\n  if (lessMsb(mostSignificant0 ^ mostSignificant1, x0 ^ x1)) {\n    mostSignificant0 = x0;\n    mostSignificant1 = x1;\n  }\n\n  return mostSignificant0 < mostSignificant1;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {Chunk, ChunkManager, ChunkSource} from 'neuroglancer/chunk_manager/frontend';\nimport {EncodedMeshData, FRAGMENT_SOURCE_RPC_ID, MESH_LAYER_RPC_ID, MULTISCALE_FRAGMENT_SOURCE_RPC_ID, MULTISCALE_MESH_LAYER_RPC_ID, MultiscaleFragmentFormat, VertexPositionFormat} from 'neuroglancer/mesh/base';\nimport {getMultiscaleChunksToDraw, getMultiscaleFragmentKey, MultiscaleMeshManifest} from 'neuroglancer/mesh/multiscale';\nimport {PerspectiveViewReadyRenderContext, PerspectiveViewRenderContext, PerspectiveViewRenderLayer} from 'neuroglancer/perspective_view/render_layer';\nimport {forEachVisibleSegment, getObjectKey} from 'neuroglancer/segmentation_display_state/base';\nimport {getObjectColor, registerRedrawWhenSegmentationDisplayState3DChanged, SegmentationDisplayState3D, SegmentationLayerSharedObject} from 'neuroglancer/segmentation_display_state/frontend';\nimport {Borrowed} from 'neuroglancer/util/disposable';\nimport {getFrustrumPlanes, mat3, mat3FromMat4, mat4, vec3, vec4} from 'neuroglancer/util/geom';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderModule, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {registerSharedObjectOwner, RPC} from 'neuroglancer/worker_rpc';\n\nconst tempMat4 = mat4.create();\nconst tempModelMatrix = mat4.create();\nconst tempMat3 = mat3.create();\n\nconst DEBUG_MULTISCALE_FRAGMENTS = false;\n\nfunction copyMeshDataToGpu(gl: GL, chunk: FragmentChunk|MultiscaleFragmentChunk) {\n  chunk.vertexBuffer =\n      Buffer.fromData(gl, chunk.meshData.vertexPositions, gl.ARRAY_BUFFER, gl.STATIC_DRAW);\n  chunk.indexBuffer =\n      Buffer.fromData(gl, chunk.meshData.indices, gl.ELEMENT_ARRAY_BUFFER, gl.STATIC_DRAW);\n  chunk.normalBuffer =\n      Buffer.fromData(gl, chunk.meshData.vertexNormals, gl.ARRAY_BUFFER, gl.STATIC_DRAW);\n}\n\nfunction freeGpuMeshData(chunk: FragmentChunk|MultiscaleFragmentChunk) {\n  chunk.vertexBuffer.dispose();\n  chunk.indexBuffer.dispose();\n  chunk.normalBuffer.dispose();\n}\n\n/**\n * Decodes normal vectors in 2xSnorm8 octahedron encoding into normalized 3x32f vector.\n *\n * Zina H. Cigolle, Sam Donow, Daniel Evangelakos, Michael Mara, Morgan McGuire, and Quirin Meyer,\n * Survey of Efficient Representations for Independent Unit Vectors, Journal of Computer Graphics\n * Techniques (JCGT), vol. 3, no. 2, 1-30, 2014\n *\n * Available online http://jcgt.org/published/0003/02/01/\n */\nconst glsl_decodeNormalOctahedronSnorm8 = `\nhighp vec3 decodeNormalOctahedronSnorm8(highp vec2 e) {\n  vec3 v = vec3(e.xy, 1.0 - abs(e.x) - abs(e.y));\n  if (v.z < 0.0) v.xy = (1.0 - abs(v.yx)) * vec2(v.x > 0.0 ? 1.0 : -1.0, v.y > 0.0 ? 1.0 : -1.0);\n  return normalize(v);\n}\n`;\n\ninterface VertexPositionFormatHandler {\n  defineShader: (builder: ShaderBuilder) => void;\n  bind:\n      (gl: GL, shader: ShaderProgram, fragmentChunk: FragmentChunk|MultiscaleFragmentChunk) => void;\n  endLayer: (gl: GL, shader: ShaderProgram) => void;\n}\n\nfunction getFloatPositionHandler(glAttributeType: number): VertexPositionFormatHandler {\n  return {\n    defineShader: (builder: ShaderBuilder) => {\n      builder.addAttribute('highp vec3', 'aVertexPosition');\n      builder.addVertexCode(`highp vec3 getVertexPosition() { return aVertexPosition; }`);\n    },\n    bind(_gl: GL, shader: ShaderProgram, fragmentChunk: FragmentChunk|MultiscaleFragmentChunk) {\n      fragmentChunk.vertexBuffer.bindToVertexAttrib(\n          shader.attribute('aVertexPosition'),\n          /*components=*/ 3, glAttributeType, /* normalized=*/ true);\n    },\n    endLayer: (gl: GL, shader: ShaderProgram) => {\n      gl.disableVertexAttribArray(shader.attribute('aVertexPosition'));\n    }\n  };\n}\n\nconst vertexPositionHandlers: {[format: number]: VertexPositionFormatHandler} = {\n  [VertexPositionFormat.float32]: getFloatPositionHandler(WebGL2RenderingContext.FLOAT),\n  [VertexPositionFormat.uint16]: getFloatPositionHandler(WebGL2RenderingContext.UNSIGNED_SHORT),\n  [VertexPositionFormat.uint10]: {\n    defineShader: (builder: ShaderBuilder) => {\n      builder.addAttribute('highp uint', 'aVertexPosition');\n      builder.addVertexCode(`\nhighp vec3 getVertexPosition() {\n  return vec3(float(aVertexPosition & 1023u),\n              float((aVertexPosition >> 10) & 1023u),\n              float((aVertexPosition >> 20) & 1023u)) / 1023.0;\n}\n`);\n    },\n    bind(_gl: GL, shader: ShaderProgram, fragmentChunk: FragmentChunk|MultiscaleFragmentChunk) {\n      fragmentChunk.vertexBuffer.bindToVertexAttribI(\n          shader.attribute('aVertexPosition'),\n          /*components=*/ 1, WebGL2RenderingContext.UNSIGNED_INT);\n    },\n    endLayer: (gl: GL, shader: ShaderProgram) => {\n      gl.disableVertexAttribArray(shader.attribute('aVertexPosition'));\n    }\n  },\n};\n\nexport class MeshShaderManager {\n  private tempLightVec = new Float32Array(4);\n  private vertexPositionHandler = vertexPositionHandlers[this.vertexPositionFormat];\n  constructor(\n      public fragmentRelativeVertices: boolean, public vertexPositionFormat: VertexPositionFormat) {\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    this.vertexPositionHandler.defineShader(builder);\n    builder.addAttribute('highp vec2', 'aVertexNormal');\n    builder.addVarying('highp vec4', 'vColor');\n    builder.addUniform('highp vec4', 'uLightDirection');\n    builder.addUniform('highp vec4', 'uColor');\n    builder.addUniform('highp mat3', 'uNormalMatrix');\n    builder.addUniform('highp mat4', 'uModelViewProjection');\n    builder.addUniform('highp uint', 'uPickID');\n    if (this.fragmentRelativeVertices) {\n      builder.addUniform('highp vec3', 'uFragmentOrigin');\n      builder.addUniform('highp vec3', 'uFragmentShape');\n    }\n    builder.addVertexCode(glsl_decodeNormalOctahedronSnorm8);\n    let vertexMain = ``;\n    if (this.fragmentRelativeVertices) {\n      vertexMain += `\nhighp vec3 vertexPosition = uFragmentOrigin + uFragmentShape * getVertexPosition();\nhighp vec3 normalMultiplier = 1.0 / uFragmentShape;\n`;\n    } else {\n      vertexMain += `\nhighp vec3 vertexPosition = getVertexPosition();\nhighp vec3 normalMultiplier = vec3(1.0, 1.0, 1.0);\n`;\n    }\n    vertexMain += `\ngl_Position = uModelViewProjection * vec4(vertexPosition, 1.0);\nvec3 normal = normalize(uNormalMatrix * normalMultiplier * decodeNormalOctahedronSnorm8(aVertexNormal));\nfloat lightingFactor = abs(dot(normal, uLightDirection.xyz)) + uLightDirection.w;\nvColor = vec4(lightingFactor * uColor.rgb, uColor.a);\n`;\n    builder.setVertexMain(vertexMain);\n    builder.setFragmentMain(`emit(vColor, uPickID);`);\n  }\n\n  beginLayer(gl: GL, shader: ShaderProgram, renderContext: PerspectiveViewRenderContext) {\n    let {lightDirection, ambientLighting, directionalLighting} = renderContext;\n    let lightVec = <vec3>this.tempLightVec;\n    vec3.scale(lightVec, lightDirection, directionalLighting);\n    lightVec[3] = ambientLighting;\n    gl.uniform4fv(shader.uniform('uLightDirection'), lightVec);\n  }\n\n  setColor(gl: GL, shader: ShaderProgram, color: vec4) {\n    gl.uniform4fv(shader.uniform('uColor'), color);\n  }\n\n  setPickID(gl: GL, shader: ShaderProgram, pickID: number) {\n    gl.uniform1ui(shader.uniform('uPickID'), pickID);\n  }\n\n  beginModel(\n      gl: GL, shader: ShaderProgram, renderContext: PerspectiveViewRenderContext, modelMat: mat4) {\n    gl.uniformMatrix4fv(\n        shader.uniform('uModelViewProjection'), false,\n        mat4.multiply(tempMat4, renderContext.dataToDevice, modelMat));\n    mat3FromMat4(tempMat3, modelMat);\n    mat3.invert(tempMat3, tempMat3);\n    mat3.transpose(tempMat3, tempMat3);\n    gl.uniformMatrix3fv(shader.uniform('uNormalMatrix'), false, tempMat3);\n  }\n\n  getShader(gl: GL, emitter: ShaderModule) {\n    return gl.memoize.get(\n        `mesh/MeshShaderManager:${getObjectId(emitter)}/` +\n            `${this.fragmentRelativeVertices}/${this.vertexPositionFormat}`,\n        () => {\n          let builder = new ShaderBuilder(gl);\n          builder.require(emitter);\n          this.defineShader(builder);\n          return builder.build();\n        });\n  }\n\n  drawFragmentHelper(\n      gl: GL, shader: ShaderProgram, fragmentChunk: FragmentChunk|MultiscaleFragmentChunk,\n      indexBegin: number, indexEnd: number) {\n    this.vertexPositionHandler.bind(gl, shader, fragmentChunk);\n    const {meshData} = fragmentChunk;\n    fragmentChunk.normalBuffer.bindToVertexAttrib(\n        shader.attribute('aVertexNormal'),\n        /*components=*/ 2, WebGL2RenderingContext.BYTE, /*normalized=*/ true);\n    fragmentChunk.indexBuffer.bind();\n    const {indices} = meshData;\n    gl.drawElements(\n        meshData.strips ? WebGL2RenderingContext.TRIANGLE_STRIP : WebGL2RenderingContext.TRIANGLES,\n        indexEnd - indexBegin,\n        indices.BYTES_PER_ELEMENT === 2 ? WebGL2RenderingContext.UNSIGNED_SHORT :\n                                          WebGL2RenderingContext.UNSIGNED_INT,\n        indexBegin * indices.BYTES_PER_ELEMENT);\n  }\n\n  drawFragment(gl: GL, shader: ShaderProgram, fragmentChunk: FragmentChunk) {\n    const {meshData} = fragmentChunk;\n    const {indices} = meshData;\n    this.drawFragmentHelper(gl, shader, fragmentChunk, 0, indices.length);\n  }\n\n  drawMultiscaleFragment(\n      gl: GL,\n      shader: ShaderProgram,\n      fragmentChunk: MultiscaleFragmentChunk,\n      subChunkBegin: number,\n      subChunkEnd: number,\n  ) {\n    const indexBegin = fragmentChunk.meshData.subChunkOffsets[subChunkBegin];\n    const indexEnd = fragmentChunk.meshData.subChunkOffsets[subChunkEnd];\n    this.drawFragmentHelper(gl, shader, fragmentChunk, indexBegin, indexEnd);\n  }\n\n  endLayer(gl: GL, shader: ShaderProgram) {\n    this.vertexPositionHandler.endLayer(gl, shader);\n    gl.disableVertexAttribArray(shader.attribute('aVertexNormal'));\n  }\n}\n\nexport class MeshLayer extends PerspectiveViewRenderLayer {\n  protected meshShaderManager =\n      new MeshShaderManager(/*fragmentRelativeVertices=*/ false, VertexPositionFormat.float32);\n  private shaders = new Map<ShaderModule, ShaderProgram>();\n  backend: SegmentationLayerSharedObject;\n\n  constructor(\n      public chunkManager: ChunkManager, public source: MeshSource,\n      public displayState: SegmentationDisplayState3D) {\n    super();\n\n    registerRedrawWhenSegmentationDisplayState3DChanged(displayState, this);\n\n    let sharedObject = this.backend =\n        this.registerDisposer(new SegmentationLayerSharedObject(chunkManager, displayState));\n    sharedObject.RPC_TYPE_ID = MESH_LAYER_RPC_ID;\n    sharedObject.initializeCounterpartWithChunkManager({\n      'source': source.addCounterpartRef(),\n    });\n    this.setReady(true);\n    sharedObject.visibility.add(this.visibility);\n    this.registerDisposer(displayState.renderScaleHistogram.visibility.add(this.visibility));\n  }\n\n  protected getShader(emitter: ShaderModule) {\n    let {shaders} = this;\n    let shader = shaders.get(emitter);\n    if (shader === undefined) {\n      shader = this.registerDisposer(this.meshShaderManager.getShader(this.gl, emitter));\n      shaders.set(emitter, shader);\n    }\n    return shader;\n  }\n\n  get isTransparent() {\n    return this.displayState.objectAlpha.value < 1.0;\n  }\n\n  get gl() {\n    return this.chunkManager.chunkQueueManager.gl;\n  }\n\n  draw(renderContext: PerspectiveViewRenderContext) {\n    if (!renderContext.emitColor && renderContext.alreadyEmittedPickID) {\n      // No need for a separate pick ID pass.\n      return;\n    }\n    let {gl, displayState, meshShaderManager} = this;\n    let alpha = Math.min(1.0, displayState.objectAlpha.value);\n    if (alpha <= 0.0) {\n      // Skip drawing.\n      return;\n    }\n    let shader = this.getShader(renderContext.emitter);\n    shader.bind();\n    const objectToDataMatrix = this.displayState.objectToDataTransform.transform;\n    meshShaderManager.beginLayer(gl, shader, renderContext);\n    meshShaderManager.beginModel(gl, shader, renderContext, objectToDataMatrix);\n\n    let {pickIDs} = renderContext;\n    const manifestChunks = this.source.chunks;\n\n    let totalChunks = 0, presentChunks = 0;\n    const {renderScaleHistogram} = this.displayState;\n    const fragmentChunks = this.source.fragmentSource.chunks;\n\n    forEachVisibleSegment(displayState, (objectId, rootObjectId) => {\n      const key = getObjectKey(objectId);\n      const manifestChunk = manifestChunks.get(key);\n      if (manifestChunk === undefined) return;\n      if (renderContext.emitColor) {\n        meshShaderManager.setColor(gl, shader, getObjectColor(displayState, rootObjectId, alpha));\n      }\n      if (renderContext.emitPickID) {\n        meshShaderManager.setPickID(gl, shader, pickIDs.registerUint64(this, objectId));\n      }\n      totalChunks += manifestChunk.fragmentIds.length;\n\n      for (const fragmentId of manifestChunk.fragmentIds) {\n        const fragment = fragmentChunks.get(`${key}/${fragmentId}`);\n        if (fragment !== undefined && fragment.state === ChunkState.GPU_MEMORY) {\n          meshShaderManager.drawFragment(gl, shader, fragment);\n          ++presentChunks;\n        }\n      }\n    });\n\n    if (renderContext.emitColor) {\n      renderScaleHistogram.begin(\n          this.chunkManager.chunkQueueManager.frameNumberCounter.frameNumber);\n      renderScaleHistogram.add(\n          Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY, presentChunks,\n          totalChunks - presentChunks);\n    }\n    meshShaderManager.endLayer(gl, shader);\n  }\n\n  isReady() {\n    const {displayState, source} = this;\n    let ready = true;\n    const fragmentChunks = source.fragmentSource.chunks;\n    forEachVisibleSegment(displayState, objectId => {\n      const key = getObjectKey(objectId);\n      const manifestChunk = source.chunks.get(key);\n      if (manifestChunk === undefined) {\n        ready = false;\n        return;\n      }\n      for (const fragmentId of manifestChunk.fragmentIds) {\n        const fragmentChunk = fragmentChunks.get(`${key}/${fragmentId}`);\n        if (fragmentChunk === undefined || fragmentChunk.state !== ChunkState.GPU_MEMORY) {\n          ready = false;\n          return;\n        }\n      }\n    });\n    return ready;\n  }\n}\n\nexport class ManifestChunk extends Chunk {\n  fragmentIds: string[];\n\n  constructor(source: MeshSource, x: any) {\n    super(source);\n    this.fragmentIds = x.fragmentIds;\n  }\n}\n\nexport class FragmentChunk extends Chunk {\n  source: FragmentSource;\n  vertexBuffer: Buffer;\n  indexBuffer: Buffer;\n  normalBuffer: Buffer;\n  meshData: EncodedMeshData;\n\n  constructor(source: FragmentSource, x: any) {\n    super(source);\n    this.meshData = x;\n  }\n\n  copyToGPU(gl: GL) {\n    super.copyToGPU(gl);\n    copyMeshDataToGpu(gl, this);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    freeGpuMeshData(this);\n  }\n}\n\nexport class MeshSource extends ChunkSource {\n  fragmentSource = this.registerDisposer(new FragmentSource(this.chunkManager, this));\n  chunks: Map<string, ManifestChunk>;\n  initializeCounterpart(rpc: RPC, options: any) {\n    this.fragmentSource.initializeCounterpart(this.chunkManager.rpc!, {});\n    options['fragmentSource'] = this.fragmentSource.addCounterpartRef();\n    super.initializeCounterpart(rpc, options);\n  }\n  getChunk(x: any) {\n    return new ManifestChunk(this, x);\n  }\n}\n\n@registerSharedObjectOwner(FRAGMENT_SOURCE_RPC_ID)\nexport class FragmentSource extends ChunkSource {\n  chunks: Map<string, FragmentChunk>;\n  get key() {\n    return this.meshSource.key;\n  }\n  constructor(chunkManager: ChunkManager, public meshSource: MeshSource) {\n    super(chunkManager);\n  }\n  getChunk(x: any) {\n    return new FragmentChunk(this, x);\n  }\n}\n\n\nfunction hasFragmentChunk(\n    fragmentChunks: Map<string, MultiscaleFragmentChunk>, objectKey: string, lod: number,\n    chunkIndex: number) {\n  const fragmentChunk = fragmentChunks.get(getMultiscaleFragmentKey(objectKey, lod, chunkIndex));\n  return fragmentChunk !== undefined && fragmentChunk.state === ChunkState.GPU_MEMORY;\n}\n\nexport class MultiscaleMeshLayer extends PerspectiveViewRenderLayer {\n  protected meshShaderManager = new MeshShaderManager(\n      /*fragmentRelativeVertices=*/ this.source.format.fragmentRelativeVertices,\n      this.source.format.vertexPositionFormat);\n  private shaders = new Map<ShaderModule, ShaderProgram>();\n  backend: SegmentationLayerSharedObject;\n\n  constructor(\n      public chunkManager: ChunkManager, public source: MultiscaleMeshSource,\n      public displayState: SegmentationDisplayState3D) {\n    super();\n\n    registerRedrawWhenSegmentationDisplayState3DChanged(displayState, this);\n\n    let sharedObject = this.backend =\n        this.registerDisposer(new SegmentationLayerSharedObject(chunkManager, displayState));\n    sharedObject.RPC_TYPE_ID = MULTISCALE_MESH_LAYER_RPC_ID;\n    sharedObject.initializeCounterpartWithChunkManager({\n      'source': source.addCounterpartRef(),\n    });\n    this.setReady(true);\n    sharedObject.visibility.add(this.visibility);\n    this.registerDisposer(displayState.renderScaleHistogram.visibility.add(this.visibility));\n  }\n\n  protected getShader(emitter: ShaderModule) {\n    let {shaders} = this;\n    let shader = shaders.get(emitter);\n    if (shader === undefined) {\n      shader = this.registerDisposer(this.meshShaderManager.getShader(this.gl, emitter));\n      shaders.set(emitter, shader);\n    }\n    return shader;\n  }\n\n  get isTransparent() {\n    return this.displayState.objectAlpha.value < 1.0;\n  }\n\n  get gl() {\n    return this.chunkManager.chunkQueueManager.gl;\n  }\n\n  draw(renderContext: PerspectiveViewRenderContext) {\n    if (!renderContext.emitColor && renderContext.alreadyEmittedPickID) {\n      // No need for a separate pick ID pass.\n      return;\n    }\n    let {gl, displayState, meshShaderManager} = this;\n    let alpha = Math.min(1.0, displayState.objectAlpha.value);\n    if (alpha <= 0.0) {\n      // Skip drawing.\n      return;\n    }\n    let shader = this.getShader(renderContext.emitter);\n    shader.bind();\n    meshShaderManager.beginLayer(gl, shader, renderContext);\n\n    const {renderScaleHistogram} = this.displayState;\n    if (renderContext.emitColor) {\n      renderScaleHistogram.begin(\n          this.chunkManager.chunkQueueManager.frameNumberCounter.frameNumber);\n    }\n\n    let {pickIDs} = renderContext;\n\n    const objectToDataMatrix = mat4.multiply(\n        tempModelMatrix, this.displayState.objectToDataTransform.transform,\n        this.source.format.transform);\n\n    mat3FromMat4(tempMat3, objectToDataMatrix);\n    const scaleMultiplier = Math.pow(mat3.determinant(tempMat3), 1 / 3);\n\n    const {chunks} = this.source;\n    const fragmentChunks = this.source.fragmentSource.chunks;\n\n    const modelViewProjection =\n        mat4.multiply(mat4.create(), renderContext.dataToDevice, objectToDataMatrix);\n\n    const clippingPlanes = getFrustrumPlanes(new Float32Array(24), modelViewProjection);\n\n    const detailCutoff = this.displayState.renderScaleTarget.value;\n    const {fragmentRelativeVertices} = this.source.format;\n\n    meshShaderManager.beginModel(gl, shader, renderContext, objectToDataMatrix);\n\n    forEachVisibleSegment(displayState, (objectId, rootObjectId) => {\n      const key = getObjectKey(objectId);\n      const manifestChunk = chunks.get(key);\n      if (manifestChunk === undefined) return;\n      const {manifest} = manifestChunk;\n      const {octree, chunkShape, chunkGridSpatialOrigin, vertexOffsets} = manifest;\n      if (renderContext.emitColor) {\n        meshShaderManager.setColor(gl, shader, getObjectColor(displayState, rootObjectId, alpha));\n      }\n      if (renderContext.emitPickID) {\n        meshShaderManager.setPickID(gl, shader, pickIDs.registerUint64(this, objectId));\n      }\n      if (DEBUG_MULTISCALE_FRAGMENTS) {\n        console.log('drawing object, numChunks=', manifest.octree.length / 5, manifest.octree);\n      }\n      getMultiscaleChunksToDraw(\n          manifest, modelViewProjection, clippingPlanes, detailCutoff, renderContext.viewportWidth,\n          renderContext.viewportHeight,\n          (lod, chunkIndex, renderScale) => {\n            const has = hasFragmentChunk(fragmentChunks, key, lod, chunkIndex);\n            if (renderContext.emitColor) {\n              renderScaleHistogram.add(\n                  manifest.lodScales[lod] * scaleMultiplier, renderScale, has ? 1 : 0, has ? 0 : 1);\n            }\n            return has;\n          },\n          (lod, chunkIndex, subChunkBegin, subChunkEnd) => {\n            const fragmentKey = getMultiscaleFragmentKey(key, lod, chunkIndex);\n            const fragmentChunk = fragmentChunks.get(fragmentKey)!;\n            const x = octree[5 * chunkIndex], y = octree[5 * chunkIndex + 1],\n                  z = octree[5 * chunkIndex + 2];\n            const scale = 1 << lod;\n            if (fragmentRelativeVertices) {\n              gl.uniform3f(\n                  shader.uniform('uFragmentOrigin'),\n                  chunkGridSpatialOrigin[0] + (x * chunkShape[0]) * scale +\n                      vertexOffsets[lod * 3 + 0],\n                  chunkGridSpatialOrigin[1] + (y * chunkShape[1]) * scale +\n                      vertexOffsets[lod * 3 + 1],\n                  chunkGridSpatialOrigin[2] + (z * chunkShape[2]) * scale +\n                      vertexOffsets[lod * 3 + 2]);\n              gl.uniform3f(\n                  shader.uniform('uFragmentShape'), chunkShape[0] * scale, chunkShape[1] * scale,\n                  chunkShape[2] * scale);\n            }\n\n            meshShaderManager.drawMultiscaleFragment(\n                gl,\n                shader,\n                fragmentChunk,\n                subChunkBegin,\n                subChunkEnd,\n            );\n          });\n    });\n    meshShaderManager.endLayer(gl, shader);\n  }\n\n  isReady(renderContext: PerspectiveViewReadyRenderContext) {\n    let {displayState} = this;\n    let alpha = Math.min(1.0, displayState.objectAlpha.value);\n    if (alpha <= 0.0) {\n      // Skip drawing.\n      return true;\n    }\n    const objectToDataMatrix = this.displayState.objectToDataTransform.transform;\n    const {chunks} = this.source;\n    const fragmentChunks = this.source.fragmentSource.chunks;\n\n    const modelViewProjection =\n        mat4.multiply(mat4.create(), renderContext.dataToDevice, objectToDataMatrix);\n\n    const clippingPlanes = getFrustrumPlanes(new Float32Array(24), modelViewProjection);\n\n    const detailCutoff = this.displayState.renderScaleTarget.value;\n\n    let hasAllChunks = true;\n\n    forEachVisibleSegment(displayState, (objectId) => {\n      if (!hasAllChunks) return;\n      const key = getObjectKey(objectId);\n      const manifestChunk = chunks.get(key);\n      if (manifestChunk === undefined) {\n        hasAllChunks = false;\n        return;\n      }\n      const {manifest} = manifestChunk;\n      getMultiscaleChunksToDraw(\n          manifest, modelViewProjection, clippingPlanes, detailCutoff, renderContext.viewportWidth,\n          renderContext.viewportHeight, (lod, chunkIndex) => {\n            hasAllChunks = hasAllChunks && hasFragmentChunk(fragmentChunks, key, lod, chunkIndex);\n            return hasAllChunks;\n          }, () => {});\n    });\n    return hasAllChunks;\n  }\n}\n\nexport class MultiscaleManifestChunk extends Chunk {\n  manifest: MultiscaleMeshManifest;\n  source: MultiscaleMeshSource;\n\n  constructor(source: MultiscaleMeshSource, x: any) {\n    super(source);\n    this.manifest = x['manifest'];\n  }\n}\n\nexport class MultiscaleFragmentChunk extends Chunk {\n  meshData: EncodedMeshData&{subChunkOffsets: Uint32Array};\n  source: MultiscaleFragmentSource;\n  vertexBuffer: Buffer;\n  indexBuffer: Buffer;\n  normalBuffer: Buffer;\n\n  constructor(source: MultiscaleFragmentSource, x: any) {\n    super(source);\n    this.meshData = x;\n  }\n\n  copyToGPU(gl: GL) {\n    super.copyToGPU(gl);\n    copyMeshDataToGpu(gl, this);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    freeGpuMeshData(this);\n  }\n}\n\nexport class MultiscaleMeshSource extends ChunkSource {\n  fragmentSource = this.registerDisposer(new MultiscaleFragmentSource(this.chunkManager, this));\n  chunks: Map<string, MultiscaleManifestChunk>;\n  format: MultiscaleFragmentFormat;\n  constructor(chunkManager: Borrowed<ChunkManager>, options: {format: MultiscaleFragmentFormat}) {\n    super(chunkManager, options);\n    this.format = options.format;\n  }\n  initializeCounterpart(rpc: RPC, options: any) {\n    this.fragmentSource.initializeCounterpart(this.chunkManager.rpc!, {});\n    options['fragmentSource'] = this.fragmentSource.addCounterpartRef();\n    options['format'] = this.format;\n    super.initializeCounterpart(rpc, options);\n  }\n  getChunk(x: any) {\n    return new MultiscaleManifestChunk(this, x);\n  }\n}\n\n@registerSharedObjectOwner(MULTISCALE_FRAGMENT_SOURCE_RPC_ID)\nexport class MultiscaleFragmentSource extends ChunkSource {\n  chunks: Map<string, MultiscaleFragmentChunk>;\n  get key() {\n    return this.meshSource.key;\n  }\n  constructor(chunkManager: ChunkManager, public meshSource: MultiscaleMeshSource) {\n    super(chunkManager);\n  }\n  getChunk(x: any) {\n    return new MultiscaleFragmentChunk(this, x);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {LayerSelectedValues, UserLayer} from 'neuroglancer/layer';\nimport {RenderScaleHistogram} from 'neuroglancer/render_scale_statistics';\nimport {SegmentColorHash} from 'neuroglancer/segment_color';\nimport {VisibleSegmentsState} from 'neuroglancer/segmentation_display_state/base';\nimport {SharedWatchableValue} from 'neuroglancer/shared_watchable_value';\nimport {TrackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {Uint64Set} from 'neuroglancer/uint64_set';\nimport {hsvToRgb, rgbToHsv} from 'neuroglancer/util/colorspace';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {vec4} from 'neuroglancer/util/geom';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {withSharedVisibility} from 'neuroglancer/visibility_priority/frontend';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\nexport class Uint64MapEntry {\n  constructor(public key: Uint64, public value: Uint64) {}\n  toString() {\n    return `${this.key}${this.value}`;\n  }\n}\n\nexport class SegmentSelectionState extends RefCounted {\n  selectedSegment = new Uint64();\n  hasSelectedSegment = false;\n  changed = new NullarySignal();\n\n  set(value: Uint64|null|undefined) {\n    if (value == null) {\n      if (this.hasSelectedSegment) {\n        this.hasSelectedSegment = false;\n        this.changed.dispatch();\n      }\n    } else {\n      let existingValue = this.selectedSegment;\n      if (!this.hasSelectedSegment || value.low !== existingValue.low ||\n          value.high !== existingValue.high) {\n        existingValue.low = value.low;\n        existingValue.high = value.high;\n        this.hasSelectedSegment = true;\n        this.changed.dispatch();\n      }\n    }\n  }\n\n  isSelected(value: Uint64) {\n    return this.hasSelectedSegment && Uint64.equal(value, this.selectedSegment);\n  }\n\n  bindTo(layerSelectedValues: LayerSelectedValues, userLayer: UserLayer) {\n    let temp = new Uint64();\n    this.registerDisposer(layerSelectedValues.changed.add(() => {\n      let value = layerSelectedValues.get(userLayer);\n      if (typeof value === 'number') {\n        temp.low = value;\n        temp.high = 0;\n        value = temp;\n      } else if (value instanceof Uint64MapEntry) {\n        value = value.value;\n      }\n      this.set(value);\n    }));\n  }\n}\n\nexport interface SegmentationDisplayState extends VisibleSegmentsState {\n  segmentSelectionState: SegmentSelectionState;\n  segmentColorHash: SegmentColorHash;\n  saturation: TrackableAlphaValue;\n  highlightedSegments: Uint64Set;\n}\n\nexport interface SegmentationDisplayStateWithAlpha extends SegmentationDisplayState {\n  objectAlpha: TrackableAlphaValue;\n}\n\nexport interface SegmentationDisplayState3D extends SegmentationDisplayStateWithAlpha {\n  objectToDataTransform: CoordinateTransform;\n  renderScaleHistogram: RenderScaleHistogram;\n  renderScaleTarget: TrackableValue<number>;\n}\n\nexport function registerRedrawWhenSegmentationDisplayStateChanged(\n    displayState: SegmentationDisplayState, renderLayer: {redrawNeeded: NullarySignal}&RefCounted) {\n  const dispatchRedrawNeeded = renderLayer.redrawNeeded.dispatch;\n  renderLayer.registerDisposer(displayState.segmentColorHash.changed.add(dispatchRedrawNeeded));\n  renderLayer.registerDisposer(displayState.visibleSegments.changed.add(dispatchRedrawNeeded));\n  renderLayer.registerDisposer(displayState.saturation.changed.add(dispatchRedrawNeeded));\n  renderLayer.registerDisposer(displayState.highlightedSegments.changed.add(dispatchRedrawNeeded));\n  renderLayer.registerDisposer(displayState.segmentEquivalences.changed.add(dispatchRedrawNeeded));\n  renderLayer.registerDisposer(\n      displayState.segmentSelectionState.changed.add(dispatchRedrawNeeded));\n}\n\nexport function registerRedrawWhenSegmentationDisplayStateWithAlphaChanged(\n    displayState: SegmentationDisplayStateWithAlpha,\n    renderLayer: {redrawNeeded: NullarySignal}&RefCounted) {\n  registerRedrawWhenSegmentationDisplayStateChanged(displayState, renderLayer);\n  renderLayer.registerDisposer(\n      displayState.objectAlpha.changed.add(renderLayer.redrawNeeded.dispatch));\n}\n\nexport function registerRedrawWhenSegmentationDisplayState3DChanged(\n    displayState: SegmentationDisplayState3D,\n    renderLayer: {redrawNeeded: NullarySignal}&RefCounted) {\n  registerRedrawWhenSegmentationDisplayStateWithAlphaChanged(displayState, renderLayer);\n  renderLayer.registerDisposer(\n      displayState.objectToDataTransform.changed.add(renderLayer.redrawNeeded.dispatch));\n  renderLayer.registerDisposer(\n      displayState.renderScaleTarget.changed.add(renderLayer.redrawNeeded.dispatch));\n}\n\n/**\n * Temporary value used by getObjectColor.\n */\nconst tempColor = vec4.create();\n\n/**\n * Returns the alpha-premultiplied color to use.\n */\nexport function getObjectColor(\n    displayState: SegmentationDisplayState, objectId: Uint64, alpha: number = 1) {\n  const color = tempColor;\n  color[3] = alpha;\n  displayState.segmentColorHash.compute(color, objectId);\n  if (displayState.segmentSelectionState.isSelected(objectId)) {\n    for (let i = 0; i < 3; ++i) {\n      color[i] = color[i] * 0.5 + 0.5;\n    }\n  }\n\n  // Apply saturation\n  let hsv = new Float32Array(3);\n  rgbToHsv(hsv, color[0], color[1], color[2]);\n  hsv[1] *= displayState.saturation.value;\n  let rgb = new Float32Array(3);\n  hsvToRgb(rgb, hsv[0], hsv[1], hsv[2]);\n  color[0] = rgb[0];\n  color[1] = rgb[1];\n  color[2] = rgb[2];\n\n  // Color highlighted segments\n  if (displayState.highlightedSegments.has(objectId)) {\n    // Make it vivid blue for selection\n    color[0] = 0.2;\n    color[1] = 0.2;\n    color[2] = 2.0;\n    color[3] = 1.0;\n  }\n\n  color[0] *= alpha;\n  color[1] *= alpha;\n  color[2] *= alpha;\n  return color;\n}\n\nconst Base = withSharedVisibility(SharedObject);\nexport class SegmentationLayerSharedObject extends Base {\n  constructor(public chunkManager: ChunkManager, public displayState: SegmentationDisplayState3D) {\n    super();\n  }\n\n  initializeCounterpartWithChunkManager(options: any) {\n    let {displayState} = this;\n    options['chunkManager'] = this.chunkManager.rpcId;\n    options['visibleSegments'] = displayState.visibleSegments.rpcId;\n    options['segmentEquivalences'] = displayState.segmentEquivalences.rpcId;\n    options['objectToDataTransform'] =\n        this.registerDisposer(SharedWatchableValue.makeFromExisting(\n                                  this.chunkManager.rpc!, this.displayState.objectToDataTransform))\n            .rpcId;\n    options['renderScaleTarget'] =\n        this.registerDisposer(SharedWatchableValue.makeFromExisting(\n                                  this.chunkManager.rpc!, this.displayState.renderScaleTarget))\n            .rpcId;\n    super.initializeCounterpart(this.chunkManager.rpc!, options);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {Chunk, ChunkManager, ChunkSource} from 'neuroglancer/chunk_manager/frontend';\nimport {LayerManager} from 'neuroglancer/layer';\nimport {NavigationState} from 'neuroglancer/navigation_state';\nimport {SLICEVIEW_ADD_VISIBLE_LAYER_RPC_ID, SLICEVIEW_REMOVE_VISIBLE_LAYER_RPC_ID, SLICEVIEW_RPC_ID, SLICEVIEW_UPDATE_VIEW_RPC_ID, SliceViewBase, SliceViewChunkSource as SliceViewChunkSourceInterface, SliceViewChunkSpecification, SliceViewSourceOptions} from 'neuroglancer/sliceview/base';\nimport {ChunkLayout} from 'neuroglancer/sliceview/chunk_layout';\nimport {RenderLayer} from 'neuroglancer/sliceview/renderlayer';\nimport {Disposer, invokeDisposers, RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4, rectifyTransformMatrixIfAxisAligned, vec3, vec3Key, vec4} from 'neuroglancer/util/geom';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {withSharedVisibility} from 'neuroglancer/visibility_priority/frontend';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {FramebufferConfiguration, makeTextureBuffers, StencilBuffer} from 'neuroglancer/webgl/offscreen';\nimport {ShaderBuilder, ShaderModule, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {getSquareCornersBuffer} from 'neuroglancer/webgl/square_corners_buffer';\nimport {registerSharedObjectOwner, RPC} from 'neuroglancer/worker_rpc';\n\nexport type GenericChunkKey = string;\n\nconst tempMat = mat4.create();\n\nclass FrontendSliceViewBase extends SliceViewBase<SliceViewChunkSource, RenderLayer> {}\nconst Base = withSharedVisibility(FrontendSliceViewBase);\n\n@registerSharedObjectOwner(SLICEVIEW_RPC_ID)\nexport class SliceView extends Base {\n  gl = this.chunkManager.gl;\n\n  dataToViewport = mat4.create();\n\n  // Transforms viewport coordinates to OpenGL normalized device coordinates\n  // [left: -1, right: 1], [top: 1, bottom: -1].\n  viewportToDevice = mat4.create();\n\n  // Equals viewportToDevice * dataToViewport.\n  dataToDevice = mat4.create();\n\n  visibleChunks = new Map<ChunkLayout, GenericChunkKey[]>();\n\n  viewChanged = new NullarySignal();\n\n  renderingStale = true;\n\n  visibleChunksStale = true;\n\n  visibleLayerList = new Array<RenderLayer>();\n\n  newVisibleLayers = new Set<RenderLayer>();\n\n  offscreenFramebuffer = this.registerDisposer(new FramebufferConfiguration(\n      this.gl,\n      {colorBuffers: makeTextureBuffers(this.gl, 1), depthBuffer: new StencilBuffer(this.gl)}));\n\n  numVisibleChunks = 0;\n\n  constructor(\n      public chunkManager: ChunkManager, public layerManager: LayerManager,\n      public navigationState: NavigationState) {\n    super();\n    mat4.identity(this.dataToViewport);\n    const rpc = this.chunkManager.rpc!;\n    this.initializeCounterpart(rpc, {\n      'chunkManager': chunkManager.rpcId,\n    });\n    this.registerDisposer(navigationState.changed.add(() => {\n      this.updateViewportFromNavigationState();\n    }));\n    this.updateViewportFromNavigationState();\n\n    this.registerDisposer(layerManager.layersChanged.add(() => {\n      if (this.hasValidViewport) {\n        this.updateVisibleLayers();\n      }\n    }));\n\n    this.viewChanged.add(() => {\n      this.renderingStale = true;\n    });\n    this.registerDisposer(\n        chunkManager.chunkQueueManager.visibleChunksChanged.add(this.viewChanged.dispatch));\n\n    this.updateViewportFromNavigationState();\n    this.updateVisibleLayers();\n  }\n\n  isReady() {\n    this.setViewportSizeDebounced.flush();\n    if (!this.hasValidViewport) {\n      return false;\n    }\n    this.maybeUpdateVisibleChunks();\n    let numValidChunks = 0;\n    for (const visibleSources of this.visibleLayers.values()) {\n      for (const {chunkLayout, source} of visibleSources) {\n        // FIXME: handle change to chunkLayout\n        const visibleChunks = this.visibleChunks.get(chunkLayout);\n        if (!visibleChunks) {\n          return false;\n        }\n        const {chunks} = source;\n        for (const key of visibleChunks) {\n          const chunk = chunks.get(key);\n          if (chunk && chunk.state === ChunkState.GPU_MEMORY) {\n            ++numValidChunks;\n          }\n        }\n      }\n    }\n    return numValidChunks === this.numVisibleChunks;\n  }\n\n  private updateViewportFromNavigationState() {\n    let {navigationState} = this;\n    if (!navigationState.valid) {\n      return;\n    }\n    navigationState.toMat4(tempMat);\n    this.setViewportToDataMatrix(tempMat);\n  }\n\n  private updateVisibleLayers = this.registerCancellable(debounce(() => {\n    this.updateVisibleLayersNow();\n  }, 0));\n\n  private invalidateVisibleSources = (() => {\n    this.visibleSourcesStale = true;\n    this.viewChanged.dispatch();\n  });\n\n  private bindVisibleRenderLayer(renderLayer: RenderLayer, disposers: Disposer[]) {\n    disposers.push(renderLayer.redrawNeeded.add(this.viewChanged.dispatch));\n    disposers.push(renderLayer.transform.changed.add(this.invalidateVisibleSources));\n    disposers.push(renderLayer.renderScaleTarget.changed.add(this.invalidateVisibleSources));\n    const {renderScaleHistogram} = renderLayer;\n    if (renderScaleHistogram !== undefined) {\n      disposers.push(renderScaleHistogram.visibility.add(this.visibility));\n    }\n  }\n\n  private visibleLayerDisposers = new Map<RenderLayer, Disposer[]>();\n\n  private updateVisibleLayersNow() {\n    if (this.wasDisposed) {\n      return false;\n    }\n    if (!this.hasValidViewport) {\n      return false;\n    }\n    let visibleLayers = this.visibleLayers;\n    let rpc = this.rpc!;\n    let rpcMessage: any = {'id': this.rpcId};\n    let newVisibleLayers = this.newVisibleLayers;\n    let changed = false;\n    let visibleLayerList = this.visibleLayerList;\n    const {visibleLayerDisposers} = this;\n    visibleLayerList.length = 0;\n    for (let renderLayer of this.layerManager.readyRenderLayers()) {\n      if (renderLayer instanceof RenderLayer) {\n        newVisibleLayers.add(renderLayer);\n        visibleLayerList.push(renderLayer);\n        if (!visibleLayers.has(renderLayer)) {\n          visibleLayers.set(renderLayer.addRef(), []);\n          const disposers: Disposer[] = [];\n          visibleLayerDisposers.set(renderLayer, disposers);\n          this.bindVisibleRenderLayer(renderLayer, disposers);\n          rpcMessage['layerId'] = renderLayer.rpcId;\n          rpc.invoke(SLICEVIEW_ADD_VISIBLE_LAYER_RPC_ID, rpcMessage);\n          changed = true;\n        }\n      }\n    }\n    for (let renderLayer of visibleLayers.keys()) {\n      if (!newVisibleLayers.has(renderLayer)) {\n        visibleLayers.delete(renderLayer);\n        const disposers = this.visibleLayerDisposers.get(renderLayer)!;\n        this.visibleLayerDisposers.delete(renderLayer);\n        invokeDisposers(disposers);\n        rpcMessage['layerId'] = renderLayer.rpcId;\n        rpc.invoke(SLICEVIEW_REMOVE_VISIBLE_LAYER_RPC_ID, rpcMessage);\n        renderLayer.dispose();\n        changed = true;\n      }\n    }\n    newVisibleLayers.clear();\n    if (changed) {\n      this.visibleSourcesStale = true;\n    }\n    // Unconditionally call viewChanged, because layers may have been reordered even if the set of\n    // sources is the same.\n    this.viewChanged.dispatch();\n    return changed;\n  }\n\n  onViewportChanged() {\n    var {width, height, viewportToDevice, dataToViewport, dataToDevice} = this;\n    // FIXME: Make this adjustable.\n    const sliceThickness = 10;\n    mat4.ortho(\n        viewportToDevice, -width / 2, width / 2, height / 2, -height / 2, -sliceThickness,\n        sliceThickness);\n    mat4.multiply(dataToDevice, viewportToDevice, dataToViewport);\n\n    this.visibleChunksStale = true;\n    this.viewChanged.dispatch();\n  }\n  setViewportSizeDebounced = this.registerCancellable(\n      debounce((width: number, height: number) => this.setViewportSize(width, height), 0));\n  setViewportSize(width: number, height: number) {\n    this.setViewportSizeDebounced.cancel();\n    if (super.setViewportSize(width, height)) {\n      this.rpc!.invoke(\n          SLICEVIEW_UPDATE_VIEW_RPC_ID, {id: this.rpcId, width: width, height: height});\n      // this.chunkManager.scheduleUpdateChunkPriorities();\n      return true;\n    }\n    return false;\n  }\n\n  onViewportToDataMatrixChanged() {\n    let {viewportToData, dataToViewport} = this;\n    mat4.invert(dataToViewport, viewportToData);\n    rectifyTransformMatrixIfAxisAligned(dataToViewport);\n    this.rpc!.invoke(\n        SLICEVIEW_UPDATE_VIEW_RPC_ID, {id: this.rpcId, viewportToData: viewportToData});\n  }\n\n  onHasValidViewport() {\n    this.updateVisibleLayers();\n  }\n\n  updateRendering() {\n    this.setViewportSizeDebounced.flush();\n    if (!this.renderingStale || !this.hasValidViewport || this.width === 0 || this.height === 0) {\n      return;\n    }\n    this.renderingStale = false;\n    this.maybeUpdateVisibleChunks();\n\n    let {gl, offscreenFramebuffer, width, height} = this;\n\n    offscreenFramebuffer.bind(width!, height!);\n    gl.disable(gl.SCISSOR_TEST);\n\n    // we have viewportToData\n    // we need: matrix that maps input x to the output x axis, scaled by\n\n    gl.clearStencil(0);\n    gl.clearColor(0, 0, 0, 0);\n    gl.colorMask(true, true, true, true);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    gl.enable(gl.STENCIL_TEST);\n    gl.disable(gl.DEPTH_TEST);\n    gl.stencilOpSeparate(\n        /*face=*/ gl.FRONT_AND_BACK, /*sfail=*/ gl.KEEP, /*dpfail=*/ gl.KEEP,\n        /*dppass=*/ gl.REPLACE);\n\n    let renderLayerNum = 0;\n    for (let renderLayer of this.visibleLayerList) {\n      gl.clear(gl.STENCIL_BUFFER_BIT);\n      gl.stencilFuncSeparate(\n          /*face=*/ gl.FRONT_AND_BACK,\n          /*func=*/ gl.GREATER,\n          /*ref=*/ 1,\n          /*mask=*/ 1);\n\n      renderLayer.setGLBlendMode(gl, renderLayerNum);\n      renderLayer.draw(this);\n      ++renderLayerNum;\n    }\n    gl.disable(gl.BLEND);\n    gl.disable(gl.STENCIL_TEST);\n    offscreenFramebuffer.unbind();\n  }\n\n  maybeUpdateVisibleChunks() {\n    this.updateVisibleLayers.flush();\n    if (!this.visibleChunksStale && !this.visibleSourcesStale) {\n      return false;\n    }\n    this.visibleChunksStale = false;\n    this.updateVisibleChunks();\n    return true;\n  }\n  updateVisibleChunks() {\n    let allVisibleChunks = this.visibleChunks;\n\n    function getLayoutObject(chunkLayout: ChunkLayout) {\n      let visibleChunks = allVisibleChunks.get(chunkLayout);\n      if (visibleChunks === undefined) {\n        visibleChunks = [];\n        allVisibleChunks.set(chunkLayout, visibleChunks);\n      } else {\n        visibleChunks.length = 0;\n      }\n      return visibleChunks;\n    }\n    let numVisibleChunks = 0;\n    function addChunk(\n        _chunkLayout: ChunkLayout, visibleChunks: string[], positionInChunks: vec3,\n        fullyVisibleSources: SliceViewChunkSource[]) {\n      let key = vec3Key(positionInChunks);\n      visibleChunks[visibleChunks.length] = key;\n      numVisibleChunks += fullyVisibleSources.length;\n    }\n    this.computeVisibleChunks(getLayoutObject, addChunk);\n    this.numVisibleChunks = numVisibleChunks;\n  }\n\n  disposed() {\n    for (const [renderLayer, disposers] of this.visibleLayerDisposers) {\n      invokeDisposers(disposers);\n      renderLayer.dispose();\n    }\n    this.visibleLayerDisposers.clear();\n    this.visibleLayers.clear();\n    this.visibleLayerList.length = 0;\n  }\n}\n\nexport interface SliceViewChunkSourceOptions {\n  spec: SliceViewChunkSpecification;\n}\n\nexport abstract class SliceViewChunkSource extends ChunkSource implements\n    SliceViewChunkSourceInterface {\n  chunks: Map<string, SliceViewChunk>;\n\n  spec: SliceViewChunkSpecification;\n\n  constructor(chunkManager: ChunkManager, options: SliceViewChunkSourceOptions) {\n    super(chunkManager, options);\n    this.spec = options.spec;\n  }\n\n  static encodeOptions(options: SliceViewChunkSourceOptions) {\n    const encoding = super.encodeOptions(options);\n    encoding.spec = options.spec.toObject();\n    return encoding;\n  }\n\n  initializeCounterpart(rpc: RPC, options: any) {\n    options['spec'] = this.spec.toObject();\n    super.initializeCounterpart(rpc, options);\n  }\n}\n\nexport interface SliceViewChunkSource {\n  // TODO(jbms): Move this declaration to the class definition above and declare abstract once\n  // TypeScript supports mixins with abstact classes.\n  getChunk(x: any): any;\n}\n\nexport class SliceViewChunk extends Chunk {\n  chunkGridPosition: vec3;\n  source: SliceViewChunkSource;\n\n  constructor(source: SliceViewChunkSource, x: any) {\n    super(source);\n    this.chunkGridPosition = x['chunkGridPosition'];\n    this.state = ChunkState.SYSTEM_MEMORY;\n  }\n}\n\n/**\n * Helper for rendering a SliceView that has been pre-rendered to a texture.\n */\nexport class SliceViewRenderHelper extends RefCounted {\n  private copyVertexPositionsBuffer = getSquareCornersBuffer(this.gl);\n  private shader: ShaderProgram;\n\n  private textureCoordinateAdjustment = new Float32Array(4);\n\n  constructor(public gl: GL, emitter: ShaderModule) {\n    super();\n    let builder = new ShaderBuilder(gl);\n    builder.addVarying('vec2', 'vTexCoord');\n    builder.addUniform('sampler2D', 'uSampler');\n    builder.addInitializer(shader => {\n      gl.uniform1i(shader.uniform('uSampler'), 0);\n    });\n    builder.addUniform('vec4', 'uColorFactor');\n    builder.addUniform('vec4', 'uBackgroundColor');\n    builder.addUniform('mat4', 'uProjectionMatrix');\n    builder.addUniform('vec4', 'uTextureCoordinateAdjustment');\n    builder.require(emitter);\n    builder.setFragmentMain(`\nvec4 sampledColor = texture(uSampler, vTexCoord);\nif (sampledColor.a == 0.0) {\n  sampledColor = uBackgroundColor;\n}\nemit(sampledColor * uColorFactor, 0u);\n`);\n    builder.addAttribute('vec4', 'aVertexPosition');\n    builder.setVertexMain(`\nvTexCoord = uTextureCoordinateAdjustment.xy + 0.5 * (aVertexPosition.xy + 1.0) * uTextureCoordinateAdjustment.zw;\ngl_Position = uProjectionMatrix * aVertexPosition;\n`);\n    this.shader = this.registerDisposer(builder.build());\n  }\n\n  draw(\n      texture: WebGLTexture|null, projectionMatrix: mat4, colorFactor: vec4, backgroundColor: vec4,\n      xStart: number, yStart: number, xEnd: number, yEnd: number) {\n    let {gl, shader, textureCoordinateAdjustment} = this;\n    textureCoordinateAdjustment[0] = xStart;\n    textureCoordinateAdjustment[1] = yStart;\n    textureCoordinateAdjustment[2] = xEnd - xStart;\n    textureCoordinateAdjustment[3] = yEnd - yStart;\n    shader.bind();\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.uniformMatrix4fv(shader.uniform('uProjectionMatrix'), false, projectionMatrix);\n    gl.uniform4fv(shader.uniform('uColorFactor'), colorFactor);\n    gl.uniform4fv(shader.uniform('uBackgroundColor'), backgroundColor);\n    gl.uniform4fv(shader.uniform('uTextureCoordinateAdjustment'), textureCoordinateAdjustment);\n\n    let aVertexPosition = shader.attribute('aVertexPosition');\n    this.copyVertexPositionsBuffer.bindToVertexAttrib(aVertexPosition, /*components=*/ 2);\n\n    gl.drawArrays(gl.TRIANGLE_FAN, 0, 4);\n\n    gl.disableVertexAttribArray(aVertexPosition);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n  }\n\n  static get(gl: GL, emitter: ShaderModule) {\n    return gl.memoize.get(\n        `sliceview/SliceViewRenderHelper:${getObjectId(emitter)}`,\n        () => new SliceViewRenderHelper(gl, emitter));\n  }\n}\n\nexport interface MultiscaleSliceViewChunkSource {\n  /**\n   * @return Chunk sources for each scale, ordered by increasing minVoxelSize.  For each scale,\n   * there may be alternative sources with different chunk layouts.\n   */\n  getSources: (options: SliceViewSourceOptions) => SliceViewChunkSource[][];\n\n  chunkManager: ChunkManager;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {WatchableValue, WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {stableStringify, verifyString} from 'neuroglancer/util/json';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderCompilationError, ShaderLinkError, ShaderModule, ShaderProgram} from 'neuroglancer/webgl/shader';\n\n/**\n * undefined means shader has not been compiled.  null means shader was compiled successfully.\n */\nexport type WatchableShaderError =\n    WatchableValue<ShaderCompilationError|ShaderLinkError|undefined|null>;\n\nexport function makeWatchableShaderError() {\n  return new WatchableValue<ShaderCompilationError|ShaderLinkError|undefined|null>(undefined);\n}\n\nexport type TrackableFragmentMain = TrackableValue<string>;\n\nexport function makeTrackableFragmentMain(value: string) {\n  return new TrackableValue<string>(value, verifyString);\n}\n\nexport class ShaderGetter extends RefCounted {\n  shaderUpdated = true;\n  shader: ShaderProgram|undefined = undefined;\n\n  invalidateShader() {\n    this.shaderUpdated = true;\n  }\n  constructor(\n      public gl: GL, private defineShader: (builder: ShaderBuilder) => void,\n      private getShaderKey: () => string,\n      public shaderError: WatchableShaderError = makeWatchableShaderError()) {\n    super();\n    shaderError.value = undefined;\n  }\n\n  get(): ShaderProgram|undefined {\n    if (!this.shaderUpdated) {\n      return this.shader;\n    }\n    this.shaderUpdated = false;\n    try {\n      let newShader = this.getShader();\n      this.disposeShader();\n      this.shader = newShader;\n      this.shaderError.value = null;\n    } catch (shaderError) {\n      this.shaderError.value = shaderError;\n    }\n    return this.shader;\n  }\n\n  private getShader() {\n    let key = this.getShaderKey();\n    return this.gl.memoize.get(key, () => this.buildShader());\n  }\n\n  private buildShader() {\n    let builder = new ShaderBuilder(this.gl);\n    this.defineShader(builder);\n    return builder.build();\n  }\n  disposed() {\n    super.disposed();\n    this.disposeShader();\n  }\n  private disposeShader() {\n    if (this.shader) {\n      this.shader.dispose();\n      this.shader = undefined;\n    }\n  }\n}\n\nexport function parameterizedEmitterDependentShaderGetter<T>(\n    refCounted: RefCounted, gl: GL, memoizeKey: any, fallbackParameters: WatchableValueInterface<T>,\n    parameters: WatchableValueInterface<T>, shaderError: WatchableShaderError,\n    defineShader: (builder: ShaderBuilder, parameters: T) =>\n        void): ((emitter: ShaderModule) => ShaderProgram | null) {\n  const shaders = new Map<ShaderModule, {generation: number, shader: ShaderProgram | null}>();\n  const stringMemoizeKey = stableStringify(memoizeKey);\n  function getNewShader(p: T, emitter: ShaderModule) {\n    const key = stringMemoizeKey + '\\0' + getObjectId(emitter) + '\\0' + JSON.stringify(parameters);\n    return gl.memoize.get(key, () => {\n      const builder = new ShaderBuilder(gl);\n      builder.require(emitter);\n      defineShader(builder, p);\n      return builder.build();\n    });\n  }\n  function getter(emitter: ShaderModule) {\n    let entry = shaders.get(emitter);\n    if (entry === undefined) {\n      entry = {generation: -1, shader: null};\n      shaders.set(emitter, entry);\n    }\n    const generation = parameters.changed.count;\n    if (generation === entry.generation) {\n      return entry.shader;\n    }\n    const oldShader = entry.shader;\n    entry.generation = generation;\n    let newShader: ShaderProgram|null = null;\n    try {\n      newShader = getNewShader(parameters.value, emitter);\n      fallbackParameters.value = parameters.value;\n      shaderError.value = null;\n    } catch (e) {\n      shaderError.value = e;\n      try {\n        newShader = getNewShader(fallbackParameters.value, emitter);\n      } catch {\n      }\n    }\n    if (oldShader !== null) {\n      oldShader.dispose();\n    }\n    entry.shader = newShader;\n    return newShader;\n  }\n  refCounted.registerDisposer(() => {\n    for (const entry of shaders.values()) {\n      const {shader} = entry;\n      if (shader !== null) {\n        shader.dispose();\n      }\n    }\n  });\n  return getter;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Convenience interface for creating TrackableValue instances designed to represent alpha\n * (opacity) values.\n */\n\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {verifyFloat01} from 'neuroglancer/util/json';\n\nexport type TrackableAlphaValue = TrackableValue<number>;\n\nexport function trackableAlphaValue(initialValue = 0.5) {\n  return new TrackableValue<number>(initialValue, verifyFloat01);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Defines a generic interface for a simple state tracking mechanism.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {verifyObject} from 'neuroglancer/util/json';\nimport {NullaryReadonlySignal, NullarySignal} from 'neuroglancer/util/signal';\n\nexport interface Trackable {\n  restoreState: (x: any) => void;\n  reset: () => void;\n  changed: NullaryReadonlySignal;\n  toJSON: () => any;\n}\n\nexport class CompoundTrackable extends RefCounted implements Trackable {\n  children = new Map<string, Trackable>();\n  changed = new NullarySignal();\n\n  add(key: string, value: Trackable): () => void {\n    const {children} = this;\n    if (children.has(key)) {\n      throw new Error(`Key ${JSON.stringify(key)} already registered.`);\n    }\n    this.children.set(key, value);\n    value.changed.add(this.changed.dispatch);\n    this.changed.dispatch();\n    return () => {\n      this.remove(key);\n    };\n  }\n\n  remove(key: string): void {\n    const {children} = this;\n    if (children.has(key)) {\n      throw new Error(`Key ${JSON.stringify(key)} not registered.`);\n    }\n    const value = children.get(key)!;\n    this.children.delete(key);\n    value.changed.remove(this.changed.dispatch);\n    this.changed.dispatch();\n  }\n\n  disposed() {\n    const {changed} = this;\n    for (let value of this.children.values()) {\n      value.changed.remove(changed.dispatch);\n    }\n    this.children = <any>undefined;\n    super.disposed();\n  }\n\n  toJSON() {\n    const result = this.baseJSON();\n    for (let [key, value] of this.children) {\n      result[key] = value.toJSON();\n    }\n    return result;\n  }\n\n  baseJSON() {\n    return <{[key: string]: any}>{};\n  }\n\n  reset() {\n    for (let value of this.children.values()) {\n      value.reset();\n    }\n  }\n\n  restoreState(x: any) {\n    verifyObject(x);\n    for (let [key, value] of this.children) {\n      try {\n        if (x.hasOwnProperty(key)) {\n          const subValue = x[key];\n          if (subValue === undefined) {\n            continue;\n          }\n          value.restoreState(subValue);\n        }\n      } catch (restoreError) {\n        throw new Error(`Error restoring property ${JSON.stringify(key)}: ${restoreError.message}`);\n      }\n    }\n  }\n}\n\nexport class PersistentCompoundTrackable extends CompoundTrackable {\n  lastState: {[key: string]: any} = {};\n\n  restoreState(x: any) {\n    verifyObject(x);\n    this.lastState = x;\n    super.restoreState(x);\n  }\n\n  reset () {\n    this.lastState = {};\n    super.reset();\n  }\n\n  baseJSON() {\n    const result = Object.assign(super.baseJSON(), this.lastState);\n    for (const key of this.children.keys()) {\n      delete result[key];\n    }\n    return result;\n  }\n\n  toJSON() {\n    const result = super.toJSON();\n    this.lastState = result;\n    return result;\n  }\n  add(key: string, value: Trackable) {\n    const result = super.add(key, value);\n    const existingValue = this.lastState[key];\n    if (existingValue !== undefined) {\n      value.reset();\n      value.restoreState(existingValue);\n    }\n    return result;\n  }\n}\n\n/**\n * Cache used by getCachedJson.\n */\nconst jsonCache = new WeakMap<Trackable, {value: any, generation: number}>();\n\n/**\n * Returns a JSON representation of a Trackable object.\n *\n * Recursively caches the result, such that it is only necessary to traverse the changed portions of\n * the object.\n *\n * The returned value must not be modified.\n */\nexport function getCachedJson(root: Trackable): {value: any, generation: number} {\n  let cacheState = jsonCache.get(root);\n  const generation = root.changed.count;\n  if (cacheState !== undefined) {\n    if (cacheState.generation === generation) {\n      return cacheState;\n    }\n  }\n  let value: any;\n  if (root instanceof CompoundTrackable) {\n    value = root.baseJSON();\n    for (let [k, v] of root.children) {\n      value[k] = getCachedJson(v).value;\n    }\n  } else {\n    value = root.toJSON();\n  }\n  if (cacheState === undefined) {\n    cacheState = {generation, value};\n    jsonCache.set(root, cacheState);\n  } else {\n    cacheState.generation = generation;\n    cacheState.value = value;\n  }\n  return cacheState;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AutomaticallyFocusedElement} from 'neuroglancer/util/automatic_focus';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {EventActionMap, KeyboardEventBinder} from 'neuroglancer/util/keyboard_bindings';\n\nexport const overlayKeyboardHandlerPriority = 100;\n\nrequire('./overlay.css');\n\nexport let overlaysOpen = 0;\n\nexport const defaultEventMap = EventActionMap.fromObject({\n  'escape': {action: 'close'},\n});\n\nexport class Overlay extends RefCounted {\n  container: HTMLDivElement;\n  content: HTMLDivElement;\n  keyMap = new EventActionMap();\n  constructor() {\n    super();\n    this.keyMap.addParent(defaultEventMap, Number.NEGATIVE_INFINITY);\n    ++overlaysOpen;\n    let container = this.container = document.createElement('div');\n    container.className = 'overlay';\n    let content = this.content = document.createElement('div');\n    this.registerDisposer(new AutomaticallyFocusedElement(content));\n    content.className = 'overlay-content';\n    container.appendChild(content);\n    document.body.appendChild(container);\n    this.registerDisposer(new KeyboardEventBinder(this.container, this.keyMap));\n    this.registerEventListener(container, 'action:close', () => {\n      this.dispose();\n    });\n    content.focus();\n  }\n\n  disposed() {\n    --overlaysOpen;\n    document.body.removeChild(this.container);\n    super.disposed();\n  }\n}\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// This is CodeMirror (https://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.CodeMirror = factory());\n}(this, (function () { 'use strict';\n\n  // Kludges for bugs and behavior differences that can't be feature\n  // detected are enabled based on userAgent etc sniffing.\n  var userAgent = navigator.userAgent;\n  var platform = navigator.platform;\n\n  var gecko = /gecko\\/\\d/i.test(userAgent);\n  var ie_upto10 = /MSIE \\d/.test(userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\n  var edge = /Edge\\/(\\d+)/.exec(userAgent);\n  var ie = ie_upto10 || ie_11up || edge;\n  var ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\n  var webkit = !edge && /WebKit\\//.test(userAgent);\n  var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\n  var chrome = !edge && /Chrome\\//.test(userAgent);\n  var presto = /Opera\\//.test(userAgent);\n  var safari = /Apple Computer/.test(navigator.vendor);\n  var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\n  var phantom = /PhantomJS/.test(userAgent);\n\n  var ios = !edge && /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent);\n  var android = /Android/.test(userAgent);\n  // This is woefully incomplete. Suggestions for alternative methods welcome.\n  var mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\n  var mac = ios || /Mac/.test(platform);\n  var chromeOS = /\\bCrOS\\b/.test(userAgent);\n  var windows = /win/i.test(platform);\n\n  var presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\n  if (presto_version) { presto_version = Number(presto_version[1]); }\n  if (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n  // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\n  var flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\n  var captureRightClick = gecko || (ie && ie_version >= 9);\n\n  function classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\n\n  var rmClass = function(node, cls) {\n    var current = node.className;\n    var match = classTest(cls).exec(current);\n    if (match) {\n      var after = current.slice(match.index + match[0].length);\n      node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n    }\n  };\n\n  function removeChildren(e) {\n    for (var count = e.childNodes.length; count > 0; --count)\n      { e.removeChild(e.firstChild); }\n    return e\n  }\n\n  function removeChildrenAndAdd(parent, e) {\n    return removeChildren(parent).appendChild(e)\n  }\n\n  function elt(tag, content, className, style) {\n    var e = document.createElement(tag);\n    if (className) { e.className = className; }\n    if (style) { e.style.cssText = style; }\n    if (typeof content == \"string\") { e.appendChild(document.createTextNode(content)); }\n    else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]); } }\n    return e\n  }\n  // wrapper for elt, which removes the elt from the accessibility tree\n  function eltP(tag, content, className, style) {\n    var e = elt(tag, content, className, style);\n    e.setAttribute(\"role\", \"presentation\");\n    return e\n  }\n\n  var range;\n  if (document.createRange) { range = function(node, start, end, endNode) {\n    var r = document.createRange();\n    r.setEnd(endNode || node, end);\n    r.setStart(node, start);\n    return r\n  }; }\n  else { range = function(node, start, end) {\n    var r = document.body.createTextRange();\n    try { r.moveToElementText(node.parentNode); }\n    catch(e) { return r }\n    r.collapse(true);\n    r.moveEnd(\"character\", end);\n    r.moveStart(\"character\", start);\n    return r\n  }; }\n\n  function contains(parent, child) {\n    if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n      { child = child.parentNode; }\n    if (parent.contains)\n      { return parent.contains(child) }\n    do {\n      if (child.nodeType == 11) { child = child.host; }\n      if (child == parent) { return true }\n    } while (child = child.parentNode)\n  }\n\n  function activeElt() {\n    // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n    // IE < 10 will throw when accessed while the page is loading or in an iframe.\n    // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n    var activeElement;\n    try {\n      activeElement = document.activeElement;\n    } catch(e) {\n      activeElement = document.body || null;\n    }\n    while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\n      { activeElement = activeElement.shadowRoot.activeElement; }\n    return activeElement\n  }\n\n  function addClass(node, cls) {\n    var current = node.className;\n    if (!classTest(cls).test(current)) { node.className += (current ? \" \" : \"\") + cls; }\n  }\n  function joinClasses(a, b) {\n    var as = a.split(\" \");\n    for (var i = 0; i < as.length; i++)\n      { if (as[i] && !classTest(as[i]).test(b)) { b += \" \" + as[i]; } }\n    return b\n  }\n\n  var selectInput = function(node) { node.select(); };\n  if (ios) // Mobile Safari apparently has a bug where select() is broken.\n    { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; }; }\n  else if (ie) // Suppress mysterious IE10 errors\n    { selectInput = function(node) { try { node.select(); } catch(_e) {} }; }\n\n  function bind(f) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    return function(){return f.apply(null, args)}\n  }\n\n  function copyObj(obj, target, overwrite) {\n    if (!target) { target = {}; }\n    for (var prop in obj)\n      { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n        { target[prop] = obj[prop]; } }\n    return target\n  }\n\n  // Counts the column offset in a string, taking tabs into account.\n  // Used mostly to find indentation.\n  function countColumn(string, end, tabSize, startIndex, startValue) {\n    if (end == null) {\n      end = string.search(/[^\\s\\u00a0]/);\n      if (end == -1) { end = string.length; }\n    }\n    for (var i = startIndex || 0, n = startValue || 0;;) {\n      var nextTab = string.indexOf(\"\\t\", i);\n      if (nextTab < 0 || nextTab >= end)\n        { return n + (end - i) }\n      n += nextTab - i;\n      n += tabSize - (n % tabSize);\n      i = nextTab + 1;\n    }\n  }\n\n  var Delayed = function() {this.id = null;};\n  Delayed.prototype.set = function (ms, f) {\n    clearTimeout(this.id);\n    this.id = setTimeout(f, ms);\n  };\n\n  function indexOf(array, elt) {\n    for (var i = 0; i < array.length; ++i)\n      { if (array[i] == elt) { return i } }\n    return -1\n  }\n\n  // Number of pixels added to scroller and sizer to hide scrollbar\n  var scrollerGap = 30;\n\n  // Returned or thrown by various protocols to signal 'I'm not\n  // handling this'.\n  var Pass = {toString: function(){return \"CodeMirror.Pass\"}};\n\n  // Reused option objects for setSelection & friends\n  var sel_dontScroll = {scroll: false}, sel_mouse = {origin: \"*mouse\"}, sel_move = {origin: \"+move\"};\n\n  // The inverse of countColumn -- find the offset that corresponds to\n  // a particular column.\n  function findColumn(string, goal, tabSize) {\n    for (var pos = 0, col = 0;;) {\n      var nextTab = string.indexOf(\"\\t\", pos);\n      if (nextTab == -1) { nextTab = string.length; }\n      var skipped = nextTab - pos;\n      if (nextTab == string.length || col + skipped >= goal)\n        { return pos + Math.min(skipped, goal - col) }\n      col += nextTab - pos;\n      col += tabSize - (col % tabSize);\n      pos = nextTab + 1;\n      if (col >= goal) { return pos }\n    }\n  }\n\n  var spaceStrs = [\"\"];\n  function spaceStr(n) {\n    while (spaceStrs.length <= n)\n      { spaceStrs.push(lst(spaceStrs) + \" \"); }\n    return spaceStrs[n]\n  }\n\n  function lst(arr) { return arr[arr.length-1] }\n\n  function map(array, f) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i); }\n    return out\n  }\n\n  function insertSorted(array, value, score) {\n    var pos = 0, priority = score(value);\n    while (pos < array.length && score(array[pos]) <= priority) { pos++; }\n    array.splice(pos, 0, value);\n  }\n\n  function nothing() {}\n\n  function createObj(base, props) {\n    var inst;\n    if (Object.create) {\n      inst = Object.create(base);\n    } else {\n      nothing.prototype = base;\n      inst = new nothing();\n    }\n    if (props) { copyObj(props, inst); }\n    return inst\n  }\n\n  var nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\n  function isWordCharBasic(ch) {\n    return /\\w/.test(ch) || ch > \"\\x80\" &&\n      (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\n  }\n  function isWordChar(ch, helper) {\n    if (!helper) { return isWordCharBasic(ch) }\n    if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) { return true }\n    return helper.test(ch)\n  }\n\n  function isEmpty(obj) {\n    for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\n    return true\n  }\n\n  // Extending unicode characters. A series of a non-extending char +\n  // any number of extending chars is treated as a single unit as far\n  // as editing and measuring is concerned. This is not fully correct,\n  // since some scripts/fonts/browsers also treat other configurations\n  // of code points as a group.\n  var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\n  function isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\n\n  // Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\n  function skipExtendingChars(str, pos, dir) {\n    while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir; }\n    return pos\n  }\n\n  // Returns the value from the range [`from`; `to`] that satisfies\n  // `pred` and is closest to `from`. Assumes that at least `to`\n  // satisfies `pred`. Supports `from` being greater than `to`.\n  function findFirst(pred, from, to) {\n    // At any point we are certain `to` satisfies `pred`, don't know\n    // whether `from` does.\n    var dir = from > to ? -1 : 1;\n    for (;;) {\n      if (from == to) { return from }\n      var midF = (from + to) / 2, mid = dir < 0 ? Math.ceil(midF) : Math.floor(midF);\n      if (mid == from) { return pred(mid) ? from : to }\n      if (pred(mid)) { to = mid; }\n      else { from = mid + dir; }\n    }\n  }\n\n  // The display handles the DOM integration, both for input reading\n  // and content drawing. It holds references to DOM nodes and\n  // display-related state.\n\n  function Display(place, doc, input) {\n    var d = this;\n    this.input = input;\n\n    // Covers bottom-right square when both scrollbars are present.\n    d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n    d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Covers bottom of gutter when coverGutterNextToScrollbar is on\n    // and h scrollbar is present.\n    d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n    d.gutterFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Will contain the actual code, positioned to cover the viewport.\n    d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\");\n    // Elements are added to these to represent selection and cursors.\n    d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n    d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n    // A visibility: hidden element used to find the size of things.\n    d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n    // When lines outside of the viewport are measured, they are drawn in this.\n    d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n    // Wraps everything that needs to exist inside the vertically-padded coordinate system\n    d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                      null, \"position: relative; outline: none\");\n    var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\");\n    // Moved around its parent to cover visible view.\n    d.mover = elt(\"div\", [lines], null, \"position: relative\");\n    // Set to the height of the document, allowing scrolling.\n    d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n    d.sizerWidth = null;\n    // Behavior of elts with overflow: auto and padding is\n    // inconsistent across browsers. This is used to ensure the\n    // scrollable area is big enough.\n    d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\");\n    // Will contain the gutters, if any.\n    d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n    d.lineGutter = null;\n    // Actual scrollable element.\n    d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n    d.scroller.setAttribute(\"tabIndex\", \"-1\");\n    // The element in which the editor lives.\n    d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n\n    // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n    if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n    if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true; }\n\n    if (place) {\n      if (place.appendChild) { place.appendChild(d.wrapper); }\n      else { place(d.wrapper); }\n    }\n\n    // Current rendered range (may be bigger than the view window).\n    d.viewFrom = d.viewTo = doc.first;\n    d.reportedViewFrom = d.reportedViewTo = doc.first;\n    // Information about the rendered lines.\n    d.view = [];\n    d.renderedView = null;\n    // Holds info about a single rendered line when it was rendered\n    // for measurement, while not in view.\n    d.externalMeasured = null;\n    // Empty space (in pixels) above the view\n    d.viewOffset = 0;\n    d.lastWrapHeight = d.lastWrapWidth = 0;\n    d.updateLineNumbers = null;\n\n    d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n    d.scrollbarsClipped = false;\n\n    // Used to only resize the line number gutter when necessary (when\n    // the amount of lines crosses a boundary that makes its width change)\n    d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n    // Set to true when a non-horizontal-scrolling line widget is\n    // added. As an optimization, line widget aligning is skipped when\n    // this is false.\n    d.alignWidgets = false;\n\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n    // Tracks the maximum line length so that the horizontal scrollbar\n    // can be kept static when scrolling.\n    d.maxLine = null;\n    d.maxLineLength = 0;\n    d.maxLineChanged = false;\n\n    // Used for measuring wheel scrolling granularity\n    d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n    // True when shift is held down.\n    d.shift = false;\n\n    // Used to track whether anything happened since the context menu\n    // was opened.\n    d.selForContextMenu = null;\n\n    d.activeTouch = null;\n\n    input.init(d);\n  }\n\n  // Find the line object corresponding to the given line number.\n  function getLine(doc, n) {\n    n -= doc.first;\n    if (n < 0 || n >= doc.size) { throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\") }\n    var chunk = doc;\n    while (!chunk.lines) {\n      for (var i = 0;; ++i) {\n        var child = chunk.children[i], sz = child.chunkSize();\n        if (n < sz) { chunk = child; break }\n        n -= sz;\n      }\n    }\n    return chunk.lines[n]\n  }\n\n  // Get the part of a document between two positions, as an array of\n  // strings.\n  function getBetween(doc, start, end) {\n    var out = [], n = start.line;\n    doc.iter(start.line, end.line + 1, function (line) {\n      var text = line.text;\n      if (n == end.line) { text = text.slice(0, end.ch); }\n      if (n == start.line) { text = text.slice(start.ch); }\n      out.push(text);\n      ++n;\n    });\n    return out\n  }\n  // Get the lines between from and to, as array of strings.\n  function getLines(doc, from, to) {\n    var out = [];\n    doc.iter(from, to, function (line) { out.push(line.text); }); // iter aborts when callback returns truthy value\n    return out\n  }\n\n  // Update the height of a line, propagating the height change\n  // upwards to parent nodes.\n  function updateLineHeight(line, height) {\n    var diff = height - line.height;\n    if (diff) { for (var n = line; n; n = n.parent) { n.height += diff; } }\n  }\n\n  // Given a line object, find its line number by walking up through\n  // its parent links.\n  function lineNo(line) {\n    if (line.parent == null) { return null }\n    var cur = line.parent, no = indexOf(cur.lines, line);\n    for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n      for (var i = 0;; ++i) {\n        if (chunk.children[i] == cur) { break }\n        no += chunk.children[i].chunkSize();\n      }\n    }\n    return no + cur.first\n  }\n\n  // Find the line at the given vertical position, using the height\n  // information in the document tree.\n  function lineAtHeight(chunk, h) {\n    var n = chunk.first;\n    outer: do {\n      for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n        var child = chunk.children[i$1], ch = child.height;\n        if (h < ch) { chunk = child; continue outer }\n        h -= ch;\n        n += child.chunkSize();\n      }\n      return n\n    } while (!chunk.lines)\n    var i = 0;\n    for (; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i], lh = line.height;\n      if (h < lh) { break }\n      h -= lh;\n    }\n    return n + i\n  }\n\n  function isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\n\n  function lineNumberFor(options, i) {\n    return String(options.lineNumberFormatter(i + options.firstLineNumber))\n  }\n\n  // A Pos instance represents a position within the text.\n  function Pos(line, ch, sticky) {\n    if ( sticky === void 0 ) sticky = null;\n\n    if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\n    this.line = line;\n    this.ch = ch;\n    this.sticky = sticky;\n  }\n\n  // Compare two positions, return 0 if they are the same, a negative\n  // number when a is less, and a positive number otherwise.\n  function cmp(a, b) { return a.line - b.line || a.ch - b.ch }\n\n  function equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\n\n  function copyPos(x) {return Pos(x.line, x.ch)}\n  function maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\n  function minPos(a, b) { return cmp(a, b) < 0 ? a : b }\n\n  // Most of the external API clips given positions to make sure they\n  // actually exist within the document.\n  function clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\n  function clipPos(doc, pos) {\n    if (pos.line < doc.first) { return Pos(doc.first, 0) }\n    var last = doc.first + doc.size - 1;\n    if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\n    return clipToLen(pos, getLine(doc, pos.line).text.length)\n  }\n  function clipToLen(pos, linelen) {\n    var ch = pos.ch;\n    if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\n    else if (ch < 0) { return Pos(pos.line, 0) }\n    else { return pos }\n  }\n  function clipPosArray(doc, array) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]); }\n    return out\n  }\n\n  // Optimize some code when these features are not used.\n  var sawReadOnlySpans = false, sawCollapsedSpans = false;\n\n  function seeReadOnlySpans() {\n    sawReadOnlySpans = true;\n  }\n\n  function seeCollapsedSpans() {\n    sawCollapsedSpans = true;\n  }\n\n  // TEXTMARKER SPANS\n\n  function MarkedSpan(marker, from, to) {\n    this.marker = marker;\n    this.from = from; this.to = to;\n  }\n\n  // Search an array of spans for a span matching the given marker.\n  function getMarkedSpanFor(spans, marker) {\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.marker == marker) { return span }\n    } }\n  }\n  // Remove a span from an array, returning undefined if no spans are\n  // left (we don't store arrays for lines without spans).\n  function removeMarkedSpan(spans, span) {\n    var r;\n    for (var i = 0; i < spans.length; ++i)\n      { if (spans[i] != span) { (r || (r = [])).push(spans[i]); } }\n    return r\n  }\n  // Add a span to a line.\n  function addMarkedSpan(line, span) {\n    line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n    span.marker.attachLine(line);\n  }\n\n  // Used for the algorithm that adjusts markers for a change in the\n  // document. These functions cut an array of spans at a given\n  // character position, returning an array of remaining chunks (or\n  // undefined if nothing remains).\n  function markedSpansBefore(old, startCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n      if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n        var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n      }\n    } }\n    return nw\n  }\n  function markedSpansAfter(old, endCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n      if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n        var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                              span.to == null ? null : span.to - endCh));\n      }\n    } }\n    return nw\n  }\n\n  // Given a change object, compute the new set of marker spans that\n  // cover the line in which the change took place. Removes spans\n  // entirely within the change, reconnects spans belonging to the\n  // same marker that appear on both sides of the change, and cuts off\n  // spans partially within the change. Returns an array of span\n  // arrays with one element for each line in (after) the change.\n  function stretchSpansOverChange(doc, change) {\n    if (change.full) { return null }\n    var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n    var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n    if (!oldFirst && !oldLast) { return null }\n\n    var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n    // Get the spans that 'stick out' on both sides\n    var first = markedSpansBefore(oldFirst, startCh, isInsert);\n    var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n    // Next, merge those two ends\n    var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n    if (first) {\n      // Fix up .to properties of first\n      for (var i = 0; i < first.length; ++i) {\n        var span = first[i];\n        if (span.to == null) {\n          var found = getMarkedSpanFor(last, span.marker);\n          if (!found) { span.to = startCh; }\n          else if (sameLine) { span.to = found.to == null ? null : found.to + offset; }\n        }\n      }\n    }\n    if (last) {\n      // Fix up .from in last (or move them into first in case of sameLine)\n      for (var i$1 = 0; i$1 < last.length; ++i$1) {\n        var span$1 = last[i$1];\n        if (span$1.to != null) { span$1.to += offset; }\n        if (span$1.from == null) {\n          var found$1 = getMarkedSpanFor(first, span$1.marker);\n          if (!found$1) {\n            span$1.from = offset;\n            if (sameLine) { (first || (first = [])).push(span$1); }\n          }\n        } else {\n          span$1.from += offset;\n          if (sameLine) { (first || (first = [])).push(span$1); }\n        }\n      }\n    }\n    // Make sure we didn't create any zero-length spans\n    if (first) { first = clearEmptySpans(first); }\n    if (last && last != first) { last = clearEmptySpans(last); }\n\n    var newMarkers = [first];\n    if (!sameLine) {\n      // Fill gap with whole-line-spans\n      var gap = change.text.length - 2, gapMarkers;\n      if (gap > 0 && first)\n        { for (var i$2 = 0; i$2 < first.length; ++i$2)\n          { if (first[i$2].to == null)\n            { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)); } } }\n      for (var i$3 = 0; i$3 < gap; ++i$3)\n        { newMarkers.push(gapMarkers); }\n      newMarkers.push(last);\n    }\n    return newMarkers\n  }\n\n  // Remove spans that are empty and don't have a clearWhenEmpty\n  // option of false.\n  function clearEmptySpans(spans) {\n    for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n        { spans.splice(i--, 1); }\n    }\n    if (!spans.length) { return null }\n    return spans\n  }\n\n  // Used to 'clip' out readOnly ranges when making a change.\n  function removeReadOnlyRanges(doc, from, to) {\n    var markers = null;\n    doc.iter(from.line, to.line + 1, function (line) {\n      if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n        var mark = line.markedSpans[i].marker;\n        if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n          { (markers || (markers = [])).push(mark); }\n      } }\n    });\n    if (!markers) { return null }\n    var parts = [{from: from, to: to}];\n    for (var i = 0; i < markers.length; ++i) {\n      var mk = markers[i], m = mk.find(0);\n      for (var j = 0; j < parts.length; ++j) {\n        var p = parts[j];\n        if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\n        var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n        if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n          { newParts.push({from: p.from, to: m.from}); }\n        if (dto > 0 || !mk.inclusiveRight && !dto)\n          { newParts.push({from: m.to, to: p.to}); }\n        parts.splice.apply(parts, newParts);\n        j += newParts.length - 3;\n      }\n    }\n    return parts\n  }\n\n  // Connect or disconnect spans from a line.\n  function detachMarkedSpans(line) {\n    var spans = line.markedSpans;\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.detachLine(line); }\n    line.markedSpans = null;\n  }\n  function attachMarkedSpans(line, spans) {\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.attachLine(line); }\n    line.markedSpans = spans;\n  }\n\n  // Helpers used when computing which overlapping collapsed span\n  // counts as the larger one.\n  function extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\n  function extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\n\n  // Returns a number indicating which of two overlapping collapsed\n  // spans is larger (and thus includes the other). Falls back to\n  // comparing ids when the spans cover exactly the same range.\n  function compareCollapsedMarkers(a, b) {\n    var lenDiff = a.lines.length - b.lines.length;\n    if (lenDiff != 0) { return lenDiff }\n    var aPos = a.find(), bPos = b.find();\n    var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n    if (fromCmp) { return -fromCmp }\n    var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n    if (toCmp) { return toCmp }\n    return b.id - a.id\n  }\n\n  // Find out whether a line ends or starts in a collapsed span. If\n  // so, return the marker for that span.\n  function collapsedSpanAtSide(line, start) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n        { found = sp.marker; }\n    } }\n    return found\n  }\n  function collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\n  function collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\n\n  function collapsedSpanAround(line, ch) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (sp.marker.collapsed && (sp.from == null || sp.from < ch) && (sp.to == null || sp.to > ch) &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0)) { found = sp.marker; }\n    } }\n    return found\n  }\n\n  // Test whether there exists a collapsed span that partially\n  // overlaps (covers the start or end, but not both) of a new span.\n  // Such overlap is not allowed.\n  function conflictingCollapsedRange(doc, lineNo$$1, from, to, marker) {\n    var line = getLine(doc, lineNo$$1);\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      var found = sp.marker.find(0);\n      var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n      var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n      if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\n      if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\n          fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\n        { return true }\n    } }\n  }\n\n  // A visual line is a line as drawn on the screen. Folding, for\n  // example, can cause multiple logical lines to appear on the same\n  // visual line. This finds the start of the visual line that the\n  // given line is part of (usually that is the line itself).\n  function visualLine(line) {\n    var merged;\n    while (merged = collapsedSpanAtStart(line))\n      { line = merged.find(-1, true).line; }\n    return line\n  }\n\n  function visualLineEnd(line) {\n    var merged;\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return line\n  }\n\n  // Returns an array of logical lines that continue the visual line\n  // started by the argument, or undefined if there are no such lines.\n  function visualLineContinued(line) {\n    var merged, lines;\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line\n      ;(lines || (lines = [])).push(line);\n    }\n    return lines\n  }\n\n  // Get the line number of the start of the visual line that the\n  // given line number is part of.\n  function visualLineNo(doc, lineN) {\n    var line = getLine(doc, lineN), vis = visualLine(line);\n    if (line == vis) { return lineN }\n    return lineNo(vis)\n  }\n\n  // Get the line number of the start of the next visual line after\n  // the given line.\n  function visualLineEndNo(doc, lineN) {\n    if (lineN > doc.lastLine()) { return lineN }\n    var line = getLine(doc, lineN), merged;\n    if (!lineIsHidden(doc, line)) { return lineN }\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return lineNo(line) + 1\n  }\n\n  // Compute whether a line is hidden. Lines count as hidden when they\n  // are part of a visual line that starts with another line, or when\n  // they are entirely covered by collapsed, non-widget span.\n  function lineIsHidden(doc, line) {\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      if (sp.from == null) { return true }\n      if (sp.marker.widgetNode) { continue }\n      if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n        { return true }\n    } }\n  }\n  function lineIsHiddenInner(doc, line, span) {\n    if (span.to == null) {\n      var end = span.marker.find(1, true);\n      return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\n    }\n    if (span.marker.inclusiveRight && span.to == line.text.length)\n      { return true }\n    for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\n      sp = line.markedSpans[i];\n      if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n          (sp.to == null || sp.to != span.from) &&\n          (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n          lineIsHiddenInner(doc, line, sp)) { return true }\n    }\n  }\n\n  // Find the height above the given line.\n  function heightAtLine(lineObj) {\n    lineObj = visualLine(lineObj);\n\n    var h = 0, chunk = lineObj.parent;\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i];\n      if (line == lineObj) { break }\n      else { h += line.height; }\n    }\n    for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n      for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n        var cur = p.children[i$1];\n        if (cur == chunk) { break }\n        else { h += cur.height; }\n      }\n    }\n    return h\n  }\n\n  // Compute the character length of a line, taking into account\n  // collapsed ranges (see markText) that might hide parts, and join\n  // other lines onto it.\n  function lineLength(line) {\n    if (line.height == 0) { return 0 }\n    var len = line.text.length, merged, cur = line;\n    while (merged = collapsedSpanAtStart(cur)) {\n      var found = merged.find(0, true);\n      cur = found.from.line;\n      len += found.from.ch - found.to.ch;\n    }\n    cur = line;\n    while (merged = collapsedSpanAtEnd(cur)) {\n      var found$1 = merged.find(0, true);\n      len -= cur.text.length - found$1.from.ch;\n      cur = found$1.to.line;\n      len += cur.text.length - found$1.to.ch;\n    }\n    return len\n  }\n\n  // Find the longest line in the document.\n  function findMaxLine(cm) {\n    var d = cm.display, doc = cm.doc;\n    d.maxLine = getLine(doc, doc.first);\n    d.maxLineLength = lineLength(d.maxLine);\n    d.maxLineChanged = true;\n    doc.iter(function (line) {\n      var len = lineLength(line);\n      if (len > d.maxLineLength) {\n        d.maxLineLength = len;\n        d.maxLine = line;\n      }\n    });\n  }\n\n  // BIDI HELPERS\n\n  function iterateBidiSections(order, from, to, f) {\n    if (!order) { return f(from, to, \"ltr\", 0) }\n    var found = false;\n    for (var i = 0; i < order.length; ++i) {\n      var part = order[i];\n      if (part.from < to && part.to > from || from == to && part.to == from) {\n        f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\", i);\n        found = true;\n      }\n    }\n    if (!found) { f(from, to, \"ltr\"); }\n  }\n\n  var bidiOther = null;\n  function getBidiPartAt(order, ch, sticky) {\n    var found;\n    bidiOther = null;\n    for (var i = 0; i < order.length; ++i) {\n      var cur = order[i];\n      if (cur.from < ch && cur.to > ch) { return i }\n      if (cur.to == ch) {\n        if (cur.from != cur.to && sticky == \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n      if (cur.from == ch) {\n        if (cur.from != cur.to && sticky != \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n    }\n    return found != null ? found : bidiOther\n  }\n\n  // Bidirectional ordering algorithm\n  // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n  // that this (partially) implements.\n\n  // One-char codes used for character types:\n  // L (L):   Left-to-Right\n  // R (R):   Right-to-Left\n  // r (AL):  Right-to-Left Arabic\n  // 1 (EN):  European Number\n  // + (ES):  European Number Separator\n  // % (ET):  European Number Terminator\n  // n (AN):  Arabic Number\n  // , (CS):  Common Number Separator\n  // m (NSM): Non-Spacing Mark\n  // b (BN):  Boundary Neutral\n  // s (B):   Paragraph Separator\n  // t (S):   Segment Separator\n  // w (WS):  Whitespace\n  // N (ON):  Other Neutrals\n\n  // Returns null if characters are ordered as they appear\n  // (left-to-right), or an array of sections ({from, to, level}\n  // objects) in the order in which they occur visually.\n  var bidiOrdering = (function() {\n    // Character types for codepoints 0 to 0xff\n    var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n    // Character types for codepoints 0x600 to 0x6f9\n    var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n    function charType(code) {\n      if (code <= 0xf7) { return lowTypes.charAt(code) }\n      else if (0x590 <= code && code <= 0x5f4) { return \"R\" }\n      else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\n      else if (0x6ee <= code && code <= 0x8ac) { return \"r\" }\n      else if (0x2000 <= code && code <= 0x200b) { return \"w\" }\n      else if (code == 0x200c) { return \"b\" }\n      else { return \"L\" }\n    }\n\n    var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n    var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n\n    function BidiSpan(level, from, to) {\n      this.level = level;\n      this.from = from; this.to = to;\n    }\n\n    return function(str, direction) {\n      var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n      if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) { return false }\n      var len = str.length, types = [];\n      for (var i = 0; i < len; ++i)\n        { types.push(charType(str.charCodeAt(i))); }\n\n      // W1. Examine each non-spacing mark (NSM) in the level run, and\n      // change the type of the NSM to the type of the previous\n      // character. If the NSM is at the start of the level run, it will\n      // get the type of sor.\n      for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n        var type = types[i$1];\n        if (type == \"m\") { types[i$1] = prev; }\n        else { prev = type; }\n      }\n\n      // W2. Search backwards from each instance of a European number\n      // until the first strong type (R, L, AL, or sor) is found. If an\n      // AL is found, change the type of the European number to Arabic\n      // number.\n      // W3. Change all ALs to R.\n      for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n        var type$1 = types[i$2];\n        if (type$1 == \"1\" && cur == \"r\") { types[i$2] = \"n\"; }\n        else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == \"r\") { types[i$2] = \"R\"; } }\n      }\n\n      // W4. A single European separator between two European numbers\n      // changes to a European number. A single common separator between\n      // two numbers of the same type changes to that type.\n      for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n        var type$2 = types[i$3];\n        if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3+1] == \"1\") { types[i$3] = \"1\"; }\n        else if (type$2 == \",\" && prev$1 == types[i$3+1] &&\n                 (prev$1 == \"1\" || prev$1 == \"n\")) { types[i$3] = prev$1; }\n        prev$1 = type$2;\n      }\n\n      // W5. A sequence of European terminators adjacent to European\n      // numbers changes to all European numbers.\n      // W6. Otherwise, separators and terminators change to Other\n      // Neutral.\n      for (var i$4 = 0; i$4 < len; ++i$4) {\n        var type$3 = types[i$4];\n        if (type$3 == \",\") { types[i$4] = \"N\"; }\n        else if (type$3 == \"%\") {\n          var end = (void 0);\n          for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n          var replace = (i$4 && types[i$4-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n          for (var j = i$4; j < end; ++j) { types[j] = replace; }\n          i$4 = end - 1;\n        }\n      }\n\n      // W7. Search backwards from each instance of a European number\n      // until the first strong type (R, L, or sor) is found. If an L is\n      // found, then change the type of the European number to L.\n      for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n        var type$4 = types[i$5];\n        if (cur$1 == \"L\" && type$4 == \"1\") { types[i$5] = \"L\"; }\n        else if (isStrong.test(type$4)) { cur$1 = type$4; }\n      }\n\n      // N1. A sequence of neutrals takes the direction of the\n      // surrounding strong text if the text on both sides has the same\n      // direction. European and Arabic numbers act as if they were R in\n      // terms of their influence on neutrals. Start-of-level-run (sor)\n      // and end-of-level-run (eor) are used at level run boundaries.\n      // N2. Any remaining neutrals take the embedding direction.\n      for (var i$6 = 0; i$6 < len; ++i$6) {\n        if (isNeutral.test(types[i$6])) {\n          var end$1 = (void 0);\n          for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n          var before = (i$6 ? types[i$6-1] : outerType) == \"L\";\n          var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n          var replace$1 = before == after ? (before ? \"L\" : \"R\") : outerType;\n          for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1; }\n          i$6 = end$1 - 1;\n        }\n      }\n\n      // Here we depart from the documented algorithm, in order to avoid\n      // building up an actual levels array. Since there are only three\n      // levels (0, 1, 2) in an implementation that doesn't take\n      // explicit embedding into account, we can build up the order on\n      // the fly, without following the level-based algorithm.\n      var order = [], m;\n      for (var i$7 = 0; i$7 < len;) {\n        if (countsAsLeft.test(types[i$7])) {\n          var start = i$7;\n          for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n          order.push(new BidiSpan(0, start, i$7));\n        } else {\n          var pos = i$7, at = order.length;\n          for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n          for (var j$2 = pos; j$2 < i$7;) {\n            if (countsAsNum.test(types[j$2])) {\n              if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)); }\n              var nstart = j$2;\n              for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n              order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n              pos = j$2;\n            } else { ++j$2; }\n          }\n          if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)); }\n        }\n      }\n      if (direction == \"ltr\") {\n        if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n          order[0].from = m[0].length;\n          order.unshift(new BidiSpan(0, 0, m[0].length));\n        }\n        if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n          lst(order).to -= m[0].length;\n          order.push(new BidiSpan(0, len - m[0].length, len));\n        }\n      }\n\n      return direction == \"rtl\" ? order.reverse() : order\n    }\n  })();\n\n  // Get the bidi ordering for the given line (and cache it). Returns\n  // false for lines that are fully left-to-right, and an array of\n  // BidiSpan objects otherwise.\n  function getOrder(line, direction) {\n    var order = line.order;\n    if (order == null) { order = line.order = bidiOrdering(line.text, direction); }\n    return order\n  }\n\n  // EVENT HANDLING\n\n  // Lightweight event framework. on/off also work on DOM nodes,\n  // registering native DOM handlers.\n\n  var noHandlers = [];\n\n  var on = function(emitter, type, f) {\n    if (emitter.addEventListener) {\n      emitter.addEventListener(type, f, false);\n    } else if (emitter.attachEvent) {\n      emitter.attachEvent(\"on\" + type, f);\n    } else {\n      var map$$1 = emitter._handlers || (emitter._handlers = {});\n      map$$1[type] = (map$$1[type] || noHandlers).concat(f);\n    }\n  };\n\n  function getHandlers(emitter, type) {\n    return emitter._handlers && emitter._handlers[type] || noHandlers\n  }\n\n  function off(emitter, type, f) {\n    if (emitter.removeEventListener) {\n      emitter.removeEventListener(type, f, false);\n    } else if (emitter.detachEvent) {\n      emitter.detachEvent(\"on\" + type, f);\n    } else {\n      var map$$1 = emitter._handlers, arr = map$$1 && map$$1[type];\n      if (arr) {\n        var index = indexOf(arr, f);\n        if (index > -1)\n          { map$$1[type] = arr.slice(0, index).concat(arr.slice(index + 1)); }\n      }\n    }\n  }\n\n  function signal(emitter, type /*, values...*/) {\n    var handlers = getHandlers(emitter, type);\n    if (!handlers.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2);\n    for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args); }\n  }\n\n  // The DOM events that CodeMirror handles can be overridden by\n  // registering a (non-DOM) handler on the editor for the event name,\n  // and preventDefault-ing the event in that handler.\n  function signalDOMEvent(cm, e, override) {\n    if (typeof e == \"string\")\n      { e = {type: e, preventDefault: function() { this.defaultPrevented = true; }}; }\n    signal(cm, override || e.type, cm, e);\n    return e_defaultPrevented(e) || e.codemirrorIgnore\n  }\n\n  function signalCursorActivity(cm) {\n    var arr = cm._handlers && cm._handlers.cursorActivity;\n    if (!arr) { return }\n    var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n    for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\n      { set.push(arr[i]); } }\n  }\n\n  function hasHandler(emitter, type) {\n    return getHandlers(emitter, type).length > 0\n  }\n\n  // Add on and off methods to a constructor's prototype, to make\n  // registering events on such objects more convenient.\n  function eventMixin(ctor) {\n    ctor.prototype.on = function(type, f) {on(this, type, f);};\n    ctor.prototype.off = function(type, f) {off(this, type, f);};\n  }\n\n  // Due to the fact that we still support jurassic IE versions, some\n  // compatibility wrappers are needed.\n\n  function e_preventDefault(e) {\n    if (e.preventDefault) { e.preventDefault(); }\n    else { e.returnValue = false; }\n  }\n  function e_stopPropagation(e) {\n    if (e.stopPropagation) { e.stopPropagation(); }\n    else { e.cancelBubble = true; }\n  }\n  function e_defaultPrevented(e) {\n    return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\n  }\n  function e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\n\n  function e_target(e) {return e.target || e.srcElement}\n  function e_button(e) {\n    var b = e.which;\n    if (b == null) {\n      if (e.button & 1) { b = 1; }\n      else if (e.button & 2) { b = 3; }\n      else if (e.button & 4) { b = 2; }\n    }\n    if (mac && e.ctrlKey && b == 1) { b = 3; }\n    return b\n  }\n\n  // Detect drag-and-drop\n  var dragAndDrop = function() {\n    // There is *some* kind of drag-and-drop support in IE6-8, but I\n    // couldn't get it to work yet.\n    if (ie && ie_version < 9) { return false }\n    var div = elt('div');\n    return \"draggable\" in div || \"dragDrop\" in div\n  }();\n\n  var zwspSupported;\n  function zeroWidthElement(measure) {\n    if (zwspSupported == null) {\n      var test = elt(\"span\", \"\\u200b\");\n      removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n      if (measure.firstChild.offsetHeight != 0)\n        { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8); }\n    }\n    var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\n      elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n    node.setAttribute(\"cm-text\", \"\");\n    return node\n  }\n\n  // Feature-detect IE's crummy client rect reporting for bidi text\n  var badBidiRects;\n  function hasBadBidiRects(measure) {\n    if (badBidiRects != null) { return badBidiRects }\n    var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n    var r0 = range(txt, 0, 1).getBoundingClientRect();\n    var r1 = range(txt, 1, 2).getBoundingClientRect();\n    removeChildren(measure);\n    if (!r0 || r0.left == r0.right) { return false } // Safari returns null in some cases (#2780)\n    return badBidiRects = (r1.right - r0.right < 3)\n  }\n\n  // See if \"\".split is the broken IE version, if so, provide an\n  // alternative way to split lines.\n  var splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n    var pos = 0, result = [], l = string.length;\n    while (pos <= l) {\n      var nl = string.indexOf(\"\\n\", pos);\n      if (nl == -1) { nl = string.length; }\n      var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n      var rt = line.indexOf(\"\\r\");\n      if (rt != -1) {\n        result.push(line.slice(0, rt));\n        pos += rt + 1;\n      } else {\n        result.push(line);\n        pos = nl + 1;\n      }\n    }\n    return result\n  } : function (string) { return string.split(/\\r\\n?|\\n/); };\n\n  var hasSelection = window.getSelection ? function (te) {\n    try { return te.selectionStart != te.selectionEnd }\n    catch(e) { return false }\n  } : function (te) {\n    var range$$1;\n    try {range$$1 = te.ownerDocument.selection.createRange();}\n    catch(e) {}\n    if (!range$$1 || range$$1.parentElement() != te) { return false }\n    return range$$1.compareEndPoints(\"StartToEnd\", range$$1) != 0\n  };\n\n  var hasCopyEvent = (function () {\n    var e = elt(\"div\");\n    if (\"oncopy\" in e) { return true }\n    e.setAttribute(\"oncopy\", \"return;\");\n    return typeof e.oncopy == \"function\"\n  })();\n\n  var badZoomedRects = null;\n  function hasBadZoomedRects(measure) {\n    if (badZoomedRects != null) { return badZoomedRects }\n    var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n    var normal = node.getBoundingClientRect();\n    var fromRange = range(node, 0, 1).getBoundingClientRect();\n    return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\n  }\n\n  // Known modes, by name and by MIME\n  var modes = {}, mimeModes = {};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  function defineMode(name, mode) {\n    if (arguments.length > 2)\n      { mode.dependencies = Array.prototype.slice.call(arguments, 2); }\n    modes[name] = mode;\n  }\n\n  function defineMIME(mime, spec) {\n    mimeModes[mime] = spec;\n  }\n\n  // Given a MIME type, a {name, ...options} config object, or a name\n  // string, return a mode config object.\n  function resolveMode(spec) {\n    if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n      spec = mimeModes[spec];\n    } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n      var found = mimeModes[spec.name];\n      if (typeof found == \"string\") { found = {name: found}; }\n      spec = createObj(found, spec);\n      spec.name = found.name;\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n      return resolveMode(\"application/xml\")\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n      return resolveMode(\"application/json\")\n    }\n    if (typeof spec == \"string\") { return {name: spec} }\n    else { return spec || {name: \"null\"} }\n  }\n\n  // Given a mode spec (anything that resolveMode accepts), find and\n  // initialize an actual mode object.\n  function getMode(options, spec) {\n    spec = resolveMode(spec);\n    var mfactory = modes[spec.name];\n    if (!mfactory) { return getMode(options, \"text/plain\") }\n    var modeObj = mfactory(options, spec);\n    if (modeExtensions.hasOwnProperty(spec.name)) {\n      var exts = modeExtensions[spec.name];\n      for (var prop in exts) {\n        if (!exts.hasOwnProperty(prop)) { continue }\n        if (modeObj.hasOwnProperty(prop)) { modeObj[\"_\" + prop] = modeObj[prop]; }\n        modeObj[prop] = exts[prop];\n      }\n    }\n    modeObj.name = spec.name;\n    if (spec.helperType) { modeObj.helperType = spec.helperType; }\n    if (spec.modeProps) { for (var prop$1 in spec.modeProps)\n      { modeObj[prop$1] = spec.modeProps[prop$1]; } }\n\n    return modeObj\n  }\n\n  // This can be used to attach properties to mode objects from\n  // outside the actual mode definition.\n  var modeExtensions = {};\n  function extendMode(mode, properties) {\n    var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n    copyObj(properties, exts);\n  }\n\n  function copyState(mode, state) {\n    if (state === true) { return state }\n    if (mode.copyState) { return mode.copyState(state) }\n    var nstate = {};\n    for (var n in state) {\n      var val = state[n];\n      if (val instanceof Array) { val = val.concat([]); }\n      nstate[n] = val;\n    }\n    return nstate\n  }\n\n  // Given a mode and a state (for that mode), find the inner mode and\n  // state at the position that the state refers to.\n  function innerMode(mode, state) {\n    var info;\n    while (mode.innerMode) {\n      info = mode.innerMode(state);\n      if (!info || info.mode == mode) { break }\n      state = info.state;\n      mode = info.mode;\n    }\n    return info || {mode: mode, state: state}\n  }\n\n  function startState(mode, a1, a2) {\n    return mode.startState ? mode.startState(a1, a2) : true\n  }\n\n  // STRING STREAM\n\n  // Fed to the mode parsers, provides helper functions to make\n  // parsers more succinct.\n\n  var StringStream = function(string, tabSize, lineOracle) {\n    this.pos = this.start = 0;\n    this.string = string;\n    this.tabSize = tabSize || 8;\n    this.lastColumnPos = this.lastColumnValue = 0;\n    this.lineStart = 0;\n    this.lineOracle = lineOracle;\n  };\n\n  StringStream.prototype.eol = function () {return this.pos >= this.string.length};\n  StringStream.prototype.sol = function () {return this.pos == this.lineStart};\n  StringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\n  StringStream.prototype.next = function () {\n    if (this.pos < this.string.length)\n      { return this.string.charAt(this.pos++) }\n  };\n  StringStream.prototype.eat = function (match) {\n    var ch = this.string.charAt(this.pos);\n    var ok;\n    if (typeof match == \"string\") { ok = ch == match; }\n    else { ok = ch && (match.test ? match.test(ch) : match(ch)); }\n    if (ok) {++this.pos; return ch}\n  };\n  StringStream.prototype.eatWhile = function (match) {\n    var start = this.pos;\n    while (this.eat(match)){}\n    return this.pos > start\n  };\n  StringStream.prototype.eatSpace = function () {\n      var this$1 = this;\n\n    var start = this.pos;\n    while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this$1.pos; }\n    return this.pos > start\n  };\n  StringStream.prototype.skipToEnd = function () {this.pos = this.string.length;};\n  StringStream.prototype.skipTo = function (ch) {\n    var found = this.string.indexOf(ch, this.pos);\n    if (found > -1) {this.pos = found; return true}\n  };\n  StringStream.prototype.backUp = function (n) {this.pos -= n;};\n  StringStream.prototype.column = function () {\n    if (this.lastColumnPos < this.start) {\n      this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n      this.lastColumnPos = this.start;\n    }\n    return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.indentation = function () {\n    return countColumn(this.string, null, this.tabSize) -\n      (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n    if (typeof pattern == \"string\") {\n      var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; };\n      var substr = this.string.substr(this.pos, pattern.length);\n      if (cased(substr) == cased(pattern)) {\n        if (consume !== false) { this.pos += pattern.length; }\n        return true\n      }\n    } else {\n      var match = this.string.slice(this.pos).match(pattern);\n      if (match && match.index > 0) { return null }\n      if (match && consume !== false) { this.pos += match[0].length; }\n      return match\n    }\n  };\n  StringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\n  StringStream.prototype.hideFirstChars = function (n, inner) {\n    this.lineStart += n;\n    try { return inner() }\n    finally { this.lineStart -= n; }\n  };\n  StringStream.prototype.lookAhead = function (n) {\n    var oracle = this.lineOracle;\n    return oracle && oracle.lookAhead(n)\n  };\n  StringStream.prototype.baseToken = function () {\n    var oracle = this.lineOracle;\n    return oracle && oracle.baseToken(this.pos)\n  };\n\n  var SavedContext = function(state, lookAhead) {\n    this.state = state;\n    this.lookAhead = lookAhead;\n  };\n\n  var Context = function(doc, state, line, lookAhead) {\n    this.state = state;\n    this.doc = doc;\n    this.line = line;\n    this.maxLookAhead = lookAhead || 0;\n    this.baseTokens = null;\n    this.baseTokenPos = 1;\n  };\n\n  Context.prototype.lookAhead = function (n) {\n    var line = this.doc.getLine(this.line + n);\n    if (line != null && n > this.maxLookAhead) { this.maxLookAhead = n; }\n    return line\n  };\n\n  Context.prototype.baseToken = function (n) {\n      var this$1 = this;\n\n    if (!this.baseTokens) { return null }\n    while (this.baseTokens[this.baseTokenPos] <= n)\n      { this$1.baseTokenPos += 2; }\n    var type = this.baseTokens[this.baseTokenPos + 1];\n    return {type: type && type.replace(/( |^)overlay .*/, \"\"),\n            size: this.baseTokens[this.baseTokenPos] - n}\n  };\n\n  Context.prototype.nextLine = function () {\n    this.line++;\n    if (this.maxLookAhead > 0) { this.maxLookAhead--; }\n  };\n\n  Context.fromSaved = function (doc, saved, line) {\n    if (saved instanceof SavedContext)\n      { return new Context(doc, copyState(doc.mode, saved.state), line, saved.lookAhead) }\n    else\n      { return new Context(doc, copyState(doc.mode, saved), line) }\n  };\n\n  Context.prototype.save = function (copy) {\n    var state = copy !== false ? copyState(this.doc.mode, this.state) : this.state;\n    return this.maxLookAhead > 0 ? new SavedContext(state, this.maxLookAhead) : state\n  };\n\n\n  // Compute a style array (an array starting with a mode generation\n  // -- for invalidation -- followed by pairs of end positions and\n  // style strings), which is used to highlight the tokens on the\n  // line.\n  function highlightLine(cm, line, context, forceToEnd) {\n    // A styles array always starts with a number identifying the\n    // mode/overlays that it is based on (for easy invalidation).\n    var st = [cm.state.modeGen], lineClasses = {};\n    // Compute the base array of styles\n    runMode(cm, line.text, cm.doc.mode, context, function (end, style) { return st.push(end, style); },\n            lineClasses, forceToEnd);\n    var state = context.state;\n\n    // Run overlays, adjust style array.\n    var loop = function ( o ) {\n      context.baseTokens = st;\n      var overlay = cm.state.overlays[o], i = 1, at = 0;\n      context.state = true;\n      runMode(cm, line.text, overlay.mode, context, function (end, style) {\n        var start = i;\n        // Ensure there's a token end at the current position, and that i points at it\n        while (at < end) {\n          var i_end = st[i];\n          if (i_end > end)\n            { st.splice(i, 1, end, st[i+1], i_end); }\n          i += 2;\n          at = Math.min(end, i_end);\n        }\n        if (!style) { return }\n        if (overlay.opaque) {\n          st.splice(start, i - start, end, \"overlay \" + style);\n          i = start + 2;\n        } else {\n          for (; start < i; start += 2) {\n            var cur = st[start+1];\n            st[start+1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n          }\n        }\n      }, lineClasses);\n      context.state = state;\n      context.baseTokens = null;\n      context.baseTokenPos = 1;\n    };\n\n    for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\n\n    return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\n  }\n\n  function getLineStyles(cm, line, updateFrontier) {\n    if (!line.styles || line.styles[0] != cm.state.modeGen) {\n      var context = getContextBefore(cm, lineNo(line));\n      var resetState = line.text.length > cm.options.maxHighlightLength && copyState(cm.doc.mode, context.state);\n      var result = highlightLine(cm, line, context);\n      if (resetState) { context.state = resetState; }\n      line.stateAfter = context.save(!resetState);\n      line.styles = result.styles;\n      if (result.classes) { line.styleClasses = result.classes; }\n      else if (line.styleClasses) { line.styleClasses = null; }\n      if (updateFrontier === cm.doc.highlightFrontier)\n        { cm.doc.modeFrontier = Math.max(cm.doc.modeFrontier, ++cm.doc.highlightFrontier); }\n    }\n    return line.styles\n  }\n\n  function getContextBefore(cm, n, precise) {\n    var doc = cm.doc, display = cm.display;\n    if (!doc.mode.startState) { return new Context(doc, true, n) }\n    var start = findStartLine(cm, n, precise);\n    var saved = start > doc.first && getLine(doc, start - 1).stateAfter;\n    var context = saved ? Context.fromSaved(doc, saved, start) : new Context(doc, startState(doc.mode), start);\n\n    doc.iter(start, n, function (line) {\n      processLine(cm, line.text, context);\n      var pos = context.line;\n      line.stateAfter = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo ? context.save() : null;\n      context.nextLine();\n    });\n    if (precise) { doc.modeFrontier = context.line; }\n    return context\n  }\n\n  // Lightweight form of highlight -- proceed over this line and\n  // update state, but don't save a style array. Used for lines that\n  // aren't currently visible.\n  function processLine(cm, text, context, startAt) {\n    var mode = cm.doc.mode;\n    var stream = new StringStream(text, cm.options.tabSize, context);\n    stream.start = stream.pos = startAt || 0;\n    if (text == \"\") { callBlankLine(mode, context.state); }\n    while (!stream.eol()) {\n      readToken(mode, stream, context.state);\n      stream.start = stream.pos;\n    }\n  }\n\n  function callBlankLine(mode, state) {\n    if (mode.blankLine) { return mode.blankLine(state) }\n    if (!mode.innerMode) { return }\n    var inner = innerMode(mode, state);\n    if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\n  }\n\n  function readToken(mode, stream, state, inner) {\n    for (var i = 0; i < 10; i++) {\n      if (inner) { inner[0] = innerMode(mode, state).mode; }\n      var style = mode.token(stream, state);\n      if (stream.pos > stream.start) { return style }\n    }\n    throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\")\n  }\n\n  var Token = function(stream, type, state) {\n    this.start = stream.start; this.end = stream.pos;\n    this.string = stream.current();\n    this.type = type || null;\n    this.state = state;\n  };\n\n  // Utility for getTokenAt and getLineTokens\n  function takeToken(cm, pos, precise, asArray) {\n    var doc = cm.doc, mode = doc.mode, style;\n    pos = clipPos(doc, pos);\n    var line = getLine(doc, pos.line), context = getContextBefore(cm, pos.line, precise);\n    var stream = new StringStream(line.text, cm.options.tabSize, context), tokens;\n    if (asArray) { tokens = []; }\n    while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n      stream.start = stream.pos;\n      style = readToken(mode, stream, context.state);\n      if (asArray) { tokens.push(new Token(stream, style, copyState(doc.mode, context.state))); }\n    }\n    return asArray ? tokens : new Token(stream, style, context.state)\n  }\n\n  function extractLineClasses(type, output) {\n    if (type) { for (;;) {\n      var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n      if (!lineClass) { break }\n      type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n      var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n      if (output[prop] == null)\n        { output[prop] = lineClass[2]; }\n      else if (!(new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\")).test(output[prop]))\n        { output[prop] += \" \" + lineClass[2]; }\n    } }\n    return type\n  }\n\n  // Run the given mode's parser over a line, calling f for each token.\n  function runMode(cm, text, mode, context, f, lineClasses, forceToEnd) {\n    var flattenSpans = mode.flattenSpans;\n    if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans; }\n    var curStart = 0, curStyle = null;\n    var stream = new StringStream(text, cm.options.tabSize, context), style;\n    var inner = cm.options.addModeClass && [null];\n    if (text == \"\") { extractLineClasses(callBlankLine(mode, context.state), lineClasses); }\n    while (!stream.eol()) {\n      if (stream.pos > cm.options.maxHighlightLength) {\n        flattenSpans = false;\n        if (forceToEnd) { processLine(cm, text, context, stream.pos); }\n        stream.pos = text.length;\n        style = null;\n      } else {\n        style = extractLineClasses(readToken(mode, stream, context.state, inner), lineClasses);\n      }\n      if (inner) {\n        var mName = inner[0].name;\n        if (mName) { style = \"m-\" + (style ? mName + \" \" + style : mName); }\n      }\n      if (!flattenSpans || curStyle != style) {\n        while (curStart < stream.start) {\n          curStart = Math.min(stream.start, curStart + 5000);\n          f(curStart, curStyle);\n        }\n        curStyle = style;\n      }\n      stream.start = stream.pos;\n    }\n    while (curStart < stream.pos) {\n      // Webkit seems to refuse to render text nodes longer than 57444\n      // characters, and returns inaccurate measurements in nodes\n      // starting around 5000 chars.\n      var pos = Math.min(stream.pos, curStart + 5000);\n      f(pos, curStyle);\n      curStart = pos;\n    }\n  }\n\n  // Finds the line to start with when starting a parse. Tries to\n  // find a line with a stateAfter, so that it can start with a\n  // valid state. If that fails, it returns the line with the\n  // smallest indentation, which tends to need the least context to\n  // parse correctly.\n  function findStartLine(cm, n, precise) {\n    var minindent, minline, doc = cm.doc;\n    var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n    for (var search = n; search > lim; --search) {\n      if (search <= doc.first) { return doc.first }\n      var line = getLine(doc, search - 1), after = line.stateAfter;\n      if (after && (!precise || search + (after instanceof SavedContext ? after.lookAhead : 0) <= doc.modeFrontier))\n        { return search }\n      var indented = countColumn(line.text, null, cm.options.tabSize);\n      if (minline == null || minindent > indented) {\n        minline = search - 1;\n        minindent = indented;\n      }\n    }\n    return minline\n  }\n\n  function retreatFrontier(doc, n) {\n    doc.modeFrontier = Math.min(doc.modeFrontier, n);\n    if (doc.highlightFrontier < n - 10) { return }\n    var start = doc.first;\n    for (var line = n - 1; line > start; line--) {\n      var saved = getLine(doc, line).stateAfter;\n      // change is on 3\n      // state on line 1 looked ahead 2 -- so saw 3\n      // test 1 + 2 < 3 should cover this\n      if (saved && (!(saved instanceof SavedContext) || line + saved.lookAhead < n)) {\n        start = line + 1;\n        break\n      }\n    }\n    doc.highlightFrontier = Math.min(doc.highlightFrontier, start);\n  }\n\n  // LINE DATA STRUCTURE\n\n  // Line objects. These hold state related to a line, including\n  // highlighting info (the styles array).\n  var Line = function(text, markedSpans, estimateHeight) {\n    this.text = text;\n    attachMarkedSpans(this, markedSpans);\n    this.height = estimateHeight ? estimateHeight(this) : 1;\n  };\n\n  Line.prototype.lineNo = function () { return lineNo(this) };\n  eventMixin(Line);\n\n  // Change the content (text, markers) of a line. Automatically\n  // invalidates cached information and tries to re-estimate the\n  // line's height.\n  function updateLine(line, text, markedSpans, estimateHeight) {\n    line.text = text;\n    if (line.stateAfter) { line.stateAfter = null; }\n    if (line.styles) { line.styles = null; }\n    if (line.order != null) { line.order = null; }\n    detachMarkedSpans(line);\n    attachMarkedSpans(line, markedSpans);\n    var estHeight = estimateHeight ? estimateHeight(line) : 1;\n    if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n  }\n\n  // Detach a line from the document tree and its markers.\n  function cleanUpLine(line) {\n    line.parent = null;\n    detachMarkedSpans(line);\n  }\n\n  // Convert a style as returned by a mode (either null, or a string\n  // containing one or more styles) to a CSS style. This is cached,\n  // and also looks for line-wide styles.\n  var styleToClassCache = {}, styleToClassCacheWithMode = {};\n  function interpretTokenStyle(style, options) {\n    if (!style || /^\\s*$/.test(style)) { return null }\n    var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n    return cache[style] ||\n      (cache[style] = style.replace(/\\S+/g, \"cm-$&\"))\n  }\n\n  // Render the DOM representation of the text of a line. Also builds\n  // up a 'line map', which points at the DOM nodes that represent\n  // specific stretches of text, and is used by the measuring code.\n  // The returned object contains the DOM node, this map, and\n  // information about line-wide styles that were set by the mode.\n  function buildLineContent(cm, lineView) {\n    // The padding-right forces the element to have a 'border', which\n    // is needed on Webkit to be able to get line-level bounding\n    // rectangles for it (in measureChar).\n    var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n    var builder = {pre: eltP(\"pre\", [content], \"CodeMirror-line\"), content: content,\n                   col: 0, pos: 0, cm: cm,\n                   trailingSpace: false,\n                   splitSpaces: cm.getOption(\"lineWrapping\")};\n    lineView.measure = {};\n\n    // Iterate over the logical lines that make up this visual line.\n    for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n      var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0);\n      builder.pos = 0;\n      builder.addToken = buildToken;\n      // Optionally wire in some hacks into the token-rendering\n      // algorithm, to deal with browser quirks.\n      if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\n        { builder.addToken = buildTokenBadBidi(builder.addToken, order); }\n      builder.map = [];\n      var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n      insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n      if (line.styleClasses) {\n        if (line.styleClasses.bgClass)\n          { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\"); }\n        if (line.styleClasses.textClass)\n          { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\"); }\n      }\n\n      // Ensure at least a single node is present, for measuring.\n      if (builder.map.length == 0)\n        { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))); }\n\n      // Store the map and a cache object for the current logical line\n      if (i == 0) {\n        lineView.measure.map = builder.map;\n        lineView.measure.cache = {};\n      } else {\n  (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\n        ;(lineView.measure.caches || (lineView.measure.caches = [])).push({});\n      }\n    }\n\n    // See issue #2901\n    if (webkit) {\n      var last = builder.content.lastChild;\n      if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(\".cm-tab\")))\n        { builder.content.className = \"cm-tab-wrap-hack\"; }\n    }\n\n    signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n    if (builder.pre.className)\n      { builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\"); }\n\n    return builder\n  }\n\n  function defaultSpecialCharPlaceholder(ch) {\n    var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n    token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n    token.setAttribute(\"aria-label\", token.title);\n    return token\n  }\n\n  // Build up the DOM representation for a single token, and add it to\n  // the line map. Takes care to render special characters separately.\n  function buildToken(builder, text, style, startStyle, endStyle, css, attributes) {\n    if (!text) { return }\n    var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n    var special = builder.cm.state.specialChars, mustWrap = false;\n    var content;\n    if (!special.test(text)) {\n      builder.col += text.length;\n      content = document.createTextNode(displayText);\n      builder.map.push(builder.pos, builder.pos + text.length, content);\n      if (ie && ie_version < 9) { mustWrap = true; }\n      builder.pos += text.length;\n    } else {\n      content = document.createDocumentFragment();\n      var pos = 0;\n      while (true) {\n        special.lastIndex = pos;\n        var m = special.exec(text);\n        var skipped = m ? m.index - pos : text.length - pos;\n        if (skipped) {\n          var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt])); }\n          else { content.appendChild(txt); }\n          builder.map.push(builder.pos, builder.pos + skipped, txt);\n          builder.col += skipped;\n          builder.pos += skipped;\n        }\n        if (!m) { break }\n        pos += skipped + 1;\n        var txt$1 = (void 0);\n        if (m[0] == \"\\t\") {\n          var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n          txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n          txt$1.setAttribute(\"role\", \"presentation\");\n          txt$1.setAttribute(\"cm-text\", \"\\t\");\n          builder.col += tabWidth;\n        } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n          txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          builder.col += 1;\n        } else {\n          txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt$1])); }\n          else { content.appendChild(txt$1); }\n          builder.col += 1;\n        }\n        builder.map.push(builder.pos, builder.pos + 1, txt$1);\n        builder.pos++;\n      }\n    }\n    builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n    if (style || startStyle || endStyle || mustWrap || css) {\n      var fullStyle = style || \"\";\n      if (startStyle) { fullStyle += startStyle; }\n      if (endStyle) { fullStyle += endStyle; }\n      var token = elt(\"span\", [content], fullStyle, css);\n      if (attributes) {\n        for (var attr in attributes) { if (attributes.hasOwnProperty(attr) && attr != \"style\" && attr != \"class\")\n          { token.setAttribute(attr, attributes[attr]); } }\n      }\n      return builder.content.appendChild(token)\n    }\n    builder.content.appendChild(content);\n  }\n\n  // Change some spaces to NBSP to prevent the browser from collapsing\n  // trailing spaces at the end of a line when rendering text (issue #1362).\n  function splitSpaces(text, trailingBefore) {\n    if (text.length > 1 && !/  /.test(text)) { return text }\n    var spaceBefore = trailingBefore, result = \"\";\n    for (var i = 0; i < text.length; i++) {\n      var ch = text.charAt(i);\n      if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\n        { ch = \"\\u00a0\"; }\n      result += ch;\n      spaceBefore = ch == \" \";\n    }\n    return result\n  }\n\n  // Work around nonsense dimensions being reported for stretches of\n  // right-to-left text.\n  function buildTokenBadBidi(inner, order) {\n    return function (builder, text, style, startStyle, endStyle, css, attributes) {\n      style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n      var start = builder.pos, end = start + text.length;\n      for (;;) {\n        // Find the part that overlaps with the start of this text\n        var part = (void 0);\n        for (var i = 0; i < order.length; i++) {\n          part = order[i];\n          if (part.to > start && part.from <= start) { break }\n        }\n        if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, css, attributes) }\n        inner(builder, text.slice(0, part.to - start), style, startStyle, null, css, attributes);\n        startStyle = null;\n        text = text.slice(part.to - start);\n        start = part.to;\n      }\n    }\n  }\n\n  function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n    var widget = !ignoreWidget && marker.widgetNode;\n    if (widget) { builder.map.push(builder.pos, builder.pos + size, widget); }\n    if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n      if (!widget)\n        { widget = builder.content.appendChild(document.createElement(\"span\")); }\n      widget.setAttribute(\"cm-marker\", marker.id);\n    }\n    if (widget) {\n      builder.cm.display.input.setUneditable(widget);\n      builder.content.appendChild(widget);\n    }\n    builder.pos += size;\n    builder.trailingSpace = false;\n  }\n\n  // Outputs a number of spans to make up a line, taking highlighting\n  // and marked text into account.\n  function insertLineContent(line, builder, styles) {\n    var spans = line.markedSpans, allText = line.text, at = 0;\n    if (!spans) {\n      for (var i$1 = 1; i$1 < styles.length; i$1+=2)\n        { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)); }\n      return\n    }\n\n    var len = allText.length, pos = 0, i = 1, text = \"\", style, css;\n    var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, collapsed, attributes;\n    for (;;) {\n      if (nextChange == pos) { // Update current marker set\n        spanStyle = spanEndStyle = spanStartStyle = css = \"\";\n        attributes = null;\n        collapsed = null; nextChange = Infinity;\n        var foundBookmarks = [], endStyles = (void 0);\n        for (var j = 0; j < spans.length; ++j) {\n          var sp = spans[j], m = sp.marker;\n          if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n            foundBookmarks.push(m);\n          } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n            if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n              nextChange = sp.to;\n              spanEndStyle = \"\";\n            }\n            if (m.className) { spanStyle += \" \" + m.className; }\n            if (m.css) { css = (css ? css + \";\" : \"\") + m.css; }\n            if (m.startStyle && sp.from == pos) { spanStartStyle += \" \" + m.startStyle; }\n            if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to); }\n            // support for the old title property\n            // https://github.com/codemirror/CodeMirror/pull/5673\n            if (m.title) { (attributes || (attributes = {})).title = m.title; }\n            if (m.attributes) {\n              for (var attr in m.attributes)\n                { (attributes || (attributes = {}))[attr] = m.attributes[attr]; }\n            }\n            if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n              { collapsed = sp; }\n          } else if (sp.from > pos && nextChange > sp.from) {\n            nextChange = sp.from;\n          }\n        }\n        if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\n          { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += \" \" + endStyles[j$1]; } } }\n\n        if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\n          { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]); } }\n        if (collapsed && (collapsed.from || 0) == pos) {\n          buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                             collapsed.marker, collapsed.from == null);\n          if (collapsed.to == null) { return }\n          if (collapsed.to == pos) { collapsed = false; }\n        }\n      }\n      if (pos >= len) { break }\n\n      var upto = Math.min(len, nextChange);\n      while (true) {\n        if (text) {\n          var end = pos + text.length;\n          if (!collapsed) {\n            var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n            builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                             spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", css, attributes);\n          }\n          if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\n          pos = end;\n          spanStartStyle = \"\";\n        }\n        text = allText.slice(at, at = styles[i++]);\n        style = interpretTokenStyle(styles[i++], builder.cm.options);\n      }\n    }\n  }\n\n\n  // These objects are used to represent the visible (currently drawn)\n  // part of the document. A LineView may correspond to multiple\n  // logical lines, if those are connected by collapsed ranges.\n  function LineView(doc, line, lineN) {\n    // The starting line\n    this.line = line;\n    // Continuing lines, if any\n    this.rest = visualLineContinued(line);\n    // Number of logical lines in this visual line\n    this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n    this.node = this.text = null;\n    this.hidden = lineIsHidden(doc, line);\n  }\n\n  // Create a range of LineView objects for the given lines.\n  function buildViewArray(cm, from, to) {\n    var array = [], nextPos;\n    for (var pos = from; pos < to; pos = nextPos) {\n      var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n      nextPos = pos + view.size;\n      array.push(view);\n    }\n    return array\n  }\n\n  var operationGroup = null;\n\n  function pushOperation(op) {\n    if (operationGroup) {\n      operationGroup.ops.push(op);\n    } else {\n      op.ownsGroup = operationGroup = {\n        ops: [op],\n        delayedCallbacks: []\n      };\n    }\n  }\n\n  function fireCallbacksForOps(group) {\n    // Calls delayed callbacks and cursorActivity handlers until no\n    // new ones appear\n    var callbacks = group.delayedCallbacks, i = 0;\n    do {\n      for (; i < callbacks.length; i++)\n        { callbacks[i].call(null); }\n      for (var j = 0; j < group.ops.length; j++) {\n        var op = group.ops[j];\n        if (op.cursorActivityHandlers)\n          { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n            { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm); } }\n      }\n    } while (i < callbacks.length)\n  }\n\n  function finishOperation(op, endCb) {\n    var group = op.ownsGroup;\n    if (!group) { return }\n\n    try { fireCallbacksForOps(group); }\n    finally {\n      operationGroup = null;\n      endCb(group);\n    }\n  }\n\n  var orphanDelayedCallbacks = null;\n\n  // Often, we want to signal events at a point where we are in the\n  // middle of some work, but don't want the handler to start calling\n  // other methods on the editor, which might be in an inconsistent\n  // state or simply not expect any other events to happen.\n  // signalLater looks whether there are any handlers, and schedules\n  // them to be executed when the last operation ends, or, if no\n  // operation is active, when a timeout fires.\n  function signalLater(emitter, type /*, values...*/) {\n    var arr = getHandlers(emitter, type);\n    if (!arr.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2), list;\n    if (operationGroup) {\n      list = operationGroup.delayedCallbacks;\n    } else if (orphanDelayedCallbacks) {\n      list = orphanDelayedCallbacks;\n    } else {\n      list = orphanDelayedCallbacks = [];\n      setTimeout(fireOrphanDelayed, 0);\n    }\n    var loop = function ( i ) {\n      list.push(function () { return arr[i].apply(null, args); });\n    };\n\n    for (var i = 0; i < arr.length; ++i)\n      loop( i );\n  }\n\n  function fireOrphanDelayed() {\n    var delayed = orphanDelayedCallbacks;\n    orphanDelayedCallbacks = null;\n    for (var i = 0; i < delayed.length; ++i) { delayed[i](); }\n  }\n\n  // When an aspect of a line changes, a string is added to\n  // lineView.changes. This updates the relevant part of the line's\n  // DOM structure.\n  function updateLineForChanges(cm, lineView, lineN, dims) {\n    for (var j = 0; j < lineView.changes.length; j++) {\n      var type = lineView.changes[j];\n      if (type == \"text\") { updateLineText(cm, lineView); }\n      else if (type == \"gutter\") { updateLineGutter(cm, lineView, lineN, dims); }\n      else if (type == \"class\") { updateLineClasses(cm, lineView); }\n      else if (type == \"widget\") { updateLineWidgets(cm, lineView, dims); }\n    }\n    lineView.changes = null;\n  }\n\n  // Lines with gutter elements, widgets or a background class need to\n  // be wrapped, and have the extra elements added to the wrapper div\n  function ensureLineWrapped(lineView) {\n    if (lineView.node == lineView.text) {\n      lineView.node = elt(\"div\", null, null, \"position: relative\");\n      if (lineView.text.parentNode)\n        { lineView.text.parentNode.replaceChild(lineView.node, lineView.text); }\n      lineView.node.appendChild(lineView.text);\n      if (ie && ie_version < 8) { lineView.node.style.zIndex = 2; }\n    }\n    return lineView.node\n  }\n\n  function updateLineBackground(cm, lineView) {\n    var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n    if (cls) { cls += \" CodeMirror-linebackground\"; }\n    if (lineView.background) {\n      if (cls) { lineView.background.className = cls; }\n      else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n    } else if (cls) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n      cm.display.input.setUneditable(lineView.background);\n    }\n  }\n\n  // Wrapper around buildLineContent which will reuse the structure\n  // in display.externalMeasured when possible.\n  function getLineContent(cm, lineView) {\n    var ext = cm.display.externalMeasured;\n    if (ext && ext.line == lineView.line) {\n      cm.display.externalMeasured = null;\n      lineView.measure = ext.measure;\n      return ext.built\n    }\n    return buildLineContent(cm, lineView)\n  }\n\n  // Redraw the line's text. Interacts with the background and text\n  // classes because the mode may output tokens that influence these\n  // classes.\n  function updateLineText(cm, lineView) {\n    var cls = lineView.text.className;\n    var built = getLineContent(cm, lineView);\n    if (lineView.text == lineView.node) { lineView.node = built.pre; }\n    lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n    lineView.text = built.pre;\n    if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n      lineView.bgClass = built.bgClass;\n      lineView.textClass = built.textClass;\n      updateLineClasses(cm, lineView);\n    } else if (cls) {\n      lineView.text.className = cls;\n    }\n  }\n\n  function updateLineClasses(cm, lineView) {\n    updateLineBackground(cm, lineView);\n    if (lineView.line.wrapClass)\n      { ensureLineWrapped(lineView).className = lineView.line.wrapClass; }\n    else if (lineView.node != lineView.text)\n      { lineView.node.className = \"\"; }\n    var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n    lineView.text.className = textClass || \"\";\n  }\n\n  function updateLineGutter(cm, lineView, lineN, dims) {\n    if (lineView.gutter) {\n      lineView.node.removeChild(lineView.gutter);\n      lineView.gutter = null;\n    }\n    if (lineView.gutterBackground) {\n      lineView.node.removeChild(lineView.gutterBackground);\n      lineView.gutterBackground = null;\n    }\n    if (lineView.line.gutterClass) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\n                                      (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + (dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(lineView.gutterBackground);\n      wrap.insertBefore(lineView.gutterBackground, lineView.text);\n    }\n    var markers = lineView.line.gutterMarkers;\n    if (cm.options.lineNumbers || markers) {\n      var wrap$1 = ensureLineWrapped(lineView);\n      var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(gutterWrap);\n      wrap$1.insertBefore(gutterWrap, lineView.text);\n      if (lineView.line.gutterClass)\n        { gutterWrap.className += \" \" + lineView.line.gutterClass; }\n      if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n        { lineView.lineNumber = gutterWrap.appendChild(\n          elt(\"div\", lineNumberFor(cm.options, lineN),\n              \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n              (\"left: \" + (dims.gutterLeft[\"CodeMirror-linenumbers\"]) + \"px; width: \" + (cm.display.lineNumInnerWidth) + \"px\"))); }\n      if (markers) { for (var k = 0; k < cm.options.gutters.length; ++k) {\n        var id = cm.options.gutters[k], found = markers.hasOwnProperty(id) && markers[id];\n        if (found)\n          { gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\",\n                                     (\"left: \" + (dims.gutterLeft[id]) + \"px; width: \" + (dims.gutterWidth[id]) + \"px\"))); }\n      } }\n    }\n  }\n\n  function updateLineWidgets(cm, lineView, dims) {\n    if (lineView.alignable) { lineView.alignable = null; }\n    for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\n      next = node.nextSibling;\n      if (node.className == \"CodeMirror-linewidget\")\n        { lineView.node.removeChild(node); }\n    }\n    insertLineWidgets(cm, lineView, dims);\n  }\n\n  // Build a line's DOM representation from scratch\n  function buildLineElement(cm, lineView, lineN, dims) {\n    var built = getLineContent(cm, lineView);\n    lineView.text = lineView.node = built.pre;\n    if (built.bgClass) { lineView.bgClass = built.bgClass; }\n    if (built.textClass) { lineView.textClass = built.textClass; }\n\n    updateLineClasses(cm, lineView);\n    updateLineGutter(cm, lineView, lineN, dims);\n    insertLineWidgets(cm, lineView, dims);\n    return lineView.node\n  }\n\n  // A lineView may contain multiple logical lines (when merged by\n  // collapsed spans). The widgets for all of them need to be drawn.\n  function insertLineWidgets(cm, lineView, dims) {\n    insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n      { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false); } }\n  }\n\n  function insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n    if (!line.widgets) { return }\n    var wrap = ensureLineWrapped(lineView);\n    for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n      var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\");\n      if (!widget.handleMouseEvents) { node.setAttribute(\"cm-ignore-events\", \"true\"); }\n      positionLineWidget(widget, node, lineView, dims);\n      cm.display.input.setUneditable(node);\n      if (allowAbove && widget.above)\n        { wrap.insertBefore(node, lineView.gutter || lineView.text); }\n      else\n        { wrap.appendChild(node); }\n      signalLater(widget, \"redraw\");\n    }\n  }\n\n  function positionLineWidget(widget, node, lineView, dims) {\n    if (widget.noHScroll) {\n  (lineView.alignable || (lineView.alignable = [])).push(node);\n      var width = dims.wrapperWidth;\n      node.style.left = dims.fixedPos + \"px\";\n      if (!widget.coverGutter) {\n        width -= dims.gutterTotalWidth;\n        node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n      }\n      node.style.width = width + \"px\";\n    }\n    if (widget.coverGutter) {\n      node.style.zIndex = 5;\n      node.style.position = \"relative\";\n      if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + \"px\"; }\n    }\n  }\n\n  function widgetHeight(widget) {\n    if (widget.height != null) { return widget.height }\n    var cm = widget.doc.cm;\n    if (!cm) { return 0 }\n    if (!contains(document.body, widget.node)) {\n      var parentStyle = \"position: relative;\";\n      if (widget.coverGutter)\n        { parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\"; }\n      if (widget.noHScroll)\n        { parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\"; }\n      removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n    }\n    return widget.height = widget.node.parentNode.offsetHeight\n  }\n\n  // Return true when the given mouse event happened in a widget\n  function eventInWidget(display, e) {\n    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n      if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\n          (n.parentNode == display.sizer && n != display.mover))\n        { return true }\n    }\n  }\n\n  // POSITION MEASUREMENT\n\n  function paddingTop(display) {return display.lineSpace.offsetTop}\n  function paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\n  function paddingH(display) {\n    if (display.cachedPaddingH) { return display.cachedPaddingH }\n    var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\"));\n    var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n    var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n    if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data; }\n    return data\n  }\n\n  function scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\n  function displayWidth(cm) {\n    return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\n  }\n  function displayHeight(cm) {\n    return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\n  }\n\n  // Ensure the lineView.wrapping.heights array is populated. This is\n  // an array of bottom offsets for the lines that make up a drawn\n  // line. When lineWrapping is on, there might be more than one\n  // height.\n  function ensureLineHeights(cm, lineView, rect) {\n    var wrapping = cm.options.lineWrapping;\n    var curWidth = wrapping && displayWidth(cm);\n    if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n      var heights = lineView.measure.heights = [];\n      if (wrapping) {\n        lineView.measure.width = curWidth;\n        var rects = lineView.text.firstChild.getClientRects();\n        for (var i = 0; i < rects.length - 1; i++) {\n          var cur = rects[i], next = rects[i + 1];\n          if (Math.abs(cur.bottom - next.bottom) > 2)\n            { heights.push((cur.bottom + next.top) / 2 - rect.top); }\n        }\n      }\n      heights.push(rect.bottom - rect.top);\n    }\n  }\n\n  // Find a line map (mapping character offsets to text nodes) and a\n  // measurement cache for the given line number. (A line view might\n  // contain multiple lines when collapsed ranges are present.)\n  function mapFromLineView(lineView, line, lineN) {\n    if (lineView.line == line)\n      { return {map: lineView.measure.map, cache: lineView.measure.cache} }\n    for (var i = 0; i < lineView.rest.length; i++)\n      { if (lineView.rest[i] == line)\n        { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\n    for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\n      { if (lineNo(lineView.rest[i$1]) > lineN)\n        { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\n  }\n\n  // Render a line into the hidden node display.externalMeasured. Used\n  // when measurement is needed for a line that's not in the viewport.\n  function updateExternalMeasurement(cm, line) {\n    line = visualLine(line);\n    var lineN = lineNo(line);\n    var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n    view.lineN = lineN;\n    var built = view.built = buildLineContent(cm, view);\n    view.text = built.pre;\n    removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n    return view\n  }\n\n  // Get a {top, bottom, left, right} box (in line-local coordinates)\n  // for a given character.\n  function measureChar(cm, line, ch, bias) {\n    return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\n  }\n\n  // Find a line view that corresponds to the given line number.\n  function findViewForLine(cm, lineN) {\n    if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n      { return cm.display.view[findViewIndex(cm, lineN)] }\n    var ext = cm.display.externalMeasured;\n    if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n      { return ext }\n  }\n\n  // Measurement can be split in two steps, the set-up work that\n  // applies to the whole line, and the measurement of the actual\n  // character. Functions like coordsChar, that need to do a lot of\n  // measurements in a row, can thus ensure that the set-up work is\n  // only done once.\n  function prepareMeasureForLine(cm, line) {\n    var lineN = lineNo(line);\n    var view = findViewForLine(cm, lineN);\n    if (view && !view.text) {\n      view = null;\n    } else if (view && view.changes) {\n      updateLineForChanges(cm, view, lineN, getDimensions(cm));\n      cm.curOp.forceUpdate = true;\n    }\n    if (!view)\n      { view = updateExternalMeasurement(cm, line); }\n\n    var info = mapFromLineView(view, line, lineN);\n    return {\n      line: line, view: view, rect: null,\n      map: info.map, cache: info.cache, before: info.before,\n      hasHeights: false\n    }\n  }\n\n  // Given a prepared measurement object, measures the position of an\n  // actual character (or fetches it from the cache).\n  function measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n    if (prepared.before) { ch = -1; }\n    var key = ch + (bias || \"\"), found;\n    if (prepared.cache.hasOwnProperty(key)) {\n      found = prepared.cache[key];\n    } else {\n      if (!prepared.rect)\n        { prepared.rect = prepared.view.text.getBoundingClientRect(); }\n      if (!prepared.hasHeights) {\n        ensureLineHeights(cm, prepared.view, prepared.rect);\n        prepared.hasHeights = true;\n      }\n      found = measureCharInner(cm, prepared, ch, bias);\n      if (!found.bogus) { prepared.cache[key] = found; }\n    }\n    return {left: found.left, right: found.right,\n            top: varHeight ? found.rtop : found.top,\n            bottom: varHeight ? found.rbottom : found.bottom}\n  }\n\n  var nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\n  function nodeAndOffsetInLineMap(map$$1, ch, bias) {\n    var node, start, end, collapse, mStart, mEnd;\n    // First, search the line map for the text node corresponding to,\n    // or closest to, the target character.\n    for (var i = 0; i < map$$1.length; i += 3) {\n      mStart = map$$1[i];\n      mEnd = map$$1[i + 1];\n      if (ch < mStart) {\n        start = 0; end = 1;\n        collapse = \"left\";\n      } else if (ch < mEnd) {\n        start = ch - mStart;\n        end = start + 1;\n      } else if (i == map$$1.length - 3 || ch == mEnd && map$$1[i + 3] > ch) {\n        end = mEnd - mStart;\n        start = end - 1;\n        if (ch >= mEnd) { collapse = \"right\"; }\n      }\n      if (start != null) {\n        node = map$$1[i + 2];\n        if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n          { collapse = bias; }\n        if (bias == \"left\" && start == 0)\n          { while (i && map$$1[i - 2] == map$$1[i - 3] && map$$1[i - 1].insertLeft) {\n            node = map$$1[(i -= 3) + 2];\n            collapse = \"left\";\n          } }\n        if (bias == \"right\" && start == mEnd - mStart)\n          { while (i < map$$1.length - 3 && map$$1[i + 3] == map$$1[i + 4] && !map$$1[i + 5].insertLeft) {\n            node = map$$1[(i += 3) + 2];\n            collapse = \"right\";\n          } }\n        break\n      }\n    }\n    return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\n  }\n\n  function getUsefulRect(rects, bias) {\n    var rect = nullRect;\n    if (bias == \"left\") { for (var i = 0; i < rects.length; i++) {\n      if ((rect = rects[i]).left != rect.right) { break }\n    } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n      if ((rect = rects[i$1]).left != rect.right) { break }\n    } }\n    return rect\n  }\n\n  function measureCharInner(cm, prepared, ch, bias) {\n    var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n    var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\n\n    var rect;\n    if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n      for (var i$1 = 0; i$1 < 4; i$1++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n        while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start; }\n        while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end; }\n        if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\n          { rect = node.parentNode.getBoundingClientRect(); }\n        else\n          { rect = getUsefulRect(range(node, start, end).getClientRects(), bias); }\n        if (rect.left || rect.right || start == 0) { break }\n        end = start;\n        start = start - 1;\n        collapse = \"right\";\n      }\n      if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect); }\n    } else { // If it is a widget, simply get the box for the whole widget.\n      if (start > 0) { collapse = bias = \"right\"; }\n      var rects;\n      if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n        { rect = rects[bias == \"right\" ? rects.length - 1 : 0]; }\n      else\n        { rect = node.getBoundingClientRect(); }\n    }\n    if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n      var rSpan = node.parentNode.getClientRects()[0];\n      if (rSpan)\n        { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom}; }\n      else\n        { rect = nullRect; }\n    }\n\n    var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n    var mid = (rtop + rbot) / 2;\n    var heights = prepared.view.measure.heights;\n    var i = 0;\n    for (; i < heights.length - 1; i++)\n      { if (mid < heights[i]) { break } }\n    var top = i ? heights[i - 1] : 0, bot = heights[i];\n    var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                  right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                  top: top, bottom: bot};\n    if (!rect.left && !rect.right) { result.bogus = true; }\n    if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n    return result\n  }\n\n  // Work around problem with bounding client rects on ranges being\n  // returned incorrectly when zoomed on IE10 and below.\n  function maybeUpdateRectForZooming(measure, rect) {\n    if (!window.screen || screen.logicalXDPI == null ||\n        screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n      { return rect }\n    var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n    var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n    return {left: rect.left * scaleX, right: rect.right * scaleX,\n            top: rect.top * scaleY, bottom: rect.bottom * scaleY}\n  }\n\n  function clearLineMeasurementCacheFor(lineView) {\n    if (lineView.measure) {\n      lineView.measure.cache = {};\n      lineView.measure.heights = null;\n      if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n        { lineView.measure.caches[i] = {}; } }\n    }\n  }\n\n  function clearLineMeasurementCache(cm) {\n    cm.display.externalMeasure = null;\n    removeChildren(cm.display.lineMeasure);\n    for (var i = 0; i < cm.display.view.length; i++)\n      { clearLineMeasurementCacheFor(cm.display.view[i]); }\n  }\n\n  function clearCaches(cm) {\n    clearLineMeasurementCache(cm);\n    cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n    if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true; }\n    cm.display.lineNumChars = null;\n  }\n\n  function pageScrollX() {\n    // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n    // which causes page_Offset and bounding client rects to use\n    // different reference viewports and invalidate our calculations.\n    if (chrome && android) { return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft)) }\n    return window.pageXOffset || (document.documentElement || document.body).scrollLeft\n  }\n  function pageScrollY() {\n    if (chrome && android) { return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop)) }\n    return window.pageYOffset || (document.documentElement || document.body).scrollTop\n  }\n\n  function widgetTopHeight(lineObj) {\n    var height = 0;\n    if (lineObj.widgets) { for (var i = 0; i < lineObj.widgets.length; ++i) { if (lineObj.widgets[i].above)\n      { height += widgetHeight(lineObj.widgets[i]); } } }\n    return height\n  }\n\n  // Converts a {top, bottom, left, right} box from line-local\n  // coordinates into another coordinate system. Context may be one of\n  // \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n  // or \"page\".\n  function intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n    if (!includeWidgets) {\n      var height = widgetTopHeight(lineObj);\n      rect.top += height; rect.bottom += height;\n    }\n    if (context == \"line\") { return rect }\n    if (!context) { context = \"local\"; }\n    var yOff = heightAtLine(lineObj);\n    if (context == \"local\") { yOff += paddingTop(cm.display); }\n    else { yOff -= cm.display.viewOffset; }\n    if (context == \"page\" || context == \"window\") {\n      var lOff = cm.display.lineSpace.getBoundingClientRect();\n      yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n      var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n      rect.left += xOff; rect.right += xOff;\n    }\n    rect.top += yOff; rect.bottom += yOff;\n    return rect\n  }\n\n  // Coverts a box from \"div\" coords to another coordinate system.\n  // Context may be \"window\", \"page\", \"div\", or \"local\"./null.\n  function fromCoordSystem(cm, coords, context) {\n    if (context == \"div\") { return coords }\n    var left = coords.left, top = coords.top;\n    // First move into \"page\" coordinate system\n    if (context == \"page\") {\n      left -= pageScrollX();\n      top -= pageScrollY();\n    } else if (context == \"local\" || !context) {\n      var localBox = cm.display.sizer.getBoundingClientRect();\n      left += localBox.left;\n      top += localBox.top;\n    }\n\n    var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n    return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\n  }\n\n  function charCoords(cm, pos, context, lineObj, bias) {\n    if (!lineObj) { lineObj = getLine(cm.doc, pos.line); }\n    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\n  }\n\n  // Returns a box for a given cursor position, which may have an\n  // 'other' property containing the position of the secondary cursor\n  // on a bidi boundary.\n  // A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n  // and after `char - 1` in writing order of `char - 1`\n  // A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n  // and before `char` in writing order of `char`\n  // Examples (upper-case letters are RTL, lower-case are LTR):\n  //     Pos(0, 1, ...)\n  //     before   after\n  // ab     a|b     a|b\n  // aB     a|B     aB|\n  // Ab     |Ab     A|b\n  // AB     B|A     B|A\n  // Every position after the last character on a line is considered to stick\n  // to the last character on the line.\n  function cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n    lineObj = lineObj || getLine(cm.doc, pos.line);\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    function get(ch, right) {\n      var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n      if (right) { m.left = m.right; } else { m.right = m.left; }\n      return intoCoordSystem(cm, lineObj, m, context)\n    }\n    var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky;\n    if (ch >= lineObj.text.length) {\n      ch = lineObj.text.length;\n      sticky = \"before\";\n    } else if (ch <= 0) {\n      ch = 0;\n      sticky = \"after\";\n    }\n    if (!order) { return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\") }\n\n    function getBidi(ch, partPos, invert) {\n      var part = order[partPos], right = part.level == 1;\n      return get(invert ? ch - 1 : ch, right != invert)\n    }\n    var partPos = getBidiPartAt(order, ch, sticky);\n    var other = bidiOther;\n    var val = getBidi(ch, partPos, sticky == \"before\");\n    if (other != null) { val.other = getBidi(ch, other, sticky != \"before\"); }\n    return val\n  }\n\n  // Used to cheaply estimate the coordinates for a position. Used for\n  // intermediate scroll updates.\n  function estimateCoords(cm, pos) {\n    var left = 0;\n    pos = clipPos(cm.doc, pos);\n    if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch; }\n    var lineObj = getLine(cm.doc, pos.line);\n    var top = heightAtLine(lineObj) + paddingTop(cm.display);\n    return {left: left, right: left, top: top, bottom: top + lineObj.height}\n  }\n\n  // Positions returned by coordsChar contain some extra information.\n  // xRel is the relative x position of the input coordinates compared\n  // to the found position (so xRel > 0 means the coordinates are to\n  // the right of the character position, for example). When outside\n  // is true, that means the coordinates lie outside the line's\n  // vertical range.\n  function PosWithInfo(line, ch, sticky, outside, xRel) {\n    var pos = Pos(line, ch, sticky);\n    pos.xRel = xRel;\n    if (outside) { pos.outside = true; }\n    return pos\n  }\n\n  // Compute the character position closest to the given coordinates.\n  // Input must be lineSpace-local (\"div\" coordinate system).\n  function coordsChar(cm, x, y) {\n    var doc = cm.doc;\n    y += cm.display.viewOffset;\n    if (y < 0) { return PosWithInfo(doc.first, 0, null, true, -1) }\n    var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n    if (lineN > last)\n      { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, true, 1) }\n    if (x < 0) { x = 0; }\n\n    var lineObj = getLine(doc, lineN);\n    for (;;) {\n      var found = coordsCharInner(cm, lineObj, lineN, x, y);\n      var collapsed = collapsedSpanAround(lineObj, found.ch + (found.xRel > 0 ? 1 : 0));\n      if (!collapsed) { return found }\n      var rangeEnd = collapsed.find(1);\n      if (rangeEnd.line == lineN) { return rangeEnd }\n      lineObj = getLine(doc, lineN = rangeEnd.line);\n    }\n  }\n\n  function wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n    y -= widgetTopHeight(lineObj);\n    var end = lineObj.text.length;\n    var begin = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch - 1).bottom <= y; }, end, 0);\n    end = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch).top > y; }, begin, end);\n    return {begin: begin, end: end}\n  }\n\n  function wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n    return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\n  }\n\n  // Returns true if the given side of a box is after the given\n  // coordinates, in top-to-bottom, left-to-right order.\n  function boxIsAfter(box, x, y, left) {\n    return box.bottom <= y ? false : box.top > y ? true : (left ? box.left : box.right) > x\n  }\n\n  function coordsCharInner(cm, lineObj, lineNo$$1, x, y) {\n    // Move y into line-local coordinate space\n    y -= heightAtLine(lineObj);\n    var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n    // When directly calling `measureCharPrepared`, we have to adjust\n    // for the widgets at this line.\n    var widgetHeight$$1 = widgetTopHeight(lineObj);\n    var begin = 0, end = lineObj.text.length, ltr = true;\n\n    var order = getOrder(lineObj, cm.doc.direction);\n    // If the line isn't plain left-to-right text, first figure out\n    // which bidi section the coordinates fall into.\n    if (order) {\n      var part = (cm.options.lineWrapping ? coordsBidiPartWrapped : coordsBidiPart)\n                   (cm, lineObj, lineNo$$1, preparedMeasure, order, x, y);\n      ltr = part.level != 1;\n      // The awkward -1 offsets are needed because findFirst (called\n      // on these below) will treat its first bound as inclusive,\n      // second as exclusive, but we want to actually address the\n      // characters in the part's range\n      begin = ltr ? part.from : part.to - 1;\n      end = ltr ? part.to : part.from - 1;\n    }\n\n    // A binary search to find the first character whose bounding box\n    // starts after the coordinates. If we run across any whose box wrap\n    // the coordinates, store that.\n    var chAround = null, boxAround = null;\n    var ch = findFirst(function (ch) {\n      var box = measureCharPrepared(cm, preparedMeasure, ch);\n      box.top += widgetHeight$$1; box.bottom += widgetHeight$$1;\n      if (!boxIsAfter(box, x, y, false)) { return false }\n      if (box.top <= y && box.left <= x) {\n        chAround = ch;\n        boxAround = box;\n      }\n      return true\n    }, begin, end);\n\n    var baseX, sticky, outside = false;\n    // If a box around the coordinates was found, use that\n    if (boxAround) {\n      // Distinguish coordinates nearer to the left or right side of the box\n      var atLeft = x - boxAround.left < boxAround.right - x, atStart = atLeft == ltr;\n      ch = chAround + (atStart ? 0 : 1);\n      sticky = atStart ? \"after\" : \"before\";\n      baseX = atLeft ? boxAround.left : boxAround.right;\n    } else {\n      // (Adjust for extended bound, if necessary.)\n      if (!ltr && (ch == end || ch == begin)) { ch++; }\n      // To determine which side to associate with, get the box to the\n      // left of the character and compare it's vertical position to the\n      // coordinates\n      sticky = ch == 0 ? \"after\" : ch == lineObj.text.length ? \"before\" :\n        (measureCharPrepared(cm, preparedMeasure, ch - (ltr ? 1 : 0)).bottom + widgetHeight$$1 <= y) == ltr ?\n        \"after\" : \"before\";\n      // Now get accurate coordinates for this place, in order to get a\n      // base X position\n      var coords = cursorCoords(cm, Pos(lineNo$$1, ch, sticky), \"line\", lineObj, preparedMeasure);\n      baseX = coords.left;\n      outside = y < coords.top || y >= coords.bottom;\n    }\n\n    ch = skipExtendingChars(lineObj.text, ch, 1);\n    return PosWithInfo(lineNo$$1, ch, sticky, outside, x - baseX)\n  }\n\n  function coordsBidiPart(cm, lineObj, lineNo$$1, preparedMeasure, order, x, y) {\n    // Bidi parts are sorted left-to-right, and in a non-line-wrapping\n    // situation, we can take this ordering to correspond to the visual\n    // ordering. This finds the first part whose end is after the given\n    // coordinates.\n    var index = findFirst(function (i) {\n      var part = order[i], ltr = part.level != 1;\n      return boxIsAfter(cursorCoords(cm, Pos(lineNo$$1, ltr ? part.to : part.from, ltr ? \"before\" : \"after\"),\n                                     \"line\", lineObj, preparedMeasure), x, y, true)\n    }, 0, order.length - 1);\n    var part = order[index];\n    // If this isn't the first part, the part's start is also after\n    // the coordinates, and the coordinates aren't on the same line as\n    // that start, move one part back.\n    if (index > 0) {\n      var ltr = part.level != 1;\n      var start = cursorCoords(cm, Pos(lineNo$$1, ltr ? part.from : part.to, ltr ? \"after\" : \"before\"),\n                               \"line\", lineObj, preparedMeasure);\n      if (boxIsAfter(start, x, y, true) && start.top > y)\n        { part = order[index - 1]; }\n    }\n    return part\n  }\n\n  function coordsBidiPartWrapped(cm, lineObj, _lineNo, preparedMeasure, order, x, y) {\n    // In a wrapped line, rtl text on wrapping boundaries can do things\n    // that don't correspond to the ordering in our `order` array at\n    // all, so a binary search doesn't work, and we want to return a\n    // part that only spans one line so that the binary search in\n    // coordsCharInner is safe. As such, we first find the extent of the\n    // wrapped line, and then do a flat search in which we discard any\n    // spans that aren't on the line.\n    var ref = wrappedLineExtent(cm, lineObj, preparedMeasure, y);\n    var begin = ref.begin;\n    var end = ref.end;\n    if (/\\s/.test(lineObj.text.charAt(end - 1))) { end--; }\n    var part = null, closestDist = null;\n    for (var i = 0; i < order.length; i++) {\n      var p = order[i];\n      if (p.from >= end || p.to <= begin) { continue }\n      var ltr = p.level != 1;\n      var endX = measureCharPrepared(cm, preparedMeasure, ltr ? Math.min(end, p.to) - 1 : Math.max(begin, p.from)).right;\n      // Weigh against spans ending before this, so that they are only\n      // picked if nothing ends after\n      var dist = endX < x ? x - endX + 1e9 : endX - x;\n      if (!part || closestDist > dist) {\n        part = p;\n        closestDist = dist;\n      }\n    }\n    if (!part) { part = order[order.length - 1]; }\n    // Clip the part to the wrapped line.\n    if (part.from < begin) { part = {from: begin, to: part.to, level: part.level}; }\n    if (part.to > end) { part = {from: part.from, to: end, level: part.level}; }\n    return part\n  }\n\n  var measureText;\n  // Compute the default text height.\n  function textHeight(display) {\n    if (display.cachedTextHeight != null) { return display.cachedTextHeight }\n    if (measureText == null) {\n      measureText = elt(\"pre\");\n      // Measure a bunch of lines, for browsers that compute\n      // fractional heights.\n      for (var i = 0; i < 49; ++i) {\n        measureText.appendChild(document.createTextNode(\"x\"));\n        measureText.appendChild(elt(\"br\"));\n      }\n      measureText.appendChild(document.createTextNode(\"x\"));\n    }\n    removeChildrenAndAdd(display.measure, measureText);\n    var height = measureText.offsetHeight / 50;\n    if (height > 3) { display.cachedTextHeight = height; }\n    removeChildren(display.measure);\n    return height || 1\n  }\n\n  // Compute the default character width.\n  function charWidth(display) {\n    if (display.cachedCharWidth != null) { return display.cachedCharWidth }\n    var anchor = elt(\"span\", \"xxxxxxxxxx\");\n    var pre = elt(\"pre\", [anchor]);\n    removeChildrenAndAdd(display.measure, pre);\n    var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n    if (width > 2) { display.cachedCharWidth = width; }\n    return width || 10\n  }\n\n  // Do a bulk-read of the DOM positions and sizes needed to draw the\n  // view, so that we don't interleave reading and writing to the DOM.\n  function getDimensions(cm) {\n    var d = cm.display, left = {}, width = {};\n    var gutterLeft = d.gutters.clientLeft;\n    for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n      left[cm.options.gutters[i]] = n.offsetLeft + n.clientLeft + gutterLeft;\n      width[cm.options.gutters[i]] = n.clientWidth;\n    }\n    return {fixedPos: compensateForHScroll(d),\n            gutterTotalWidth: d.gutters.offsetWidth,\n            gutterLeft: left,\n            gutterWidth: width,\n            wrapperWidth: d.wrapper.clientWidth}\n  }\n\n  // Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n  // but using getBoundingClientRect to get a sub-pixel-accurate\n  // result.\n  function compensateForHScroll(display) {\n    return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\n  }\n\n  // Returns a function that estimates the height of a line, to use as\n  // first approximation until the line becomes visible (and is thus\n  // properly measurable).\n  function estimateHeight(cm) {\n    var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n    var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n    return function (line) {\n      if (lineIsHidden(cm.doc, line)) { return 0 }\n\n      var widgetsHeight = 0;\n      if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\n        if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height; }\n      } }\n\n      if (wrapping)\n        { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\n      else\n        { return widgetsHeight + th }\n    }\n  }\n\n  function estimateLineHeights(cm) {\n    var doc = cm.doc, est = estimateHeight(cm);\n    doc.iter(function (line) {\n      var estHeight = est(line);\n      if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n    });\n  }\n\n  // Given a mouse event, find the corresponding position. If liberal\n  // is false, it checks whether a gutter or scrollbar was clicked,\n  // and returns null if it was. forRect is used by rectangular\n  // selections, and tries to estimate a character position even for\n  // coordinates beyond the right of the text.\n  function posFromMouse(cm, e, liberal, forRect) {\n    var display = cm.display;\n    if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") { return null }\n\n    var x, y, space = display.lineSpace.getBoundingClientRect();\n    // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n    try { x = e.clientX - space.left; y = e.clientY - space.top; }\n    catch (e) { return null }\n    var coords = coordsChar(cm, x, y), line;\n    if (forRect && coords.xRel == 1 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n      var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n      coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n    }\n    return coords\n  }\n\n  // Find the view element corresponding to a given line. Return null\n  // when the line isn't visible.\n  function findViewIndex(cm, n) {\n    if (n >= cm.display.viewTo) { return null }\n    n -= cm.display.viewFrom;\n    if (n < 0) { return null }\n    var view = cm.display.view;\n    for (var i = 0; i < view.length; i++) {\n      n -= view[i].size;\n      if (n < 0) { return i }\n    }\n  }\n\n  function updateSelection(cm) {\n    cm.display.input.showSelection(cm.display.input.prepareSelection());\n  }\n\n  function prepareSelection(cm, primary) {\n    if ( primary === void 0 ) primary = true;\n\n    var doc = cm.doc, result = {};\n    var curFragment = result.cursors = document.createDocumentFragment();\n    var selFragment = result.selection = document.createDocumentFragment();\n\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      if (!primary && i == doc.sel.primIndex) { continue }\n      var range$$1 = doc.sel.ranges[i];\n      if (range$$1.from().line >= cm.display.viewTo || range$$1.to().line < cm.display.viewFrom) { continue }\n      var collapsed = range$$1.empty();\n      if (collapsed || cm.options.showCursorWhenSelecting)\n        { drawSelectionCursor(cm, range$$1.head, curFragment); }\n      if (!collapsed)\n        { drawSelectionRange(cm, range$$1, selFragment); }\n    }\n    return result\n  }\n\n  // Draws a cursor for the given range\n  function drawSelectionCursor(cm, head, output) {\n    var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n    var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n    cursor.style.left = pos.left + \"px\";\n    cursor.style.top = pos.top + \"px\";\n    cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n    if (pos.other) {\n      // Secondary cursor, shown when on a 'jump' in bi-directional text\n      var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n      otherCursor.style.display = \"\";\n      otherCursor.style.left = pos.other.left + \"px\";\n      otherCursor.style.top = pos.other.top + \"px\";\n      otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n    }\n  }\n\n  function cmpCoords(a, b) { return a.top - b.top || a.left - b.left }\n\n  // Draws the given range as a highlighted selection\n  function drawSelectionRange(cm, range$$1, output) {\n    var display = cm.display, doc = cm.doc;\n    var fragment = document.createDocumentFragment();\n    var padding = paddingH(cm.display), leftSide = padding.left;\n    var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n    var docLTR = doc.direction == \"ltr\";\n\n    function add(left, top, width, bottom) {\n      if (top < 0) { top = 0; }\n      top = Math.round(top);\n      bottom = Math.round(bottom);\n      fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", (\"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\")));\n    }\n\n    function drawForLine(line, fromArg, toArg) {\n      var lineObj = getLine(doc, line);\n      var lineLen = lineObj.text.length;\n      var start, end;\n      function coords(ch, bias) {\n        return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias)\n      }\n\n      function wrapX(pos, dir, side) {\n        var extent = wrappedLineExtentChar(cm, lineObj, null, pos);\n        var prop = (dir == \"ltr\") == (side == \"after\") ? \"left\" : \"right\";\n        var ch = side == \"after\" ? extent.begin : extent.end - (/\\s/.test(lineObj.text.charAt(extent.end - 1)) ? 2 : 1);\n        return coords(ch, prop)[prop]\n      }\n\n      var order = getOrder(lineObj, doc.direction);\n      iterateBidiSections(order, fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir, i) {\n        var ltr = dir == \"ltr\";\n        var fromPos = coords(from, ltr ? \"left\" : \"right\");\n        var toPos = coords(to - 1, ltr ? \"right\" : \"left\");\n\n        var openStart = fromArg == null && from == 0, openEnd = toArg == null && to == lineLen;\n        var first = i == 0, last = !order || i == order.length - 1;\n        if (toPos.top - fromPos.top <= 3) { // Single line\n          var openLeft = (docLTR ? openStart : openEnd) && first;\n          var openRight = (docLTR ? openEnd : openStart) && last;\n          var left = openLeft ? leftSide : (ltr ? fromPos : toPos).left;\n          var right = openRight ? rightSide : (ltr ? toPos : fromPos).right;\n          add(left, fromPos.top, right - left, fromPos.bottom);\n        } else { // Multiple lines\n          var topLeft, topRight, botLeft, botRight;\n          if (ltr) {\n            topLeft = docLTR && openStart && first ? leftSide : fromPos.left;\n            topRight = docLTR ? rightSide : wrapX(from, dir, \"before\");\n            botLeft = docLTR ? leftSide : wrapX(to, dir, \"after\");\n            botRight = docLTR && openEnd && last ? rightSide : toPos.right;\n          } else {\n            topLeft = !docLTR ? leftSide : wrapX(from, dir, \"before\");\n            topRight = !docLTR && openStart && first ? rightSide : fromPos.right;\n            botLeft = !docLTR && openEnd && last ? leftSide : toPos.left;\n            botRight = !docLTR ? rightSide : wrapX(to, dir, \"after\");\n          }\n          add(topLeft, fromPos.top, topRight - topLeft, fromPos.bottom);\n          if (fromPos.bottom < toPos.top) { add(leftSide, fromPos.bottom, null, toPos.top); }\n          add(botLeft, toPos.top, botRight - botLeft, toPos.bottom);\n        }\n\n        if (!start || cmpCoords(fromPos, start) < 0) { start = fromPos; }\n        if (cmpCoords(toPos, start) < 0) { start = toPos; }\n        if (!end || cmpCoords(fromPos, end) < 0) { end = fromPos; }\n        if (cmpCoords(toPos, end) < 0) { end = toPos; }\n      });\n      return {start: start, end: end}\n    }\n\n    var sFrom = range$$1.from(), sTo = range$$1.to();\n    if (sFrom.line == sTo.line) {\n      drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n    } else {\n      var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n      var singleVLine = visualLine(fromLine) == visualLine(toLine);\n      var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n      var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n      if (singleVLine) {\n        if (leftEnd.top < rightStart.top - 2) {\n          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n          add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n        } else {\n          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n        }\n      }\n      if (leftEnd.bottom < rightStart.top)\n        { add(leftSide, leftEnd.bottom, null, rightStart.top); }\n    }\n\n    output.appendChild(fragment);\n  }\n\n  // Cursor-blinking\n  function restartBlink(cm) {\n    if (!cm.state.focused) { return }\n    var display = cm.display;\n    clearInterval(display.blinker);\n    var on = true;\n    display.cursorDiv.style.visibility = \"\";\n    if (cm.options.cursorBlinkRate > 0)\n      { display.blinker = setInterval(function () { return display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\"; },\n        cm.options.cursorBlinkRate); }\n    else if (cm.options.cursorBlinkRate < 0)\n      { display.cursorDiv.style.visibility = \"hidden\"; }\n  }\n\n  function ensureFocus(cm) {\n    if (!cm.state.focused) { cm.display.input.focus(); onFocus(cm); }\n  }\n\n  function delayBlurEvent(cm) {\n    cm.state.delayingBlurEvent = true;\n    setTimeout(function () { if (cm.state.delayingBlurEvent) {\n      cm.state.delayingBlurEvent = false;\n      onBlur(cm);\n    } }, 100);\n  }\n\n  function onFocus(cm, e) {\n    if (cm.state.delayingBlurEvent) { cm.state.delayingBlurEvent = false; }\n\n    if (cm.options.readOnly == \"nocursor\") { return }\n    if (!cm.state.focused) {\n      signal(cm, \"focus\", cm, e);\n      cm.state.focused = true;\n      addClass(cm.display.wrapper, \"CodeMirror-focused\");\n      // This test prevents this from firing when a context\n      // menu is closed (since the input reset would kill the\n      // select-all detection hack)\n      if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n        cm.display.input.reset();\n        if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20); } // Issue #1730\n      }\n      cm.display.input.receivedFocus();\n    }\n    restartBlink(cm);\n  }\n  function onBlur(cm, e) {\n    if (cm.state.delayingBlurEvent) { return }\n\n    if (cm.state.focused) {\n      signal(cm, \"blur\", cm, e);\n      cm.state.focused = false;\n      rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n    }\n    clearInterval(cm.display.blinker);\n    setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false; } }, 150);\n  }\n\n  // Read the actual heights of the rendered lines, and update their\n  // stored heights to match.\n  function updateHeightsInViewport(cm) {\n    var display = cm.display;\n    var prevBottom = display.lineDiv.offsetTop;\n    for (var i = 0; i < display.view.length; i++) {\n      var cur = display.view[i], wrapping = cm.options.lineWrapping;\n      var height = (void 0), width = 0;\n      if (cur.hidden) { continue }\n      if (ie && ie_version < 8) {\n        var bot = cur.node.offsetTop + cur.node.offsetHeight;\n        height = bot - prevBottom;\n        prevBottom = bot;\n      } else {\n        var box = cur.node.getBoundingClientRect();\n        height = box.bottom - box.top;\n        // Check that lines don't extend past the right of the current\n        // editor width\n        if (!wrapping && cur.text.firstChild)\n          { width = cur.text.firstChild.getBoundingClientRect().right - box.left - 1; }\n      }\n      var diff = cur.line.height - height;\n      if (diff > .005 || diff < -.005) {\n        updateLineHeight(cur.line, height);\n        updateWidgetHeight(cur.line);\n        if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\n          { updateWidgetHeight(cur.rest[j]); } }\n      }\n      if (width > cm.display.sizerWidth) {\n        var chWidth = Math.ceil(width / charWidth(cm.display));\n        if (chWidth > cm.display.maxLineLength) {\n          cm.display.maxLineLength = chWidth;\n          cm.display.maxLine = cur.line;\n          cm.display.maxLineChanged = true;\n        }\n      }\n    }\n  }\n\n  // Read and store the height of line widgets associated with the\n  // given line.\n  function updateWidgetHeight(line) {\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i) {\n      var w = line.widgets[i], parent = w.node.parentNode;\n      if (parent) { w.height = parent.offsetHeight; }\n    } }\n  }\n\n  // Compute the lines that are visible in a given viewport (defaults\n  // the the current scroll position). viewport may contain top,\n  // height, and ensure (see op.scrollToPos) properties.\n  function visibleLines(display, doc, viewport) {\n    var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n    top = Math.floor(top - paddingTop(display));\n    var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n    var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n    // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n    // forces those lines into the viewport (if possible).\n    if (viewport && viewport.ensure) {\n      var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n      if (ensureFrom < from) {\n        from = ensureFrom;\n        to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n      } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n        from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n        to = ensureTo;\n      }\n    }\n    return {from: from, to: Math.max(to, from + 1)}\n  }\n\n  // Re-align line numbers and gutter marks to compensate for\n  // horizontal scrolling.\n  function alignHorizontally(cm) {\n    var display = cm.display, view = display.view;\n    if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\n    var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n    var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n    for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\n      if (cm.options.fixedGutter) {\n        if (view[i].gutter)\n          { view[i].gutter.style.left = left; }\n        if (view[i].gutterBackground)\n          { view[i].gutterBackground.style.left = left; }\n      }\n      var align = view[i].alignable;\n      if (align) { for (var j = 0; j < align.length; j++)\n        { align[j].style.left = left; } }\n    } }\n    if (cm.options.fixedGutter)\n      { display.gutters.style.left = (comp + gutterW) + \"px\"; }\n  }\n\n  // Used to ensure that the line number gutter is still the right\n  // size for the current document size. Returns true when an update\n  // is needed.\n  function maybeUpdateLineNumberWidth(cm) {\n    if (!cm.options.lineNumbers) { return false }\n    var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n    if (last.length != display.lineNumChars) {\n      var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                                 \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n      var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n      display.lineGutter.style.width = \"\";\n      display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n      display.lineNumWidth = display.lineNumInnerWidth + padding;\n      display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n      display.lineGutter.style.width = display.lineNumWidth + \"px\";\n      updateGutterSpace(cm);\n      return true\n    }\n    return false\n  }\n\n  // SCROLLING THINGS INTO VIEW\n\n  // If an editor sits on the top or bottom of the window, partially\n  // scrolled out of view, this ensures that the cursor is visible.\n  function maybeScrollWindow(cm, rect) {\n    if (signalDOMEvent(cm, \"scrollCursorIntoView\")) { return }\n\n    var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n    if (rect.top + box.top < 0) { doScroll = true; }\n    else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) { doScroll = false; }\n    if (doScroll != null && !phantom) {\n      var scrollNode = elt(\"div\", \"\\u200b\", null, (\"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + (rect.left) + \"px; width: \" + (Math.max(2, rect.right - rect.left)) + \"px;\"));\n      cm.display.lineSpace.appendChild(scrollNode);\n      scrollNode.scrollIntoView(doScroll);\n      cm.display.lineSpace.removeChild(scrollNode);\n    }\n  }\n\n  // Scroll a given position into view (immediately), verifying that\n  // it actually became visible (as line heights are accurately\n  // measured, the position of something may 'drift' during drawing).\n  function scrollPosIntoView(cm, pos, end, margin) {\n    if (margin == null) { margin = 0; }\n    var rect;\n    if (!cm.options.lineWrapping && pos == end) {\n      // Set pos and end to the cursor positions around the character pos sticks to\n      // If pos.sticky == \"before\", that is around pos.ch - 1, otherwise around pos.ch\n      // If pos == Pos(_, 0, \"before\"), pos and end are unchanged\n      pos = pos.ch ? Pos(pos.line, pos.sticky == \"before\" ? pos.ch - 1 : pos.ch, \"after\") : pos;\n      end = pos.sticky == \"before\" ? Pos(pos.line, pos.ch + 1, \"before\") : pos;\n    }\n    for (var limit = 0; limit < 5; limit++) {\n      var changed = false;\n      var coords = cursorCoords(cm, pos);\n      var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n      rect = {left: Math.min(coords.left, endCoords.left),\n              top: Math.min(coords.top, endCoords.top) - margin,\n              right: Math.max(coords.left, endCoords.left),\n              bottom: Math.max(coords.bottom, endCoords.bottom) + margin};\n      var scrollPos = calculateScrollPos(cm, rect);\n      var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n      if (scrollPos.scrollTop != null) {\n        updateScrollTop(cm, scrollPos.scrollTop);\n        if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true; }\n      }\n      if (scrollPos.scrollLeft != null) {\n        setScrollLeft(cm, scrollPos.scrollLeft);\n        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true; }\n      }\n      if (!changed) { break }\n    }\n    return rect\n  }\n\n  // Scroll a given set of coordinates into view (immediately).\n  function scrollIntoView(cm, rect) {\n    var scrollPos = calculateScrollPos(cm, rect);\n    if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop); }\n    if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft); }\n  }\n\n  // Calculate a new scroll position needed to scroll the given\n  // rectangle into view. Returns an object with scrollTop and\n  // scrollLeft properties. When these are undefined, the\n  // vertical/horizontal position does not need to be adjusted.\n  function calculateScrollPos(cm, rect) {\n    var display = cm.display, snapMargin = textHeight(cm.display);\n    if (rect.top < 0) { rect.top = 0; }\n    var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n    var screen = displayHeight(cm), result = {};\n    if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen; }\n    var docBottom = cm.doc.height + paddingVert(display);\n    var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin;\n    if (rect.top < screentop) {\n      result.scrollTop = atTop ? 0 : rect.top;\n    } else if (rect.bottom > screentop + screen) {\n      var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n      if (newTop != screentop) { result.scrollTop = newTop; }\n    }\n\n    var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n    var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0);\n    var tooWide = rect.right - rect.left > screenw;\n    if (tooWide) { rect.right = rect.left + screenw; }\n    if (rect.left < 10)\n      { result.scrollLeft = 0; }\n    else if (rect.left < screenleft)\n      { result.scrollLeft = Math.max(0, rect.left - (tooWide ? 0 : 10)); }\n    else if (rect.right > screenw + screenleft - 3)\n      { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw; }\n    return result\n  }\n\n  // Store a relative adjustment to the scroll position in the current\n  // operation (to be applied when the operation finishes).\n  function addToScrollTop(cm, top) {\n    if (top == null) { return }\n    resolveScrollToPos(cm);\n    cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n  }\n\n  // Make sure that at the end of the operation the current cursor is\n  // shown.\n  function ensureCursorVisible(cm) {\n    resolveScrollToPos(cm);\n    var cur = cm.getCursor();\n    cm.curOp.scrollToPos = {from: cur, to: cur, margin: cm.options.cursorScrollMargin};\n  }\n\n  function scrollToCoords(cm, x, y) {\n    if (x != null || y != null) { resolveScrollToPos(cm); }\n    if (x != null) { cm.curOp.scrollLeft = x; }\n    if (y != null) { cm.curOp.scrollTop = y; }\n  }\n\n  function scrollToRange(cm, range$$1) {\n    resolveScrollToPos(cm);\n    cm.curOp.scrollToPos = range$$1;\n  }\n\n  // When an operation has its scrollToPos property set, and another\n  // scroll action is applied before the end of the operation, this\n  // 'simulates' scrolling that position into view in a cheap way, so\n  // that the effect of intermediate scroll commands is not ignored.\n  function resolveScrollToPos(cm) {\n    var range$$1 = cm.curOp.scrollToPos;\n    if (range$$1) {\n      cm.curOp.scrollToPos = null;\n      var from = estimateCoords(cm, range$$1.from), to = estimateCoords(cm, range$$1.to);\n      scrollToCoordsRange(cm, from, to, range$$1.margin);\n    }\n  }\n\n  function scrollToCoordsRange(cm, from, to, margin) {\n    var sPos = calculateScrollPos(cm, {\n      left: Math.min(from.left, to.left),\n      top: Math.min(from.top, to.top) - margin,\n      right: Math.max(from.right, to.right),\n      bottom: Math.max(from.bottom, to.bottom) + margin\n    });\n    scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n  }\n\n  // Sync the scrollable area and scrollbars, ensure the viewport\n  // covers the visible area.\n  function updateScrollTop(cm, val) {\n    if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\n    if (!gecko) { updateDisplaySimple(cm, {top: val}); }\n    setScrollTop(cm, val, true);\n    if (gecko) { updateDisplaySimple(cm); }\n    startWorker(cm, 100);\n  }\n\n  function setScrollTop(cm, val, forceScroll) {\n    val = Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val);\n    if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\n    cm.doc.scrollTop = val;\n    cm.display.scrollbars.setScrollTop(val);\n    if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val; }\n  }\n\n  // Sync scroller and scrollbar, ensure the gutter elements are\n  // aligned.\n  function setScrollLeft(cm, val, isScroller, forceScroll) {\n    val = Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth);\n    if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\n    cm.doc.scrollLeft = val;\n    alignHorizontally(cm);\n    if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val; }\n    cm.display.scrollbars.setScrollLeft(val);\n  }\n\n  // SCROLLBARS\n\n  // Prepare DOM reads needed to update the scrollbars. Done in one\n  // shot to minimize update/measure roundtrips.\n  function measureForScrollbars(cm) {\n    var d = cm.display, gutterW = d.gutters.offsetWidth;\n    var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n    return {\n      clientHeight: d.scroller.clientHeight,\n      viewHeight: d.wrapper.clientHeight,\n      scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\n      viewWidth: d.wrapper.clientWidth,\n      barLeft: cm.options.fixedGutter ? gutterW : 0,\n      docHeight: docH,\n      scrollHeight: docH + scrollGap(cm) + d.barHeight,\n      nativeBarWidth: d.nativeBarWidth,\n      gutterWidth: gutterW\n    }\n  }\n\n  var NativeScrollbars = function(place, scroll, cm) {\n    this.cm = cm;\n    var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n    var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n    vert.tabIndex = horiz.tabIndex = -1;\n    place(vert); place(horiz);\n\n    on(vert, \"scroll\", function () {\n      if (vert.clientHeight) { scroll(vert.scrollTop, \"vertical\"); }\n    });\n    on(horiz, \"scroll\", function () {\n      if (horiz.clientWidth) { scroll(horiz.scrollLeft, \"horizontal\"); }\n    });\n\n    this.checkedZeroWidth = false;\n    // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n    if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\"; }\n  };\n\n  NativeScrollbars.prototype.update = function (measure) {\n    var needsH = measure.scrollWidth > measure.clientWidth + 1;\n    var needsV = measure.scrollHeight > measure.clientHeight + 1;\n    var sWidth = measure.nativeBarWidth;\n\n    if (needsV) {\n      this.vert.style.display = \"block\";\n      this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n      var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\n      // A bug in IE8 can cause this value to be negative, so guard it.\n      this.vert.firstChild.style.height =\n        Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n    } else {\n      this.vert.style.display = \"\";\n      this.vert.firstChild.style.height = \"0\";\n    }\n\n    if (needsH) {\n      this.horiz.style.display = \"block\";\n      this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n      this.horiz.style.left = measure.barLeft + \"px\";\n      var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n      this.horiz.firstChild.style.width =\n        Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n    } else {\n      this.horiz.style.display = \"\";\n      this.horiz.firstChild.style.width = \"0\";\n    }\n\n    if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n      if (sWidth == 0) { this.zeroWidthHack(); }\n      this.checkedZeroWidth = true;\n    }\n\n    return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\n  };\n\n  NativeScrollbars.prototype.setScrollLeft = function (pos) {\n    if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos; }\n    if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\"); }\n  };\n\n  NativeScrollbars.prototype.setScrollTop = function (pos) {\n    if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos; }\n    if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\"); }\n  };\n\n  NativeScrollbars.prototype.zeroWidthHack = function () {\n    var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n    this.horiz.style.height = this.vert.style.width = w;\n    this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\";\n    this.disableHoriz = new Delayed;\n    this.disableVert = new Delayed;\n  };\n\n  NativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n    bar.style.pointerEvents = \"auto\";\n    function maybeDisable() {\n      // To find out whether the scrollbar is still visible, we\n      // check whether the element under the pixel in the bottom\n      // right corner of the scrollbar box is the scrollbar box\n      // itself (when the bar is still visible) or its filler child\n      // (when the bar is hidden). If it is still visible, we keep\n      // it enabled, if it's hidden, we disable pointer events.\n      var box = bar.getBoundingClientRect();\n      var elt$$1 = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\n          : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n      if (elt$$1 != bar) { bar.style.pointerEvents = \"none\"; }\n      else { delay.set(1000, maybeDisable); }\n    }\n    delay.set(1000, maybeDisable);\n  };\n\n  NativeScrollbars.prototype.clear = function () {\n    var parent = this.horiz.parentNode;\n    parent.removeChild(this.horiz);\n    parent.removeChild(this.vert);\n  };\n\n  var NullScrollbars = function () {};\n\n  NullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\n  NullScrollbars.prototype.setScrollLeft = function () {};\n  NullScrollbars.prototype.setScrollTop = function () {};\n  NullScrollbars.prototype.clear = function () {};\n\n  function updateScrollbars(cm, measure) {\n    if (!measure) { measure = measureForScrollbars(cm); }\n    var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\n    updateScrollbarsInner(cm, measure);\n    for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n      if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\n        { updateHeightsInViewport(cm); }\n      updateScrollbarsInner(cm, measureForScrollbars(cm));\n      startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\n    }\n  }\n\n  // Re-synchronize the fake scrollbars with the actual size of the\n  // content.\n  function updateScrollbarsInner(cm, measure) {\n    var d = cm.display;\n    var sizes = d.scrollbars.update(measure);\n\n    d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n    d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n    d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n    if (sizes.right && sizes.bottom) {\n      d.scrollbarFiller.style.display = \"block\";\n      d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n      d.scrollbarFiller.style.width = sizes.right + \"px\";\n    } else { d.scrollbarFiller.style.display = \"\"; }\n    if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n      d.gutterFiller.style.display = \"block\";\n      d.gutterFiller.style.height = sizes.bottom + \"px\";\n      d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n    } else { d.gutterFiller.style.display = \"\"; }\n  }\n\n  var scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars};\n\n  function initScrollbars(cm) {\n    if (cm.display.scrollbars) {\n      cm.display.scrollbars.clear();\n      if (cm.display.scrollbars.addClass)\n        { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n    }\n\n    cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n      cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\n      // Prevent clicks in the scrollbars from killing focus\n      on(node, \"mousedown\", function () {\n        if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0); }\n      });\n      node.setAttribute(\"cm-not-content\", \"true\");\n    }, function (pos, axis) {\n      if (axis == \"horizontal\") { setScrollLeft(cm, pos); }\n      else { updateScrollTop(cm, pos); }\n    }, cm);\n    if (cm.display.scrollbars.addClass)\n      { addClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n  }\n\n  // Operations are used to wrap a series of changes to the editor\n  // state in such a way that each change won't have to update the\n  // cursor and display (which would be awkward, slow, and\n  // error-prone). Instead, display updates are batched and then all\n  // combined and executed at once.\n\n  var nextOpId = 0;\n  // Start a new operation.\n  function startOperation(cm) {\n    cm.curOp = {\n      cm: cm,\n      viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n      startHeight: cm.doc.height, // Used to detect need to update scrollbar\n      forceUpdate: false,      // Used to force a redraw\n      updateInput: 0,       // Whether to reset the input textarea\n      typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n      changeObjs: null,        // Accumulated changes, for firing change events\n      cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n      cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n      selectionChanged: false, // Whether the selection needs to be redrawn\n      updateMaxLine: false,    // Set when the widest line needs to be determined anew\n      scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n      scrollToPos: null,       // Used to scroll to a specific position\n      focus: false,\n      id: ++nextOpId           // Unique ID\n    };\n    pushOperation(cm.curOp);\n  }\n\n  // Finish an operation, updating the display and signalling delayed events\n  function endOperation(cm) {\n    var op = cm.curOp;\n    if (op) { finishOperation(op, function (group) {\n      for (var i = 0; i < group.ops.length; i++)\n        { group.ops[i].cm.curOp = null; }\n      endOperations(group);\n    }); }\n  }\n\n  // The DOM updates done when an operation finishes are batched so\n  // that the minimum number of relayouts are required.\n  function endOperations(group) {\n    var ops = group.ops;\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      { endOperation_R1(ops[i]); }\n    for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n      { endOperation_W1(ops[i$1]); }\n    for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n      { endOperation_R2(ops[i$2]); }\n    for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n      { endOperation_W2(ops[i$3]); }\n    for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n      { endOperation_finish(ops[i$4]); }\n  }\n\n  function endOperation_R1(op) {\n    var cm = op.cm, display = cm.display;\n    maybeClipScrollbars(cm);\n    if (op.updateMaxLine) { findMaxLine(cm); }\n\n    op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n      op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                         op.scrollToPos.to.line >= display.viewTo) ||\n      display.maxLineChanged && cm.options.lineWrapping;\n    op.update = op.mustUpdate &&\n      new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n  }\n\n  function endOperation_W1(op) {\n    op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n  }\n\n  function endOperation_R2(op) {\n    var cm = op.cm, display = cm.display;\n    if (op.updatedDisplay) { updateHeightsInViewport(cm); }\n\n    op.barMeasure = measureForScrollbars(cm);\n\n    // If the max line changed since it was last measured, measure it,\n    // and ensure the document's width matches it.\n    // updateDisplay_W2 will use these properties to do the actual resizing\n    if (display.maxLineChanged && !cm.options.lineWrapping) {\n      op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n      cm.display.sizerWidth = op.adjustWidthTo;\n      op.barMeasure.scrollWidth =\n        Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n      op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n    }\n\n    if (op.updatedDisplay || op.selectionChanged)\n      { op.preparedSelection = display.input.prepareSelection(); }\n  }\n\n  function endOperation_W2(op) {\n    var cm = op.cm;\n\n    if (op.adjustWidthTo != null) {\n      cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n      if (op.maxScrollLeft < cm.doc.scrollLeft)\n        { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true); }\n      cm.display.maxLineChanged = false;\n    }\n\n    var takeFocus = op.focus && op.focus == activeElt();\n    if (op.preparedSelection)\n      { cm.display.input.showSelection(op.preparedSelection, takeFocus); }\n    if (op.updatedDisplay || op.startHeight != cm.doc.height)\n      { updateScrollbars(cm, op.barMeasure); }\n    if (op.updatedDisplay)\n      { setDocumentHeight(cm, op.barMeasure); }\n\n    if (op.selectionChanged) { restartBlink(cm); }\n\n    if (cm.state.focused && op.updateInput)\n      { cm.display.input.reset(op.typing); }\n    if (takeFocus) { ensureFocus(op.cm); }\n  }\n\n  function endOperation_finish(op) {\n    var cm = op.cm, display = cm.display, doc = cm.doc;\n\n    if (op.updatedDisplay) { postUpdateDisplay(cm, op.update); }\n\n    // Abort mouse wheel delta measurement, when scrolling explicitly\n    if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n      { display.wheelStartX = display.wheelStartY = null; }\n\n    // Propagate the scroll position to the actual DOM scroller\n    if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll); }\n\n    if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true); }\n    // If we need to scroll a specific position into view, do so.\n    if (op.scrollToPos) {\n      var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                   clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n      maybeScrollWindow(cm, rect);\n    }\n\n    // Fire events for markers that are hidden/unidden by editing or\n    // undoing\n    var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n    if (hidden) { for (var i = 0; i < hidden.length; ++i)\n      { if (!hidden[i].lines.length) { signal(hidden[i], \"hide\"); } } }\n    if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\n      { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], \"unhide\"); } } }\n\n    if (display.wrapper.offsetHeight)\n      { doc.scrollTop = cm.display.scroller.scrollTop; }\n\n    // Fire change events, and delayed event handlers\n    if (op.changeObjs)\n      { signal(cm, \"changes\", cm, op.changeObjs); }\n    if (op.update)\n      { op.update.finish(); }\n  }\n\n  // Run the given function in an operation\n  function runInOp(cm, f) {\n    if (cm.curOp) { return f() }\n    startOperation(cm);\n    try { return f() }\n    finally { endOperation(cm); }\n  }\n  // Wraps a function in an operation. Returns the wrapped function.\n  function operation(cm, f) {\n    return function() {\n      if (cm.curOp) { return f.apply(cm, arguments) }\n      startOperation(cm);\n      try { return f.apply(cm, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n  // Used to add methods to editor and doc instances, wrapping them in\n  // operations.\n  function methodOp(f) {\n    return function() {\n      if (this.curOp) { return f.apply(this, arguments) }\n      startOperation(this);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(this); }\n    }\n  }\n  function docMethodOp(f) {\n    return function() {\n      var cm = this.cm;\n      if (!cm || cm.curOp) { return f.apply(this, arguments) }\n      startOperation(cm);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n\n  // Updates the display.view data structure for a given change to the\n  // document. From and to are in pre-change coordinates. Lendiff is\n  // the amount of lines added or subtracted by the change. This is\n  // used for changes that span multiple lines, or change the way\n  // lines are divided into visual lines. regLineChange (below)\n  // registers single-line changes.\n  function regChange(cm, from, to, lendiff) {\n    if (from == null) { from = cm.doc.first; }\n    if (to == null) { to = cm.doc.first + cm.doc.size; }\n    if (!lendiff) { lendiff = 0; }\n\n    var display = cm.display;\n    if (lendiff && to < display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers > from))\n      { display.updateLineNumbers = from; }\n\n    cm.curOp.viewChanged = true;\n\n    if (from >= display.viewTo) { // Change after\n      if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n        { resetView(cm); }\n    } else if (to <= display.viewFrom) { // Change before\n      if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n        resetView(cm);\n      } else {\n        display.viewFrom += lendiff;\n        display.viewTo += lendiff;\n      }\n    } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n      resetView(cm);\n    } else if (from <= display.viewFrom) { // Top overlap\n      var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cut) {\n        display.view = display.view.slice(cut.index);\n        display.viewFrom = cut.lineN;\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    } else if (to >= display.viewTo) { // Bottom overlap\n      var cut$1 = viewCuttingPoint(cm, from, from, -1);\n      if (cut$1) {\n        display.view = display.view.slice(0, cut$1.index);\n        display.viewTo = cut$1.lineN;\n      } else {\n        resetView(cm);\n      }\n    } else { // Gap in the middle\n      var cutTop = viewCuttingPoint(cm, from, from, -1);\n      var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cutTop && cutBot) {\n        display.view = display.view.slice(0, cutTop.index)\n          .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n          .concat(display.view.slice(cutBot.index));\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    }\n\n    var ext = display.externalMeasured;\n    if (ext) {\n      if (to < ext.lineN)\n        { ext.lineN += lendiff; }\n      else if (from < ext.lineN + ext.size)\n        { display.externalMeasured = null; }\n    }\n  }\n\n  // Register a change to a single line. Type must be one of \"text\",\n  // \"gutter\", \"class\", \"widget\"\n  function regLineChange(cm, line, type) {\n    cm.curOp.viewChanged = true;\n    var display = cm.display, ext = cm.display.externalMeasured;\n    if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n      { display.externalMeasured = null; }\n\n    if (line < display.viewFrom || line >= display.viewTo) { return }\n    var lineView = display.view[findViewIndex(cm, line)];\n    if (lineView.node == null) { return }\n    var arr = lineView.changes || (lineView.changes = []);\n    if (indexOf(arr, type) == -1) { arr.push(type); }\n  }\n\n  // Clear the view.\n  function resetView(cm) {\n    cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n    cm.display.view = [];\n    cm.display.viewOffset = 0;\n  }\n\n  function viewCuttingPoint(cm, oldN, newN, dir) {\n    var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n    if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n      { return {index: index, lineN: newN} }\n    var n = cm.display.viewFrom;\n    for (var i = 0; i < index; i++)\n      { n += view[i].size; }\n    if (n != oldN) {\n      if (dir > 0) {\n        if (index == view.length - 1) { return null }\n        diff = (n + view[index].size) - oldN;\n        index++;\n      } else {\n        diff = n - oldN;\n      }\n      oldN += diff; newN += diff;\n    }\n    while (visualLineNo(cm.doc, newN) != newN) {\n      if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\n      newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n      index += dir;\n    }\n    return {index: index, lineN: newN}\n  }\n\n  // Force the view to cover a given range, adding empty view element\n  // or clipping off existing ones as needed.\n  function adjustView(cm, from, to) {\n    var display = cm.display, view = display.view;\n    if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n      display.view = buildViewArray(cm, from, to);\n      display.viewFrom = from;\n    } else {\n      if (display.viewFrom > from)\n        { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view); }\n      else if (display.viewFrom < from)\n        { display.view = display.view.slice(findViewIndex(cm, from)); }\n      display.viewFrom = from;\n      if (display.viewTo < to)\n        { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)); }\n      else if (display.viewTo > to)\n        { display.view = display.view.slice(0, findViewIndex(cm, to)); }\n    }\n    display.viewTo = to;\n  }\n\n  // Count the number of lines in the view whose DOM representation is\n  // out of date (or nonexistent).\n  function countDirtyView(cm) {\n    var view = cm.display.view, dirty = 0;\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty; }\n    }\n    return dirty\n  }\n\n  // HIGHLIGHT WORKER\n\n  function startWorker(cm, time) {\n    if (cm.doc.highlightFrontier < cm.display.viewTo)\n      { cm.state.highlight.set(time, bind(highlightWorker, cm)); }\n  }\n\n  function highlightWorker(cm) {\n    var doc = cm.doc;\n    if (doc.highlightFrontier >= cm.display.viewTo) { return }\n    var end = +new Date + cm.options.workTime;\n    var context = getContextBefore(cm, doc.highlightFrontier);\n    var changedLines = [];\n\n    doc.iter(context.line, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n      if (context.line >= cm.display.viewFrom) { // Visible\n        var oldStyles = line.styles;\n        var resetState = line.text.length > cm.options.maxHighlightLength ? copyState(doc.mode, context.state) : null;\n        var highlighted = highlightLine(cm, line, context, true);\n        if (resetState) { context.state = resetState; }\n        line.styles = highlighted.styles;\n        var oldCls = line.styleClasses, newCls = highlighted.classes;\n        if (newCls) { line.styleClasses = newCls; }\n        else if (oldCls) { line.styleClasses = null; }\n        var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n          oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n        for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i]; }\n        if (ischange) { changedLines.push(context.line); }\n        line.stateAfter = context.save();\n        context.nextLine();\n      } else {\n        if (line.text.length <= cm.options.maxHighlightLength)\n          { processLine(cm, line.text, context); }\n        line.stateAfter = context.line % 5 == 0 ? context.save() : null;\n        context.nextLine();\n      }\n      if (+new Date > end) {\n        startWorker(cm, cm.options.workDelay);\n        return true\n      }\n    });\n    doc.highlightFrontier = context.line;\n    doc.modeFrontier = Math.max(doc.modeFrontier, context.line);\n    if (changedLines.length) { runInOp(cm, function () {\n      for (var i = 0; i < changedLines.length; i++)\n        { regLineChange(cm, changedLines[i], \"text\"); }\n    }); }\n  }\n\n  // DISPLAY DRAWING\n\n  var DisplayUpdate = function(cm, viewport, force) {\n    var display = cm.display;\n\n    this.viewport = viewport;\n    // Store some values that we'll need later (but don't want to force a relayout for)\n    this.visible = visibleLines(display, cm.doc, viewport);\n    this.editorIsHidden = !display.wrapper.offsetWidth;\n    this.wrapperHeight = display.wrapper.clientHeight;\n    this.wrapperWidth = display.wrapper.clientWidth;\n    this.oldDisplayWidth = displayWidth(cm);\n    this.force = force;\n    this.dims = getDimensions(cm);\n    this.events = [];\n  };\n\n  DisplayUpdate.prototype.signal = function (emitter, type) {\n    if (hasHandler(emitter, type))\n      { this.events.push(arguments); }\n  };\n  DisplayUpdate.prototype.finish = function () {\n      var this$1 = this;\n\n    for (var i = 0; i < this.events.length; i++)\n      { signal.apply(null, this$1.events[i]); }\n  };\n\n  function maybeClipScrollbars(cm) {\n    var display = cm.display;\n    if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n      display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n      display.heightForcer.style.height = scrollGap(cm) + \"px\";\n      display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n      display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n      display.scrollbarsClipped = true;\n    }\n  }\n\n  function selectionSnapshot(cm) {\n    if (cm.hasFocus()) { return null }\n    var active = activeElt();\n    if (!active || !contains(cm.display.lineDiv, active)) { return null }\n    var result = {activeElt: active};\n    if (window.getSelection) {\n      var sel = window.getSelection();\n      if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n        result.anchorNode = sel.anchorNode;\n        result.anchorOffset = sel.anchorOffset;\n        result.focusNode = sel.focusNode;\n        result.focusOffset = sel.focusOffset;\n      }\n    }\n    return result\n  }\n\n  function restoreSelection(snapshot) {\n    if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) { return }\n    snapshot.activeElt.focus();\n    if (snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n      var sel = window.getSelection(), range$$1 = document.createRange();\n      range$$1.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n      range$$1.collapse(false);\n      sel.removeAllRanges();\n      sel.addRange(range$$1);\n      sel.extend(snapshot.focusNode, snapshot.focusOffset);\n    }\n  }\n\n  // Does the actual updating of the line display. Bails out\n  // (returning false) when there is nothing to be done and forced is\n  // false.\n  function updateDisplayIfNeeded(cm, update) {\n    var display = cm.display, doc = cm.doc;\n\n    if (update.editorIsHidden) {\n      resetView(cm);\n      return false\n    }\n\n    // Bail out if the visible area is already rendered and nothing changed.\n    if (!update.force &&\n        update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n        display.renderedView == display.view && countDirtyView(cm) == 0)\n      { return false }\n\n    if (maybeUpdateLineNumberWidth(cm)) {\n      resetView(cm);\n      update.dims = getDimensions(cm);\n    }\n\n    // Compute a suitable new viewport (from & to)\n    var end = doc.first + doc.size;\n    var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n    var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n    if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom); }\n    if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo); }\n    if (sawCollapsedSpans) {\n      from = visualLineNo(cm.doc, from);\n      to = visualLineEndNo(cm.doc, to);\n    }\n\n    var different = from != display.viewFrom || to != display.viewTo ||\n      display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n    adjustView(cm, from, to);\n\n    display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n    // Position the mover div to align with the current scroll position\n    cm.display.mover.style.top = display.viewOffset + \"px\";\n\n    var toUpdate = countDirtyView(cm);\n    if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n      { return false }\n\n    // For big changes, we hide the enclosing element during the\n    // update, since that speeds up the operations on most browsers.\n    var selSnapshot = selectionSnapshot(cm);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"none\"; }\n    patchDisplay(cm, display.updateLineNumbers, update.dims);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"\"; }\n    display.renderedView = display.view;\n    // There might have been a widget with a focused element that got\n    // hidden or updated, if so re-focus it.\n    restoreSelection(selSnapshot);\n\n    // Prevent selection and cursors from interfering with the scroll\n    // width and height.\n    removeChildren(display.cursorDiv);\n    removeChildren(display.selectionDiv);\n    display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n    if (different) {\n      display.lastWrapHeight = update.wrapperHeight;\n      display.lastWrapWidth = update.wrapperWidth;\n      startWorker(cm, 400);\n    }\n\n    display.updateLineNumbers = null;\n\n    return true\n  }\n\n  function postUpdateDisplay(cm, update) {\n    var viewport = update.viewport;\n\n    for (var first = true;; first = false) {\n      if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n        // Clip forced viewport to actual scrollable area.\n        if (viewport && viewport.top != null)\n          { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)}; }\n        // Updated line heights might result in the drawn area not\n        // actually covering the viewport. Keep looping until it does.\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n        if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n          { break }\n      }\n      if (!updateDisplayIfNeeded(cm, update)) { break }\n      updateHeightsInViewport(cm);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.force = false;\n    }\n\n    update.signal(cm, \"update\", cm);\n    if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n      update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n      cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\n    }\n  }\n\n  function updateDisplaySimple(cm, viewport) {\n    var update = new DisplayUpdate(cm, viewport);\n    if (updateDisplayIfNeeded(cm, update)) {\n      updateHeightsInViewport(cm);\n      postUpdateDisplay(cm, update);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.finish();\n    }\n  }\n\n  // Sync the actual display DOM structure with display.view, removing\n  // nodes for lines that are no longer in view, and creating the ones\n  // that are not there yet, and updating the ones that are out of\n  // date.\n  function patchDisplay(cm, updateNumbersFrom, dims) {\n    var display = cm.display, lineNumbers = cm.options.lineNumbers;\n    var container = display.lineDiv, cur = container.firstChild;\n\n    function rm(node) {\n      var next = node.nextSibling;\n      // Works around a throw-scroll bug in OS X Webkit\n      if (webkit && mac && cm.display.currentWheelTarget == node)\n        { node.style.display = \"none\"; }\n      else\n        { node.parentNode.removeChild(node); }\n      return next\n    }\n\n    var view = display.view, lineN = display.viewFrom;\n    // Loop over the elements in the view, syncing cur (the DOM nodes\n    // in display.lineDiv) with the view as we go.\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (lineView.hidden) ; else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\n        var node = buildLineElement(cm, lineView, lineN, dims);\n        container.insertBefore(node, cur);\n      } else { // Already drawn\n        while (cur != lineView.node) { cur = rm(cur); }\n        var updateNumber = lineNumbers && updateNumbersFrom != null &&\n          updateNumbersFrom <= lineN && lineView.lineNumber;\n        if (lineView.changes) {\n          if (indexOf(lineView.changes, \"gutter\") > -1) { updateNumber = false; }\n          updateLineForChanges(cm, lineView, lineN, dims);\n        }\n        if (updateNumber) {\n          removeChildren(lineView.lineNumber);\n          lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n        }\n        cur = lineView.node.nextSibling;\n      }\n      lineN += lineView.size;\n    }\n    while (cur) { cur = rm(cur); }\n  }\n\n  function updateGutterSpace(cm) {\n    var width = cm.display.gutters.offsetWidth;\n    cm.display.sizer.style.marginLeft = width + \"px\";\n  }\n\n  function setDocumentHeight(cm, measure) {\n    cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n    cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n    cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + \"px\";\n  }\n\n  // Rebuild the gutter elements, ensure the margin to the left of the\n  // code matches their width.\n  function updateGutters(cm) {\n    var gutters = cm.display.gutters, specs = cm.options.gutters;\n    removeChildren(gutters);\n    var i = 0;\n    for (; i < specs.length; ++i) {\n      var gutterClass = specs[i];\n      var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + gutterClass));\n      if (gutterClass == \"CodeMirror-linenumbers\") {\n        cm.display.lineGutter = gElt;\n        gElt.style.width = (cm.display.lineNumWidth || 1) + \"px\";\n      }\n    }\n    gutters.style.display = i ? \"\" : \"none\";\n    updateGutterSpace(cm);\n  }\n\n  // Make sure the gutters options contains the element\n  // \"CodeMirror-linenumbers\" when the lineNumbers option is true.\n  function setGuttersForLineNumbers(options) {\n    var found = indexOf(options.gutters, \"CodeMirror-linenumbers\");\n    if (found == -1 && options.lineNumbers) {\n      options.gutters = options.gutters.concat([\"CodeMirror-linenumbers\"]);\n    } else if (found > -1 && !options.lineNumbers) {\n      options.gutters = options.gutters.slice(0);\n      options.gutters.splice(found, 1);\n    }\n  }\n\n  // Since the delta values reported on mouse wheel events are\n  // unstandardized between browsers and even browser versions, and\n  // generally horribly unpredictable, this code starts by measuring\n  // the scroll effect that the first few mouse wheel events have,\n  // and, from that, detects the way it can convert deltas to pixel\n  // offsets afterwards.\n  //\n  // The reason we want to know the amount a wheel event will scroll\n  // is that it gives us a chance to update the display before the\n  // actual scrolling happens, reducing flickering.\n\n  var wheelSamples = 0, wheelPixelsPerUnit = null;\n  // Fill in a browser-detected starting value on browsers where we\n  // know one. These don't have to be accurate -- the result of them\n  // being wrong would just be a slight flicker on the first wheel\n  // scroll (if it is large enough).\n  if (ie) { wheelPixelsPerUnit = -.53; }\n  else if (gecko) { wheelPixelsPerUnit = 15; }\n  else if (chrome) { wheelPixelsPerUnit = -.7; }\n  else if (safari) { wheelPixelsPerUnit = -1/3; }\n\n  function wheelEventDelta(e) {\n    var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail; }\n    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail; }\n    else if (dy == null) { dy = e.wheelDelta; }\n    return {x: dx, y: dy}\n  }\n  function wheelEventPixels(e) {\n    var delta = wheelEventDelta(e);\n    delta.x *= wheelPixelsPerUnit;\n    delta.y *= wheelPixelsPerUnit;\n    return delta\n  }\n\n  function onScrollWheel(cm, e) {\n    var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\n\n    var display = cm.display, scroll = display.scroller;\n    // Quit if there's nothing to scroll here\n    var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n    var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n    if (!(dx && canScrollX || dy && canScrollY)) { return }\n\n    // Webkit browsers on OS X abort momentum scrolls when the target\n    // of the scroll event is removed from the scrollable element.\n    // This hack (see related code in patchDisplay) makes sure the\n    // element is kept around.\n    if (dy && mac && webkit) {\n      outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n        for (var i = 0; i < view.length; i++) {\n          if (view[i].node == cur) {\n            cm.display.currentWheelTarget = cur;\n            break outer\n          }\n        }\n      }\n    }\n\n    // On some browsers, horizontal scrolling will cause redraws to\n    // happen before the gutter has been realigned, causing it to\n    // wriggle around in a most unseemly way. When we have an\n    // estimated pixels/delta value, we just handle horizontal\n    // scrolling entirely here. It'll be slightly off from native, but\n    // better than glitching out.\n    if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n      if (dy && canScrollY)\n        { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit)); }\n      setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit));\n      // Only prevent default scrolling if vertical scrolling is\n      // actually possible. Otherwise, it causes vertical scroll\n      // jitter on OSX trackpads when deltaX is small and deltaY\n      // is large (issue #3579)\n      if (!dy || (dy && canScrollY))\n        { e_preventDefault(e); }\n      display.wheelStartX = null; // Abort measurement, if in progress\n      return\n    }\n\n    // 'Project' the visible viewport to cover the area that is being\n    // scrolled into view (if we know enough to estimate it).\n    if (dy && wheelPixelsPerUnit != null) {\n      var pixels = dy * wheelPixelsPerUnit;\n      var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n      if (pixels < 0) { top = Math.max(0, top + pixels - 50); }\n      else { bot = Math.min(cm.doc.height, bot + pixels + 50); }\n      updateDisplaySimple(cm, {top: top, bottom: bot});\n    }\n\n    if (wheelSamples < 20) {\n      if (display.wheelStartX == null) {\n        display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n        display.wheelDX = dx; display.wheelDY = dy;\n        setTimeout(function () {\n          if (display.wheelStartX == null) { return }\n          var movedX = scroll.scrollLeft - display.wheelStartX;\n          var movedY = scroll.scrollTop - display.wheelStartY;\n          var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n            (movedX && display.wheelDX && movedX / display.wheelDX);\n          display.wheelStartX = display.wheelStartY = null;\n          if (!sample) { return }\n          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n          ++wheelSamples;\n        }, 200);\n      } else {\n        display.wheelDX += dx; display.wheelDY += dy;\n      }\n    }\n  }\n\n  // Selection objects are immutable. A new one is created every time\n  // the selection changes. A selection is one or more non-overlapping\n  // (and non-touching) ranges, sorted, and an integer that indicates\n  // which one is the primary selection (the one that's scrolled into\n  // view, that getCursor returns, etc).\n  var Selection = function(ranges, primIndex) {\n    this.ranges = ranges;\n    this.primIndex = primIndex;\n  };\n\n  Selection.prototype.primary = function () { return this.ranges[this.primIndex] };\n\n  Selection.prototype.equals = function (other) {\n      var this$1 = this;\n\n    if (other == this) { return true }\n    if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var here = this$1.ranges[i], there = other.ranges[i];\n      if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\n    }\n    return true\n  };\n\n  Selection.prototype.deepCopy = function () {\n      var this$1 = this;\n\n    var out = [];\n    for (var i = 0; i < this.ranges.length; i++)\n      { out[i] = new Range(copyPos(this$1.ranges[i].anchor), copyPos(this$1.ranges[i].head)); }\n    return new Selection(out, this.primIndex)\n  };\n\n  Selection.prototype.somethingSelected = function () {\n      var this$1 = this;\n\n    for (var i = 0; i < this.ranges.length; i++)\n      { if (!this$1.ranges[i].empty()) { return true } }\n    return false\n  };\n\n  Selection.prototype.contains = function (pos, end) {\n      var this$1 = this;\n\n    if (!end) { end = pos; }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var range = this$1.ranges[i];\n      if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n        { return i }\n    }\n    return -1\n  };\n\n  var Range = function(anchor, head) {\n    this.anchor = anchor; this.head = head;\n  };\n\n  Range.prototype.from = function () { return minPos(this.anchor, this.head) };\n  Range.prototype.to = function () { return maxPos(this.anchor, this.head) };\n  Range.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\n\n  // Take an unsorted, potentially overlapping set of ranges, and\n  // build a selection out of it. 'Consumes' ranges array (modifying\n  // it).\n  function normalizeSelection(cm, ranges, primIndex) {\n    var mayTouch = cm && cm.options.selectionsMayTouch;\n    var prim = ranges[primIndex];\n    ranges.sort(function (a, b) { return cmp(a.from(), b.from()); });\n    primIndex = indexOf(ranges, prim);\n    for (var i = 1; i < ranges.length; i++) {\n      var cur = ranges[i], prev = ranges[i - 1];\n      var diff = cmp(prev.to(), cur.from());\n      if (mayTouch && !cur.empty() ? diff > 0 : diff >= 0) {\n        var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n        var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n        if (i <= primIndex) { --primIndex; }\n        ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n      }\n    }\n    return new Selection(ranges, primIndex)\n  }\n\n  function simpleSelection(anchor, head) {\n    return new Selection([new Range(anchor, head || anchor)], 0)\n  }\n\n  // Compute the position of the end of a change (its 'to' property\n  // refers to the pre-change end).\n  function changeEnd(change) {\n    if (!change.text) { return change.to }\n    return Pos(change.from.line + change.text.length - 1,\n               lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\n  }\n\n  // Adjust a position to refer to the post-change position of the\n  // same text, or the end of the change if the change covers it.\n  function adjustForChange(pos, change) {\n    if (cmp(pos, change.from) < 0) { return pos }\n    if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\n\n    var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n    if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch; }\n    return Pos(line, ch)\n  }\n\n  function computeSelAfterChange(doc, change) {\n    var out = [];\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      var range = doc.sel.ranges[i];\n      out.push(new Range(adjustForChange(range.anchor, change),\n                         adjustForChange(range.head, change)));\n    }\n    return normalizeSelection(doc.cm, out, doc.sel.primIndex)\n  }\n\n  function offsetPos(pos, old, nw) {\n    if (pos.line == old.line)\n      { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\n    else\n      { return Pos(nw.line + (pos.line - old.line), pos.ch) }\n  }\n\n  // Used by replaceSelections to allow moving the selection to the\n  // start or around the replaced test. Hint may be \"start\" or \"around\".\n  function computeReplacedSel(doc, changes, hint) {\n    var out = [];\n    var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n    for (var i = 0; i < changes.length; i++) {\n      var change = changes[i];\n      var from = offsetPos(change.from, oldPrev, newPrev);\n      var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n      oldPrev = change.to;\n      newPrev = to;\n      if (hint == \"around\") {\n        var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n        out[i] = new Range(inv ? to : from, inv ? from : to);\n      } else {\n        out[i] = new Range(from, from);\n      }\n    }\n    return new Selection(out, doc.sel.primIndex)\n  }\n\n  // Used to get the editor into a consistent state again when options change.\n\n  function loadMode(cm) {\n    cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n    resetModeState(cm);\n  }\n\n  function resetModeState(cm) {\n    cm.doc.iter(function (line) {\n      if (line.stateAfter) { line.stateAfter = null; }\n      if (line.styles) { line.styles = null; }\n    });\n    cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first;\n    startWorker(cm, 100);\n    cm.state.modeGen++;\n    if (cm.curOp) { regChange(cm); }\n  }\n\n  // DOCUMENT DATA STRUCTURE\n\n  // By default, updates that start and end at the beginning of a line\n  // are treated specially, in order to make the association of line\n  // widgets and marker elements with the text behave more intuitive.\n  function isWholeLineUpdate(doc, change) {\n    return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n      (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\n  }\n\n  // Perform a change on the document data structure.\n  function updateDoc(doc, change, markedSpans, estimateHeight$$1) {\n    function spansFor(n) {return markedSpans ? markedSpans[n] : null}\n    function update(line, text, spans) {\n      updateLine(line, text, spans, estimateHeight$$1);\n      signalLater(line, \"change\", line, change);\n    }\n    function linesFor(start, end) {\n      var result = [];\n      for (var i = start; i < end; ++i)\n        { result.push(new Line(text[i], spansFor(i), estimateHeight$$1)); }\n      return result\n    }\n\n    var from = change.from, to = change.to, text = change.text;\n    var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n    var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n    // Adjust the line structure\n    if (change.full) {\n      doc.insert(0, linesFor(0, text.length));\n      doc.remove(text.length, doc.size - text.length);\n    } else if (isWholeLineUpdate(doc, change)) {\n      // This is a whole-line replace. Treated specially to make\n      // sure line objects move the way they are supposed to.\n      var added = linesFor(0, text.length - 1);\n      update(lastLine, lastLine.text, lastSpans);\n      if (nlines) { doc.remove(from.line, nlines); }\n      if (added.length) { doc.insert(from.line, added); }\n    } else if (firstLine == lastLine) {\n      if (text.length == 1) {\n        update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n      } else {\n        var added$1 = linesFor(1, text.length - 1);\n        added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight$$1));\n        update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n        doc.insert(from.line + 1, added$1);\n      }\n    } else if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n      doc.remove(from.line + 1, nlines);\n    } else {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n      var added$2 = linesFor(1, text.length - 1);\n      if (nlines > 1) { doc.remove(from.line + 1, nlines - 1); }\n      doc.insert(from.line + 1, added$2);\n    }\n\n    signalLater(doc, \"change\", doc, change);\n  }\n\n  // Call f for all linked documents.\n  function linkedDocs(doc, f, sharedHistOnly) {\n    function propagate(doc, skip, sharedHist) {\n      if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\n        var rel = doc.linked[i];\n        if (rel.doc == skip) { continue }\n        var shared = sharedHist && rel.sharedHist;\n        if (sharedHistOnly && !shared) { continue }\n        f(rel.doc, shared);\n        propagate(rel.doc, doc, shared);\n      } }\n    }\n    propagate(doc, null, true);\n  }\n\n  // Attach a document to an editor.\n  function attachDoc(cm, doc) {\n    if (doc.cm) { throw new Error(\"This document is already in use.\") }\n    cm.doc = doc;\n    doc.cm = cm;\n    estimateLineHeights(cm);\n    loadMode(cm);\n    setDirectionClass(cm);\n    if (!cm.options.lineWrapping) { findMaxLine(cm); }\n    cm.options.mode = doc.modeOption;\n    regChange(cm);\n  }\n\n  function setDirectionClass(cm) {\n  (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n  }\n\n  function directionChanged(cm) {\n    runInOp(cm, function () {\n      setDirectionClass(cm);\n      regChange(cm);\n    });\n  }\n\n  function History(startGen) {\n    // Arrays of change events and selections. Doing something adds an\n    // event to done and clears undo. Undoing moves events from done\n    // to undone, redoing moves them in the other direction.\n    this.done = []; this.undone = [];\n    this.undoDepth = Infinity;\n    // Used to track when changes can be merged into a single undo\n    // event\n    this.lastModTime = this.lastSelTime = 0;\n    this.lastOp = this.lastSelOp = null;\n    this.lastOrigin = this.lastSelOrigin = null;\n    // Used by the isClean() method\n    this.generation = this.maxGeneration = startGen || 1;\n  }\n\n  // Create a history change event from an updateDoc-style change\n  // object.\n  function historyChangeFromChange(doc, change) {\n    var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n    attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n    linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true);\n    return histChange\n  }\n\n  // Pop all selection events off the end of a history array. Stop at\n  // a change event.\n  function clearSelectionEvents(array) {\n    while (array.length) {\n      var last = lst(array);\n      if (last.ranges) { array.pop(); }\n      else { break }\n    }\n  }\n\n  // Find the top change event in the history. Pop off selection\n  // events that are in the way.\n  function lastChangeEvent(hist, force) {\n    if (force) {\n      clearSelectionEvents(hist.done);\n      return lst(hist.done)\n    } else if (hist.done.length && !lst(hist.done).ranges) {\n      return lst(hist.done)\n    } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n      hist.done.pop();\n      return lst(hist.done)\n    }\n  }\n\n  // Register a change in the history. Merges changes that are within\n  // a single operation, or are close together with an origin that\n  // allows merging (starting with \"+\") into a single event.\n  function addChangeToHistory(doc, change, selAfter, opId) {\n    var hist = doc.history;\n    hist.undone.length = 0;\n    var time = +new Date, cur;\n    var last;\n\n    if ((hist.lastOp == opId ||\n         hist.lastOrigin == change.origin && change.origin &&\n         ((change.origin.charAt(0) == \"+\" && hist.lastModTime > time - (doc.cm ? doc.cm.options.historyEventDelay : 500)) ||\n          change.origin.charAt(0) == \"*\")) &&\n        (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n      // Merge this change into the last event\n      last = lst(cur.changes);\n      if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n        // Optimized case for simple insertion -- don't want to add\n        // new changesets for every character typed\n        last.to = changeEnd(change);\n      } else {\n        // Add new sub-event\n        cur.changes.push(historyChangeFromChange(doc, change));\n      }\n    } else {\n      // Can not be merged, start a new event.\n      var before = lst(hist.done);\n      if (!before || !before.ranges)\n        { pushSelectionToHistory(doc.sel, hist.done); }\n      cur = {changes: [historyChangeFromChange(doc, change)],\n             generation: hist.generation};\n      hist.done.push(cur);\n      while (hist.done.length > hist.undoDepth) {\n        hist.done.shift();\n        if (!hist.done[0].ranges) { hist.done.shift(); }\n      }\n    }\n    hist.done.push(selAfter);\n    hist.generation = ++hist.maxGeneration;\n    hist.lastModTime = hist.lastSelTime = time;\n    hist.lastOp = hist.lastSelOp = opId;\n    hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n    if (!last) { signal(doc, \"historyAdded\"); }\n  }\n\n  function selectionEventCanBeMerged(doc, origin, prev, sel) {\n    var ch = origin.charAt(0);\n    return ch == \"*\" ||\n      ch == \"+\" &&\n      prev.ranges.length == sel.ranges.length &&\n      prev.somethingSelected() == sel.somethingSelected() &&\n      new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\n  }\n\n  // Called whenever the selection changes, sets the new selection as\n  // the pending selection in the history, and pushes the old pending\n  // selection into the 'done' array when it was significantly\n  // different (in number of selected ranges, emptiness, or time).\n  function addSelectionToHistory(doc, sel, opId, options) {\n    var hist = doc.history, origin = options && options.origin;\n\n    // A new event is started when the previous origin does not match\n    // the current, or the origins don't allow matching. Origins\n    // starting with * are always merged, those starting with + are\n    // merged when similar and close together in time.\n    if (opId == hist.lastSelOp ||\n        (origin && hist.lastSelOrigin == origin &&\n         (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n          selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n      { hist.done[hist.done.length - 1] = sel; }\n    else\n      { pushSelectionToHistory(sel, hist.done); }\n\n    hist.lastSelTime = +new Date;\n    hist.lastSelOrigin = origin;\n    hist.lastSelOp = opId;\n    if (options && options.clearRedo !== false)\n      { clearSelectionEvents(hist.undone); }\n  }\n\n  function pushSelectionToHistory(sel, dest) {\n    var top = lst(dest);\n    if (!(top && top.ranges && top.equals(sel)))\n      { dest.push(sel); }\n  }\n\n  // Used to store marked span information in the history.\n  function attachLocalSpans(doc, change, from, to) {\n    var existing = change[\"spans_\" + doc.id], n = 0;\n    doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n      if (line.markedSpans)\n        { (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans; }\n      ++n;\n    });\n  }\n\n  // When un/re-doing restores text containing marked spans, those\n  // that have been explicitly cleared should not be restored.\n  function removeClearedSpans(spans) {\n    if (!spans) { return null }\n    var out;\n    for (var i = 0; i < spans.length; ++i) {\n      if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i); } }\n      else if (out) { out.push(spans[i]); }\n    }\n    return !out ? spans : out.length ? out : null\n  }\n\n  // Retrieve and filter the old marked spans stored in a change event.\n  function getOldSpans(doc, change) {\n    var found = change[\"spans_\" + doc.id];\n    if (!found) { return null }\n    var nw = [];\n    for (var i = 0; i < change.text.length; ++i)\n      { nw.push(removeClearedSpans(found[i])); }\n    return nw\n  }\n\n  // Used for un/re-doing changes from the history. Combines the\n  // result of computing the existing spans with the set of spans that\n  // existed in the history (so that deleting around a span and then\n  // undoing brings back the span).\n  function mergeOldSpans(doc, change) {\n    var old = getOldSpans(doc, change);\n    var stretched = stretchSpansOverChange(doc, change);\n    if (!old) { return stretched }\n    if (!stretched) { return old }\n\n    for (var i = 0; i < old.length; ++i) {\n      var oldCur = old[i], stretchCur = stretched[i];\n      if (oldCur && stretchCur) {\n        spans: for (var j = 0; j < stretchCur.length; ++j) {\n          var span = stretchCur[j];\n          for (var k = 0; k < oldCur.length; ++k)\n            { if (oldCur[k].marker == span.marker) { continue spans } }\n          oldCur.push(span);\n        }\n      } else if (stretchCur) {\n        old[i] = stretchCur;\n      }\n    }\n    return old\n  }\n\n  // Used both to provide a JSON-safe object in .getHistory, and, when\n  // detaching a document, to split the history in two\n  function copyHistoryArray(events, newGroup, instantiateSel) {\n    var copy = [];\n    for (var i = 0; i < events.length; ++i) {\n      var event = events[i];\n      if (event.ranges) {\n        copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n        continue\n      }\n      var changes = event.changes, newChanges = [];\n      copy.push({changes: newChanges});\n      for (var j = 0; j < changes.length; ++j) {\n        var change = changes[j], m = (void 0);\n        newChanges.push({from: change.from, to: change.to, text: change.text});\n        if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\n          if (indexOf(newGroup, Number(m[1])) > -1) {\n            lst(newChanges)[prop] = change[prop];\n            delete change[prop];\n          }\n        } } }\n      }\n    }\n    return copy\n  }\n\n  // The 'scroll' parameter given to many of these indicated whether\n  // the new cursor position should be scrolled into view after\n  // modifying the selection.\n\n  // If shift is held or the extend flag is set, extends a range to\n  // include a given position (and optionally a second position).\n  // Otherwise, simply returns the range between the given positions.\n  // Used for cursor motion and such.\n  function extendRange(range, head, other, extend) {\n    if (extend) {\n      var anchor = range.anchor;\n      if (other) {\n        var posBefore = cmp(head, anchor) < 0;\n        if (posBefore != (cmp(other, anchor) < 0)) {\n          anchor = head;\n          head = other;\n        } else if (posBefore != (cmp(head, other) < 0)) {\n          head = other;\n        }\n      }\n      return new Range(anchor, head)\n    } else {\n      return new Range(other || head, head)\n    }\n  }\n\n  // Extend the primary selection range, discard the rest.\n  function extendSelection(doc, head, other, options, extend) {\n    if (extend == null) { extend = doc.cm && (doc.cm.display.shift || doc.extend); }\n    setSelection(doc, new Selection([extendRange(doc.sel.primary(), head, other, extend)], 0), options);\n  }\n\n  // Extend all selections (pos is an array of selections with length\n  // equal the number of selections)\n  function extendSelections(doc, heads, options) {\n    var out = [];\n    var extend = doc.cm && (doc.cm.display.shift || doc.extend);\n    for (var i = 0; i < doc.sel.ranges.length; i++)\n      { out[i] = extendRange(doc.sel.ranges[i], heads[i], null, extend); }\n    var newSel = normalizeSelection(doc.cm, out, doc.sel.primIndex);\n    setSelection(doc, newSel, options);\n  }\n\n  // Updates a single range in the selection.\n  function replaceOneSelection(doc, i, range, options) {\n    var ranges = doc.sel.ranges.slice(0);\n    ranges[i] = range;\n    setSelection(doc, normalizeSelection(doc.cm, ranges, doc.sel.primIndex), options);\n  }\n\n  // Reset the selection to a single range.\n  function setSimpleSelection(doc, anchor, head, options) {\n    setSelection(doc, simpleSelection(anchor, head), options);\n  }\n\n  // Give beforeSelectionChange handlers a change to influence a\n  // selection update.\n  function filterSelectionChange(doc, sel, options) {\n    var obj = {\n      ranges: sel.ranges,\n      update: function(ranges) {\n        var this$1 = this;\n\n        this.ranges = [];\n        for (var i = 0; i < ranges.length; i++)\n          { this$1.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                     clipPos(doc, ranges[i].head)); }\n      },\n      origin: options && options.origin\n    };\n    signal(doc, \"beforeSelectionChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj); }\n    if (obj.ranges != sel.ranges) { return normalizeSelection(doc.cm, obj.ranges, obj.ranges.length - 1) }\n    else { return sel }\n  }\n\n  function setSelectionReplaceHistory(doc, sel, options) {\n    var done = doc.history.done, last = lst(done);\n    if (last && last.ranges) {\n      done[done.length - 1] = sel;\n      setSelectionNoUndo(doc, sel, options);\n    } else {\n      setSelection(doc, sel, options);\n    }\n  }\n\n  // Set a new selection.\n  function setSelection(doc, sel, options) {\n    setSelectionNoUndo(doc, sel, options);\n    addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n  }\n\n  function setSelectionNoUndo(doc, sel, options) {\n    if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n      { sel = filterSelectionChange(doc, sel, options); }\n\n    var bias = options && options.bias ||\n      (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n    setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n    if (!(options && options.scroll === false) && doc.cm)\n      { ensureCursorVisible(doc.cm); }\n  }\n\n  function setSelectionInner(doc, sel) {\n    if (sel.equals(doc.sel)) { return }\n\n    doc.sel = sel;\n\n    if (doc.cm) {\n      doc.cm.curOp.updateInput = 1;\n      doc.cm.curOp.selectionChanged = true;\n      signalCursorActivity(doc.cm);\n    }\n    signalLater(doc, \"cursorActivity\", doc);\n  }\n\n  // Verify that the selection does not partially select any atomic\n  // marked ranges.\n  function reCheckSelection(doc) {\n    setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n  }\n\n  // Return a selection that does not partially select any atomic\n  // ranges.\n  function skipAtomicInSelection(doc, sel, bias, mayClear) {\n    var out;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range = sel.ranges[i];\n      var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n      var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n      var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n      if (out || newAnchor != range.anchor || newHead != range.head) {\n        if (!out) { out = sel.ranges.slice(0, i); }\n        out[i] = new Range(newAnchor, newHead);\n      }\n    }\n    return out ? normalizeSelection(doc.cm, out, sel.primIndex) : sel\n  }\n\n  function skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n    var line = getLine(doc, pos.line);\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n      var sp = line.markedSpans[i], m = sp.marker;\n      if ((sp.from == null || (m.inclusiveLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\n          (sp.to == null || (m.inclusiveRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n        if (mayClear) {\n          signal(m, \"beforeCursorEnter\");\n          if (m.explicitlyCleared) {\n            if (!line.markedSpans) { break }\n            else {--i; continue}\n          }\n        }\n        if (!m.atomic) { continue }\n\n        if (oldPos) {\n          var near = m.find(dir < 0 ? 1 : -1), diff = (void 0);\n          if (dir < 0 ? m.inclusiveRight : m.inclusiveLeft)\n            { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null); }\n          if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\n            { return skipAtomicInner(doc, near, pos, dir, mayClear) }\n        }\n\n        var far = m.find(dir < 0 ? -1 : 1);\n        if (dir < 0 ? m.inclusiveLeft : m.inclusiveRight)\n          { far = movePos(doc, far, dir, far.line == pos.line ? line : null); }\n        return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\n      }\n    } }\n    return pos\n  }\n\n  // Ensure a given position is not inside an atomic range.\n  function skipAtomic(doc, pos, oldPos, bias, mayClear) {\n    var dir = bias || 1;\n    var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\n        skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true));\n    if (!found) {\n      doc.cantEdit = true;\n      return Pos(doc.first, 0)\n    }\n    return found\n  }\n\n  function movePos(doc, pos, dir, line) {\n    if (dir < 0 && pos.ch == 0) {\n      if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\n      else { return null }\n    } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n      if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\n      else { return null }\n    } else {\n      return new Pos(pos.line, pos.ch + dir)\n    }\n  }\n\n  function selectAll(cm) {\n    cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n  }\n\n  // UPDATING\n\n  // Allow \"beforeChange\" event handlers to influence a change\n  function filterChange(doc, change, update) {\n    var obj = {\n      canceled: false,\n      from: change.from,\n      to: change.to,\n      text: change.text,\n      origin: change.origin,\n      cancel: function () { return obj.canceled = true; }\n    };\n    if (update) { obj.update = function (from, to, text, origin) {\n      if (from) { obj.from = clipPos(doc, from); }\n      if (to) { obj.to = clipPos(doc, to); }\n      if (text) { obj.text = text; }\n      if (origin !== undefined) { obj.origin = origin; }\n    }; }\n    signal(doc, \"beforeChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeChange\", doc.cm, obj); }\n\n    if (obj.canceled) {\n      if (doc.cm) { doc.cm.curOp.updateInput = 2; }\n      return null\n    }\n    return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\n  }\n\n  // Apply a change to a document, and add it to the document's\n  // history, and propagating it to all linked documents.\n  function makeChange(doc, change, ignoreReadOnly) {\n    if (doc.cm) {\n      if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\n      if (doc.cm.state.suppressEdits) { return }\n    }\n\n    if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n      change = filterChange(doc, change, true);\n      if (!change) { return }\n    }\n\n    // Possibly split or suppress the update based on the presence\n    // of read-only spans in its range.\n    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n    if (split) {\n      for (var i = split.length - 1; i >= 0; --i)\n        { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text, origin: change.origin}); }\n    } else {\n      makeChangeInner(doc, change);\n    }\n  }\n\n  function makeChangeInner(doc, change) {\n    if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) { return }\n    var selAfter = computeSelAfterChange(doc, change);\n    addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n    var rebased = [];\n\n    linkedDocs(doc, function (doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n    });\n  }\n\n  // Revert a change stored in a document's history.\n  function makeChangeFromHistory(doc, type, allowSelectionOnly) {\n    var suppress = doc.cm && doc.cm.state.suppressEdits;\n    if (suppress && !allowSelectionOnly) { return }\n\n    var hist = doc.history, event, selAfter = doc.sel;\n    var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n    // Verify that there is a useable event (so that ctrl-z won't\n    // needlessly clear selection events)\n    var i = 0;\n    for (; i < source.length; i++) {\n      event = source[i];\n      if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n        { break }\n    }\n    if (i == source.length) { return }\n    hist.lastOrigin = hist.lastSelOrigin = null;\n\n    for (;;) {\n      event = source.pop();\n      if (event.ranges) {\n        pushSelectionToHistory(event, dest);\n        if (allowSelectionOnly && !event.equals(doc.sel)) {\n          setSelection(doc, event, {clearRedo: false});\n          return\n        }\n        selAfter = event;\n      } else if (suppress) {\n        source.push(event);\n        return\n      } else { break }\n    }\n\n    // Build up a reverse change object to add to the opposite history\n    // stack (redo when undoing, and vice versa).\n    var antiChanges = [];\n    pushSelectionToHistory(selAfter, dest);\n    dest.push({changes: antiChanges, generation: hist.generation});\n    hist.generation = event.generation || ++hist.maxGeneration;\n\n    var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n    var loop = function ( i ) {\n      var change = event.changes[i];\n      change.origin = type;\n      if (filter && !filterChange(doc, change, false)) {\n        source.length = 0;\n        return {}\n      }\n\n      antiChanges.push(historyChangeFromChange(doc, change));\n\n      var after = i ? computeSelAfterChange(doc, change) : lst(source);\n      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n      if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}); }\n      var rebased = [];\n\n      // Propagate to the linked documents\n      linkedDocs(doc, function (doc, sharedHist) {\n        if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n          rebaseHist(doc.history, change);\n          rebased.push(doc.history);\n        }\n        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n      });\n    };\n\n    for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n      var returned = loop( i$1 );\n\n      if ( returned ) return returned.v;\n    }\n  }\n\n  // Sub-views need their line numbers shifted when text is added\n  // above or below them in the parent document.\n  function shiftDoc(doc, distance) {\n    if (distance == 0) { return }\n    doc.first += distance;\n    doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\n      Pos(range.anchor.line + distance, range.anchor.ch),\n      Pos(range.head.line + distance, range.head.ch)\n    ); }), doc.sel.primIndex);\n    if (doc.cm) {\n      regChange(doc.cm, doc.first, doc.first - distance, distance);\n      for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n        { regLineChange(doc.cm, l, \"gutter\"); }\n    }\n  }\n\n  // More lower-level change function, handling only a single document\n  // (not linked ones).\n  function makeChangeSingleDoc(doc, change, selAfter, spans) {\n    if (doc.cm && !doc.cm.curOp)\n      { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\n\n    if (change.to.line < doc.first) {\n      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n      return\n    }\n    if (change.from.line > doc.lastLine()) { return }\n\n    // Clip the change to the size of this doc\n    if (change.from.line < doc.first) {\n      var shift = change.text.length - 1 - (doc.first - change.from.line);\n      shiftDoc(doc, shift);\n      change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n                text: [lst(change.text)], origin: change.origin};\n    }\n    var last = doc.lastLine();\n    if (change.to.line > last) {\n      change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n                text: [change.text[0]], origin: change.origin};\n    }\n\n    change.removed = getBetween(doc, change.from, change.to);\n\n    if (!selAfter) { selAfter = computeSelAfterChange(doc, change); }\n    if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans); }\n    else { updateDoc(doc, change, spans); }\n    setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n  }\n\n  // Handle the interaction of a change to a document with the editor\n  // that this document is part of.\n  function makeChangeSingleDocInEditor(cm, change, spans) {\n    var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n    var recomputeMaxLength = false, checkWidthStart = from.line;\n    if (!cm.options.lineWrapping) {\n      checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n      doc.iter(checkWidthStart, to.line + 1, function (line) {\n        if (line == display.maxLine) {\n          recomputeMaxLength = true;\n          return true\n        }\n      });\n    }\n\n    if (doc.sel.contains(change.from, change.to) > -1)\n      { signalCursorActivity(cm); }\n\n    updateDoc(doc, change, spans, estimateHeight(cm));\n\n    if (!cm.options.lineWrapping) {\n      doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n        var len = lineLength(line);\n        if (len > display.maxLineLength) {\n          display.maxLine = line;\n          display.maxLineLength = len;\n          display.maxLineChanged = true;\n          recomputeMaxLength = false;\n        }\n      });\n      if (recomputeMaxLength) { cm.curOp.updateMaxLine = true; }\n    }\n\n    retreatFrontier(doc, from.line);\n    startWorker(cm, 400);\n\n    var lendiff = change.text.length - (to.line - from.line) - 1;\n    // Remember that these lines changed, for updating the display\n    if (change.full)\n      { regChange(cm); }\n    else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n      { regLineChange(cm, from.line, \"text\"); }\n    else\n      { regChange(cm, from.line, to.line + 1, lendiff); }\n\n    var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n    if (changeHandler || changesHandler) {\n      var obj = {\n        from: from, to: to,\n        text: change.text,\n        removed: change.removed,\n        origin: change.origin\n      };\n      if (changeHandler) { signalLater(cm, \"change\", cm, obj); }\n      if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj); }\n    }\n    cm.display.selForContextMenu = null;\n  }\n\n  function replaceRange(doc, code, from, to, origin) {\n    var assign;\n\n    if (!to) { to = from; }\n    if (cmp(to, from) < 0) { (assign = [to, from], from = assign[0], to = assign[1]); }\n    if (typeof code == \"string\") { code = doc.splitLines(code); }\n    makeChange(doc, {from: from, to: to, text: code, origin: origin});\n  }\n\n  // Rebasing/resetting history to deal with externally-sourced changes\n\n  function rebaseHistSelSingle(pos, from, to, diff) {\n    if (to < pos.line) {\n      pos.line += diff;\n    } else if (from < pos.line) {\n      pos.line = from;\n      pos.ch = 0;\n    }\n  }\n\n  // Tries to rebase an array of history events given a change in the\n  // document. If the change touches the same lines as the event, the\n  // event, and everything 'behind' it, is discarded. If the change is\n  // before the event, the event's positions are updated. Uses a\n  // copy-on-write scheme for the positions, to avoid having to\n  // reallocate them all on every rebase, but also avoid problems with\n  // shared position objects being unsafely updated.\n  function rebaseHistArray(array, from, to, diff) {\n    for (var i = 0; i < array.length; ++i) {\n      var sub = array[i], ok = true;\n      if (sub.ranges) {\n        if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n        for (var j = 0; j < sub.ranges.length; j++) {\n          rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n          rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n        }\n        continue\n      }\n      for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n        var cur = sub.changes[j$1];\n        if (to < cur.from.line) {\n          cur.from = Pos(cur.from.line + diff, cur.from.ch);\n          cur.to = Pos(cur.to.line + diff, cur.to.ch);\n        } else if (from <= cur.to.line) {\n          ok = false;\n          break\n        }\n      }\n      if (!ok) {\n        array.splice(0, i + 1);\n        i = 0;\n      }\n    }\n  }\n\n  function rebaseHist(hist, change) {\n    var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n    rebaseHistArray(hist.done, from, to, diff);\n    rebaseHistArray(hist.undone, from, to, diff);\n  }\n\n  // Utility for applying a change to a line by handle or number,\n  // returning the number and optionally registering the line as\n  // changed.\n  function changeLine(doc, handle, changeType, op) {\n    var no = handle, line = handle;\n    if (typeof handle == \"number\") { line = getLine(doc, clipLine(doc, handle)); }\n    else { no = lineNo(handle); }\n    if (no == null) { return null }\n    if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType); }\n    return line\n  }\n\n  // The document is represented as a BTree consisting of leaves, with\n  // chunk of lines in them, and branches, with up to ten leaves or\n  // other branch nodes below them. The top node is always a branch\n  // node, and is the document object itself (meaning it has\n  // additional methods and properties).\n  //\n  // All nodes have parent links. The tree is used both to go from\n  // line numbers to line objects, and to go from objects to numbers.\n  // It also indexes by height, and is used to convert between height\n  // and line object, and to find the total height of the document.\n  //\n  // See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\n  function LeafChunk(lines) {\n    var this$1 = this;\n\n    this.lines = lines;\n    this.parent = null;\n    var height = 0;\n    for (var i = 0; i < lines.length; ++i) {\n      lines[i].parent = this$1;\n      height += lines[i].height;\n    }\n    this.height = height;\n  }\n\n  LeafChunk.prototype = {\n    chunkSize: function() { return this.lines.length },\n\n    // Remove the n lines at offset 'at'.\n    removeInner: function(at, n) {\n      var this$1 = this;\n\n      for (var i = at, e = at + n; i < e; ++i) {\n        var line = this$1.lines[i];\n        this$1.height -= line.height;\n        cleanUpLine(line);\n        signalLater(line, \"delete\");\n      }\n      this.lines.splice(at, n);\n    },\n\n    // Helper used to collapse a small branch into a single leaf.\n    collapse: function(lines) {\n      lines.push.apply(lines, this.lines);\n    },\n\n    // Insert the given array of lines at offset 'at', count them as\n    // having the given height.\n    insertInner: function(at, lines, height) {\n      var this$1 = this;\n\n      this.height += height;\n      this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n      for (var i = 0; i < lines.length; ++i) { lines[i].parent = this$1; }\n    },\n\n    // Used to iterate over a part of the tree.\n    iterN: function(at, n, op) {\n      var this$1 = this;\n\n      for (var e = at + n; at < e; ++at)\n        { if (op(this$1.lines[at])) { return true } }\n    }\n  };\n\n  function BranchChunk(children) {\n    var this$1 = this;\n\n    this.children = children;\n    var size = 0, height = 0;\n    for (var i = 0; i < children.length; ++i) {\n      var ch = children[i];\n      size += ch.chunkSize(); height += ch.height;\n      ch.parent = this$1;\n    }\n    this.size = size;\n    this.height = height;\n    this.parent = null;\n  }\n\n  BranchChunk.prototype = {\n    chunkSize: function() { return this.size },\n\n    removeInner: function(at, n) {\n      var this$1 = this;\n\n      this.size -= n;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this$1.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var rm = Math.min(n, sz - at), oldHeight = child.height;\n          child.removeInner(at, rm);\n          this$1.height -= oldHeight - child.height;\n          if (sz == rm) { this$1.children.splice(i--, 1); child.parent = null; }\n          if ((n -= rm) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n      // If the result is smaller than 25 lines, ensure that it is a\n      // single leaf node.\n      if (this.size - n < 25 &&\n          (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n        var lines = [];\n        this.collapse(lines);\n        this.children = [new LeafChunk(lines)];\n        this.children[0].parent = this;\n      }\n    },\n\n    collapse: function(lines) {\n      var this$1 = this;\n\n      for (var i = 0; i < this.children.length; ++i) { this$1.children[i].collapse(lines); }\n    },\n\n    insertInner: function(at, lines, height) {\n      var this$1 = this;\n\n      this.size += lines.length;\n      this.height += height;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this$1.children[i], sz = child.chunkSize();\n        if (at <= sz) {\n          child.insertInner(at, lines, height);\n          if (child.lines && child.lines.length > 50) {\n            // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n            // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n            var remaining = child.lines.length % 25 + 25;\n            for (var pos = remaining; pos < child.lines.length;) {\n              var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n              child.height -= leaf.height;\n              this$1.children.splice(++i, 0, leaf);\n              leaf.parent = this$1;\n            }\n            child.lines = child.lines.slice(0, remaining);\n            this$1.maybeSpill();\n          }\n          break\n        }\n        at -= sz;\n      }\n    },\n\n    // When a node has grown, check whether it should be split.\n    maybeSpill: function() {\n      if (this.children.length <= 10) { return }\n      var me = this;\n      do {\n        var spilled = me.children.splice(me.children.length - 5, 5);\n        var sibling = new BranchChunk(spilled);\n        if (!me.parent) { // Become the parent node\n          var copy = new BranchChunk(me.children);\n          copy.parent = me;\n          me.children = [copy, sibling];\n          me = copy;\n       } else {\n          me.size -= sibling.size;\n          me.height -= sibling.height;\n          var myIndex = indexOf(me.parent.children, me);\n          me.parent.children.splice(myIndex + 1, 0, sibling);\n        }\n        sibling.parent = me.parent;\n      } while (me.children.length > 10)\n      me.parent.maybeSpill();\n    },\n\n    iterN: function(at, n, op) {\n      var this$1 = this;\n\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this$1.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var used = Math.min(n, sz - at);\n          if (child.iterN(at, used, op)) { return true }\n          if ((n -= used) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n    }\n  };\n\n  // Line widgets are block elements displayed above or below a line.\n\n  var LineWidget = function(doc, node, options) {\n    var this$1 = this;\n\n    if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\n      { this$1[opt] = options[opt]; } } }\n    this.doc = doc;\n    this.node = node;\n  };\n\n  LineWidget.prototype.clear = function () {\n      var this$1 = this;\n\n    var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n    if (no == null || !ws) { return }\n    for (var i = 0; i < ws.length; ++i) { if (ws[i] == this$1) { ws.splice(i--, 1); } }\n    if (!ws.length) { line.widgets = null; }\n    var height = widgetHeight(this);\n    updateLineHeight(line, Math.max(0, line.height - height));\n    if (cm) {\n      runInOp(cm, function () {\n        adjustScrollWhenAboveVisible(cm, line, -height);\n        regLineChange(cm, no, \"widget\");\n      });\n      signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n    }\n  };\n\n  LineWidget.prototype.changed = function () {\n      var this$1 = this;\n\n    var oldH = this.height, cm = this.doc.cm, line = this.line;\n    this.height = null;\n    var diff = widgetHeight(this) - oldH;\n    if (!diff) { return }\n    if (!lineIsHidden(this.doc, line)) { updateLineHeight(line, line.height + diff); }\n    if (cm) {\n      runInOp(cm, function () {\n        cm.curOp.forceUpdate = true;\n        adjustScrollWhenAboveVisible(cm, line, diff);\n        signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n      });\n    }\n  };\n  eventMixin(LineWidget);\n\n  function adjustScrollWhenAboveVisible(cm, line, diff) {\n    if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n      { addToScrollTop(cm, diff); }\n  }\n\n  function addLineWidget(doc, handle, node, options) {\n    var widget = new LineWidget(doc, node, options);\n    var cm = doc.cm;\n    if (cm && widget.noHScroll) { cm.display.alignWidgets = true; }\n    changeLine(doc, handle, \"widget\", function (line) {\n      var widgets = line.widgets || (line.widgets = []);\n      if (widget.insertAt == null) { widgets.push(widget); }\n      else { widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget); }\n      widget.line = line;\n      if (cm && !lineIsHidden(doc, line)) {\n        var aboveVisible = heightAtLine(line) < doc.scrollTop;\n        updateLineHeight(line, line.height + widgetHeight(widget));\n        if (aboveVisible) { addToScrollTop(cm, widget.height); }\n        cm.curOp.forceUpdate = true;\n      }\n      return true\n    });\n    if (cm) { signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle)); }\n    return widget\n  }\n\n  // TEXTMARKERS\n\n  // Created with markText and setBookmark methods. A TextMarker is a\n  // handle that can be used to clear or find a marked position in the\n  // document. Line objects hold arrays (markedSpans) containing\n  // {from, to, marker} object pointing to such marker objects, and\n  // indicating that such a marker is present on that line. Multiple\n  // lines may point to the same marker when it spans across lines.\n  // The spans will have null for their from/to properties when the\n  // marker continues beyond the start/end of the line. Markers have\n  // links back to the lines they currently touch.\n\n  // Collapsed markers have unique ids, in order to be able to order\n  // them, which is needed for uniquely determining an outer marker\n  // when they overlap (they may nest, but not partially overlap).\n  var nextMarkerId = 0;\n\n  var TextMarker = function(doc, type) {\n    this.lines = [];\n    this.type = type;\n    this.doc = doc;\n    this.id = ++nextMarkerId;\n  };\n\n  // Clear the marker.\n  TextMarker.prototype.clear = function () {\n      var this$1 = this;\n\n    if (this.explicitlyCleared) { return }\n    var cm = this.doc.cm, withOp = cm && !cm.curOp;\n    if (withOp) { startOperation(cm); }\n    if (hasHandler(this, \"clear\")) {\n      var found = this.find();\n      if (found) { signalLater(this, \"clear\", found.from, found.to); }\n    }\n    var min = null, max = null;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this$1.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this$1);\n      if (cm && !this$1.collapsed) { regLineChange(cm, lineNo(line), \"text\"); }\n      else if (cm) {\n        if (span.to != null) { max = lineNo(line); }\n        if (span.from != null) { min = lineNo(line); }\n      }\n      line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n      if (span.from == null && this$1.collapsed && !lineIsHidden(this$1.doc, line) && cm)\n        { updateLineHeight(line, textHeight(cm.display)); }\n    }\n    if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n      var visual = visualLine(this$1.lines[i$1]), len = lineLength(visual);\n      if (len > cm.display.maxLineLength) {\n        cm.display.maxLine = visual;\n        cm.display.maxLineLength = len;\n        cm.display.maxLineChanged = true;\n      }\n    } }\n\n    if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1); }\n    this.lines.length = 0;\n    this.explicitlyCleared = true;\n    if (this.atomic && this.doc.cantEdit) {\n      this.doc.cantEdit = false;\n      if (cm) { reCheckSelection(cm.doc); }\n    }\n    if (cm) { signalLater(cm, \"markerCleared\", cm, this, min, max); }\n    if (withOp) { endOperation(cm); }\n    if (this.parent) { this.parent.clear(); }\n  };\n\n  // Find the position of the marker in the document. Returns a {from,\n  // to} object by default. Side can be passed to get a specific side\n  // -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n  // Pos objects returned contain a line object, rather than a line\n  // number (used to prevent looking up the same line twice).\n  TextMarker.prototype.find = function (side, lineObj) {\n      var this$1 = this;\n\n    if (side == null && this.type == \"bookmark\") { side = 1; }\n    var from, to;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this$1.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this$1);\n      if (span.from != null) {\n        from = Pos(lineObj ? line : lineNo(line), span.from);\n        if (side == -1) { return from }\n      }\n      if (span.to != null) {\n        to = Pos(lineObj ? line : lineNo(line), span.to);\n        if (side == 1) { return to }\n      }\n    }\n    return from && {from: from, to: to}\n  };\n\n  // Signals that the marker's widget changed, and surrounding layout\n  // should be recomputed.\n  TextMarker.prototype.changed = function () {\n      var this$1 = this;\n\n    var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n    if (!pos || !cm) { return }\n    runInOp(cm, function () {\n      var line = pos.line, lineN = lineNo(pos.line);\n      var view = findViewForLine(cm, lineN);\n      if (view) {\n        clearLineMeasurementCacheFor(view);\n        cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n      }\n      cm.curOp.updateMaxLine = true;\n      if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n        var oldHeight = widget.height;\n        widget.height = null;\n        var dHeight = widgetHeight(widget) - oldHeight;\n        if (dHeight)\n          { updateLineHeight(line, line.height + dHeight); }\n      }\n      signalLater(cm, \"markerChanged\", cm, this$1);\n    });\n  };\n\n  TextMarker.prototype.attachLine = function (line) {\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n        { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this); }\n    }\n    this.lines.push(line);\n  };\n\n  TextMarker.prototype.detachLine = function (line) {\n    this.lines.splice(indexOf(this.lines, line), 1);\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp\n      ;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n    }\n  };\n  eventMixin(TextMarker);\n\n  // Create a marker, wire it up to the right lines, and\n  function markText(doc, from, to, options, type) {\n    // Shared markers (across linked documents) are handled separately\n    // (markTextShared will call out to this again, once per\n    // document).\n    if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\n    // Ensure we are in an operation.\n    if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\n\n    var marker = new TextMarker(doc, type), diff = cmp(from, to);\n    if (options) { copyObj(options, marker, false); }\n    // Don't connect empty markers unless clearWhenEmpty is false\n    if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n      { return marker }\n    if (marker.replacedWith) {\n      // Showing up as a widget implies collapsed (widget replaces text)\n      marker.collapsed = true;\n      marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n      if (!options.handleMouseEvents) { marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\"); }\n      if (options.insertLeft) { marker.widgetNode.insertLeft = true; }\n    }\n    if (marker.collapsed) {\n      if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n          from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n        { throw new Error(\"Inserting collapsed marker partially overlapping an existing one\") }\n      seeCollapsedSpans();\n    }\n\n    if (marker.addToHistory)\n      { addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN); }\n\n    var curLine = from.line, cm = doc.cm, updateMaxLine;\n    doc.iter(curLine, to.line + 1, function (line) {\n      if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n        { updateMaxLine = true; }\n      if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0); }\n      addMarkedSpan(line, new MarkedSpan(marker,\n                                         curLine == from.line ? from.ch : null,\n                                         curLine == to.line ? to.ch : null));\n      ++curLine;\n    });\n    // lineIsHidden depends on the presence of the spans, so needs a second pass\n    if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\n      if (lineIsHidden(doc, line)) { updateLineHeight(line, 0); }\n    }); }\n\n    if (marker.clearOnEnter) { on(marker, \"beforeCursorEnter\", function () { return marker.clear(); }); }\n\n    if (marker.readOnly) {\n      seeReadOnlySpans();\n      if (doc.history.done.length || doc.history.undone.length)\n        { doc.clearHistory(); }\n    }\n    if (marker.collapsed) {\n      marker.id = ++nextMarkerId;\n      marker.atomic = true;\n    }\n    if (cm) {\n      // Sync editor state\n      if (updateMaxLine) { cm.curOp.updateMaxLine = true; }\n      if (marker.collapsed)\n        { regChange(cm, from.line, to.line + 1); }\n      else if (marker.className || marker.startStyle || marker.endStyle || marker.css ||\n               marker.attributes || marker.title)\n        { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, \"text\"); } }\n      if (marker.atomic) { reCheckSelection(cm.doc); }\n      signalLater(cm, \"markerAdded\", cm, marker);\n    }\n    return marker\n  }\n\n  // SHARED TEXTMARKERS\n\n  // A shared marker spans multiple linked documents. It is\n  // implemented as a meta-marker-object controlling multiple normal\n  // markers.\n  var SharedTextMarker = function(markers, primary) {\n    var this$1 = this;\n\n    this.markers = markers;\n    this.primary = primary;\n    for (var i = 0; i < markers.length; ++i)\n      { markers[i].parent = this$1; }\n  };\n\n  SharedTextMarker.prototype.clear = function () {\n      var this$1 = this;\n\n    if (this.explicitlyCleared) { return }\n    this.explicitlyCleared = true;\n    for (var i = 0; i < this.markers.length; ++i)\n      { this$1.markers[i].clear(); }\n    signalLater(this, \"clear\");\n  };\n\n  SharedTextMarker.prototype.find = function (side, lineObj) {\n    return this.primary.find(side, lineObj)\n  };\n  eventMixin(SharedTextMarker);\n\n  function markTextShared(doc, from, to, options, type) {\n    options = copyObj(options);\n    options.shared = false;\n    var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n    var widget = options.widgetNode;\n    linkedDocs(doc, function (doc) {\n      if (widget) { options.widgetNode = widget.cloneNode(true); }\n      markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n      for (var i = 0; i < doc.linked.length; ++i)\n        { if (doc.linked[i].isParent) { return } }\n      primary = lst(markers);\n    });\n    return new SharedTextMarker(markers, primary)\n  }\n\n  function findSharedMarkers(doc) {\n    return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\n  }\n\n  function copySharedMarkers(doc, markers) {\n    for (var i = 0; i < markers.length; i++) {\n      var marker = markers[i], pos = marker.find();\n      var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n      if (cmp(mFrom, mTo)) {\n        var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n        marker.markers.push(subMark);\n        subMark.parent = marker;\n      }\n    }\n  }\n\n  function detachSharedMarkers(markers) {\n    var loop = function ( i ) {\n      var marker = markers[i], linked = [marker.primary.doc];\n      linkedDocs(marker.primary.doc, function (d) { return linked.push(d); });\n      for (var j = 0; j < marker.markers.length; j++) {\n        var subMarker = marker.markers[j];\n        if (indexOf(linked, subMarker.doc) == -1) {\n          subMarker.parent = null;\n          marker.markers.splice(j--, 1);\n        }\n      }\n    };\n\n    for (var i = 0; i < markers.length; i++) loop( i );\n  }\n\n  var nextDocId = 0;\n  var Doc = function(text, mode, firstLine, lineSep, direction) {\n    if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\n    if (firstLine == null) { firstLine = 0; }\n\n    BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n    this.first = firstLine;\n    this.scrollTop = this.scrollLeft = 0;\n    this.cantEdit = false;\n    this.cleanGeneration = 1;\n    this.modeFrontier = this.highlightFrontier = firstLine;\n    var start = Pos(firstLine, 0);\n    this.sel = simpleSelection(start);\n    this.history = new History(null);\n    this.id = ++nextDocId;\n    this.modeOption = mode;\n    this.lineSep = lineSep;\n    this.direction = (direction == \"rtl\") ? \"rtl\" : \"ltr\";\n    this.extend = false;\n\n    if (typeof text == \"string\") { text = this.splitLines(text); }\n    updateDoc(this, {from: start, to: start, text: text});\n    setSelection(this, simpleSelection(start), sel_dontScroll);\n  };\n\n  Doc.prototype = createObj(BranchChunk.prototype, {\n    constructor: Doc,\n    // Iterate over the document. Supports two forms -- with only one\n    // argument, it calls that for each line in the document. With\n    // three, it iterates over the range given by the first two (with\n    // the second being non-inclusive).\n    iter: function(from, to, op) {\n      if (op) { this.iterN(from - this.first, to - from, op); }\n      else { this.iterN(this.first, this.first + this.size, from); }\n    },\n\n    // Non-public interface for adding and removing lines.\n    insert: function(at, lines) {\n      var height = 0;\n      for (var i = 0; i < lines.length; ++i) { height += lines[i].height; }\n      this.insertInner(at - this.first, lines, height);\n    },\n    remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n    // From here, the methods are part of the public interface. Most\n    // are also available from CodeMirror (editor) instances.\n\n    getValue: function(lineSep) {\n      var lines = getLines(this, this.first, this.first + this.size);\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n    setValue: docMethodOp(function(code) {\n      var top = Pos(this.first, 0), last = this.first + this.size - 1;\n      makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                        text: this.splitLines(code), origin: \"setValue\", full: true}, true);\n      if (this.cm) { scrollToCoords(this.cm, 0, 0); }\n      setSelection(this, simpleSelection(top), sel_dontScroll);\n    }),\n    replaceRange: function(code, from, to, origin) {\n      from = clipPos(this, from);\n      to = to ? clipPos(this, to) : from;\n      replaceRange(this, code, from, to, origin);\n    },\n    getRange: function(from, to, lineSep) {\n      var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n\n    getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\n\n    getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\n    getLineNumber: function(line) {return lineNo(line)},\n\n    getLineHandleVisualStart: function(line) {\n      if (typeof line == \"number\") { line = getLine(this, line); }\n      return visualLine(line)\n    },\n\n    lineCount: function() {return this.size},\n    firstLine: function() {return this.first},\n    lastLine: function() {return this.first + this.size - 1},\n\n    clipPos: function(pos) {return clipPos(this, pos)},\n\n    getCursor: function(start) {\n      var range$$1 = this.sel.primary(), pos;\n      if (start == null || start == \"head\") { pos = range$$1.head; }\n      else if (start == \"anchor\") { pos = range$$1.anchor; }\n      else if (start == \"end\" || start == \"to\" || start === false) { pos = range$$1.to(); }\n      else { pos = range$$1.from(); }\n      return pos\n    },\n    listSelections: function() { return this.sel.ranges },\n    somethingSelected: function() {return this.sel.somethingSelected()},\n\n    setCursor: docMethodOp(function(line, ch, options) {\n      setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n    }),\n    setSelection: docMethodOp(function(anchor, head, options) {\n      setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n    }),\n    extendSelection: docMethodOp(function(head, other, options) {\n      extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n    }),\n    extendSelections: docMethodOp(function(heads, options) {\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    extendSelectionsBy: docMethodOp(function(f, options) {\n      var heads = map(this.sel.ranges, f);\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    setSelections: docMethodOp(function(ranges, primary, options) {\n      var this$1 = this;\n\n      if (!ranges.length) { return }\n      var out = [];\n      for (var i = 0; i < ranges.length; i++)\n        { out[i] = new Range(clipPos(this$1, ranges[i].anchor),\n                           clipPos(this$1, ranges[i].head)); }\n      if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex); }\n      setSelection(this, normalizeSelection(this.cm, out, primary), options);\n    }),\n    addSelection: docMethodOp(function(anchor, head, options) {\n      var ranges = this.sel.ranges.slice(0);\n      ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n      setSelection(this, normalizeSelection(this.cm, ranges, ranges.length - 1), options);\n    }),\n\n    getSelection: function(lineSep) {\n      var this$1 = this;\n\n      var ranges = this.sel.ranges, lines;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n        lines = lines ? lines.concat(sel) : sel;\n      }\n      if (lineSep === false) { return lines }\n      else { return lines.join(lineSep || this.lineSeparator()) }\n    },\n    getSelections: function(lineSep) {\n      var this$1 = this;\n\n      var parts = [], ranges = this.sel.ranges;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n        if (lineSep !== false) { sel = sel.join(lineSep || this$1.lineSeparator()); }\n        parts[i] = sel;\n      }\n      return parts\n    },\n    replaceSelection: function(code, collapse, origin) {\n      var dup = [];\n      for (var i = 0; i < this.sel.ranges.length; i++)\n        { dup[i] = code; }\n      this.replaceSelections(dup, collapse, origin || \"+input\");\n    },\n    replaceSelections: docMethodOp(function(code, collapse, origin) {\n      var this$1 = this;\n\n      var changes = [], sel = this.sel;\n      for (var i = 0; i < sel.ranges.length; i++) {\n        var range$$1 = sel.ranges[i];\n        changes[i] = {from: range$$1.from(), to: range$$1.to(), text: this$1.splitLines(code[i]), origin: origin};\n      }\n      var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n      for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\n        { makeChange(this$1, changes[i$1]); }\n      if (newSel) { setSelectionReplaceHistory(this, newSel); }\n      else if (this.cm) { ensureCursorVisible(this.cm); }\n    }),\n    undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n    redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n    undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n    redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n    setExtending: function(val) {this.extend = val;},\n    getExtending: function() {return this.extend},\n\n    historySize: function() {\n      var hist = this.history, done = 0, undone = 0;\n      for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done; } }\n      for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone; } }\n      return {undo: done, redo: undone}\n    },\n    clearHistory: function() {this.history = new History(this.history.maxGeneration);},\n\n    markClean: function() {\n      this.cleanGeneration = this.changeGeneration(true);\n    },\n    changeGeneration: function(forceSplit) {\n      if (forceSplit)\n        { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null; }\n      return this.history.generation\n    },\n    isClean: function (gen) {\n      return this.history.generation == (gen || this.cleanGeneration)\n    },\n\n    getHistory: function() {\n      return {done: copyHistoryArray(this.history.done),\n              undone: copyHistoryArray(this.history.undone)}\n    },\n    setHistory: function(histData) {\n      var hist = this.history = new History(this.history.maxGeneration);\n      hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n      hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n    },\n\n    setGutterMarker: docMethodOp(function(line, gutterID, value) {\n      return changeLine(this, line, \"gutter\", function (line) {\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\n        markers[gutterID] = value;\n        if (!value && isEmpty(markers)) { line.gutterMarkers = null; }\n        return true\n      })\n    }),\n\n    clearGutter: docMethodOp(function(gutterID) {\n      var this$1 = this;\n\n      this.iter(function (line) {\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n          changeLine(this$1, line, \"gutter\", function () {\n            line.gutterMarkers[gutterID] = null;\n            if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null; }\n            return true\n          });\n        }\n      });\n    }),\n\n    lineInfo: function(line) {\n      var n;\n      if (typeof line == \"number\") {\n        if (!isLine(this, line)) { return null }\n        n = line;\n        line = getLine(this, line);\n        if (!line) { return null }\n      } else {\n        n = lineNo(line);\n        if (n == null) { return null }\n      }\n      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n              widgets: line.widgets}\n    },\n\n    addLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        if (!line[prop]) { line[prop] = cls; }\n        else if (classTest(cls).test(line[prop])) { return false }\n        else { line[prop] += \" \" + cls; }\n        return true\n      })\n    }),\n    removeLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        var cur = line[prop];\n        if (!cur) { return false }\n        else if (cls == null) { line[prop] = null; }\n        else {\n          var found = cur.match(classTest(cls));\n          if (!found) { return false }\n          var end = found.index + found[0].length;\n          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n        }\n        return true\n      })\n    }),\n\n    addLineWidget: docMethodOp(function(handle, node, options) {\n      return addLineWidget(this, handle, node, options)\n    }),\n    removeLineWidget: function(widget) { widget.clear(); },\n\n    markText: function(from, to, options) {\n      return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\")\n    },\n    setBookmark: function(pos, options) {\n      var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                      insertLeft: options && options.insertLeft,\n                      clearWhenEmpty: false, shared: options && options.shared,\n                      handleMouseEvents: options && options.handleMouseEvents};\n      pos = clipPos(this, pos);\n      return markText(this, pos, pos, realOpts, \"bookmark\")\n    },\n    findMarksAt: function(pos) {\n      pos = clipPos(this, pos);\n      var markers = [], spans = getLine(this, pos.line).markedSpans;\n      if (spans) { for (var i = 0; i < spans.length; ++i) {\n        var span = spans[i];\n        if ((span.from == null || span.from <= pos.ch) &&\n            (span.to == null || span.to >= pos.ch))\n          { markers.push(span.marker.parent || span.marker); }\n      } }\n      return markers\n    },\n    findMarks: function(from, to, filter) {\n      from = clipPos(this, from); to = clipPos(this, to);\n      var found = [], lineNo$$1 = from.line;\n      this.iter(from.line, to.line + 1, function (line) {\n        var spans = line.markedSpans;\n        if (spans) { for (var i = 0; i < spans.length; i++) {\n          var span = spans[i];\n          if (!(span.to != null && lineNo$$1 == from.line && from.ch >= span.to ||\n                span.from == null && lineNo$$1 != from.line ||\n                span.from != null && lineNo$$1 == to.line && span.from >= to.ch) &&\n              (!filter || filter(span.marker)))\n            { found.push(span.marker.parent || span.marker); }\n        } }\n        ++lineNo$$1;\n      });\n      return found\n    },\n    getAllMarks: function() {\n      var markers = [];\n      this.iter(function (line) {\n        var sps = line.markedSpans;\n        if (sps) { for (var i = 0; i < sps.length; ++i)\n          { if (sps[i].from != null) { markers.push(sps[i].marker); } } }\n      });\n      return markers\n    },\n\n    posFromIndex: function(off) {\n      var ch, lineNo$$1 = this.first, sepSize = this.lineSeparator().length;\n      this.iter(function (line) {\n        var sz = line.text.length + sepSize;\n        if (sz > off) { ch = off; return true }\n        off -= sz;\n        ++lineNo$$1;\n      });\n      return clipPos(this, Pos(lineNo$$1, ch))\n    },\n    indexFromPos: function (coords) {\n      coords = clipPos(this, coords);\n      var index = coords.ch;\n      if (coords.line < this.first || coords.ch < 0) { return 0 }\n      var sepSize = this.lineSeparator().length;\n      this.iter(this.first, coords.line, function (line) { // iter aborts when callback returns a truthy value\n        index += line.text.length + sepSize;\n      });\n      return index\n    },\n\n    copy: function(copyHistory) {\n      var doc = new Doc(getLines(this, this.first, this.first + this.size),\n                        this.modeOption, this.first, this.lineSep, this.direction);\n      doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n      doc.sel = this.sel;\n      doc.extend = false;\n      if (copyHistory) {\n        doc.history.undoDepth = this.history.undoDepth;\n        doc.setHistory(this.getHistory());\n      }\n      return doc\n    },\n\n    linkedDoc: function(options) {\n      if (!options) { options = {}; }\n      var from = this.first, to = this.first + this.size;\n      if (options.from != null && options.from > from) { from = options.from; }\n      if (options.to != null && options.to < to) { to = options.to; }\n      var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n      if (options.sharedHist) { copy.history = this.history\n      ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n      copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n      copySharedMarkers(copy, findSharedMarkers(this));\n      return copy\n    },\n    unlinkDoc: function(other) {\n      var this$1 = this;\n\n      if (other instanceof CodeMirror) { other = other.doc; }\n      if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\n        var link = this$1.linked[i];\n        if (link.doc != other) { continue }\n        this$1.linked.splice(i, 1);\n        other.unlinkDoc(this$1);\n        detachSharedMarkers(findSharedMarkers(this$1));\n        break\n      } }\n      // If the histories were shared, split them again\n      if (other.history == this.history) {\n        var splitIds = [other.id];\n        linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true);\n        other.history = new History(null);\n        other.history.done = copyHistoryArray(this.history.done, splitIds);\n        other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n      }\n    },\n    iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n    getMode: function() {return this.mode},\n    getEditor: function() {return this.cm},\n\n    splitLines: function(str) {\n      if (this.lineSep) { return str.split(this.lineSep) }\n      return splitLinesAuto(str)\n    },\n    lineSeparator: function() { return this.lineSep || \"\\n\" },\n\n    setDirection: docMethodOp(function (dir) {\n      if (dir != \"rtl\") { dir = \"ltr\"; }\n      if (dir == this.direction) { return }\n      this.direction = dir;\n      this.iter(function (line) { return line.order = null; });\n      if (this.cm) { directionChanged(this.cm); }\n    })\n  });\n\n  // Public alias.\n  Doc.prototype.eachLine = Doc.prototype.iter;\n\n  // Kludge to work around strange IE behavior where it'll sometimes\n  // re-fire a series of drag-related events right after the drop (#1551)\n  var lastDrop = 0;\n\n  function onDrop(e) {\n    var cm = this;\n    clearDragCursor(cm);\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n      { return }\n    e_preventDefault(e);\n    if (ie) { lastDrop = +new Date; }\n    var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n    if (!pos || cm.isReadOnly()) { return }\n    // Might be a file drop, in which case we simply extract the text\n    // and insert it.\n    if (files && files.length && window.FileReader && window.File) {\n      var n = files.length, text = Array(n), read = 0;\n      var loadFile = function (file, i) {\n        if (cm.options.allowDropFileTypes &&\n            indexOf(cm.options.allowDropFileTypes, file.type) == -1)\n          { return }\n\n        var reader = new FileReader;\n        reader.onload = operation(cm, function () {\n          var content = reader.result;\n          if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) { content = \"\"; }\n          text[i] = content;\n          if (++read == n) {\n            pos = clipPos(cm.doc, pos);\n            var change = {from: pos, to: pos,\n                          text: cm.doc.splitLines(text.join(cm.doc.lineSeparator())),\n                          origin: \"paste\"};\n            makeChange(cm.doc, change);\n            setSelectionReplaceHistory(cm.doc, simpleSelection(pos, changeEnd(change)));\n          }\n        });\n        reader.readAsText(file);\n      };\n      for (var i = 0; i < n; ++i) { loadFile(files[i], i); }\n    } else { // Normal drop\n      // Don't do a replace if the drop happened inside of the selected text.\n      if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n        cm.state.draggingText(e);\n        // Ensure the editor is re-focused\n        setTimeout(function () { return cm.display.input.focus(); }, 20);\n        return\n      }\n      try {\n        var text$1 = e.dataTransfer.getData(\"Text\");\n        if (text$1) {\n          var selected;\n          if (cm.state.draggingText && !cm.state.draggingText.copy)\n            { selected = cm.listSelections(); }\n          setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n          if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\n            { replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\"); } }\n          cm.replaceSelection(text$1, \"around\", \"paste\");\n          cm.display.input.focus();\n        }\n      }\n      catch(e){}\n    }\n  }\n\n  function onDragStart(cm, e) {\n    if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\n\n    e.dataTransfer.setData(\"Text\", cm.getSelection());\n    e.dataTransfer.effectAllowed = \"copyMove\";\n\n    // Use dummy image instead of default browsers image.\n    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n    if (e.dataTransfer.setDragImage && !safari) {\n      var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n      img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n      if (presto) {\n        img.width = img.height = 1;\n        cm.display.wrapper.appendChild(img);\n        // Force a relayout, or Opera won't use our image for some obscure reason\n        img._top = img.offsetTop;\n      }\n      e.dataTransfer.setDragImage(img, 0, 0);\n      if (presto) { img.parentNode.removeChild(img); }\n    }\n  }\n\n  function onDragOver(cm, e) {\n    var pos = posFromMouse(cm, e);\n    if (!pos) { return }\n    var frag = document.createDocumentFragment();\n    drawSelectionCursor(cm, pos, frag);\n    if (!cm.display.dragCursor) {\n      cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n      cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n    }\n    removeChildrenAndAdd(cm.display.dragCursor, frag);\n  }\n\n  function clearDragCursor(cm) {\n    if (cm.display.dragCursor) {\n      cm.display.lineSpace.removeChild(cm.display.dragCursor);\n      cm.display.dragCursor = null;\n    }\n  }\n\n  // These must be handled carefully, because naively registering a\n  // handler for each editor will cause the editors to never be\n  // garbage collected.\n\n  function forEachCodeMirror(f) {\n    if (!document.getElementsByClassName) { return }\n    var byClass = document.getElementsByClassName(\"CodeMirror\"), editors = [];\n    for (var i = 0; i < byClass.length; i++) {\n      var cm = byClass[i].CodeMirror;\n      if (cm) { editors.push(cm); }\n    }\n    if (editors.length) { editors[0].operation(function () {\n      for (var i = 0; i < editors.length; i++) { f(editors[i]); }\n    }); }\n  }\n\n  var globalsRegistered = false;\n  function ensureGlobalHandlers() {\n    if (globalsRegistered) { return }\n    registerGlobalHandlers();\n    globalsRegistered = true;\n  }\n  function registerGlobalHandlers() {\n    // When the window resizes, we need to refresh active editors.\n    var resizeTimer;\n    on(window, \"resize\", function () {\n      if (resizeTimer == null) { resizeTimer = setTimeout(function () {\n        resizeTimer = null;\n        forEachCodeMirror(onResize);\n      }, 100); }\n    });\n    // When the window loses focus, we want to show the editor as blurred\n    on(window, \"blur\", function () { return forEachCodeMirror(onBlur); });\n  }\n  // Called when the window resizes\n  function onResize(cm) {\n    var d = cm.display;\n    // Might be a text scaling operation, clear size caches.\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n    d.scrollbarsClipped = false;\n    cm.setSize();\n  }\n\n  var keyNames = {\n    3: \"Pause\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n    19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n    36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n    46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\n    106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 127: \"Delete\", 145: \"ScrollLock\",\n    173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n    221: \"]\", 222: \"'\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n    63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\n  };\n\n  // Number keys\n  for (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i); }\n  // Alphabetic keys\n  for (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1); }\n  // Function keys\n  for (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2; }\n\n  var keyMap = {};\n\n  keyMap.basic = {\n    \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n    \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n    \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n    \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n    \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n    \"Esc\": \"singleSelection\"\n  };\n  // Note that the save and find-related commands aren't defined by\n  // default. User code or addons can define them. Unknown commands\n  // are simply ignored.\n  keyMap.pcDefault = {\n    \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n    \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n    \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n    \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n    \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n    \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n    \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n    \"fallthrough\": \"basic\"\n  };\n  // Very basic readline/emacs-style bindings, which are standard on Mac.\n  keyMap.emacsy = {\n    \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n    \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\n    \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\n    \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\",\n    \"Ctrl-O\": \"openLine\"\n  };\n  keyMap.macDefault = {\n    \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n    \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n    \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n    \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n    \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n    \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n    \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n    \"fallthrough\": [\"basic\", \"emacsy\"]\n  };\n  keyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n  // KEYMAP DISPATCH\n\n  function normalizeKeyName(name) {\n    var parts = name.split(/-(?!$)/);\n    name = parts[parts.length - 1];\n    var alt, ctrl, shift, cmd;\n    for (var i = 0; i < parts.length - 1; i++) {\n      var mod = parts[i];\n      if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true; }\n      else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n      else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n      else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n      else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n    }\n    if (alt) { name = \"Alt-\" + name; }\n    if (ctrl) { name = \"Ctrl-\" + name; }\n    if (cmd) { name = \"Cmd-\" + name; }\n    if (shift) { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // This is a kludge to keep keymaps mostly working as raw objects\n  // (backwards compatibility) while at the same time support features\n  // like normalization and multi-stroke key bindings. It compiles a\n  // new normalized keymap, and then updates the old object to reflect\n  // this.\n  function normalizeKeyMap(keymap) {\n    var copy = {};\n    for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\n      var value = keymap[keyname];\n      if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\n      if (value == \"...\") { delete keymap[keyname]; continue }\n\n      var keys = map(keyname.split(\" \"), normalizeKeyName);\n      for (var i = 0; i < keys.length; i++) {\n        var val = (void 0), name = (void 0);\n        if (i == keys.length - 1) {\n          name = keys.join(\" \");\n          val = value;\n        } else {\n          name = keys.slice(0, i + 1).join(\" \");\n          val = \"...\";\n        }\n        var prev = copy[name];\n        if (!prev) { copy[name] = val; }\n        else if (prev != val) { throw new Error(\"Inconsistent bindings for \" + name) }\n      }\n      delete keymap[keyname];\n    } }\n    for (var prop in copy) { keymap[prop] = copy[prop]; }\n    return keymap\n  }\n\n  function lookupKey(key, map$$1, handle, context) {\n    map$$1 = getKeyMap(map$$1);\n    var found = map$$1.call ? map$$1.call(key, context) : map$$1[key];\n    if (found === false) { return \"nothing\" }\n    if (found === \"...\") { return \"multi\" }\n    if (found != null && handle(found)) { return \"handled\" }\n\n    if (map$$1.fallthrough) {\n      if (Object.prototype.toString.call(map$$1.fallthrough) != \"[object Array]\")\n        { return lookupKey(key, map$$1.fallthrough, handle, context) }\n      for (var i = 0; i < map$$1.fallthrough.length; i++) {\n        var result = lookupKey(key, map$$1.fallthrough[i], handle, context);\n        if (result) { return result }\n      }\n    }\n  }\n\n  // Modifier key presses don't count as 'real' key presses for the\n  // purpose of keymap fallthrough.\n  function isModifierKey(value) {\n    var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n    return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\"\n  }\n\n  function addModifierNames(name, event, noShift) {\n    var base = name;\n    if (event.altKey && base != \"Alt\") { name = \"Alt-\" + name; }\n    if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") { name = \"Ctrl-\" + name; }\n    if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Cmd\") { name = \"Cmd-\" + name; }\n    if (!noShift && event.shiftKey && base != \"Shift\") { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // Look up the name of a key as indicated by an event object.\n  function keyName(event, noShift) {\n    if (presto && event.keyCode == 34 && event[\"char\"]) { return false }\n    var name = keyNames[event.keyCode];\n    if (name == null || event.altGraphKey) { return false }\n    // Ctrl-ScrollLock has keyCode 3, same as Ctrl-Pause,\n    // so we'll use event.code when available (Chrome 48+, FF 38+, Safari 10.1+)\n    if (event.keyCode == 3 && event.code) { name = event.code; }\n    return addModifierNames(name, event, noShift)\n  }\n\n  function getKeyMap(val) {\n    return typeof val == \"string\" ? keyMap[val] : val\n  }\n\n  // Helper for deleting text near the selection(s), used to implement\n  // backspace, delete, and similar functionality.\n  function deleteNearSelection(cm, compute) {\n    var ranges = cm.doc.sel.ranges, kill = [];\n    // Build up a set of ranges to kill first, merging overlapping\n    // ranges.\n    for (var i = 0; i < ranges.length; i++) {\n      var toKill = compute(ranges[i]);\n      while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n        var replaced = kill.pop();\n        if (cmp(replaced.from, toKill.from) < 0) {\n          toKill.from = replaced.from;\n          break\n        }\n      }\n      kill.push(toKill);\n    }\n    // Next, remove those actual ranges.\n    runInOp(cm, function () {\n      for (var i = kill.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\"); }\n      ensureCursorVisible(cm);\n    });\n  }\n\n  function moveCharLogically(line, ch, dir) {\n    var target = skipExtendingChars(line.text, ch + dir, dir);\n    return target < 0 || target > line.text.length ? null : target\n  }\n\n  function moveLogically(line, start, dir) {\n    var ch = moveCharLogically(line, start.ch, dir);\n    return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\")\n  }\n\n  function endOfLine(visually, cm, lineObj, lineNo, dir) {\n    if (visually) {\n      var order = getOrder(lineObj, cm.doc.direction);\n      if (order) {\n        var part = dir < 0 ? lst(order) : order[0];\n        var moveInStorageOrder = (dir < 0) == (part.level == 1);\n        var sticky = moveInStorageOrder ? \"after\" : \"before\";\n        var ch;\n        // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n        // it could be that the last bidi part is not on the last visual line,\n        // since visual lines contain content order-consecutive chunks.\n        // Thus, in rtl, we are looking for the first (content-order) character\n        // in the rtl chunk that is on the last line (that is, the same line\n        // as the last (content-order) character).\n        if (part.level > 0 || cm.doc.direction == \"rtl\") {\n          var prep = prepareMeasureForLine(cm, lineObj);\n          ch = dir < 0 ? lineObj.text.length - 1 : 0;\n          var targetTop = measureCharPrepared(cm, prep, ch).top;\n          ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch);\n          if (sticky == \"before\") { ch = moveCharLogically(lineObj, ch, 1); }\n        } else { ch = dir < 0 ? part.to : part.from; }\n        return new Pos(lineNo, ch, sticky)\n      }\n    }\n    return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\")\n  }\n\n  function moveVisually(cm, line, start, dir) {\n    var bidi = getOrder(line, cm.doc.direction);\n    if (!bidi) { return moveLogically(line, start, dir) }\n    if (start.ch >= line.text.length) {\n      start.ch = line.text.length;\n      start.sticky = \"before\";\n    } else if (start.ch <= 0) {\n      start.ch = 0;\n      start.sticky = \"after\";\n    }\n    var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos];\n    if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n      // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n      // nothing interesting happens.\n      return moveLogically(line, start, dir)\n    }\n\n    var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); };\n    var prep;\n    var getWrappedLineExtent = function (ch) {\n      if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\n      prep = prep || prepareMeasureForLine(cm, line);\n      return wrappedLineExtentChar(cm, line, prep, ch)\n    };\n    var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n    if (cm.doc.direction == \"rtl\" || part.level == 1) {\n      var moveInStorageOrder = (part.level == 1) == (dir < 0);\n      var ch = mv(start, moveInStorageOrder ? 1 : -1);\n      if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n        // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n        var sticky = moveInStorageOrder ? \"before\" : \"after\";\n        return new Pos(start.line, ch, sticky)\n      }\n    }\n\n    // Case 3: Could not move within this bidi part in this visual line, so leave\n    // the current bidi part\n\n    var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\n      var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\n        ? new Pos(start.line, mv(ch, 1), \"before\")\n        : new Pos(start.line, ch, \"after\"); };\n\n      for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n        var part = bidi[partPos];\n        var moveInStorageOrder = (dir > 0) == (part.level != 1);\n        var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n        if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\n        ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n        if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\n      }\n    };\n\n    // Case 3a: Look for other bidi parts on the same visual line\n    var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n    if (res) { return res }\n\n    // Case 3b: Look for other bidi parts on the next visual line\n    var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n    if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n      res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n      if (res) { return res }\n    }\n\n    // Case 4: Nowhere to move\n    return null\n  }\n\n  // Commands are parameter-less actions that can be performed on an\n  // editor, mostly used for keybindings.\n  var commands = {\n    selectAll: selectAll,\n    singleSelection: function (cm) { return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll); },\n    killLine: function (cm) { return deleteNearSelection(cm, function (range) {\n      if (range.empty()) {\n        var len = getLine(cm.doc, range.head.line).text.length;\n        if (range.head.ch == len && range.head.line < cm.lastLine())\n          { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\n        else\n          { return {from: range.head, to: Pos(range.head.line, len)} }\n      } else {\n        return {from: range.from(), to: range.to()}\n      }\n    }); },\n    deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0),\n      to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\n    }); }); },\n    delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0), to: range.from()\n    }); }); },\n    delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n      return {from: leftPos, to: range.from()}\n    }); },\n    delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n      return {from: range.from(), to: rightPos }\n    }); },\n    undo: function (cm) { return cm.undo(); },\n    redo: function (cm) { return cm.redo(); },\n    undoSelection: function (cm) { return cm.undoSelection(); },\n    redoSelection: function (cm) { return cm.redoSelection(); },\n    goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\n    goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\n    goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\n      {origin: \"+move\", bias: -1}\n    ); },\n    goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: 0, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n      if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\n      return pos\n    }, sel_move); },\n    goLineUp: function (cm) { return cm.moveV(-1, \"line\"); },\n    goLineDown: function (cm) { return cm.moveV(1, \"line\"); },\n    goPageUp: function (cm) { return cm.moveV(-1, \"page\"); },\n    goPageDown: function (cm) { return cm.moveV(1, \"page\"); },\n    goCharLeft: function (cm) { return cm.moveH(-1, \"char\"); },\n    goCharRight: function (cm) { return cm.moveH(1, \"char\"); },\n    goColumnLeft: function (cm) { return cm.moveH(-1, \"column\"); },\n    goColumnRight: function (cm) { return cm.moveH(1, \"column\"); },\n    goWordLeft: function (cm) { return cm.moveH(-1, \"word\"); },\n    goGroupRight: function (cm) { return cm.moveH(1, \"group\"); },\n    goGroupLeft: function (cm) { return cm.moveH(-1, \"group\"); },\n    goWordRight: function (cm) { return cm.moveH(1, \"word\"); },\n    delCharBefore: function (cm) { return cm.deleteH(-1, \"char\"); },\n    delCharAfter: function (cm) { return cm.deleteH(1, \"char\"); },\n    delWordBefore: function (cm) { return cm.deleteH(-1, \"word\"); },\n    delWordAfter: function (cm) { return cm.deleteH(1, \"word\"); },\n    delGroupBefore: function (cm) { return cm.deleteH(-1, \"group\"); },\n    delGroupAfter: function (cm) { return cm.deleteH(1, \"group\"); },\n    indentAuto: function (cm) { return cm.indentSelection(\"smart\"); },\n    indentMore: function (cm) { return cm.indentSelection(\"add\"); },\n    indentLess: function (cm) { return cm.indentSelection(\"subtract\"); },\n    insertTab: function (cm) { return cm.replaceSelection(\"\\t\"); },\n    insertSoftTab: function (cm) {\n      var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n      for (var i = 0; i < ranges.length; i++) {\n        var pos = ranges[i].from();\n        var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n        spaces.push(spaceStr(tabSize - col % tabSize));\n      }\n      cm.replaceSelections(spaces);\n    },\n    defaultTab: function (cm) {\n      if (cm.somethingSelected()) { cm.indentSelection(\"add\"); }\n      else { cm.execCommand(\"insertTab\"); }\n    },\n    // Swap the two chars left and right of each selection's head.\n    // Move cursor behind the two swapped characters afterwards.\n    //\n    // Doesn't consider line feeds a character.\n    // Doesn't scan more than one line above to find a character.\n    // Doesn't do anything on an empty line.\n    // Doesn't do anything with non-empty selections.\n    transposeChars: function (cm) { return runInOp(cm, function () {\n      var ranges = cm.listSelections(), newSel = [];\n      for (var i = 0; i < ranges.length; i++) {\n        if (!ranges[i].empty()) { continue }\n        var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n        if (line) {\n          if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1); }\n          if (cur.ch > 0) {\n            cur = new Pos(cur.line, cur.ch + 1);\n            cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                            Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n          } else if (cur.line > cm.doc.first) {\n            var prev = getLine(cm.doc, cur.line - 1).text;\n            if (prev) {\n              cur = new Pos(cur.line, 1);\n              cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\n                              prev.charAt(prev.length - 1),\n                              Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n            }\n          }\n        }\n        newSel.push(new Range(cur, cur));\n      }\n      cm.setSelections(newSel);\n    }); },\n    newlineAndIndent: function (cm) { return runInOp(cm, function () {\n      var sels = cm.listSelections();\n      for (var i = sels.length - 1; i >= 0; i--)\n        { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\"); }\n      sels = cm.listSelections();\n      for (var i$1 = 0; i$1 < sels.length; i$1++)\n        { cm.indentLine(sels[i$1].from().line, null, true); }\n      ensureCursorVisible(cm);\n    }); },\n    openLine: function (cm) { return cm.replaceSelection(\"\\n\", \"start\"); },\n    toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\n  };\n\n\n  function lineStart(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLine(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, visual, lineN, 1)\n  }\n  function lineEnd(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLineEnd(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, line, lineN, -1)\n  }\n  function lineStartSmart(cm, pos) {\n    var start = lineStart(cm, pos.line);\n    var line = getLine(cm.doc, start.line);\n    var order = getOrder(line, cm.doc.direction);\n    if (!order || order[0].level == 0) {\n      var firstNonWS = Math.max(0, line.text.search(/\\S/));\n      var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n      return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\n    }\n    return start\n  }\n\n  // Run a handler that was bound to a key.\n  function doHandleBinding(cm, bound, dropShift) {\n    if (typeof bound == \"string\") {\n      bound = commands[bound];\n      if (!bound) { return false }\n    }\n    // Ensure previous input has been read, so that the handler sees a\n    // consistent view of the document\n    cm.display.input.ensurePolled();\n    var prevShift = cm.display.shift, done = false;\n    try {\n      if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n      if (dropShift) { cm.display.shift = false; }\n      done = bound(cm) != Pass;\n    } finally {\n      cm.display.shift = prevShift;\n      cm.state.suppressEdits = false;\n    }\n    return done\n  }\n\n  function lookupKeyForEditor(cm, name, handle) {\n    for (var i = 0; i < cm.state.keyMaps.length; i++) {\n      var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n      if (result) { return result }\n    }\n    return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\n      || lookupKey(name, cm.options.keyMap, handle, cm)\n  }\n\n  // Note that, despite the name, this function is also used to check\n  // for bound mouse clicks.\n\n  var stopSeq = new Delayed;\n\n  function dispatchKey(cm, name, e, handle) {\n    var seq = cm.state.keySeq;\n    if (seq) {\n      if (isModifierKey(name)) { return \"handled\" }\n      if (/\\'$/.test(name))\n        { cm.state.keySeq = null; }\n      else\n        { stopSeq.set(50, function () {\n          if (cm.state.keySeq == seq) {\n            cm.state.keySeq = null;\n            cm.display.input.reset();\n          }\n        }); }\n      if (dispatchKeyInner(cm, seq + \" \" + name, e, handle)) { return true }\n    }\n    return dispatchKeyInner(cm, name, e, handle)\n  }\n\n  function dispatchKeyInner(cm, name, e, handle) {\n    var result = lookupKeyForEditor(cm, name, handle);\n\n    if (result == \"multi\")\n      { cm.state.keySeq = name; }\n    if (result == \"handled\")\n      { signalLater(cm, \"keyHandled\", cm, name, e); }\n\n    if (result == \"handled\" || result == \"multi\") {\n      e_preventDefault(e);\n      restartBlink(cm);\n    }\n\n    return !!result\n  }\n\n  // Handle a key from the keydown event.\n  function handleKeyBinding(cm, e) {\n    var name = keyName(e, true);\n    if (!name) { return false }\n\n    if (e.shiftKey && !cm.state.keySeq) {\n      // First try to resolve full name (including 'Shift-'). Failing\n      // that, see if there is a cursor-motion command (starting with\n      // 'go') bound to the keyname without 'Shift-'.\n      return dispatchKey(cm, \"Shift-\" + name, e, function (b) { return doHandleBinding(cm, b, true); })\n          || dispatchKey(cm, name, e, function (b) {\n               if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n                 { return doHandleBinding(cm, b) }\n             })\n    } else {\n      return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\n    }\n  }\n\n  // Handle a key from the keypress event\n  function handleCharBinding(cm, e, ch) {\n    return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) { return doHandleBinding(cm, b, true); })\n  }\n\n  var lastStoppedKey = null;\n  function onKeyDown(e) {\n    var cm = this;\n    cm.curOp.focus = activeElt();\n    if (signalDOMEvent(cm, e)) { return }\n    // IE does strange things with escape.\n    if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false; }\n    var code = e.keyCode;\n    cm.display.shift = code == 16 || e.shiftKey;\n    var handled = handleKeyBinding(cm, e);\n    if (presto) {\n      lastStoppedKey = handled ? code : null;\n      // Opera has no cut event... we try to at least catch the key combo\n      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n        { cm.replaceSelection(\"\", null, \"cut\"); }\n    }\n\n    // Turn mouse into crosshair when Alt is held on Mac.\n    if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n      { showCrossHair(cm); }\n  }\n\n  function showCrossHair(cm) {\n    var lineDiv = cm.display.lineDiv;\n    addClass(lineDiv, \"CodeMirror-crosshair\");\n\n    function up(e) {\n      if (e.keyCode == 18 || !e.altKey) {\n        rmClass(lineDiv, \"CodeMirror-crosshair\");\n        off(document, \"keyup\", up);\n        off(document, \"mouseover\", up);\n      }\n    }\n    on(document, \"keyup\", up);\n    on(document, \"mouseover\", up);\n  }\n\n  function onKeyUp(e) {\n    if (e.keyCode == 16) { this.doc.sel.shift = false; }\n    signalDOMEvent(this, e);\n  }\n\n  function onKeyPress(e) {\n    var cm = this;\n    if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\n    var keyCode = e.keyCode, charCode = e.charCode;\n    if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\n    if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\n    var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n    // Some browsers fire keypress events for backspace\n    if (ch == \"\\x08\") { return }\n    if (handleCharBinding(cm, e, ch)) { return }\n    cm.display.input.onKeyPress(e);\n  }\n\n  var DOUBLECLICK_DELAY = 400;\n\n  var PastClick = function(time, pos, button) {\n    this.time = time;\n    this.pos = pos;\n    this.button = button;\n  };\n\n  PastClick.prototype.compare = function (time, pos, button) {\n    return this.time + DOUBLECLICK_DELAY > time &&\n      cmp(pos, this.pos) == 0 && button == this.button\n  };\n\n  var lastClick, lastDoubleClick;\n  function clickRepeat(pos, button) {\n    var now = +new Date;\n    if (lastDoubleClick && lastDoubleClick.compare(now, pos, button)) {\n      lastClick = lastDoubleClick = null;\n      return \"triple\"\n    } else if (lastClick && lastClick.compare(now, pos, button)) {\n      lastDoubleClick = new PastClick(now, pos, button);\n      lastClick = null;\n      return \"double\"\n    } else {\n      lastClick = new PastClick(now, pos, button);\n      lastDoubleClick = null;\n      return \"single\"\n    }\n  }\n\n  // A mouse down can be a single click, double click, triple click,\n  // start of selection drag, start of text drag, new cursor\n  // (ctrl-click), rectangle drag (alt-drag), or xwin\n  // middle-click-paste. Or it might be a click on something we should\n  // not interfere with, such as a scrollbar or widget.\n  function onMouseDown(e) {\n    var cm = this, display = cm.display;\n    if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\n    display.input.ensurePolled();\n    display.shift = e.shiftKey;\n\n    if (eventInWidget(display, e)) {\n      if (!webkit) {\n        // Briefly turn off draggability, to allow widgets to do\n        // normal dragging things.\n        display.scroller.draggable = false;\n        setTimeout(function () { return display.scroller.draggable = true; }, 100);\n      }\n      return\n    }\n    if (clickInGutter(cm, e)) { return }\n    var pos = posFromMouse(cm, e), button = e_button(e), repeat = pos ? clickRepeat(pos, button) : \"single\";\n    window.focus();\n\n    // #3261: make sure, that we're not starting a second selection\n    if (button == 1 && cm.state.selectingText)\n      { cm.state.selectingText(e); }\n\n    if (pos && handleMappedButton(cm, button, pos, repeat, e)) { return }\n\n    if (button == 1) {\n      if (pos) { leftButtonDown(cm, pos, repeat, e); }\n      else if (e_target(e) == display.scroller) { e_preventDefault(e); }\n    } else if (button == 2) {\n      if (pos) { extendSelection(cm.doc, pos); }\n      setTimeout(function () { return display.input.focus(); }, 20);\n    } else if (button == 3) {\n      if (captureRightClick) { cm.display.input.onContextMenu(e); }\n      else { delayBlurEvent(cm); }\n    }\n  }\n\n  function handleMappedButton(cm, button, pos, repeat, event) {\n    var name = \"Click\";\n    if (repeat == \"double\") { name = \"Double\" + name; }\n    else if (repeat == \"triple\") { name = \"Triple\" + name; }\n    name = (button == 1 ? \"Left\" : button == 2 ? \"Middle\" : \"Right\") + name;\n\n    return dispatchKey(cm,  addModifierNames(name, event), event, function (bound) {\n      if (typeof bound == \"string\") { bound = commands[bound]; }\n      if (!bound) { return false }\n      var done = false;\n      try {\n        if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n        done = bound(cm, pos) != Pass;\n      } finally {\n        cm.state.suppressEdits = false;\n      }\n      return done\n    })\n  }\n\n  function configureMouse(cm, repeat, event) {\n    var option = cm.getOption(\"configureMouse\");\n    var value = option ? option(cm, repeat, event) : {};\n    if (value.unit == null) {\n      var rect = chromeOS ? event.shiftKey && event.metaKey : event.altKey;\n      value.unit = rect ? \"rectangle\" : repeat == \"single\" ? \"char\" : repeat == \"double\" ? \"word\" : \"line\";\n    }\n    if (value.extend == null || cm.doc.extend) { value.extend = cm.doc.extend || event.shiftKey; }\n    if (value.addNew == null) { value.addNew = mac ? event.metaKey : event.ctrlKey; }\n    if (value.moveOnDrag == null) { value.moveOnDrag = !(mac ? event.altKey : event.ctrlKey); }\n    return value\n  }\n\n  function leftButtonDown(cm, pos, repeat, event) {\n    if (ie) { setTimeout(bind(ensureFocus, cm), 0); }\n    else { cm.curOp.focus = activeElt(); }\n\n    var behavior = configureMouse(cm, repeat, event);\n\n    var sel = cm.doc.sel, contained;\n    if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\n        repeat == \"single\" && (contained = sel.contains(pos)) > -1 &&\n        (cmp((contained = sel.ranges[contained]).from(), pos) < 0 || pos.xRel > 0) &&\n        (cmp(contained.to(), pos) > 0 || pos.xRel < 0))\n      { leftButtonStartDrag(cm, event, pos, behavior); }\n    else\n      { leftButtonSelect(cm, event, pos, behavior); }\n  }\n\n  // Start a text drag. When it ends, see if any dragging actually\n  // happen, and treat as a click if it didn't.\n  function leftButtonStartDrag(cm, event, pos, behavior) {\n    var display = cm.display, moved = false;\n    var dragEnd = operation(cm, function (e) {\n      if (webkit) { display.scroller.draggable = false; }\n      cm.state.draggingText = false;\n      off(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n      off(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n      off(display.scroller, \"dragstart\", dragStart);\n      off(display.scroller, \"drop\", dragEnd);\n      if (!moved) {\n        e_preventDefault(e);\n        if (!behavior.addNew)\n          { extendSelection(cm.doc, pos, null, null, behavior.extend); }\n        // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n        if (webkit || ie && ie_version == 9)\n          { setTimeout(function () {display.wrapper.ownerDocument.body.focus(); display.input.focus();}, 20); }\n        else\n          { display.input.focus(); }\n      }\n    });\n    var mouseMove = function(e2) {\n      moved = moved || Math.abs(event.clientX - e2.clientX) + Math.abs(event.clientY - e2.clientY) >= 10;\n    };\n    var dragStart = function () { return moved = true; };\n    // Let the drag handler handle this.\n    if (webkit) { display.scroller.draggable = true; }\n    cm.state.draggingText = dragEnd;\n    dragEnd.copy = !behavior.moveOnDrag;\n    // IE's approach to draggable\n    if (display.scroller.dragDrop) { display.scroller.dragDrop(); }\n    on(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n    on(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n    on(display.scroller, \"dragstart\", dragStart);\n    on(display.scroller, \"drop\", dragEnd);\n\n    delayBlurEvent(cm);\n    setTimeout(function () { return display.input.focus(); }, 20);\n  }\n\n  function rangeForUnit(cm, pos, unit) {\n    if (unit == \"char\") { return new Range(pos, pos) }\n    if (unit == \"word\") { return cm.findWordAt(pos) }\n    if (unit == \"line\") { return new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))) }\n    var result = unit(cm, pos);\n    return new Range(result.from, result.to)\n  }\n\n  // Normal selection, as opposed to text dragging.\n  function leftButtonSelect(cm, event, start, behavior) {\n    var display = cm.display, doc = cm.doc;\n    e_preventDefault(event);\n\n    var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\n    if (behavior.addNew && !behavior.extend) {\n      ourIndex = doc.sel.contains(start);\n      if (ourIndex > -1)\n        { ourRange = ranges[ourIndex]; }\n      else\n        { ourRange = new Range(start, start); }\n    } else {\n      ourRange = doc.sel.primary();\n      ourIndex = doc.sel.primIndex;\n    }\n\n    if (behavior.unit == \"rectangle\") {\n      if (!behavior.addNew) { ourRange = new Range(start, start); }\n      start = posFromMouse(cm, event, true, true);\n      ourIndex = -1;\n    } else {\n      var range$$1 = rangeForUnit(cm, start, behavior.unit);\n      if (behavior.extend)\n        { ourRange = extendRange(ourRange, range$$1.anchor, range$$1.head, behavior.extend); }\n      else\n        { ourRange = range$$1; }\n    }\n\n    if (!behavior.addNew) {\n      ourIndex = 0;\n      setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n      startSel = doc.sel;\n    } else if (ourIndex == -1) {\n      ourIndex = ranges.length;\n      setSelection(doc, normalizeSelection(cm, ranges.concat([ourRange]), ourIndex),\n                   {scroll: false, origin: \"*mouse\"});\n    } else if (ranges.length > 1 && ranges[ourIndex].empty() && behavior.unit == \"char\" && !behavior.extend) {\n      setSelection(doc, normalizeSelection(cm, ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\n                   {scroll: false, origin: \"*mouse\"});\n      startSel = doc.sel;\n    } else {\n      replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n    }\n\n    var lastPos = start;\n    function extendTo(pos) {\n      if (cmp(lastPos, pos) == 0) { return }\n      lastPos = pos;\n\n      if (behavior.unit == \"rectangle\") {\n        var ranges = [], tabSize = cm.options.tabSize;\n        var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n        var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n        var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n        for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n             line <= end; line++) {\n          var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n          if (left == right)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))); }\n          else if (text.length > leftPos)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))); }\n        }\n        if (!ranges.length) { ranges.push(new Range(start, start)); }\n        setSelection(doc, normalizeSelection(cm, startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                     {origin: \"*mouse\", scroll: false});\n        cm.scrollIntoView(pos);\n      } else {\n        var oldRange = ourRange;\n        var range$$1 = rangeForUnit(cm, pos, behavior.unit);\n        var anchor = oldRange.anchor, head;\n        if (cmp(range$$1.anchor, anchor) > 0) {\n          head = range$$1.head;\n          anchor = minPos(oldRange.from(), range$$1.anchor);\n        } else {\n          head = range$$1.anchor;\n          anchor = maxPos(oldRange.to(), range$$1.head);\n        }\n        var ranges$1 = startSel.ranges.slice(0);\n        ranges$1[ourIndex] = bidiSimplify(cm, new Range(clipPos(doc, anchor), head));\n        setSelection(doc, normalizeSelection(cm, ranges$1, ourIndex), sel_mouse);\n      }\n    }\n\n    var editorSize = display.wrapper.getBoundingClientRect();\n    // Used to ensure timeout re-tries don't fire when another extend\n    // happened in the meantime (clearTimeout isn't reliable -- at\n    // least on Chrome, the timeouts still happen even when cleared,\n    // if the clear happens after their scheduled firing time).\n    var counter = 0;\n\n    function extend(e) {\n      var curCount = ++counter;\n      var cur = posFromMouse(cm, e, true, behavior.unit == \"rectangle\");\n      if (!cur) { return }\n      if (cmp(cur, lastPos) != 0) {\n        cm.curOp.focus = activeElt();\n        extendTo(cur);\n        var visible = visibleLines(display, doc);\n        if (cur.line >= visible.to || cur.line < visible.from)\n          { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e); }}), 150); }\n      } else {\n        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n        if (outside) { setTimeout(operation(cm, function () {\n          if (counter != curCount) { return }\n          display.scroller.scrollTop += outside;\n          extend(e);\n        }), 50); }\n      }\n    }\n\n    function done(e) {\n      cm.state.selectingText = false;\n      counter = Infinity;\n      e_preventDefault(e);\n      display.input.focus();\n      off(display.wrapper.ownerDocument, \"mousemove\", move);\n      off(display.wrapper.ownerDocument, \"mouseup\", up);\n      doc.history.lastSelOrigin = null;\n    }\n\n    var move = operation(cm, function (e) {\n      if (e.buttons === 0 || !e_button(e)) { done(e); }\n      else { extend(e); }\n    });\n    var up = operation(cm, done);\n    cm.state.selectingText = up;\n    on(display.wrapper.ownerDocument, \"mousemove\", move);\n    on(display.wrapper.ownerDocument, \"mouseup\", up);\n  }\n\n  // Used when mouse-selecting to adjust the anchor to the proper side\n  // of a bidi jump depending on the visual position of the head.\n  function bidiSimplify(cm, range$$1) {\n    var anchor = range$$1.anchor;\n    var head = range$$1.head;\n    var anchorLine = getLine(cm.doc, anchor.line);\n    if (cmp(anchor, head) == 0 && anchor.sticky == head.sticky) { return range$$1 }\n    var order = getOrder(anchorLine);\n    if (!order) { return range$$1 }\n    var index = getBidiPartAt(order, anchor.ch, anchor.sticky), part = order[index];\n    if (part.from != anchor.ch && part.to != anchor.ch) { return range$$1 }\n    var boundary = index + ((part.from == anchor.ch) == (part.level != 1) ? 0 : 1);\n    if (boundary == 0 || boundary == order.length) { return range$$1 }\n\n    // Compute the relative visual position of the head compared to the\n    // anchor (<0 is to the left, >0 to the right)\n    var leftSide;\n    if (head.line != anchor.line) {\n      leftSide = (head.line - anchor.line) * (cm.doc.direction == \"ltr\" ? 1 : -1) > 0;\n    } else {\n      var headIndex = getBidiPartAt(order, head.ch, head.sticky);\n      var dir = headIndex - index || (head.ch - anchor.ch) * (part.level == 1 ? -1 : 1);\n      if (headIndex == boundary - 1 || headIndex == boundary)\n        { leftSide = dir < 0; }\n      else\n        { leftSide = dir > 0; }\n    }\n\n    var usePart = order[boundary + (leftSide ? -1 : 0)];\n    var from = leftSide == (usePart.level == 1);\n    var ch = from ? usePart.from : usePart.to, sticky = from ? \"after\" : \"before\";\n    return anchor.ch == ch && anchor.sticky == sticky ? range$$1 : new Range(new Pos(anchor.line, ch, sticky), head)\n  }\n\n\n  // Determines whether an event happened in the gutter, and fires the\n  // handlers for the corresponding event.\n  function gutterEvent(cm, e, type, prevent) {\n    var mX, mY;\n    if (e.touches) {\n      mX = e.touches[0].clientX;\n      mY = e.touches[0].clientY;\n    } else {\n      try { mX = e.clientX; mY = e.clientY; }\n      catch(e) { return false }\n    }\n    if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\n    if (prevent) { e_preventDefault(e); }\n\n    var display = cm.display;\n    var lineBox = display.lineDiv.getBoundingClientRect();\n\n    if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\n    mY -= lineBox.top - display.viewOffset;\n\n    for (var i = 0; i < cm.options.gutters.length; ++i) {\n      var g = display.gutters.childNodes[i];\n      if (g && g.getBoundingClientRect().right >= mX) {\n        var line = lineAtHeight(cm.doc, mY);\n        var gutter = cm.options.gutters[i];\n        signal(cm, type, cm, line, gutter, e);\n        return e_defaultPrevented(e)\n      }\n    }\n  }\n\n  function clickInGutter(cm, e) {\n    return gutterEvent(cm, e, \"gutterClick\", true)\n  }\n\n  // CONTEXT MENU HANDLING\n\n  // To make the context menu work, we need to briefly unhide the\n  // textarea (making it as unobtrusive as possible) to let the\n  // right-click take effect on it.\n  function onContextMenu(cm, e) {\n    if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\n    if (signalDOMEvent(cm, e, \"contextmenu\")) { return }\n    if (!captureRightClick) { cm.display.input.onContextMenu(e); }\n  }\n\n  function contextMenuInGutter(cm, e) {\n    if (!hasHandler(cm, \"gutterContextMenu\")) { return false }\n    return gutterEvent(cm, e, \"gutterContextMenu\", false)\n  }\n\n  function themeChanged(cm) {\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n      cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n    clearCaches(cm);\n  }\n\n  var Init = {toString: function(){return \"CodeMirror.Init\"}};\n\n  var defaults = {};\n  var optionHandlers = {};\n\n  function defineOptions(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    function option(name, deflt, handle, notOnInit) {\n      CodeMirror.defaults[name] = deflt;\n      if (handle) { optionHandlers[name] =\n        notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old); }} : handle; }\n    }\n\n    CodeMirror.defineOption = option;\n\n    // Passed to option handlers when there is no old value.\n    CodeMirror.Init = Init;\n\n    // These two are, on init, called from the constructor because they\n    // have to be initialized before the editor can start at all.\n    option(\"value\", \"\", function (cm, val) { return cm.setValue(val); }, true);\n    option(\"mode\", null, function (cm, val) {\n      cm.doc.modeOption = val;\n      loadMode(cm);\n    }, true);\n\n    option(\"indentUnit\", 2, loadMode, true);\n    option(\"indentWithTabs\", false);\n    option(\"smartIndent\", true);\n    option(\"tabSize\", 4, function (cm) {\n      resetModeState(cm);\n      clearCaches(cm);\n      regChange(cm);\n    }, true);\n\n    option(\"lineSeparator\", null, function (cm, val) {\n      cm.doc.lineSep = val;\n      if (!val) { return }\n      var newBreaks = [], lineNo = cm.doc.first;\n      cm.doc.iter(function (line) {\n        for (var pos = 0;;) {\n          var found = line.text.indexOf(val, pos);\n          if (found == -1) { break }\n          pos = found + val.length;\n          newBreaks.push(Pos(lineNo, found));\n        }\n        lineNo++;\n      });\n      for (var i = newBreaks.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)); }\n    });\n    option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200f\\u2028\\u2029\\ufeff]/g, function (cm, val, old) {\n      cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n      if (old != Init) { cm.refresh(); }\n    });\n    option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true);\n    option(\"electricChars\", true);\n    option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n      throw new Error(\"inputStyle can not (yet) be changed in a running editor\") // FIXME\n    }, true);\n    option(\"spellcheck\", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true);\n    option(\"autocorrect\", false, function (cm, val) { return cm.getInputField().autocorrect = val; }, true);\n    option(\"autocapitalize\", false, function (cm, val) { return cm.getInputField().autocapitalize = val; }, true);\n    option(\"rtlMoveVisually\", !windows);\n    option(\"wholeLineUpdateBefore\", true);\n\n    option(\"theme\", \"default\", function (cm) {\n      themeChanged(cm);\n      guttersChanged(cm);\n    }, true);\n    option(\"keyMap\", \"default\", function (cm, val, old) {\n      var next = getKeyMap(val);\n      var prev = old != Init && getKeyMap(old);\n      if (prev && prev.detach) { prev.detach(cm, next); }\n      if (next.attach) { next.attach(cm, prev || null); }\n    });\n    option(\"extraKeys\", null);\n    option(\"configureMouse\", null);\n\n    option(\"lineWrapping\", false, wrappingChanged, true);\n    option(\"gutters\", [], function (cm) {\n      setGuttersForLineNumbers(cm.options);\n      guttersChanged(cm);\n    }, true);\n    option(\"fixedGutter\", true, function (cm, val) {\n      cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n      cm.refresh();\n    }, true);\n    option(\"coverGutterNextToScrollbar\", false, function (cm) { return updateScrollbars(cm); }, true);\n    option(\"scrollbarStyle\", \"native\", function (cm) {\n      initScrollbars(cm);\n      updateScrollbars(cm);\n      cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n      cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n    }, true);\n    option(\"lineNumbers\", false, function (cm) {\n      setGuttersForLineNumbers(cm.options);\n      guttersChanged(cm);\n    }, true);\n    option(\"firstLineNumber\", 1, guttersChanged, true);\n    option(\"lineNumberFormatter\", function (integer) { return integer; }, guttersChanged, true);\n    option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n    option(\"resetSelectionOnContextMenu\", true);\n    option(\"lineWiseCopyCut\", true);\n    option(\"pasteLinesPerSelection\", true);\n    option(\"selectionsMayTouch\", false);\n\n    option(\"readOnly\", false, function (cm, val) {\n      if (val == \"nocursor\") {\n        onBlur(cm);\n        cm.display.input.blur();\n      }\n      cm.display.input.readOnlyChanged(val);\n    });\n    option(\"disableInput\", false, function (cm, val) {if (!val) { cm.display.input.reset(); }}, true);\n    option(\"dragDrop\", true, dragDropChanged);\n    option(\"allowDropFileTypes\", null);\n\n    option(\"cursorBlinkRate\", 530);\n    option(\"cursorScrollMargin\", 0);\n    option(\"cursorHeight\", 1, updateSelection, true);\n    option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n    option(\"workTime\", 100);\n    option(\"workDelay\", 100);\n    option(\"flattenSpans\", true, resetModeState, true);\n    option(\"addModeClass\", false, resetModeState, true);\n    option(\"pollInterval\", 100);\n    option(\"undoDepth\", 200, function (cm, val) { return cm.doc.history.undoDepth = val; });\n    option(\"historyEventDelay\", 1250);\n    option(\"viewportMargin\", 10, function (cm) { return cm.refresh(); }, true);\n    option(\"maxHighlightLength\", 10000, resetModeState, true);\n    option(\"moveInputWithCursor\", true, function (cm, val) {\n      if (!val) { cm.display.input.resetPosition(); }\n    });\n\n    option(\"tabindex\", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || \"\"; });\n    option(\"autofocus\", null);\n    option(\"direction\", \"ltr\", function (cm, val) { return cm.doc.setDirection(val); }, true);\n    option(\"phrases\", null);\n  }\n\n  function guttersChanged(cm) {\n    updateGutters(cm);\n    regChange(cm);\n    alignHorizontally(cm);\n  }\n\n  function dragDropChanged(cm, value, old) {\n    var wasOn = old && old != Init;\n    if (!value != !wasOn) {\n      var funcs = cm.display.dragFunctions;\n      var toggle = value ? on : off;\n      toggle(cm.display.scroller, \"dragstart\", funcs.start);\n      toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n      toggle(cm.display.scroller, \"dragover\", funcs.over);\n      toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n      toggle(cm.display.scroller, \"drop\", funcs.drop);\n    }\n  }\n\n  function wrappingChanged(cm) {\n    if (cm.options.lineWrapping) {\n      addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      cm.display.sizer.style.minWidth = \"\";\n      cm.display.sizerWidth = null;\n    } else {\n      rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      findMaxLine(cm);\n    }\n    estimateLineHeights(cm);\n    regChange(cm);\n    clearCaches(cm);\n    setTimeout(function () { return updateScrollbars(cm); }, 100);\n  }\n\n  // A CodeMirror instance represents an editor. This is the object\n  // that user code is usually dealing with.\n\n  function CodeMirror(place, options) {\n    var this$1 = this;\n\n    if (!(this instanceof CodeMirror)) { return new CodeMirror(place, options) }\n\n    this.options = options = options ? copyObj(options) : {};\n    // Determine effective options based on given values and defaults.\n    copyObj(defaults, options, false);\n    setGuttersForLineNumbers(options);\n\n    var doc = options.value;\n    if (typeof doc == \"string\") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction); }\n    else if (options.mode) { doc.modeOption = options.mode; }\n    this.doc = doc;\n\n    var input = new CodeMirror.inputStyles[options.inputStyle](this);\n    var display = this.display = new Display(place, doc, input);\n    display.wrapper.CodeMirror = this;\n    updateGutters(this);\n    themeChanged(this);\n    if (options.lineWrapping)\n      { this.display.wrapper.className += \" CodeMirror-wrap\"; }\n    initScrollbars(this);\n\n    this.state = {\n      keyMaps: [],  // stores maps added by addKeyMap\n      overlays: [], // highlighting overlays, as added by addOverlay\n      modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n      overwrite: false,\n      delayingBlurEvent: false,\n      focused: false,\n      suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n      pasteIncoming: -1, cutIncoming: -1, // help recognize paste/cut edits in input.poll\n      selectingText: false,\n      draggingText: false,\n      highlight: new Delayed(), // stores highlight worker timeout\n      keySeq: null,  // Unfinished key sequence\n      specialChars: null\n    };\n\n    if (options.autofocus && !mobile) { display.input.focus(); }\n\n    // Override magic textarea content restore that IE sometimes does\n    // on our hidden textarea on reload\n    if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20); }\n\n    registerEventHandlers(this);\n    ensureGlobalHandlers();\n\n    startOperation(this);\n    this.curOp.forceUpdate = true;\n    attachDoc(this, doc);\n\n    if ((options.autofocus && !mobile) || this.hasFocus())\n      { setTimeout(bind(onFocus, this), 20); }\n    else\n      { onBlur(this); }\n\n    for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\n      { optionHandlers[opt](this$1, options[opt], Init); } }\n    maybeUpdateLineNumberWidth(this);\n    if (options.finishInit) { options.finishInit(this); }\n    for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this$1); }\n    endOperation(this);\n    // Suppress optimizelegibility in Webkit, since it breaks text\n    // measuring on line wrapping boundaries.\n    if (webkit && options.lineWrapping &&\n        getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n      { display.lineDiv.style.textRendering = \"auto\"; }\n  }\n\n  // The default configuration options.\n  CodeMirror.defaults = defaults;\n  // Functions to run when options are changed.\n  CodeMirror.optionHandlers = optionHandlers;\n\n  // Attach the necessary event handlers when initializing the editor\n  function registerEventHandlers(cm) {\n    var d = cm.display;\n    on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n    // Older IE's will not fire a second mousedown for a double click\n    if (ie && ie_version < 11)\n      { on(d.scroller, \"dblclick\", operation(cm, function (e) {\n        if (signalDOMEvent(cm, e)) { return }\n        var pos = posFromMouse(cm, e);\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\n        e_preventDefault(e);\n        var word = cm.findWordAt(pos);\n        extendSelection(cm.doc, word.anchor, word.head);\n      })); }\n    else\n      { on(d.scroller, \"dblclick\", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }); }\n    // Some browsers fire contextmenu *after* opening the menu, at\n    // which point we can't mess with it anymore. Context menu is\n    // handled in onMouseDown for these browsers.\n    on(d.scroller, \"contextmenu\", function (e) { return onContextMenu(cm, e); });\n\n    // Used to suppress mouse event handling when a touch happens\n    var touchFinished, prevTouch = {end: 0};\n    function finishTouch() {\n      if (d.activeTouch) {\n        touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000);\n        prevTouch = d.activeTouch;\n        prevTouch.end = +new Date;\n      }\n    }\n    function isMouseLikeTouchEvent(e) {\n      if (e.touches.length != 1) { return false }\n      var touch = e.touches[0];\n      return touch.radiusX <= 1 && touch.radiusY <= 1\n    }\n    function farAway(touch, other) {\n      if (other.left == null) { return true }\n      var dx = other.left - touch.left, dy = other.top - touch.top;\n      return dx * dx + dy * dy > 20 * 20\n    }\n    on(d.scroller, \"touchstart\", function (e) {\n      if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e) && !clickInGutter(cm, e)) {\n        d.input.ensurePolled();\n        clearTimeout(touchFinished);\n        var now = +new Date;\n        d.activeTouch = {start: now, moved: false,\n                         prev: now - prevTouch.end <= 300 ? prevTouch : null};\n        if (e.touches.length == 1) {\n          d.activeTouch.left = e.touches[0].pageX;\n          d.activeTouch.top = e.touches[0].pageY;\n        }\n      }\n    });\n    on(d.scroller, \"touchmove\", function () {\n      if (d.activeTouch) { d.activeTouch.moved = true; }\n    });\n    on(d.scroller, \"touchend\", function (e) {\n      var touch = d.activeTouch;\n      if (touch && !eventInWidget(d, e) && touch.left != null &&\n          !touch.moved && new Date - touch.start < 300) {\n        var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n        if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n          { range = new Range(pos, pos); }\n        else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n          { range = cm.findWordAt(pos); }\n        else // Triple tap\n          { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))); }\n        cm.setSelection(range.anchor, range.head);\n        cm.focus();\n        e_preventDefault(e);\n      }\n      finishTouch();\n    });\n    on(d.scroller, \"touchcancel\", finishTouch);\n\n    // Sync scrolling between fake scrollbars and real scrollable\n    // area, ensure viewport is updated when scrolling.\n    on(d.scroller, \"scroll\", function () {\n      if (d.scroller.clientHeight) {\n        updateScrollTop(cm, d.scroller.scrollTop);\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\n        signal(cm, \"scroll\", cm);\n      }\n    });\n\n    // Listen to wheel events in order to try and update the viewport on time.\n    on(d.scroller, \"mousewheel\", function (e) { return onScrollWheel(cm, e); });\n    on(d.scroller, \"DOMMouseScroll\", function (e) { return onScrollWheel(cm, e); });\n\n    // Prevent wrapper from ever scrolling\n    on(d.wrapper, \"scroll\", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n    d.dragFunctions = {\n      enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e); }},\n      over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n      start: function (e) { return onDragStart(cm, e); },\n      drop: operation(cm, onDrop),\n      leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\n    };\n\n    var inp = d.input.getField();\n    on(inp, \"keyup\", function (e) { return onKeyUp.call(cm, e); });\n    on(inp, \"keydown\", operation(cm, onKeyDown));\n    on(inp, \"keypress\", operation(cm, onKeyPress));\n    on(inp, \"focus\", function (e) { return onFocus(cm, e); });\n    on(inp, \"blur\", function (e) { return onBlur(cm, e); });\n  }\n\n  var initHooks = [];\n  CodeMirror.defineInitHook = function (f) { return initHooks.push(f); };\n\n  // Indent the given line. The how parameter can be \"smart\",\n  // \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n  // (typically set to true for forced single-line indents), empty\n  // lines are not indented, and places where the mode returns Pass\n  // are left alone.\n  function indentLine(cm, n, how, aggressive) {\n    var doc = cm.doc, state;\n    if (how == null) { how = \"add\"; }\n    if (how == \"smart\") {\n      // Fall back to \"prev\" when the mode doesn't have an indentation\n      // method.\n      if (!doc.mode.indent) { how = \"prev\"; }\n      else { state = getContextBefore(cm, n).state; }\n    }\n\n    var tabSize = cm.options.tabSize;\n    var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n    if (line.stateAfter) { line.stateAfter = null; }\n    var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n    if (!aggressive && !/\\S/.test(line.text)) {\n      indentation = 0;\n      how = \"not\";\n    } else if (how == \"smart\") {\n      indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n      if (indentation == Pass || indentation > 150) {\n        if (!aggressive) { return }\n        how = \"prev\";\n      }\n    }\n    if (how == \"prev\") {\n      if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize); }\n      else { indentation = 0; }\n    } else if (how == \"add\") {\n      indentation = curSpace + cm.options.indentUnit;\n    } else if (how == \"subtract\") {\n      indentation = curSpace - cm.options.indentUnit;\n    } else if (typeof how == \"number\") {\n      indentation = curSpace + how;\n    }\n    indentation = Math.max(0, indentation);\n\n    var indentString = \"\", pos = 0;\n    if (cm.options.indentWithTabs)\n      { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";} }\n    if (pos < indentation) { indentString += spaceStr(indentation - pos); }\n\n    if (indentString != curSpaceString) {\n      replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n      line.stateAfter = null;\n      return true\n    } else {\n      // Ensure that, if the cursor was in the whitespace at the start\n      // of the line, it is moved to the end of that space.\n      for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n        var range = doc.sel.ranges[i$1];\n        if (range.head.line == n && range.head.ch < curSpaceString.length) {\n          var pos$1 = Pos(n, curSpaceString.length);\n          replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n          break\n        }\n      }\n    }\n  }\n\n  // This will be set to a {lineWise: bool, text: [string]} object, so\n  // that, when pasting, we know what kind of selections the copied\n  // text was made out of.\n  var lastCopied = null;\n\n  function setLastCopied(newLastCopied) {\n    lastCopied = newLastCopied;\n  }\n\n  function applyTextInput(cm, inserted, deleted, sel, origin) {\n    var doc = cm.doc;\n    cm.display.shift = false;\n    if (!sel) { sel = doc.sel; }\n\n    var recent = +new Date - 200;\n    var paste = origin == \"paste\" || cm.state.pasteIncoming > recent;\n    var textLines = splitLinesAuto(inserted), multiPaste = null;\n    // When pasting N lines into N selections, insert one line per selection\n    if (paste && sel.ranges.length > 1) {\n      if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n        if (sel.ranges.length % lastCopied.text.length == 0) {\n          multiPaste = [];\n          for (var i = 0; i < lastCopied.text.length; i++)\n            { multiPaste.push(doc.splitLines(lastCopied.text[i])); }\n        }\n      } else if (textLines.length == sel.ranges.length && cm.options.pasteLinesPerSelection) {\n        multiPaste = map(textLines, function (l) { return [l]; });\n      }\n    }\n\n    var updateInput = cm.curOp.updateInput;\n    // Normal behavior is to insert the new text into every selection\n    for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n      var range$$1 = sel.ranges[i$1];\n      var from = range$$1.from(), to = range$$1.to();\n      if (range$$1.empty()) {\n        if (deleted && deleted > 0) // Handle deletion\n          { from = Pos(from.line, from.ch - deleted); }\n        else if (cm.state.overwrite && !paste) // Handle overwrite\n          { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)); }\n        else if (paste && lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == inserted)\n          { from = to = Pos(from.line, 0); }\n      }\n      var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n                         origin: origin || (paste ? \"paste\" : cm.state.cutIncoming > recent ? \"cut\" : \"+input\")};\n      makeChange(cm.doc, changeEvent);\n      signalLater(cm, \"inputRead\", cm, changeEvent);\n    }\n    if (inserted && !paste)\n      { triggerElectric(cm, inserted); }\n\n    ensureCursorVisible(cm);\n    if (cm.curOp.updateInput < 2) { cm.curOp.updateInput = updateInput; }\n    cm.curOp.typing = true;\n    cm.state.pasteIncoming = cm.state.cutIncoming = -1;\n  }\n\n  function handlePaste(e, cm) {\n    var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n    if (pasted) {\n      e.preventDefault();\n      if (!cm.isReadOnly() && !cm.options.disableInput)\n        { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, \"paste\"); }); }\n      return true\n    }\n  }\n\n  function triggerElectric(cm, inserted) {\n    // When an 'electric' character is inserted, immediately trigger a reindent\n    if (!cm.options.electricChars || !cm.options.smartIndent) { return }\n    var sel = cm.doc.sel;\n\n    for (var i = sel.ranges.length - 1; i >= 0; i--) {\n      var range$$1 = sel.ranges[i];\n      if (range$$1.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range$$1.head.line)) { continue }\n      var mode = cm.getModeAt(range$$1.head);\n      var indented = false;\n      if (mode.electricChars) {\n        for (var j = 0; j < mode.electricChars.length; j++)\n          { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n            indented = indentLine(cm, range$$1.head.line, \"smart\");\n            break\n          } }\n      } else if (mode.electricInput) {\n        if (mode.electricInput.test(getLine(cm.doc, range$$1.head.line).text.slice(0, range$$1.head.ch)))\n          { indented = indentLine(cm, range$$1.head.line, \"smart\"); }\n      }\n      if (indented) { signalLater(cm, \"electricInput\", cm, range$$1.head.line); }\n    }\n  }\n\n  function copyableRanges(cm) {\n    var text = [], ranges = [];\n    for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n      var line = cm.doc.sel.ranges[i].head.line;\n      var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n      ranges.push(lineRange);\n      text.push(cm.getRange(lineRange.anchor, lineRange.head));\n    }\n    return {text: text, ranges: ranges}\n  }\n\n  function disableBrowserMagic(field, spellcheck, autocorrect, autocapitalize) {\n    field.setAttribute(\"autocorrect\", !!autocorrect);\n    field.setAttribute(\"autocapitalize\", !!autocapitalize);\n    field.setAttribute(\"spellcheck\", !!spellcheck);\n  }\n\n  function hiddenTextarea() {\n    var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\");\n    var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n    // The textarea is kept positioned near the cursor to prevent the\n    // fact that it'll be scrolled into view on input from scrolling\n    // our fake cursor out of view. On webkit, when wrap=off, paste is\n    // very slow. So make the area wide instead.\n    if (webkit) { te.style.width = \"1000px\"; }\n    else { te.setAttribute(\"wrap\", \"off\"); }\n    // If border: 0; -- iOS fails to open keyboard (issue #1287)\n    if (ios) { te.style.border = \"1px solid black\"; }\n    disableBrowserMagic(te);\n    return div\n  }\n\n  // The publicly visible API. Note that methodOp(f) means\n  // 'wrap f in an operation, performed on its `this` parameter'.\n\n  // This is not the complete set of editor methods. Most of the\n  // methods defined on the Doc type are also injected into\n  // CodeMirror.prototype, for backwards compatibility and\n  // convenience.\n\n  function addEditorMethods(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    var helpers = CodeMirror.helpers = {};\n\n    CodeMirror.prototype = {\n      constructor: CodeMirror,\n      focus: function(){window.focus(); this.display.input.focus();},\n\n      setOption: function(option, value) {\n        var options = this.options, old = options[option];\n        if (options[option] == value && option != \"mode\") { return }\n        options[option] = value;\n        if (optionHandlers.hasOwnProperty(option))\n          { operation(this, optionHandlers[option])(this, value, old); }\n        signal(this, \"optionChange\", this, option);\n      },\n\n      getOption: function(option) {return this.options[option]},\n      getDoc: function() {return this.doc},\n\n      addKeyMap: function(map$$1, bottom) {\n        this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map$$1));\n      },\n      removeKeyMap: function(map$$1) {\n        var maps = this.state.keyMaps;\n        for (var i = 0; i < maps.length; ++i)\n          { if (maps[i] == map$$1 || maps[i].name == map$$1) {\n            maps.splice(i, 1);\n            return true\n          } }\n      },\n\n      addOverlay: methodOp(function(spec, options) {\n        var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n        if (mode.startState) { throw new Error(\"Overlays may not be stateful.\") }\n        insertSorted(this.state.overlays,\n                     {mode: mode, modeSpec: spec, opaque: options && options.opaque,\n                      priority: (options && options.priority) || 0},\n                     function (overlay) { return overlay.priority; });\n        this.state.modeGen++;\n        regChange(this);\n      }),\n      removeOverlay: methodOp(function(spec) {\n        var this$1 = this;\n\n        var overlays = this.state.overlays;\n        for (var i = 0; i < overlays.length; ++i) {\n          var cur = overlays[i].modeSpec;\n          if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n            overlays.splice(i, 1);\n            this$1.state.modeGen++;\n            regChange(this$1);\n            return\n          }\n        }\n      }),\n\n      indentLine: methodOp(function(n, dir, aggressive) {\n        if (typeof dir != \"string\" && typeof dir != \"number\") {\n          if (dir == null) { dir = this.options.smartIndent ? \"smart\" : \"prev\"; }\n          else { dir = dir ? \"add\" : \"subtract\"; }\n        }\n        if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive); }\n      }),\n      indentSelection: methodOp(function(how) {\n        var this$1 = this;\n\n        var ranges = this.doc.sel.ranges, end = -1;\n        for (var i = 0; i < ranges.length; i++) {\n          var range$$1 = ranges[i];\n          if (!range$$1.empty()) {\n            var from = range$$1.from(), to = range$$1.to();\n            var start = Math.max(end, from.line);\n            end = Math.min(this$1.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n            for (var j = start; j < end; ++j)\n              { indentLine(this$1, j, how); }\n            var newRanges = this$1.doc.sel.ranges;\n            if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n              { replaceOneSelection(this$1.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll); }\n          } else if (range$$1.head.line > end) {\n            indentLine(this$1, range$$1.head.line, how, true);\n            end = range$$1.head.line;\n            if (i == this$1.doc.sel.primIndex) { ensureCursorVisible(this$1); }\n          }\n        }\n      }),\n\n      // Fetch the parser token for a given character. Useful for hacks\n      // that want to inspect the mode state (say, for completion).\n      getTokenAt: function(pos, precise) {\n        return takeToken(this, pos, precise)\n      },\n\n      getLineTokens: function(line, precise) {\n        return takeToken(this, Pos(line), precise, true)\n      },\n\n      getTokenTypeAt: function(pos) {\n        pos = clipPos(this.doc, pos);\n        var styles = getLineStyles(this, getLine(this.doc, pos.line));\n        var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n        var type;\n        if (ch == 0) { type = styles[2]; }\n        else { for (;;) {\n          var mid = (before + after) >> 1;\n          if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid; }\n          else if (styles[mid * 2 + 1] < ch) { before = mid + 1; }\n          else { type = styles[mid * 2 + 2]; break }\n        } }\n        var cut = type ? type.indexOf(\"overlay \") : -1;\n        return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\n      },\n\n      getModeAt: function(pos) {\n        var mode = this.doc.mode;\n        if (!mode.innerMode) { return mode }\n        return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\n      },\n\n      getHelper: function(pos, type) {\n        return this.getHelpers(pos, type)[0]\n      },\n\n      getHelpers: function(pos, type) {\n        var this$1 = this;\n\n        var found = [];\n        if (!helpers.hasOwnProperty(type)) { return found }\n        var help = helpers[type], mode = this.getModeAt(pos);\n        if (typeof mode[type] == \"string\") {\n          if (help[mode[type]]) { found.push(help[mode[type]]); }\n        } else if (mode[type]) {\n          for (var i = 0; i < mode[type].length; i++) {\n            var val = help[mode[type][i]];\n            if (val) { found.push(val); }\n          }\n        } else if (mode.helperType && help[mode.helperType]) {\n          found.push(help[mode.helperType]);\n        } else if (help[mode.name]) {\n          found.push(help[mode.name]);\n        }\n        for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n          var cur = help._global[i$1];\n          if (cur.pred(mode, this$1) && indexOf(found, cur.val) == -1)\n            { found.push(cur.val); }\n        }\n        return found\n      },\n\n      getStateAfter: function(line, precise) {\n        var doc = this.doc;\n        line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n        return getContextBefore(this, line + 1, precise).state\n      },\n\n      cursorCoords: function(start, mode) {\n        var pos, range$$1 = this.doc.sel.primary();\n        if (start == null) { pos = range$$1.head; }\n        else if (typeof start == \"object\") { pos = clipPos(this.doc, start); }\n        else { pos = start ? range$$1.from() : range$$1.to(); }\n        return cursorCoords(this, pos, mode || \"page\")\n      },\n\n      charCoords: function(pos, mode) {\n        return charCoords(this, clipPos(this.doc, pos), mode || \"page\")\n      },\n\n      coordsChar: function(coords, mode) {\n        coords = fromCoordSystem(this, coords, mode || \"page\");\n        return coordsChar(this, coords.left, coords.top)\n      },\n\n      lineAtHeight: function(height, mode) {\n        height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n        return lineAtHeight(this.doc, height + this.display.viewOffset)\n      },\n      heightAtLine: function(line, mode, includeWidgets) {\n        var end = false, lineObj;\n        if (typeof line == \"number\") {\n          var last = this.doc.first + this.doc.size - 1;\n          if (line < this.doc.first) { line = this.doc.first; }\n          else if (line > last) { line = last; end = true; }\n          lineObj = getLine(this.doc, line);\n        } else {\n          lineObj = line;\n        }\n        return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\", includeWidgets || end).top +\n          (end ? this.doc.height - heightAtLine(lineObj) : 0)\n      },\n\n      defaultTextHeight: function() { return textHeight(this.display) },\n      defaultCharWidth: function() { return charWidth(this.display) },\n\n      getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\n\n      addWidget: function(pos, node, scroll, vert, horiz) {\n        var display = this.display;\n        pos = cursorCoords(this, clipPos(this.doc, pos));\n        var top = pos.bottom, left = pos.left;\n        node.style.position = \"absolute\";\n        node.setAttribute(\"cm-ignore-events\", \"true\");\n        this.display.input.setUneditable(node);\n        display.sizer.appendChild(node);\n        if (vert == \"over\") {\n          top = pos.top;\n        } else if (vert == \"above\" || vert == \"near\") {\n          var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n          hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n          // Default to positioning above (if specified and possible); otherwise default to positioning below\n          if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n            { top = pos.top - node.offsetHeight; }\n          else if (pos.bottom + node.offsetHeight <= vspace)\n            { top = pos.bottom; }\n          if (left + node.offsetWidth > hspace)\n            { left = hspace - node.offsetWidth; }\n        }\n        node.style.top = top + \"px\";\n        node.style.left = node.style.right = \"\";\n        if (horiz == \"right\") {\n          left = display.sizer.clientWidth - node.offsetWidth;\n          node.style.right = \"0px\";\n        } else {\n          if (horiz == \"left\") { left = 0; }\n          else if (horiz == \"middle\") { left = (display.sizer.clientWidth - node.offsetWidth) / 2; }\n          node.style.left = left + \"px\";\n        }\n        if (scroll)\n          { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}); }\n      },\n\n      triggerOnKeyDown: methodOp(onKeyDown),\n      triggerOnKeyPress: methodOp(onKeyPress),\n      triggerOnKeyUp: onKeyUp,\n      triggerOnMouseDown: methodOp(onMouseDown),\n\n      execCommand: function(cmd) {\n        if (commands.hasOwnProperty(cmd))\n          { return commands[cmd].call(null, this) }\n      },\n\n      triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n      findPosH: function(from, amount, unit, visually) {\n        var this$1 = this;\n\n        var dir = 1;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          cur = findPosH(this$1.doc, cur, dir, unit, visually);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveH: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        this.extendSelectionsBy(function (range$$1) {\n          if (this$1.display.shift || this$1.doc.extend || range$$1.empty())\n            { return findPosH(this$1.doc, range$$1.head, dir, unit, this$1.options.rtlMoveVisually) }\n          else\n            { return dir < 0 ? range$$1.from() : range$$1.to() }\n        }, sel_move);\n      }),\n\n      deleteH: methodOp(function(dir, unit) {\n        var sel = this.doc.sel, doc = this.doc;\n        if (sel.somethingSelected())\n          { doc.replaceSelection(\"\", null, \"+delete\"); }\n        else\n          { deleteNearSelection(this, function (range$$1) {\n            var other = findPosH(doc, range$$1.head, dir, unit, false);\n            return dir < 0 ? {from: other, to: range$$1.head} : {from: range$$1.head, to: other}\n          }); }\n      }),\n\n      findPosV: function(from, amount, unit, goalColumn) {\n        var this$1 = this;\n\n        var dir = 1, x = goalColumn;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          var coords = cursorCoords(this$1, cur, \"div\");\n          if (x == null) { x = coords.left; }\n          else { coords.left = x; }\n          cur = findPosV(this$1, coords, dir, unit);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveV: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        var doc = this.doc, goals = [];\n        var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n        doc.extendSelectionsBy(function (range$$1) {\n          if (collapse)\n            { return dir < 0 ? range$$1.from() : range$$1.to() }\n          var headPos = cursorCoords(this$1, range$$1.head, \"div\");\n          if (range$$1.goalColumn != null) { headPos.left = range$$1.goalColumn; }\n          goals.push(headPos.left);\n          var pos = findPosV(this$1, headPos, dir, unit);\n          if (unit == \"page\" && range$$1 == doc.sel.primary())\n            { addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top); }\n          return pos\n        }, sel_move);\n        if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\n          { doc.sel.ranges[i].goalColumn = goals[i]; } }\n      }),\n\n      // Find the word at the given position (as returned by coordsChar).\n      findWordAt: function(pos) {\n        var doc = this.doc, line = getLine(doc, pos.line).text;\n        var start = pos.ch, end = pos.ch;\n        if (line) {\n          var helper = this.getHelper(pos, \"wordChars\");\n          if ((pos.sticky == \"before\" || end == line.length) && start) { --start; } else { ++end; }\n          var startChar = line.charAt(start);\n          var check = isWordChar(startChar, helper)\n            ? function (ch) { return isWordChar(ch, helper); }\n            : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\n            : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); };\n          while (start > 0 && check(line.charAt(start - 1))) { --start; }\n          while (end < line.length && check(line.charAt(end))) { ++end; }\n        }\n        return new Range(Pos(pos.line, start), Pos(pos.line, end))\n      },\n\n      toggleOverwrite: function(value) {\n        if (value != null && value == this.state.overwrite) { return }\n        if (this.state.overwrite = !this.state.overwrite)\n          { addClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n        else\n          { rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n\n        signal(this, \"overwriteToggle\", this, this.state.overwrite);\n      },\n      hasFocus: function() { return this.display.input.getField() == activeElt() },\n      isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\n\n      scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y); }),\n      getScrollInfo: function() {\n        var scroller = this.display.scroller;\n        return {left: scroller.scrollLeft, top: scroller.scrollTop,\n                height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n                width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n                clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\n      },\n\n      scrollIntoView: methodOp(function(range$$1, margin) {\n        if (range$$1 == null) {\n          range$$1 = {from: this.doc.sel.primary().head, to: null};\n          if (margin == null) { margin = this.options.cursorScrollMargin; }\n        } else if (typeof range$$1 == \"number\") {\n          range$$1 = {from: Pos(range$$1, 0), to: null};\n        } else if (range$$1.from == null) {\n          range$$1 = {from: range$$1, to: null};\n        }\n        if (!range$$1.to) { range$$1.to = range$$1.from; }\n        range$$1.margin = margin || 0;\n\n        if (range$$1.from.line != null) {\n          scrollToRange(this, range$$1);\n        } else {\n          scrollToCoordsRange(this, range$$1.from, range$$1.to, range$$1.margin);\n        }\n      }),\n\n      setSize: methodOp(function(width, height) {\n        var this$1 = this;\n\n        var interpret = function (val) { return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val; };\n        if (width != null) { this.display.wrapper.style.width = interpret(width); }\n        if (height != null) { this.display.wrapper.style.height = interpret(height); }\n        if (this.options.lineWrapping) { clearLineMeasurementCache(this); }\n        var lineNo$$1 = this.display.viewFrom;\n        this.doc.iter(lineNo$$1, this.display.viewTo, function (line) {\n          if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\n            { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo$$1, \"widget\"); break } } }\n          ++lineNo$$1;\n        });\n        this.curOp.forceUpdate = true;\n        signal(this, \"refresh\", this);\n      }),\n\n      operation: function(f){return runInOp(this, f)},\n      startOperation: function(){return startOperation(this)},\n      endOperation: function(){return endOperation(this)},\n\n      refresh: methodOp(function() {\n        var oldHeight = this.display.cachedTextHeight;\n        regChange(this);\n        this.curOp.forceUpdate = true;\n        clearCaches(this);\n        scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n        updateGutterSpace(this);\n        if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5)\n          { estimateLineHeights(this); }\n        signal(this, \"refresh\", this);\n      }),\n\n      swapDoc: methodOp(function(doc) {\n        var old = this.doc;\n        old.cm = null;\n        attachDoc(this, doc);\n        clearCaches(this);\n        this.display.input.reset();\n        scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n        this.curOp.forceScroll = true;\n        signalLater(this, \"swapDoc\", this, old);\n        return old\n      }),\n\n      phrase: function(phraseText) {\n        var phrases = this.options.phrases;\n        return phrases && Object.prototype.hasOwnProperty.call(phrases, phraseText) ? phrases[phraseText] : phraseText\n      },\n\n      getInputField: function(){return this.display.input.getField()},\n      getWrapperElement: function(){return this.display.wrapper},\n      getScrollerElement: function(){return this.display.scroller},\n      getGutterElement: function(){return this.display.gutters}\n    };\n    eventMixin(CodeMirror);\n\n    CodeMirror.registerHelper = function(type, name, value) {\n      if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []}; }\n      helpers[type][name] = value;\n    };\n    CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n      CodeMirror.registerHelper(type, name, value);\n      helpers[type]._global.push({pred: predicate, val: value});\n    };\n  }\n\n  // Used for horizontal relative motion. Dir is -1 or 1 (left or\n  // right), unit can be \"char\", \"column\" (like char, but doesn't\n  // cross line boundaries), \"word\" (across next word), or \"group\" (to\n  // the start of next group of word or non-word-non-whitespace\n  // chars). The visually param controls whether, in right-to-left\n  // text, direction 1 means to move towards the next index in the\n  // string, or towards the character to the right of the current\n  // position. The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosH(doc, pos, dir, unit, visually) {\n    var oldPos = pos;\n    var origDir = dir;\n    var lineObj = getLine(doc, pos.line);\n    function findNextLine() {\n      var l = pos.line + dir;\n      if (l < doc.first || l >= doc.first + doc.size) { return false }\n      pos = new Pos(l, pos.ch, pos.sticky);\n      return lineObj = getLine(doc, l)\n    }\n    function moveOnce(boundToLine) {\n      var next;\n      if (visually) {\n        next = moveVisually(doc.cm, lineObj, pos, dir);\n      } else {\n        next = moveLogically(lineObj, pos, dir);\n      }\n      if (next == null) {\n        if (!boundToLine && findNextLine())\n          { pos = endOfLine(visually, doc.cm, lineObj, pos.line, dir); }\n        else\n          { return false }\n      } else {\n        pos = next;\n      }\n      return true\n    }\n\n    if (unit == \"char\") {\n      moveOnce();\n    } else if (unit == \"column\") {\n      moveOnce(true);\n    } else if (unit == \"word\" || unit == \"group\") {\n      var sawType = null, group = unit == \"group\";\n      var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n      for (var first = true;; first = false) {\n        if (dir < 0 && !moveOnce(!first)) { break }\n        var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n        var type = isWordChar(cur, helper) ? \"w\"\n          : group && cur == \"\\n\" ? \"n\"\n          : !group || /\\s/.test(cur) ? null\n          : \"p\";\n        if (group && !first && !type) { type = \"s\"; }\n        if (sawType && sawType != type) {\n          if (dir < 0) {dir = 1; moveOnce(); pos.sticky = \"after\";}\n          break\n        }\n\n        if (type) { sawType = type; }\n        if (dir > 0 && !moveOnce(!first)) { break }\n      }\n    }\n    var result = skipAtomic(doc, pos, oldPos, origDir, true);\n    if (equalCursorPos(oldPos, result)) { result.hitSide = true; }\n    return result\n  }\n\n  // For relative vertical movement. Dir may be -1 or 1. Unit can be\n  // \"page\" or \"line\". The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosV(cm, pos, dir, unit) {\n    var doc = cm.doc, x = pos.left, y;\n    if (unit == \"page\") {\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n      var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n      y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n\n    } else if (unit == \"line\") {\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n    }\n    var target;\n    for (;;) {\n      target = coordsChar(cm, x, y);\n      if (!target.outside) { break }\n      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\n      y += dir * 5;\n    }\n    return target\n  }\n\n  // CONTENTEDITABLE INPUT STYLE\n\n  var ContentEditableInput = function(cm) {\n    this.cm = cm;\n    this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n    this.polling = new Delayed();\n    this.composing = null;\n    this.gracePeriod = false;\n    this.readDOMTimeout = null;\n  };\n\n  ContentEditableInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = input.cm;\n    var div = input.div = display.lineDiv;\n    disableBrowserMagic(div, cm.options.spellcheck, cm.options.autocorrect, cm.options.autocapitalize);\n\n    on(div, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n      // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n      if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20); }\n    });\n\n    on(div, \"compositionstart\", function (e) {\n      this$1.composing = {data: e.data, done: false};\n    });\n    on(div, \"compositionupdate\", function (e) {\n      if (!this$1.composing) { this$1.composing = {data: e.data, done: false}; }\n    });\n    on(div, \"compositionend\", function (e) {\n      if (this$1.composing) {\n        if (e.data != this$1.composing.data) { this$1.readFromDOMSoon(); }\n        this$1.composing.done = true;\n      }\n    });\n\n    on(div, \"touchstart\", function () { return input.forceCompositionEnd(); });\n\n    on(div, \"input\", function () {\n      if (!this$1.composing) { this$1.readFromDOMSoon(); }\n    });\n\n    function onCopyCut(e) {\n      if (signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n        if (e.type == \"cut\") { cm.replaceSelection(\"\", null, \"cut\"); }\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.operation(function () {\n            cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n            cm.replaceSelection(\"\", null, \"cut\");\n          });\n        }\n      }\n      if (e.clipboardData) {\n        e.clipboardData.clearData();\n        var content = lastCopied.text.join(\"\\n\");\n        // iOS exposes the clipboard API, but seems to discard content inserted into it\n        e.clipboardData.setData(\"Text\", content);\n        if (e.clipboardData.getData(\"Text\") == content) {\n          e.preventDefault();\n          return\n        }\n      }\n      // Old-fashioned briefly-focus-a-textarea hack\n      var kludge = hiddenTextarea(), te = kludge.firstChild;\n      cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n      te.value = lastCopied.text.join(\"\\n\");\n      var hadFocus = document.activeElement;\n      selectInput(te);\n      setTimeout(function () {\n        cm.display.lineSpace.removeChild(kludge);\n        hadFocus.focus();\n        if (hadFocus == div) { input.showPrimarySelection(); }\n      }, 50);\n    }\n    on(div, \"copy\", onCopyCut);\n    on(div, \"cut\", onCopyCut);\n  };\n\n  ContentEditableInput.prototype.prepareSelection = function () {\n    var result = prepareSelection(this.cm, false);\n    result.focus = this.cm.state.focused;\n    return result\n  };\n\n  ContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n    if (!info || !this.cm.display.view.length) { return }\n    if (info.focus || takeFocus) { this.showPrimarySelection(); }\n    this.showMultipleSelections(info);\n  };\n\n  ContentEditableInput.prototype.getSelection = function () {\n    return this.cm.display.wrapper.ownerDocument.getSelection()\n  };\n\n  ContentEditableInput.prototype.showPrimarySelection = function () {\n    var sel = this.getSelection(), cm = this.cm, prim = cm.doc.sel.primary();\n    var from = prim.from(), to = prim.to();\n\n    if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\n        cmp(minPos(curAnchor, curFocus), from) == 0 &&\n        cmp(maxPos(curAnchor, curFocus), to) == 0)\n      { return }\n\n    var view = cm.display.view;\n    var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\n        {node: view[0].measure.map[2], offset: 0};\n    var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n    if (!end) {\n      var measure = view[view.length - 1].measure;\n      var map$$1 = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n      end = {node: map$$1[map$$1.length - 1], offset: map$$1[map$$1.length - 2] - map$$1[map$$1.length - 3]};\n    }\n\n    if (!start || !end) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var old = sel.rangeCount && sel.getRangeAt(0), rng;\n    try { rng = range(start.node, start.offset, end.offset, end.node); }\n    catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n    if (rng) {\n      if (!gecko && cm.state.focused) {\n        sel.collapse(start.node, start.offset);\n        if (!rng.collapsed) {\n          sel.removeAllRanges();\n          sel.addRange(rng);\n        }\n      } else {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n      }\n      if (old && sel.anchorNode == null) { sel.addRange(old); }\n      else if (gecko) { this.startGracePeriod(); }\n    }\n    this.rememberSelection();\n  };\n\n  ContentEditableInput.prototype.startGracePeriod = function () {\n      var this$1 = this;\n\n    clearTimeout(this.gracePeriod);\n    this.gracePeriod = setTimeout(function () {\n      this$1.gracePeriod = false;\n      if (this$1.selectionChanged())\n        { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }); }\n    }, 20);\n  };\n\n  ContentEditableInput.prototype.showMultipleSelections = function (info) {\n    removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n    removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n  };\n\n  ContentEditableInput.prototype.rememberSelection = function () {\n    var sel = this.getSelection();\n    this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\n    this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\n  };\n\n  ContentEditableInput.prototype.selectionInEditor = function () {\n    var sel = this.getSelection();\n    if (!sel.rangeCount) { return false }\n    var node = sel.getRangeAt(0).commonAncestorContainer;\n    return contains(this.div, node)\n  };\n\n  ContentEditableInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\") {\n      if (!this.selectionInEditor())\n        { this.showSelection(this.prepareSelection(), true); }\n      this.div.focus();\n    }\n  };\n  ContentEditableInput.prototype.blur = function () { this.div.blur(); };\n  ContentEditableInput.prototype.getField = function () { return this.div };\n\n  ContentEditableInput.prototype.supportsTouch = function () { return true };\n\n  ContentEditableInput.prototype.receivedFocus = function () {\n    var input = this;\n    if (this.selectionInEditor())\n      { this.pollSelection(); }\n    else\n      { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }); }\n\n    function poll() {\n      if (input.cm.state.focused) {\n        input.pollSelection();\n        input.polling.set(input.cm.options.pollInterval, poll);\n      }\n    }\n    this.polling.set(this.cm.options.pollInterval, poll);\n  };\n\n  ContentEditableInput.prototype.selectionChanged = function () {\n    var sel = this.getSelection();\n    return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\n      sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\n  };\n\n  ContentEditableInput.prototype.pollSelection = function () {\n    if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\n    var sel = this.getSelection(), cm = this.cm;\n    // On Android Chrome (version 56, at least), backspacing into an\n    // uneditable block element will put the cursor in that element,\n    // and then, because it's not editable, hide the virtual keyboard.\n    // Because Android doesn't allow us to actually detect backspace\n    // presses in a sane way, this code checks for when that happens\n    // and simulates a backspace press in this case.\n    if (android && chrome && this.cm.options.gutters.length && isInGutter(sel.anchorNode)) {\n      this.cm.triggerOnKeyDown({type: \"keydown\", keyCode: 8, preventDefault: Math.abs});\n      this.blur();\n      this.focus();\n      return\n    }\n    if (this.composing) { return }\n    this.rememberSelection();\n    var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (anchor && head) { runInOp(cm, function () {\n      setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n      if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true; }\n    }); }\n  };\n\n  ContentEditableInput.prototype.pollContent = function () {\n    if (this.readDOMTimeout != null) {\n      clearTimeout(this.readDOMTimeout);\n      this.readDOMTimeout = null;\n    }\n\n    var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\n    var from = sel.from(), to = sel.to();\n    if (from.ch == 0 && from.line > cm.firstLine())\n      { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length); }\n    if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\n      { to = Pos(to.line + 1, 0); }\n    if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\n\n    var fromIndex, fromLine, fromNode;\n    if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n      fromLine = lineNo(display.view[0].line);\n      fromNode = display.view[0].node;\n    } else {\n      fromLine = lineNo(display.view[fromIndex].line);\n      fromNode = display.view[fromIndex - 1].node.nextSibling;\n    }\n    var toIndex = findViewIndex(cm, to.line);\n    var toLine, toNode;\n    if (toIndex == display.view.length - 1) {\n      toLine = display.viewTo - 1;\n      toNode = display.lineDiv.lastChild;\n    } else {\n      toLine = lineNo(display.view[toIndex + 1].line) - 1;\n      toNode = display.view[toIndex + 1].node.previousSibling;\n    }\n\n    if (!fromNode) { return false }\n    var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n    var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n    while (newText.length > 1 && oldText.length > 1) {\n      if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\n      else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\n      else { break }\n    }\n\n    var cutFront = 0, cutEnd = 0;\n    var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\n    while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\n      { ++cutFront; }\n    var newBot = lst(newText), oldBot = lst(oldText);\n    var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\n                             oldBot.length - (oldText.length == 1 ? cutFront : 0));\n    while (cutEnd < maxCutEnd &&\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\n      { ++cutEnd; }\n    // Try to move start of change to start of selection if ambiguous\n    if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n      while (cutFront && cutFront > from.ch &&\n             newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n        cutFront--;\n        cutEnd++;\n      }\n    }\n\n    newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n    newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n\n    var chFrom = Pos(fromLine, cutFront);\n    var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n    if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n      replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n      return true\n    }\n  };\n\n  ContentEditableInput.prototype.ensurePolled = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.reset = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.forceCompositionEnd = function () {\n    if (!this.composing) { return }\n    clearTimeout(this.readDOMTimeout);\n    this.composing = null;\n    this.updateFromDOM();\n    this.div.blur();\n    this.div.focus();\n  };\n  ContentEditableInput.prototype.readFromDOMSoon = function () {\n      var this$1 = this;\n\n    if (this.readDOMTimeout != null) { return }\n    this.readDOMTimeout = setTimeout(function () {\n      this$1.readDOMTimeout = null;\n      if (this$1.composing) {\n        if (this$1.composing.done) { this$1.composing = null; }\n        else { return }\n      }\n      this$1.updateFromDOM();\n    }, 80);\n  };\n\n  ContentEditableInput.prototype.updateFromDOM = function () {\n      var this$1 = this;\n\n    if (this.cm.isReadOnly() || !this.pollContent())\n      { runInOp(this.cm, function () { return regChange(this$1.cm); }); }\n  };\n\n  ContentEditableInput.prototype.setUneditable = function (node) {\n    node.contentEditable = \"false\";\n  };\n\n  ContentEditableInput.prototype.onKeyPress = function (e) {\n    if (e.charCode == 0 || this.composing) { return }\n    e.preventDefault();\n    if (!this.cm.isReadOnly())\n      { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0); }\n  };\n\n  ContentEditableInput.prototype.readOnlyChanged = function (val) {\n    this.div.contentEditable = String(val != \"nocursor\");\n  };\n\n  ContentEditableInput.prototype.onContextMenu = function () {};\n  ContentEditableInput.prototype.resetPosition = function () {};\n\n  ContentEditableInput.prototype.needsContentAttribute = true;\n\n  function posToDOM(cm, pos) {\n    var view = findViewForLine(cm, pos.line);\n    if (!view || view.hidden) { return null }\n    var line = getLine(cm.doc, pos.line);\n    var info = mapFromLineView(view, line, pos.line);\n\n    var order = getOrder(line, cm.doc.direction), side = \"left\";\n    if (order) {\n      var partPos = getBidiPartAt(order, pos.ch);\n      side = partPos % 2 ? \"right\" : \"left\";\n    }\n    var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n    result.offset = result.collapse == \"right\" ? result.end : result.start;\n    return result\n  }\n\n  function isInGutter(node) {\n    for (var scan = node; scan; scan = scan.parentNode)\n      { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\n    return false\n  }\n\n  function badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\n\n  function domTextBetween(cm, from, to, fromLine, toLine) {\n    var text = \"\", closing = false, lineSep = cm.doc.lineSeparator(), extraLinebreak = false;\n    function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\n    function close() {\n      if (closing) {\n        text += lineSep;\n        if (extraLinebreak) { text += lineSep; }\n        closing = extraLinebreak = false;\n      }\n    }\n    function addText(str) {\n      if (str) {\n        close();\n        text += str;\n      }\n    }\n    function walk(node) {\n      if (node.nodeType == 1) {\n        var cmText = node.getAttribute(\"cm-text\");\n        if (cmText) {\n          addText(cmText);\n          return\n        }\n        var markerID = node.getAttribute(\"cm-marker\"), range$$1;\n        if (markerID) {\n          var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n          if (found.length && (range$$1 = found[0].find(0)))\n            { addText(getBetween(cm.doc, range$$1.from, range$$1.to).join(lineSep)); }\n          return\n        }\n        if (node.getAttribute(\"contenteditable\") == \"false\") { return }\n        var isBlock = /^(pre|div|p|li|table|br)$/i.test(node.nodeName);\n        if (!/^br$/i.test(node.nodeName) && node.textContent.length == 0) { return }\n\n        if (isBlock) { close(); }\n        for (var i = 0; i < node.childNodes.length; i++)\n          { walk(node.childNodes[i]); }\n\n        if (/^(pre|p)$/i.test(node.nodeName)) { extraLinebreak = true; }\n        if (isBlock) { closing = true; }\n      } else if (node.nodeType == 3) {\n        addText(node.nodeValue.replace(/\\u200b/g, \"\").replace(/\\u00a0/g, \" \"));\n      }\n    }\n    for (;;) {\n      walk(from);\n      if (from == to) { break }\n      from = from.nextSibling;\n      extraLinebreak = false;\n    }\n    return text\n  }\n\n  function domToPos(cm, node, offset) {\n    var lineNode;\n    if (node == cm.display.lineDiv) {\n      lineNode = cm.display.lineDiv.childNodes[offset];\n      if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\n      node = null; offset = 0;\n    } else {\n      for (lineNode = node;; lineNode = lineNode.parentNode) {\n        if (!lineNode || lineNode == cm.display.lineDiv) { return null }\n        if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\n      }\n    }\n    for (var i = 0; i < cm.display.view.length; i++) {\n      var lineView = cm.display.view[i];\n      if (lineView.node == lineNode)\n        { return locateNodeInLineView(lineView, node, offset) }\n    }\n  }\n\n  function locateNodeInLineView(lineView, node, offset) {\n    var wrapper = lineView.text.firstChild, bad = false;\n    if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\n    if (node == wrapper) {\n      bad = true;\n      node = wrapper.childNodes[offset];\n      offset = 0;\n      if (!node) {\n        var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n        return badPos(Pos(lineNo(line), line.text.length), bad)\n      }\n    }\n\n    var textNode = node.nodeType == 3 ? node : null, topNode = node;\n    if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n      textNode = node.firstChild;\n      if (offset) { offset = textNode.nodeValue.length; }\n    }\n    while (topNode.parentNode != wrapper) { topNode = topNode.parentNode; }\n    var measure = lineView.measure, maps = measure.maps;\n\n    function find(textNode, topNode, offset) {\n      for (var i = -1; i < (maps ? maps.length : 0); i++) {\n        var map$$1 = i < 0 ? measure.map : maps[i];\n        for (var j = 0; j < map$$1.length; j += 3) {\n          var curNode = map$$1[j + 2];\n          if (curNode == textNode || curNode == topNode) {\n            var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n            var ch = map$$1[j] + offset;\n            if (offset < 0 || curNode != textNode) { ch = map$$1[j + (offset ? 1 : 0)]; }\n            return Pos(line, ch)\n          }\n        }\n      }\n    }\n    var found = find(textNode, topNode, offset);\n    if (found) { return badPos(found, bad) }\n\n    // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n    for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n      found = find(after, after.firstChild, 0);\n      if (found)\n        { return badPos(Pos(found.line, found.ch - dist), bad) }\n      else\n        { dist += after.textContent.length; }\n    }\n    for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n      found = find(before, before.firstChild, -1);\n      if (found)\n        { return badPos(Pos(found.line, found.ch + dist$1), bad) }\n      else\n        { dist$1 += before.textContent.length; }\n    }\n  }\n\n  // TEXTAREA INPUT STYLE\n\n  var TextareaInput = function(cm) {\n    this.cm = cm;\n    // See input.poll and input.reset\n    this.prevInput = \"\";\n\n    // Flag that indicates whether we expect input to appear real soon\n    // now (after some event like 'keypress' or 'input') and are\n    // polling intensively.\n    this.pollingFast = false;\n    // Self-resetting timeout for the poller\n    this.polling = new Delayed();\n    // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n    this.hasSelection = false;\n    this.composing = null;\n  };\n\n  TextareaInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = this.cm;\n    this.createField(display);\n    var te = this.textarea;\n\n    display.wrapper.insertBefore(this.wrapper, display.wrapper.firstChild);\n\n    // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n    if (ios) { te.style.width = \"0px\"; }\n\n    on(te, \"input\", function () {\n      if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null; }\n      input.poll();\n    });\n\n    on(te, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n\n      cm.state.pasteIncoming = +new Date;\n      input.fastPoll();\n    });\n\n    function prepareCopyCut(e) {\n      if (signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.setSelections(ranges.ranges, null, sel_dontScroll);\n        } else {\n          input.prevInput = \"\";\n          te.value = ranges.text.join(\"\\n\");\n          selectInput(te);\n        }\n      }\n      if (e.type == \"cut\") { cm.state.cutIncoming = +new Date; }\n    }\n    on(te, \"cut\", prepareCopyCut);\n    on(te, \"copy\", prepareCopyCut);\n\n    on(display.scroller, \"paste\", function (e) {\n      if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\n      if (!te.dispatchEvent) {\n        cm.state.pasteIncoming = +new Date;\n        input.focus();\n        return\n      }\n\n      // Pass the `paste` event to the textarea so it's handled by its event listener.\n      var event = new Event(\"paste\");\n      event.clipboardData = e.clipboardData;\n      te.dispatchEvent(event);\n    });\n\n    // Prevent normal selection in the editor (we handle our own)\n    on(display.lineSpace, \"selectstart\", function (e) {\n      if (!eventInWidget(display, e)) { e_preventDefault(e); }\n    });\n\n    on(te, \"compositionstart\", function () {\n      var start = cm.getCursor(\"from\");\n      if (input.composing) { input.composing.range.clear(); }\n      input.composing = {\n        start: start,\n        range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\n      };\n    });\n    on(te, \"compositionend\", function () {\n      if (input.composing) {\n        input.poll();\n        input.composing.range.clear();\n        input.composing = null;\n      }\n    });\n  };\n\n  TextareaInput.prototype.createField = function (_display) {\n    // Wraps and hides input textarea\n    this.wrapper = hiddenTextarea();\n    // The semihidden textarea that is focused when the editor is\n    // focused, and receives input.\n    this.textarea = this.wrapper.firstChild;\n  };\n\n  TextareaInput.prototype.prepareSelection = function () {\n    // Redraw the selection and/or cursor\n    var cm = this.cm, display = cm.display, doc = cm.doc;\n    var result = prepareSelection(cm);\n\n    // Move the hidden textarea near the cursor to prevent scrolling artifacts\n    if (cm.options.moveInputWithCursor) {\n      var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n      var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n      result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                          headPos.top + lineOff.top - wrapOff.top));\n      result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                           headPos.left + lineOff.left - wrapOff.left));\n    }\n\n    return result\n  };\n\n  TextareaInput.prototype.showSelection = function (drawn) {\n    var cm = this.cm, display = cm.display;\n    removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n    removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n    if (drawn.teTop != null) {\n      this.wrapper.style.top = drawn.teTop + \"px\";\n      this.wrapper.style.left = drawn.teLeft + \"px\";\n    }\n  };\n\n  // Reset the input to correspond to the selection (or to be empty,\n  // when not typing and nothing is selected)\n  TextareaInput.prototype.reset = function (typing) {\n    if (this.contextMenuPending || this.composing) { return }\n    var cm = this.cm;\n    if (cm.somethingSelected()) {\n      this.prevInput = \"\";\n      var content = cm.getSelection();\n      this.textarea.value = content;\n      if (cm.state.focused) { selectInput(this.textarea); }\n      if (ie && ie_version >= 9) { this.hasSelection = content; }\n    } else if (!typing) {\n      this.prevInput = this.textarea.value = \"\";\n      if (ie && ie_version >= 9) { this.hasSelection = null; }\n    }\n  };\n\n  TextareaInput.prototype.getField = function () { return this.textarea };\n\n  TextareaInput.prototype.supportsTouch = function () { return false };\n\n  TextareaInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n      try { this.textarea.focus(); }\n      catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n    }\n  };\n\n  TextareaInput.prototype.blur = function () { this.textarea.blur(); };\n\n  TextareaInput.prototype.resetPosition = function () {\n    this.wrapper.style.top = this.wrapper.style.left = 0;\n  };\n\n  TextareaInput.prototype.receivedFocus = function () { this.slowPoll(); };\n\n  // Poll for input changes, using the normal rate of polling. This\n  // runs as long as the editor is focused.\n  TextareaInput.prototype.slowPoll = function () {\n      var this$1 = this;\n\n    if (this.pollingFast) { return }\n    this.polling.set(this.cm.options.pollInterval, function () {\n      this$1.poll();\n      if (this$1.cm.state.focused) { this$1.slowPoll(); }\n    });\n  };\n\n  // When an event has just come in that is likely to add or change\n  // something in the input textarea, we poll faster, to ensure that\n  // the change appears on the screen quickly.\n  TextareaInput.prototype.fastPoll = function () {\n    var missed = false, input = this;\n    input.pollingFast = true;\n    function p() {\n      var changed = input.poll();\n      if (!changed && !missed) {missed = true; input.polling.set(60, p);}\n      else {input.pollingFast = false; input.slowPoll();}\n    }\n    input.polling.set(20, p);\n  };\n\n  // Read input from the textarea, and update the document to match.\n  // When something is selected, it is present in the textarea, and\n  // selected (unless it is huge, in which case a placeholder is\n  // used). When nothing is selected, the cursor sits after previously\n  // seen text (can be empty), which is stored in prevInput (we must\n  // not reset the textarea when typing, because that breaks IME).\n  TextareaInput.prototype.poll = function () {\n      var this$1 = this;\n\n    var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\n    // Since this is called a *lot*, try to bail out as cheaply as\n    // possible when it is clear that nothing happened. hasSelection\n    // will be the case when there is a lot of text in the textarea,\n    // in which case reading its value would be expensive.\n    if (this.contextMenuPending || !cm.state.focused ||\n        (hasSelection(input) && !prevInput && !this.composing) ||\n        cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\n      { return false }\n\n    var text = input.value;\n    // If nothing changed, bail.\n    if (text == prevInput && !cm.somethingSelected()) { return false }\n    // Work around nonsensical selection resetting in IE9/10, and\n    // inexplicable appearance of private area unicode characters on\n    // some key combos in Mac (#2689).\n    if (ie && ie_version >= 9 && this.hasSelection === text ||\n        mac && /[\\uf700-\\uf7ff]/.test(text)) {\n      cm.display.input.reset();\n      return false\n    }\n\n    if (cm.doc.sel == cm.display.selForContextMenu) {\n      var first = text.charCodeAt(0);\n      if (first == 0x200b && !prevInput) { prevInput = \"\\u200b\"; }\n      if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\") }\n    }\n    // Find the part of the input that is actually new\n    var same = 0, l = Math.min(prevInput.length, text.length);\n    while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same; }\n\n    runInOp(cm, function () {\n      applyTextInput(cm, text.slice(same), prevInput.length - same,\n                     null, this$1.composing ? \"*compose\" : null);\n\n      // Don't leave long text in the textarea, since it makes further polling slow\n      if (text.length > 1000 || text.indexOf(\"\\n\") > -1) { input.value = this$1.prevInput = \"\"; }\n      else { this$1.prevInput = text; }\n\n      if (this$1.composing) {\n        this$1.composing.range.clear();\n        this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"),\n                                           {className: \"CodeMirror-composing\"});\n      }\n    });\n    return true\n  };\n\n  TextareaInput.prototype.ensurePolled = function () {\n    if (this.pollingFast && this.poll()) { this.pollingFast = false; }\n  };\n\n  TextareaInput.prototype.onKeyPress = function () {\n    if (ie && ie_version >= 9) { this.hasSelection = null; }\n    this.fastPoll();\n  };\n\n  TextareaInput.prototype.onContextMenu = function (e) {\n    var input = this, cm = input.cm, display = cm.display, te = input.textarea;\n    if (input.contextMenuPending) { input.contextMenuPending(); }\n    var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n    if (!pos || presto) { return } // Opera is difficult.\n\n    // Reset the current text selection only if the click is done outside of the selection\n    // and 'resetSelectionOnContextMenu' option is true.\n    var reset = cm.options.resetSelectionOnContextMenu;\n    if (reset && cm.doc.sel.contains(pos) == -1)\n      { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll); }\n\n    var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText;\n    var wrapperBox = input.wrapper.offsetParent.getBoundingClientRect();\n    input.wrapper.style.cssText = \"position: static\";\n    te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n    var oldScrollY;\n    if (webkit) { oldScrollY = window.scrollY; } // Work around Chrome issue (#2712)\n    display.input.focus();\n    if (webkit) { window.scrollTo(null, oldScrollY); }\n    display.input.reset();\n    // Adds \"Select all\" to context menu in FF\n    if (!cm.somethingSelected()) { te.value = input.prevInput = \" \"; }\n    input.contextMenuPending = rehide;\n    display.selForContextMenu = cm.doc.sel;\n    clearTimeout(display.detectingSelectAll);\n\n    // Select-all will be greyed out if there's nothing to select, so\n    // this adds a zero-width space so that we can later check whether\n    // it got selected.\n    function prepareSelectAllHack() {\n      if (te.selectionStart != null) {\n        var selected = cm.somethingSelected();\n        var extval = \"\\u200b\" + (selected ? te.value : \"\");\n        te.value = \"\\u21da\"; // Used to catch context-menu undo\n        te.value = extval;\n        input.prevInput = selected ? \"\" : \"\\u200b\";\n        te.selectionStart = 1; te.selectionEnd = extval.length;\n        // Re-set this, in case some other handler touched the\n        // selection in the meantime.\n        display.selForContextMenu = cm.doc.sel;\n      }\n    }\n    function rehide() {\n      if (input.contextMenuPending != rehide) { return }\n      input.contextMenuPending = false;\n      input.wrapper.style.cssText = oldWrapperCSS;\n      te.style.cssText = oldCSS;\n      if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos); }\n\n      // Try to detect the user choosing select-all\n      if (te.selectionStart != null) {\n        if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack(); }\n        var i = 0, poll = function () {\n          if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\n              te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\n            operation(cm, selectAll)(cm);\n          } else if (i++ < 10) {\n            display.detectingSelectAll = setTimeout(poll, 500);\n          } else {\n            display.selForContextMenu = null;\n            display.input.reset();\n          }\n        };\n        display.detectingSelectAll = setTimeout(poll, 200);\n      }\n    }\n\n    if (ie && ie_version >= 9) { prepareSelectAllHack(); }\n    if (captureRightClick) {\n      e_stop(e);\n      var mouseup = function () {\n        off(window, \"mouseup\", mouseup);\n        setTimeout(rehide, 20);\n      };\n      on(window, \"mouseup\", mouseup);\n    } else {\n      setTimeout(rehide, 50);\n    }\n  };\n\n  TextareaInput.prototype.readOnlyChanged = function (val) {\n    if (!val) { this.reset(); }\n    this.textarea.disabled = val == \"nocursor\";\n  };\n\n  TextareaInput.prototype.setUneditable = function () {};\n\n  TextareaInput.prototype.needsContentAttribute = false;\n\n  function fromTextArea(textarea, options) {\n    options = options ? copyObj(options) : {};\n    options.value = textarea.value;\n    if (!options.tabindex && textarea.tabIndex)\n      { options.tabindex = textarea.tabIndex; }\n    if (!options.placeholder && textarea.placeholder)\n      { options.placeholder = textarea.placeholder; }\n    // Set autofocus to true if this textarea is focused, or if it has\n    // autofocus and no other element is focused.\n    if (options.autofocus == null) {\n      var hasFocus = activeElt();\n      options.autofocus = hasFocus == textarea ||\n        textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n    }\n\n    function save() {textarea.value = cm.getValue();}\n\n    var realSubmit;\n    if (textarea.form) {\n      on(textarea.form, \"submit\", save);\n      // Deplorable hack to make the submit method do the right thing.\n      if (!options.leaveSubmitMethodAlone) {\n        var form = textarea.form;\n        realSubmit = form.submit;\n        try {\n          var wrappedSubmit = form.submit = function () {\n            save();\n            form.submit = realSubmit;\n            form.submit();\n            form.submit = wrappedSubmit;\n          };\n        } catch(e) {}\n      }\n    }\n\n    options.finishInit = function (cm) {\n      cm.save = save;\n      cm.getTextArea = function () { return textarea; };\n      cm.toTextArea = function () {\n        cm.toTextArea = isNaN; // Prevent this from being ran twice\n        save();\n        textarea.parentNode.removeChild(cm.getWrapperElement());\n        textarea.style.display = \"\";\n        if (textarea.form) {\n          off(textarea.form, \"submit\", save);\n          if (typeof textarea.form.submit == \"function\")\n            { textarea.form.submit = realSubmit; }\n        }\n      };\n    };\n\n    textarea.style.display = \"none\";\n    var cm = CodeMirror(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\n      options);\n    return cm\n  }\n\n  function addLegacyProps(CodeMirror) {\n    CodeMirror.off = off;\n    CodeMirror.on = on;\n    CodeMirror.wheelEventPixels = wheelEventPixels;\n    CodeMirror.Doc = Doc;\n    CodeMirror.splitLines = splitLinesAuto;\n    CodeMirror.countColumn = countColumn;\n    CodeMirror.findColumn = findColumn;\n    CodeMirror.isWordChar = isWordCharBasic;\n    CodeMirror.Pass = Pass;\n    CodeMirror.signal = signal;\n    CodeMirror.Line = Line;\n    CodeMirror.changeEnd = changeEnd;\n    CodeMirror.scrollbarModel = scrollbarModel;\n    CodeMirror.Pos = Pos;\n    CodeMirror.cmpPos = cmp;\n    CodeMirror.modes = modes;\n    CodeMirror.mimeModes = mimeModes;\n    CodeMirror.resolveMode = resolveMode;\n    CodeMirror.getMode = getMode;\n    CodeMirror.modeExtensions = modeExtensions;\n    CodeMirror.extendMode = extendMode;\n    CodeMirror.copyState = copyState;\n    CodeMirror.startState = startState;\n    CodeMirror.innerMode = innerMode;\n    CodeMirror.commands = commands;\n    CodeMirror.keyMap = keyMap;\n    CodeMirror.keyName = keyName;\n    CodeMirror.isModifierKey = isModifierKey;\n    CodeMirror.lookupKey = lookupKey;\n    CodeMirror.normalizeKeyMap = normalizeKeyMap;\n    CodeMirror.StringStream = StringStream;\n    CodeMirror.SharedTextMarker = SharedTextMarker;\n    CodeMirror.TextMarker = TextMarker;\n    CodeMirror.LineWidget = LineWidget;\n    CodeMirror.e_preventDefault = e_preventDefault;\n    CodeMirror.e_stopPropagation = e_stopPropagation;\n    CodeMirror.e_stop = e_stop;\n    CodeMirror.addClass = addClass;\n    CodeMirror.contains = contains;\n    CodeMirror.rmClass = rmClass;\n    CodeMirror.keyNames = keyNames;\n  }\n\n  // EDITOR CONSTRUCTOR\n\n  defineOptions(CodeMirror);\n\n  addEditorMethods(CodeMirror);\n\n  // Set up methods on CodeMirror's prototype to redirect to the editor's document.\n  var dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\n  for (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n    { CodeMirror.prototype[prop] = (function(method) {\n      return function() {return method.apply(this.doc, arguments)}\n    })(Doc.prototype[prop]); } }\n\n  eventMixin(Doc);\n  CodeMirror.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  CodeMirror.defineMode = function(name/*, mode, */) {\n    if (!CodeMirror.defaults.mode && name != \"null\") { CodeMirror.defaults.mode = name; }\n    defineMode.apply(this, arguments);\n  };\n\n  CodeMirror.defineMIME = defineMIME;\n\n  // Minimal default mode.\n  CodeMirror.defineMode(\"null\", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); });\n  CodeMirror.defineMIME(\"text/plain\", \"null\");\n\n  // EXTENSIONS\n\n  CodeMirror.defineExtension = function (name, func) {\n    CodeMirror.prototype[name] = func;\n  };\n  CodeMirror.defineDocExtension = function (name, func) {\n    Doc.prototype[name] = func;\n  };\n\n  CodeMirror.fromTextArea = fromTextArea;\n\n  addLegacyProps(CodeMirror);\n\n  CodeMirror.version = \"5.45.0\";\n\n  return CodeMirror;\n\n})));\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TypedArray} from 'neuroglancer/util/array';\n\nexport function getRandomHexString(numBits = 128) {\n  const numValues = Math.ceil(numBits / 32);\n  const data = new Uint32Array(numValues);\n  crypto.getRandomValues(data);\n  let s = '';\n  for (let i = 0; i < numValues; ++i) {\n    s += ('00000000' + data[i].toString(16)).slice(-8);\n  }\n  return s;\n}\n\n/**\n * Calls crypto.getRandomValues as many times as needed to fill array.\n */\nexport function getRandomValues<T extends TypedArray>(array: T): T {\n  let byteArray = new Uint8Array(array.buffer, array.byteOffset, array.byteLength);\n  const blockSize = 65536;\n  for (let i = 0, length = byteArray.length; i < length; i += blockSize) {\n    crypto.getRandomValues(byteArray.subarray(i, Math.min(length, i + blockSize)));\n  }\n  return array;\n}\n\nexport function getRandomUint32() {\n  const data = new Uint32Array(1);\n  crypto.getRandomValues(data);\n  return data[0];\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SliceViewChunkSpecification} from 'neuroglancer/sliceview/base';\n\nexport const ANNOTATION_METADATA_CHUNK_SOURCE_RPC_ID = 'annotation.MetadataChunkSource';\nexport const ANNOTATION_GEOMETRY_CHUNK_SOURCE_RPC_ID = 'annotation.GeometryChunkSource';\nexport const ANNOTATION_SUBSET_GEOMETRY_CHUNK_SOURCE_RPC_ID = 'annotation.SubsetGeometryChunkSource';\nexport const ANNOTATION_REFERENCE_ADD_RPC_ID = 'annotation.reference.add';\nexport const ANNOTATION_REFERENCE_DELETE_RPC_ID = 'annotation.reference.delete';\nexport const ANNOTATION_COMMIT_UPDATE_RPC_ID = 'annotation.commit';\nexport const ANNOTATION_COMMIT_UPDATE_RESULT_RPC_ID = 'annotation.commit';\n\nexport class AnnotationGeometryChunkSpecification extends SliceViewChunkSpecification {}\n\nexport const ANNOTATION_PERSPECTIVE_RENDER_LAYER_RPC_ID = 'annotation/PerspectiveRenderLayer';\nexport const ANNOTATION_RENDER_LAYER_RPC_ID = 'annotation/RenderLayer';\nexport const ANNOTATION_RENDER_LAYER_UPDATE_SEGMENTATION_RPC_ID =\n    'annotation/RenderLayer.updateSegmentation';\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {mat4} from 'neuroglancer/util/geom';\n\nexport const MESH_LAYER_RPC_ID = 'mesh/MeshLayer';\nexport const MULTISCALE_MESH_LAYER_RPC_ID = 'mesh/MultiscaleMeshLayer';\nexport const FRAGMENT_SOURCE_RPC_ID = 'mesh/FragmentSource';\n\nexport const MULTISCALE_FRAGMENT_SOURCE_RPC_ID = 'mesh/MultiscaleFragmentSource';\n\nexport type EncodedVertexPositions = Float32Array|Uint32Array|Uint16Array;\nexport type MeshVertexIndices = Uint16Array|Uint32Array;\nexport type OctahedronVertexNormals = Uint8Array;\n\nexport interface EncodedMeshData {\n  vertexPositions: EncodedVertexPositions;\n  vertexNormals: OctahedronVertexNormals;\n  indices: MeshVertexIndices;\n  strips: boolean;\n}\n\nexport interface MultiscaleFragmentFormat {\n  /**\n   * If `true`, vertex positions are specified relative to the fragment bounds, meaning (0, 0, 0) is\n   * the start corner of the fragment and (1, 1, 1) is the end corner.\n   *\n   * If `false`, vertex positions are in \"model\" coordinates.\n   */\n  fragmentRelativeVertices: boolean;\n\n  transform: mat4;\n  vertexPositionFormat: VertexPositionFormat;\n}\n\nexport enum VertexPositionFormat {\n  float32,\n  uint10,\n  uint16,\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Facility for drawing a scale bar to indicate pixel size in physical length\n * units.\n *\n * The physical length with which the scale bar is labeled will be of the form:\n *\n *   significand * 10^exponent\n *\n * Any exponent may be used, but the significand in the range [1, 10] will be\n * equal to one of a\n * discrete set of allowed significand values, in order to ensure that the scale\n * bar is easy to\n * understand.\n */\n\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {verifyFloat, verifyObjectProperty, verifyString} from 'neuroglancer/util/json';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {setTextureFromCanvas} from 'neuroglancer/webgl/texture';\n\n/**\n * Default set of allowed significand values.  1 is implicitly part of the set.\n */\nconst DEFAULT_ALLOWED_SIGNIFICANDS = [\n  1.5,\n  2,\n  3,\n  5,\n  7.5,\n  10,\n];\n\nexport interface LengthUnit {\n  unit: string;\n  lengthInNanometers: number;\n}\n\nexport const ALLOWED_UNITS: LengthUnit[] = [\n  {unit: 'km', lengthInNanometers: 1e12},\n  {unit: 'm', lengthInNanometers: 1e9},\n  {unit: 'mm', lengthInNanometers: 1e6},\n  {unit: 'm', lengthInNanometers: 1e3},\n  {unit: 'nm', lengthInNanometers: 1},\n  {unit: 'pm', lengthInNanometers: 1e-3},\n];\n\nexport function pickLengthUnit(lengthInNanometers: number) {\n  const numAllowedUnits = ALLOWED_UNITS.length;\n  let unit = ALLOWED_UNITS[numAllowedUnits - 1];\n  for (let i = 0; i < numAllowedUnits; ++i) {\n    const allowedUnit = ALLOWED_UNITS[i];\n    if (lengthInNanometers >= allowedUnit.lengthInNanometers) {\n      unit = allowedUnit;\n      break;\n    }\n  }\n  return unit;\n}\n\nexport function pickVolumeUnit(volumeInCubicNanometers: number) {\n  const numAllowedUnits = ALLOWED_UNITS.length;\n  let unit = ALLOWED_UNITS[numAllowedUnits - 1];\n  for (let i = 0; i < numAllowedUnits; ++i) {\n    const allowedUnit = ALLOWED_UNITS[i];\n    if (volumeInCubicNanometers >= Math.pow(allowedUnit.lengthInNanometers, 3)) {\n      unit = allowedUnit;\n      break;\n    }\n  }\n  return unit;\n}\n\nexport class ScaleBarDimensions {\n  /**\n   * Allowed significand values.  1 is not included, but is always considered\n   * part of the set.\n   */\n  allowedSignificands = DEFAULT_ALLOWED_SIGNIFICANDS;\n\n  /**\n   * The target length in pixels.  The closest\n   */\n  targetLengthInPixels: number = 0;\n\n  /**\n   * Pixel size in nanometers.\n   */\n  nanometersPerPixel: number = 0;\n\n  // The following three fields are computed from the previous three fields.\n\n  /**\n   * Length that scale bar should be drawn, in pixels.\n   */\n  lengthInPixels: number;\n\n  /**\n   * Physical length with which to label the scale bar.\n   */\n  physicalLength: number;\n  physicalUnit: string;\n\n  prevNanometersPerPixel: number = 0;\n  prevTargetLengthInPixels: number = 0;\n\n  /**\n   * Updates physicalLength, physicalUnit, and lengthInPixels to be the optimal\n   * values corresponding\n   * to targetLengthInPixels and nanometersPerPixel.\n   *\n   * @returns true if the scale bar has changed, false if it is unchanged.\n   */\n  update() {\n    let {nanometersPerPixel, targetLengthInPixels} = this;\n    if (this.prevNanometersPerPixel === nanometersPerPixel &&\n        this.prevTargetLengthInPixels === targetLengthInPixels) {\n      return false;\n    }\n    this.prevNanometersPerPixel = nanometersPerPixel;\n    this.prevTargetLengthInPixels = targetLengthInPixels;\n    const targetNanometers = targetLengthInPixels * nanometersPerPixel;\n    const exponent = Math.floor(Math.log(targetNanometers) / Math.LN10);\n    const tenToThePowerExponent = Math.pow(10, exponent);\n    const targetSignificand = targetNanometers / tenToThePowerExponent;\n\n    // Determine significand value in this.allowedSignificands that is closest\n    // to targetSignificand.\n    let bestSignificand = 1;\n    for (let allowedSignificand of this.allowedSignificands) {\n      if (Math.abs(allowedSignificand - targetSignificand) <\n          Math.abs(bestSignificand - targetSignificand)) {\n        bestSignificand = allowedSignificand;\n      } else {\n        // If distance did not decrease, then it can only increase from here.\n        break;\n      }\n    }\n\n    const physicalNanometers = bestSignificand * tenToThePowerExponent;\n    const unit = pickLengthUnit(physicalNanometers);\n    this.lengthInPixels = Math.round(physicalNanometers / nanometersPerPixel);\n    this.physicalUnit = unit.unit;\n    this.physicalLength = physicalNanometers / unit.lengthInNanometers;\n    return true;\n  }\n}\n\nfunction makeScaleBarTexture(\n    dimensions: ScaleBarDimensions, gl: GL, texture: WebGLTexture|null,\n    options: ScaleBarTextureOptions = defaultScaleBarTextureOptions) {\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d')!;\n  const textHeight = options.textHeightInPixels * options.scaleFactor;\n  const font = `bold ${textHeight}px ${options.fontName}`;\n  ctx.font = font;\n  ctx.fillStyle = 'white';\n  const text = `${dimensions.physicalLength} ${dimensions.physicalUnit}`;\n  const textMetrics = ctx.measureText(text);\n  const innerWidth = Math.max(dimensions.lengthInPixels, textMetrics.width);\n  const barHeight = options.barHeightInPixels * options.scaleFactor;\n  const barTopMargin = options.barTopMarginInPixels * options.scaleFactor;\n  const innerHeight = barHeight + barTopMargin + textHeight;\n  const padding = options.paddingInPixels * options.scaleFactor;\n  const totalHeight = innerHeight + 2 * padding;\n  const totalWidth = innerWidth + 2 * padding;\n  canvas.width = totalWidth;\n  canvas.height = totalHeight;\n  ctx.font = font;\n  ctx.textAlign = 'center';\n  ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\n  ctx.fillRect(0, 0, totalWidth, totalHeight);\n  ctx.fillStyle = 'white';\n  ctx.fillText(text, totalWidth / 2, totalHeight - padding - barHeight - barTopMargin);\n  ctx.fillRect(padding, totalHeight - padding - barHeight, dimensions.lengthInPixels, barHeight);\n  setTextureFromCanvas(gl, texture, canvas);\n  return {width: totalWidth, height: totalHeight};\n}\n\nexport class ScaleBarTexture extends RefCounted {\n  texture: WebGLTexture|null = null;\n  width = 0;\n  height = 0;\n  private priorOptions: ScaleBarTextureOptions|undefined = undefined;\n\n  constructor(public gl: GL, public dimensions = new ScaleBarDimensions()) {\n    super();\n  }\n\n  update(options: ScaleBarTextureOptions) {\n    let {dimensions} = this;\n    let {texture} = this;\n    if (!dimensions.update() && texture !== null && options === this.priorOptions) {\n      return;\n    }\n    if (texture === null) {\n      texture = this.texture = this.gl.createTexture();\n    }\n    const {width, height} = makeScaleBarTexture(dimensions, this.gl, texture, options);\n    this.priorOptions = options;\n    this.width = width;\n    this.height = height;\n  }\n\n  disposed() {\n    this.gl.deleteTexture(this.texture);\n    this.texture = null;\n    super.disposed();\n  }\n}\n\nexport interface ScaleBarTextureOptions {\n  textHeightInPixels: number;\n  barTopMarginInPixels: number;\n  fontName: string;\n  barHeightInPixels: number;\n  paddingInPixels: number;\n  scaleFactor: number;\n}\n\nexport interface ScaleBarOptions extends ScaleBarTextureOptions {\n  maxWidthInPixels: number;\n  maxWidthFraction: number;\n  leftPixelOffset: number;\n  bottomPixelOffset: number;\n}\n\nexport const defaultScaleBarTextureOptions: ScaleBarTextureOptions = {\n  scaleFactor: 1,\n  textHeightInPixels: 15,\n  barHeightInPixels: 8,\n  barTopMarginInPixels: 5,\n  fontName: 'sans-serif',\n  paddingInPixels: 2,\n};\n\nexport const defaultScaleBarOptions: ScaleBarOptions = {\n  ...defaultScaleBarTextureOptions,\n  maxWidthInPixels: 100,\n  maxWidthFraction: 0.25,\n  leftPixelOffset: 10,\n  bottomPixelOffset: 10,\n};\n\nfunction parseScaleBarOptions(obj: any): ScaleBarOptions {\n  const result = {\n    ...defaultScaleBarOptions,\n  };\n  for (const k of <(keyof ScaleBarOptions)[]>[\n         'textHeightInPixels', 'barTopMarginInPixels', 'barHeightInPixels', 'paddingInPixels',\n         'scaleFactor', 'maxWidthInPixels', 'maxWidthFraction', 'leftPixelOffset',\n         'bottomPixelOffset'\n       ]) {\n    verifyObjectProperty(obj, k, x => {\n      if (x !== undefined) {\n        result[k] = verifyFloat(x);\n      }\n    });\n  }\n  verifyObjectProperty(obj, 'fontName', x => {\n    if (x !== undefined) {\n      result.fontName = verifyString(x);\n    }\n  });\n  return result;\n}\n\nexport class TrackableScaleBarOptions extends TrackableValue<ScaleBarOptions> {\n  constructor() {\n    super(defaultScaleBarOptions, parseScaleBarOptions);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\n\nrequire('./range.css');\n\nexport class RangeWidget extends RefCounted {\n  element = document.createElement('label');\n  promptElement = document.createElement('span');\n  inputElement = document.createElement('input');\n\n  constructor(public value: TrackableValue<number>, {min = 0, max = 1, step = 0.01} = {}) {\n    super();\n    let {element, promptElement, inputElement} = this;\n    element.className = 'range-slider';\n    promptElement.className = 'range-prompt';\n    inputElement.type = 'range';\n    inputElement.min = '' + min;\n    inputElement.max = '' + max;\n    inputElement.step = '' + step;\n    inputElement.valueAsNumber = this.value.value;\n    element.appendChild(promptElement);\n    element.appendChild(inputElement);\n    const inputValueChanged = () => {\n      this.value.value = this.inputElement.valueAsNumber;\n    };\n    this.registerEventListener(inputElement, 'change', inputValueChanged);\n    this.registerEventListener(inputElement, 'input', inputValueChanged);\n    this.registerEventListener(inputElement, 'wheel', (event: WheelEvent) => {\n      let {deltaY} = event;\n      if (deltaY > 0) {\n        this.inputElement.stepUp();\n        inputValueChanged();\n      } else if (deltaY < 0) {\n        this.inputElement.stepDown();\n        inputValueChanged();\n      }\n    });\n    value.changed.add(() => {\n      this.inputElement.valueAsNumber = this.value.value;\n    });\n  }\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DataType} from 'neuroglancer/util/data_type';\n\nexport const SKELETON_LAYER_RPC_ID = 'skeleton/SkeletonLayer';\n\nexport interface VertexAttributeInfo {\n  dataType: DataType;\n  numComponents: number;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {Chunk, ChunkManager, ChunkSource} from 'neuroglancer/chunk_manager/frontend';\nimport {RenderLayer} from 'neuroglancer/layer';\nimport {VoxelSize} from 'neuroglancer/navigation_state';\nimport {PerspectiveViewRenderContext, PerspectiveViewRenderLayer} from 'neuroglancer/perspective_view/render_layer';\nimport {forEachVisibleSegment, getObjectKey} from 'neuroglancer/segmentation_display_state/base';\nimport {getObjectColor, registerRedrawWhenSegmentationDisplayState3DChanged, SegmentationDisplayState3D, SegmentationLayerSharedObject} from 'neuroglancer/segmentation_display_state/frontend';\nimport {SKELETON_LAYER_RPC_ID, VertexAttributeInfo} from 'neuroglancer/skeleton/base';\nimport {SliceViewPanelRenderContext, SliceViewPanelRenderLayer} from 'neuroglancer/sliceview/panel';\nimport {TrackableValue, WatchableValue} from 'neuroglancer/trackable_value';\nimport {DataType} from 'neuroglancer/util/data_type';\nimport {Borrowed, RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {verifyFinitePositiveFloat, verifyString} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {CompoundTrackable, Trackable} from 'neuroglancer/util/trackable';\nimport {TrackableEnum} from 'neuroglancer/util/trackable_enum';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {CircleShader} from 'neuroglancer/webgl/circles';\nimport glsl_COLORMAPS from 'neuroglancer/webgl/colormaps.glsl';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {parameterizedEmitterDependentShaderGetter, WatchableShaderError} from 'neuroglancer/webgl/dynamic_shader';\nimport {LineShader} from 'neuroglancer/webgl/lines';\nimport {ShaderBuilder, ShaderProgram, ShaderSamplerType} from 'neuroglancer/webgl/shader';\nimport {compute1dTextureLayout, computeTextureFormat, getSamplerPrefixForDataType, OneDimensionalTextureAccessHelper, setOneDimensionalTextureData, TextureFormat} from 'neuroglancer/webgl/texture_access';\n\nconst tempMat2 = mat4.create();\n\nconst DEFAULT_FRAGMENT_MAIN = `void main() {\n  emitDefault();\n}\n`;\n\nexport const FRAGMENT_MAIN_START = '//NEUROGLANCER_SKELETON_LAYER_FRAGMENT_MAIN_START';\n\nexport type TrackableFragmentMain = TrackableValue<string>;\n\nexport function getTrackableFragmentMain(value = DEFAULT_FRAGMENT_MAIN) {\n  return new TrackableValue<string>(value, verifyString);\n}\n\ninterface VertexAttributeRenderInfo extends VertexAttributeInfo {\n  name: string;\n  webglDataType: number;\n  glslDataType: string;\n}\n\nconst vertexAttributeSamplerSymbols: Symbol[] = [];\n\nconst vertexPositionTextureFormat = computeTextureFormat(new TextureFormat(), DataType.FLOAT32, 3);\n\nclass RenderHelper extends RefCounted {\n  private textureAccessHelper = new OneDimensionalTextureAccessHelper('vertexData');\n  private lineShader = this.registerDisposer(new LineShader(this.gl, 1));\n  private circleShader = this.registerDisposer(new CircleShader(this.gl, 2));\n\n  get vertexAttributes(): VertexAttributeRenderInfo[] {\n    return this.base.vertexAttributes;\n  }\n\n  defineCommonShader(builder: ShaderBuilder) {\n    builder.addUniform('highp vec4', 'uColor');\n    builder.addUniform('highp mat4', 'uProjection');\n    builder.addUniform('highp uint', 'uPickID');\n  }\n\n  edgeShaderGetter = parameterizedEmitterDependentShaderGetter(\n      this, this.gl,\n      {type: 'skeleton/SkeletonShaderManager/edge', vertexAttributes: this.vertexAttributes},\n      this.base.fallbackFragmentMain, this.base.displayState.skeletonRenderingOptions.shader,\n      this.base.displayState.shaderError, (builder: ShaderBuilder, fragmentMain: string) => {\n        this.defineAttributeAccess(builder);\n        this.lineShader.defineShader(builder);\n        builder.addAttribute('highp uvec2', 'aVertexIndex');\n        this.defineCommonShader(builder);\n        let vertexMain = `\nhighp vec3 vertexA = readAttribute0(aVertexIndex.x);\nhighp vec3 vertexB = readAttribute0(aVertexIndex.y);\nemitLine(uProjection, vertexA, vertexB);\nhighp uint lineEndpointIndex = getLineEndpointIndex();\nhighp uint vertexIndex = aVertexIndex.x * lineEndpointIndex + aVertexIndex.y * (1u - lineEndpointIndex);\n`;\n\n        builder.addFragmentCode(`\nvec4 segmentColor() {\n  return uColor;\n}\nvoid emitRGB(vec3 color) {\n  emit(vec4(color * uColor.a, uColor.a * getLineAlpha() * ${this.getCrossSectionFadeFactor()}), uPickID);\n}\nvoid emitDefault() {\n  //emit(vec4(uColor.rgb, uColor.a * ${this.getCrossSectionFadeFactor()}), uPickID);\n  emit(vec4(uColor.rgb, uColor.a * getLineAlpha() * ${this.getCrossSectionFadeFactor()}), uPickID);\n}\n`);\n        builder.addFragmentCode(glsl_COLORMAPS);\n        const {vertexAttributes} = this;\n        const numAttributes = vertexAttributes.length;\n        for (let i = 1; i < numAttributes; ++i) {\n          const info = vertexAttributes[i];\n          builder.addVarying(`highp ${info.glslDataType}`, `vCustom${i}`);\n          vertexMain += `vCustom${i} = readAttribute${i}(vertexIndex);\\n`;\n          builder.addFragmentCode(`#define ${info.name} vCustom${i}\\n`);\n        }\n        builder.setVertexMain(vertexMain);\n        builder.setFragmentMainFunction(FRAGMENT_MAIN_START + '\\n' + fragmentMain);\n      });\n\n  nodeShaderGetter = parameterizedEmitterDependentShaderGetter(\n      this, this.gl,\n      {type: 'skeleton/SkeletonShaderManager/node', vertexAttributes: this.vertexAttributes},\n      this.base.fallbackFragmentMain, this.base.displayState.skeletonRenderingOptions.shader,\n      this.base.displayState.shaderError, (builder: ShaderBuilder, fragmentMain: string) => {\n        this.defineAttributeAccess(builder);\n        this.circleShader.defineShader(builder, /*crossSectionFade=*/ this.targetIsSliceView);\n        this.defineCommonShader(builder);\n        let vertexMain = `\nhighp uint vertexIndex = uint(gl_InstanceID);\nhighp vec3 vertexPosition = readAttribute0(vertexIndex);\nemitCircle(uProjection * vec4(vertexPosition, 1.0));\n`;\n\n        builder.addFragmentCode(`\nvec4 segmentColor() {\n  return uColor;\n}\nvoid emitRGBA(vec4 color) {\n  vec4 borderColor = color;\n  emit(getCircleColor(color, borderColor), uPickID);\n}\nvoid emitRGB(vec3 color) {\n  emitRGBA(vec4(color, 1.0));\n}\nvoid emitDefault() {\n  emitRGBA(uColor);\n}\n`);\n        builder.addFragmentCode(glsl_COLORMAPS);\n        const {vertexAttributes} = this;\n        const numAttributes = vertexAttributes.length;\n        for (let i = 1; i < numAttributes; ++i) {\n          const info = vertexAttributes[i];\n          builder.addVarying(`highp ${info.glslDataType}`, `vCustom${i}`);\n          vertexMain += `vCustom${i} = readAttribute${i}(vertexIndex);\\n`;\n          builder.addFragmentCode(`#define ${info.name} vCustom${i}\\n`);\n        }\n        builder.setVertexMain(vertexMain);\n        builder.setFragmentMainFunction(FRAGMENT_MAIN_START + '\\n' + fragmentMain);\n      });\n\n  get gl(): GL {\n    return this.base.gl;\n  }\n\n  constructor(public base: SkeletonLayer, public targetIsSliceView: boolean) {\n    super();\n  }\n\n  defineAttributeAccess(builder: ShaderBuilder) {\n    const {textureAccessHelper} = this;\n    textureAccessHelper.defineShader(builder);\n    const numAttributes = this.vertexAttributes.length;\n    for (let j = vertexAttributeSamplerSymbols.length; j < numAttributes; ++j) {\n      vertexAttributeSamplerSymbols[j] = Symbol(`SkeletonShader.vertexAttributeTextureUnit${j}`);\n    }\n    this.vertexAttributes.forEach((info, i) => {\n      builder.addTextureSampler(\n          `${getSamplerPrefixForDataType(info.dataType)}sampler2D` as ShaderSamplerType,\n          `uVertexAttributeSampler${i}`, vertexAttributeSamplerSymbols[i]);\n      builder.addVertexCode(textureAccessHelper.getAccessor(\n          `readAttribute${i}`, `uVertexAttributeSampler${i}`, info.dataType, info.numComponents));\n    });\n  }\n\n  getCrossSectionFadeFactor() {\n    if (this.targetIsSliceView) {\n      return `(clamp(1.0 - 2.0 * abs(0.5 - gl_FragCoord.z), 0.0, 1.0))`;\n    } else {\n      return `(1.0)`;\n    }\n  }\n\n  beginLayer(\n      gl: GL, shader: ShaderProgram,\n      renderContext: SliceViewPanelRenderContext|PerspectiveViewRenderContext,\n      objectToDataMatrix: mat4) {\n    let {dataToDevice} = renderContext;\n    let mat = mat4.multiply(tempMat2, dataToDevice, objectToDataMatrix);\n    gl.uniformMatrix4fv(shader.uniform('uProjection'), false, mat);\n  }\n\n  setColor(gl: GL, shader: ShaderProgram, color: vec3) {\n    gl.uniform4fv(shader.uniform('uColor'), color);\n  }\n\n  setPickID(gl: GL, shader: ShaderProgram, pickID: number) {\n    gl.uniform1ui(shader.uniform('uPickID'), pickID);\n  }\n\n  drawSkeleton(\n      gl: GL, edgeShader: ShaderProgram, nodeShader: ShaderProgram|null,\n      skeletonChunk: SkeletonChunk, renderContext: {viewportWidth: number, viewportHeight: number},\n    lineWidth: number,\n    pointDiameter: number) {\n    const {vertexAttributes} = this;\n    const numAttributes = vertexAttributes.length;\n    const {vertexAttributeTextures} = skeletonChunk;\n    for (let i = 0; i < numAttributes; ++i) {\n      const textureUnit = WebGL2RenderingContext.TEXTURE0 +\n          edgeShader.textureUnit(vertexAttributeSamplerSymbols[i]);\n      gl.activeTexture(textureUnit);\n      gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, vertexAttributeTextures[i]);\n    }\n\n    // Draw edges\n    {\n      edgeShader.bind();\n      this.textureAccessHelper.setupTextureLayout(gl, edgeShader, skeletonChunk);\n      const aVertexIndex = edgeShader.attribute('aVertexIndex');\n      skeletonChunk.indexBuffer.bindToVertexAttribI(\n          aVertexIndex, 2, WebGL2RenderingContext.UNSIGNED_INT);\n      gl.vertexAttribDivisor(aVertexIndex, 1);\n      this.lineShader.draw(\n          edgeShader, renderContext, lineWidth, this.targetIsSliceView ? 1.0 : 0.0,\n          skeletonChunk.numIndices / 2);\n      gl.vertexAttribDivisor(aVertexIndex, 0);\n      gl.disableVertexAttribArray(aVertexIndex);\n    }\n\n    if (nodeShader !== null) {\n      nodeShader.bind();\n      this.textureAccessHelper.setupTextureLayout(gl, nodeShader, skeletonChunk);\n      this.circleShader.draw(\n          nodeShader, renderContext, {\n            interiorRadiusInPixels: pointDiameter / 2,\n            borderWidthInPixels: 0,\n            featherWidthInPixels: this.targetIsSliceView ? 1.0 : 0.0,\n          },\n          skeletonChunk.numVertices);\n    }\n  }\n\n  endLayer(gl: GL, shader: ShaderProgram) {\n    const {vertexAttributes} = this;\n    const numAttributes = vertexAttributes.length;\n    for (let i = 0; i < numAttributes; ++i) {\n      let curTextureUnit =\n          shader.textureUnit(vertexAttributeSamplerSymbols[i]) + WebGL2RenderingContext.TEXTURE0;\n      gl.activeTexture(curTextureUnit);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n    }\n  }\n}\n\nexport enum SkeletonRenderMode {\n  LINES,\n  LINES_AND_POINTS,\n}\n\nexport class TrackableSkeletonRenderMode extends TrackableEnum<SkeletonRenderMode> {\n  constructor(value: SkeletonRenderMode, defaultValue: SkeletonRenderMode = value) {\n    super(SkeletonRenderMode, value, defaultValue);\n  }\n}\n\nexport class TrackableSkeletonLineWidth extends TrackableValue<number> {\n  constructor(value: number, defaultValue: number = value) {\n    super(value, verifyFinitePositiveFloat, defaultValue);\n  }\n}\n\nexport interface ViewSpecificSkeletonRenderingOptions {\n  mode: TrackableSkeletonRenderMode;\n  lineWidth: TrackableSkeletonLineWidth;\n}\n\nexport class SkeletonRenderingOptions implements Trackable {\n  private compound = new CompoundTrackable();\n  get changed() {\n    return this.compound.changed;\n  }\n\n  shader = getTrackableFragmentMain();\n  params2d: ViewSpecificSkeletonRenderingOptions = {\n    mode: new TrackableSkeletonRenderMode(SkeletonRenderMode.LINES_AND_POINTS),\n    lineWidth: new TrackableSkeletonLineWidth(5),\n  };\n  params3d: ViewSpecificSkeletonRenderingOptions = {\n    mode: new TrackableSkeletonRenderMode(SkeletonRenderMode.LINES),\n    lineWidth: new TrackableSkeletonLineWidth(2),\n  };\n\n  constructor() {\n    const {compound} = this;\n    compound.add('shader', this.shader);\n    compound.add('mode2d', this.params2d.mode);\n    compound.add('lineWidth2d', this.params2d.lineWidth);\n    compound.add('mode3d', this.params3d.mode);\n    compound.add('lineWidth3d', this.params3d.lineWidth);\n  }\n\n  reset() {\n    this.compound.reset();\n  }\n\n  restoreState(obj: any) {\n    if (obj === undefined) return;\n    this.compound.restoreState(obj);\n  }\n\n  toJSON(): any {\n    const obj = this.compound.toJSON();\n    for (const _ in obj) return obj;\n    return undefined;\n  }\n}\n\nexport interface SkeletonLayerDisplayState extends SegmentationDisplayState3D {\n  shaderError: WatchableShaderError;\n  skeletonRenderingOptions: SkeletonRenderingOptions;\n}\n\nexport class SkeletonLayer extends RefCounted {\n  private tempMat = mat4.create();\n  redrawNeeded = new NullarySignal();\n  private sharedObject: SegmentationLayerSharedObject;\n  vertexAttributes: VertexAttributeRenderInfo[];\n  fallbackFragmentMain = new WatchableValue<string>(DEFAULT_FRAGMENT_MAIN);\n\n  get visibility() {\n    return this.sharedObject.visibility;\n  }\n\n  constructor(\n      public chunkManager: ChunkManager, public source: SkeletonSource,\n      public voxelSizeObject: VoxelSize, public displayState: SkeletonLayerDisplayState) {\n    super();\n\n    registerRedrawWhenSegmentationDisplayState3DChanged(displayState, this);\n    this.displayState.shaderError.value = undefined;\n    const {skeletonRenderingOptions: renderingOptions} = displayState;\n    this.registerDisposer(renderingOptions.shader.changed.add(() => {\n      this.displayState.shaderError.value = undefined;\n      this.redrawNeeded.dispatch();\n    }));\n    let sharedObject = this.sharedObject =\n        this.registerDisposer(new SegmentationLayerSharedObject(chunkManager, displayState));\n    sharedObject.RPC_TYPE_ID = SKELETON_LAYER_RPC_ID;\n    sharedObject.initializeCounterpartWithChunkManager({\n      'source': source.addCounterpartRef(),\n    });\n\n    const vertexAttributes = this.vertexAttributes = [vertexPositionAttribute];\n\n    for (let [name, info] of source.vertexAttributes) {\n      vertexAttributes.push({\n        name,\n        dataType: info.dataType,\n        numComponents: info.numComponents,\n        webglDataType: getWebglDataType(info.dataType),\n        glslDataType: info.numComponents > 1 ? `vec${info.numComponents}` : 'float',\n      });\n    }\n  }\n\n  get gl() {\n    return this.chunkManager.chunkQueueManager.gl;\n  }\n\n  draw(\n      renderContext: SliceViewPanelRenderContext|PerspectiveViewRenderContext, layer: RenderLayer,\n    renderHelper: RenderHelper, renderOptions: ViewSpecificSkeletonRenderingOptions) {\n    let lineWidth = renderOptions.lineWidth.value;\n    let {gl, source, displayState} = this;\n    let alpha = Math.min(1.0, displayState.objectAlpha.value);\n    if (alpha <= 0.0) {\n      // Skip drawing.\n      return;\n    }\n    let pointDiameter: number;\n    if (renderOptions.mode.value === SkeletonRenderMode.LINES_AND_POINTS) {\n      pointDiameter = Math.max(10, lineWidth * 2);\n    } else {\n      pointDiameter = lineWidth;\n    }\n\n    const edgeShader = renderHelper.edgeShaderGetter(renderContext.emitter);\n    const nodeShader = renderHelper.nodeShaderGetter(renderContext.emitter);\n    if (edgeShader === null || nodeShader === null) {\n      // Shader error, skip drawing.\n      return;\n    }\n\n    let objectToDataMatrix = this.tempMat;\n    mat4.identity(objectToDataMatrix);\n    if (source.skeletonVertexCoordinatesInVoxels) {\n      mat4.scale(objectToDataMatrix, objectToDataMatrix, this.voxelSizeObject.size);\n    }\n    mat4.multiply(objectToDataMatrix, objectToDataMatrix, source.transform);\n    mat4.multiply(\n        objectToDataMatrix, this.displayState.objectToDataTransform.transform, objectToDataMatrix);\n\n    edgeShader.bind();\n    renderHelper.beginLayer(gl, edgeShader, renderContext, objectToDataMatrix);\n\n    nodeShader.bind();\n    renderHelper.beginLayer(gl, nodeShader, renderContext, objectToDataMatrix);\n\n    const skeletons = source.chunks;\n    const {pickIDs} = renderContext;\n\n    forEachVisibleSegment(displayState, (objectId, rootObjectId) => {\n      const key = getObjectKey(objectId);\n      const skeleton = skeletons.get(key);\n      if (skeleton === undefined || skeleton.state !== ChunkState.GPU_MEMORY) {\n        return;\n      }\n      if (renderContext.emitColor) {\n        edgeShader.bind();\n        renderHelper.setColor(\n            gl, edgeShader, <vec3><Float32Array>getObjectColor(displayState, rootObjectId, alpha));\n        nodeShader.bind();\n        renderHelper.setColor(\n            gl, nodeShader, <vec3><Float32Array>getObjectColor(displayState, rootObjectId, alpha));\n      }\n      if (renderContext.emitPickID) {\n        edgeShader.bind();\n        renderHelper.setPickID(gl, edgeShader, pickIDs.registerUint64(layer, objectId));\n        nodeShader.bind();\n        renderHelper.setPickID(gl, nodeShader, pickIDs.registerUint64(layer, objectId));\n      }\n      renderHelper.drawSkeleton(\n          gl, edgeShader, nodeShader, skeleton, renderContext, lineWidth!, pointDiameter);\n    });\n    renderHelper.endLayer(gl, edgeShader);\n  }\n}\n\nexport class PerspectiveViewSkeletonLayer extends PerspectiveViewRenderLayer {\n  private renderHelper = this.registerDisposer(new RenderHelper(this.base, false));\n  private renderOptions = this.base.displayState.skeletonRenderingOptions.params3d;\n\n  constructor(public base: SkeletonLayer) {\n    super();\n    this.registerDisposer(base);\n    this.registerDisposer(base.redrawNeeded.add(this.redrawNeeded.dispatch));\n    const {renderOptions} = this;\n    this.registerDisposer(renderOptions.mode.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(renderOptions.lineWidth.changed.add(this.redrawNeeded.dispatch));\n    this.setReady(true);\n    this.registerDisposer(base.visibility.add(this.visibility));\n  }\n  get gl() {\n    return this.base.gl;\n  }\n\n  get isTransparent() {\n    return this.base.displayState.objectAlpha.value < 1.0;\n  }\n\n  draw(renderContext: PerspectiveViewRenderContext) {\n    if (!renderContext.emitColor && renderContext.alreadyEmittedPickID) {\n      // No need for a separate pick ID pass.\n      return;\n    }\n    this.base.draw(renderContext, this, this.renderHelper, this.renderOptions);\n  }\n}\n\nexport class SliceViewPanelSkeletonLayer extends SliceViewPanelRenderLayer {\n  private renderHelper = this.registerDisposer(new RenderHelper(this.base, true));\n  private renderOptions = this.base.displayState.skeletonRenderingOptions.params2d;\n  constructor(public base: SkeletonLayer) {\n    super();\n    this.registerDisposer(base);\n    const {renderOptions} = this;\n    this.registerDisposer(renderOptions.mode.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(renderOptions.lineWidth.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(base.redrawNeeded.add(this.redrawNeeded.dispatch));\n    this.setReady(true);\n    this.registerDisposer(base.visibility.add(this.visibility));\n  }\n  get gl() {\n    return this.base.gl;\n  }\n\n  draw(renderContext: SliceViewPanelRenderContext) {\n    this.base.draw(renderContext, this, this.renderHelper, this.renderOptions);\n  }\n}\n\nfunction getWebglDataType(dataType: DataType) {\n  switch (dataType) {\n    case DataType.FLOAT32:\n      return WebGL2RenderingContext.FLOAT;\n    default:\n      throw new Error('Data type not supported by WebGL: ${DataType[dataType]}');\n  }\n}\n\nconst vertexPositionAttribute: VertexAttributeRenderInfo = {\n  dataType: DataType.FLOAT32,\n  numComponents: 3,\n  name: '',\n  webglDataType: WebGL2RenderingContext.FLOAT,\n  glslDataType: 'vec3',\n};\n\nexport class SkeletonChunk extends Chunk {\n  source: SkeletonSource;\n  vertexAttributes: Uint8Array;\n  indices: Uint32Array;\n  indexBuffer: Buffer;\n  numIndices: number;\n  numVertices: number;\n  vertexAttributeOffsets: Uint32Array;\n  vertexAttributeTextures: (WebGLTexture|null)[];\n\n  // Emulation of buffer as texture.\n  textureXBits: number;\n  textureWidth: number;\n  textureHeight: number;\n\n  constructor(source: SkeletonSource, x: any) {\n    super(source);\n    this.vertexAttributes = x['vertexAttributes'];\n    let indices = this.indices = x['indices'];\n    this.numVertices = x['numVertices'];\n    this.vertexAttributeOffsets = x['vertexAttributeOffsets'];\n    this.numIndices = indices.length;\n  }\n\n  copyToGPU(gl: GL) {\n    super.copyToGPU(gl);\n    compute1dTextureLayout(this, gl, /*texelsPerElement=*/ 1, this.numVertices);\n    const {attributeTextureFormats} = this.source;\n    const {vertexAttributes, vertexAttributeOffsets} = this;\n    const vertexAttributeTextures: (WebGLTexture|null)[] = this.vertexAttributeTextures = [];\n    for (let i = 0, numAttributes = vertexAttributeOffsets.length; i < numAttributes; ++i) {\n      const texture = gl.createTexture();\n      gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, texture);\n      setOneDimensionalTextureData(\n          gl, this, attributeTextureFormats[i],\n          vertexAttributes.subarray(\n              vertexAttributeOffsets[i],\n              i + 1 !== numAttributes ? vertexAttributeOffsets[i + 1] : vertexAttributes.length));\n      vertexAttributeTextures[i] = texture;\n    }\n    gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, null);\n    this.indexBuffer = Buffer.fromData(\n        gl, this.indices, WebGL2RenderingContext.ARRAY_BUFFER, WebGL2RenderingContext.STATIC_DRAW);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    const {vertexAttributeTextures} = this;\n    for (const texture of vertexAttributeTextures) {\n      gl.deleteTexture(texture);\n    }\n    vertexAttributeTextures.length = 0;\n    this.indexBuffer.dispose();\n  }\n}\n\nconst emptyVertexAttributes = new Map<string, VertexAttributeInfo>();\n\nfunction getAttributeTextureFormats(vertexAttributes: Map<string, VertexAttributeInfo>):\n    TextureFormat[] {\n  const attributeTextureFormats: TextureFormat[] = [vertexPositionTextureFormat];\n  for (const info of vertexAttributes.values()) {\n    attributeTextureFormats.push(\n        computeTextureFormat(new TextureFormat(), info.dataType, info.numComponents));\n  }\n  return attributeTextureFormats;\n}\n\nexport class SkeletonSource extends ChunkSource {\n  private attributeTextureFormats_?: TextureFormat[];\n\n  get attributeTextureFormats() {\n    let attributeTextureFormats = this.attributeTextureFormats_;\n    if (attributeTextureFormats === undefined) {\n      attributeTextureFormats = this.attributeTextureFormats_ =\n          getAttributeTextureFormats(this.vertexAttributes);\n    }\n    return attributeTextureFormats;\n  }\n\n  chunks: Map<string, SkeletonChunk>;\n  getChunk(x: any) {\n    return new SkeletonChunk(this, x);\n  }\n\n  transform: mat4;\n\n  constructor(chunkManager: Borrowed<ChunkManager>, options: {transform?: mat4}) {\n    super(chunkManager, options);\n    const {transform = mat4.create()} = options;\n    this.transform = transform;\n  }\n\n  /**\n   * Specifies whether the skeleton vertex coordinates are specified in units of voxels rather than\n   * nanometers.\n   */\n  get skeletonVertexCoordinatesInVoxels() {\n    return true;\n  }\n\n  get vertexAttributes(): Map<string, VertexAttributeInfo> {\n    return emptyVertexAttributes;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facility for sharing arbitrary values that support structural cloning between threads.\n */\n\nimport {WatchableValue, WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {registerRPC, registerSharedObject, RPC, SharedObjectCounterpart} from 'neuroglancer/worker_rpc';\n\nconst CHANGED_RPC_METHOD_ID = 'SharedWatchableValue.changed';\n\n@registerSharedObject('SharedWatchableValue')\nexport class SharedWatchableValue<T> extends SharedObjectCounterpart implements\n    WatchableValueInterface<T> {\n  base: WatchableValueInterface<T>;\n\n  /**\n   * The value is being updated to reflect a remote change.\n   * @internal\n   */\n  updatingValue_ = false;\n\n  constructor(rpc?: RPC, options: any = {}) {\n    super(rpc, options);\n    if (rpc !== undefined) {\n      this.base = new WatchableValue<T>(options['value']);\n      this.setupChangedHandler();\n    }\n  }\n\n  initializeCounterpart(rpc: RPC, options: any = {}) {\n    options['value'] = this.value;\n    super.initializeCounterpart(rpc, options);\n  }\n\n  private setupChangedHandler() {\n    this.registerDisposer(this.base.changed.add(() => {\n      if (this.updatingValue_) {\n        this.updatingValue_ = false;\n      } else {\n        const {rpc} = this;\n        if (rpc !== null) {\n          rpc.invoke(CHANGED_RPC_METHOD_ID, {'id': this.rpcId, 'value': this.value});\n        }\n      }\n    }));\n  }\n\n  static makeFromExisting<T>(rpc: RPC, base: WatchableValueInterface<T>) {\n    let obj = new SharedWatchableValue<T>();\n    obj.base = base;\n    obj.setupChangedHandler();\n    obj.initializeCounterpart(rpc);\n    return obj;\n  }\n\n  static make<T>(rpc: RPC, value: T) {\n    return SharedWatchableValue.makeFromExisting(rpc, new WatchableValue<T>(value));\n  }\n\n  get value() {\n    return this.base.value;\n  }\n\n  set value(value: T) {\n    this.base.value = value;\n  }\n\n  get changed() {\n    return this.base.changed;\n  }\n}\n\nregisterRPC(CHANGED_RPC_METHOD_ID, function(x) {\n  const obj = <SharedWatchableValue<any>>this.get(x['id']);\n  obj.updatingValue_ = true;\n  obj.base.value = x['value'];\n  obj.updatingValue_ = false;\n});\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {DataSource, DataSourceProvider, GetVolumeOptions} from 'neuroglancer/datasource';\nimport {ComputationParameters, ComputedVolumeChunkSourceParameters} from 'neuroglancer/datasource/computed/base';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {CancellationToken} from 'neuroglancer/util/cancellation';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {verifyObject, verifyString} from 'neuroglancer/util/json';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\n\nclass ComputedVolumeChunkSource extends\n(WithParameters(VolumeChunkSource, ComputedVolumeChunkSourceParameters)) {}\n\nexport abstract class VolumeComputationFrontend extends SharedObject {\n  constructor(public params: ComputationParameters) {\n    super();\n  }\n}\n\nexport interface VolumeComputationFrontendProvider {\n  /**\n   * Modifes the ComputedVolumeDataSourceParameters as needed and returns\n   * a VolumeComputationFrontend in a Promise.\n   * @param config a JSON object parsed from the URL\n   * @param volumes A volumes array as returned by\n   *   GenericMultiscaleVolumeChunkSource.getSources()\n   * @param params volume data source parameters, populated with defaults\n   *   from the native resolution origin source. These are to be modified.\n   * @returns a Promise containing containg the frontend computation.\n   */\n  getComputation(\n      config: any, volumes: VolumeChunkSource[][],\n      params: ComputedVolumeDataSourceParameters): Promise<VolumeComputationFrontend>;\n}\n\nexport interface ComputedVolumeDataSourceParameters {\n  // URL of the origin volume chunk source, used as computational input.\n  originUrl: string;\n  // Index of the input scale on the origin source.\n  inputScaleIndex: number;\n  // Index of the input volume at the given scale on the origin source.\n  inputSourceIndex: number;\n  // Output voxel size.\n  outputVoxelSize: vec3;\n  // Output voxel offset.\n  outputVoxelOffset: vec3;\n  // Output volume size.\n  outputVolumeSize: vec3;\n  // Determines input buffer size as well as output data chunks size, etc.\n  computationParameters: ComputationParameters;\n\n  dataSourceProvider: DataSourceProvider;\n}\n\ninterface ComputedVolumeSpecs {\n  sources: VolumeChunkSource[][];\n  volumeType: VolumeType;\n  dataType: DataType;\n  numChannels: number;\n}\n\nexport class ComputedMultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  numChannels: number;\n  dataType: DataType;\n  volumeType: VolumeType;\n\n  constructor(\n      public params: ComputedVolumeDataSourceParameters, public sources: VolumeChunkSource[][],\n      public computation: VolumeComputationFrontend, public chunkManager: ChunkManager) {\n    this.numChannels = params.computationParameters.outputSpec.numChannels;\n    this.dataType = params.computationParameters.outputSpec.dataType;\n    this.volumeType = params.computationParameters.outputSpec.volumeType;\n  }\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    const spec = VolumeChunkSpecification.getDefaults({\n      voxelSize: this.params.outputVoxelSize,\n      dataType: this.dataType,\n      numChannels: this.numChannels,\n      chunkDataSizes: [this.params.computationParameters.outputSpec.size],\n      transform: mat4.fromTranslation(\n          mat4.create(),\n          vec3.multiply(vec3.create(), this.params.outputVoxelSize, this.params.outputVoxelOffset)),\n      upperVoxelBound: this.params.outputVolumeSize,\n      volumeType: this.volumeType,\n      baseVoxelOffset: this.params.outputVoxelOffset,\n      volumeSourceOptions,\n    })[0];\n\n    const originSource = this.sources[this.params.inputScaleIndex][this.params.inputSourceIndex];\n    const inputResolution = originSource.spec.voxelSize;\n\n    const parameters: ComputedVolumeChunkSourceParameters = {\n      computationRef: this.computation.addCounterpartRef(),\n      sourceRef: originSource.addCounterpartRef(),\n      inputSize: this.params.computationParameters.inputSpec.size,\n      scaleFactor: vec3.divide(vec3.create(), this.params.outputVoxelSize, inputResolution)\n    };\n\n    const computedSource =\n        this.chunkManager.getChunkSource(ComputedVolumeChunkSource, {spec, parameters});\n\n    return [[computedSource]];\n  }\n\n  getMeshSource() {\n    return null;\n  }\n}\n\n\nexport class ComputedDataSource extends DataSource {\n  getOriginVolumes(\n      dataSourceProvider: DataSourceProvider, originUrl: string, chunkManager: ChunkManager,\n      cancellationToken: CancellationToken): Promise<ComputedVolumeSpecs> {\n    return dataSourceProvider.getVolume(chunkManager, originUrl, {}, cancellationToken)\n        .then((multiScaleVolumeChunkSource: GenericMultiscaleVolumeChunkSource) => {\n          const sources = multiScaleVolumeChunkSource.getSources({});\n          const specs = sources.map((volumeChunkSources) => {\n            return volumeChunkSources.map((volumeChunkSource) => {\n              return volumeChunkSource.spec;\n            });\n          });\n\n          return {\n            specs,\n            sources,\n            volumeType: multiScaleVolumeChunkSource.volumeType,\n            dataType: multiScaleVolumeChunkSource.dataType,\n            numChannels: multiScaleVolumeChunkSource.numChannels,\n          };\n        });\n  }\n\n  /**\n   * Creates a ComputedVolumeDataSourceParameters object with default values\n   * populated from the first volume spec at native resolution.\n   * @param volumeSpecs ComputedVolumeSpecs\n   * @param originUrl url for the origin data source\n   * @param dataSourceProvider\n   * @returns ComputedVolumeDataSourceParameters\n   */\n  defaultParams(\n      volumeSpecs: ComputedVolumeSpecs, originUrl: string,\n      dataSourceProvider: DataSourceProvider): ComputedVolumeDataSourceParameters {\n    const spec = volumeSpecs.sources[0][0].spec;\n    // Default DataType, VolumeType, channel count\n    const {dataType, volumeType, numChannels} = volumeSpecs;\n    // Default chunk size, used for input and output computation buffer sizes.\n    const size = spec.chunkDataSize;\n    return {\n      originUrl,\n      computationParameters: {\n        inputSpec: {size: vec3.copy(vec3.create(), size), dataType, volumeType, numChannels},\n        outputSpec: {size: vec3.copy(vec3.create(), size), dataType, volumeType, numChannels}\n      },\n      inputScaleIndex: 0,\n      inputSourceIndex: 0,\n      outputVoxelSize: vec3.copy(vec3.create(), spec.voxelSize),\n      outputVolumeSize: vec3.copy(vec3.create(), spec.upperVoxelBound),\n      outputVoxelOffset: vec3.copy(vec3.create(), spec.baseVoxelOffset),\n      dataSourceProvider\n    };\n  }\n\n  get description() {\n    return 'Computed data source.';\n  }\n\n  getVolume(\n      chunkManager: ChunkManager, config: string, options: GetVolumeOptions,\n      cancellationToken: CancellationToken) {\n    // Config is expected to be a json string, for example:\n    //   {\"origin\":\"brainmaps://p:d:v\",\"computation\":\"example\",\"inputSize\":\n    //     [36,36,32],\"outputSize\":[32,32,32]}\n    console.log('Computed datasource config:', config);\n    if (!options.dataSourceProvider) {\n      return Promise.reject(new Error('Need a DataSourceProvider'));\n    }\n\n    const dataSourceProvider = options.dataSourceProvider!;\n    let configObj: any;\n    try {\n      configObj = verifyObject(JSON.parse(config));\n    } catch (error) {\n      return Promise.reject(new Error(\n          `Could not parse JSON configuration while initializing computational datasource: ${\n              error}`));\n    }\n\n    if (!configObj) {\n      return Promise.reject(new Error('Could not verify configuration JSON'));\n    }\n    if (configObj['origin'] === undefined) {\n      return Promise.reject(new Error('Config is missing origin'));\n    }\n    if (configObj['computation'] === undefined) {\n      return Promise.reject(new Error('Config is missing computation'));\n    }\n\n    const computationName = verifyString(configObj['computation']);\n    const computationProvider = ComputedDataSource.computationMap.get(computationName);\n\n    const originUrl = verifyString(configObj['origin']);\n\n    if (!computationProvider) {\n      return Promise.reject(new Error(`Unable to find computation ${computationName}`));\n    }\n\n    return this.getOriginVolumes(dataSourceProvider, originUrl, chunkManager, cancellationToken)\n        .then((volumes) => {\n          const dataSourceParams = this.defaultParams(volumes, originUrl, dataSourceProvider);\n          return chunkManager.memoize.getUncounted(\n              {type: 'computed:getVolume', config: configObj},\n              () => computationProvider.getComputation(configObj, volumes.sources, dataSourceParams)\n                        .then((computation: VolumeComputationFrontend) => {\n                          computation.initializeCounterpart(chunkManager.rpc!, computation.params);\n                          return new ComputedMultiscaleVolumeChunkSource(\n                              dataSourceParams, volumes.sources, computation, chunkManager);\n                        }));\n        });\n  }\n\n  static computationMap = new Map<string, VolumeComputationFrontendProvider>();\n\n  static registerComputation(key: string, computationProvider: VolumeComputationFrontendProvider) {\n    this.computationMap.set(key, computationProvider);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {identityMat4, kOneVec, kZeroVec, mat4, quat, vec3} from 'neuroglancer/util/geom';\nimport {parseFiniteVec} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\n\nexport interface RotationTranslationScale {\n  rotation: quat;\n  translation: vec3;\n  scale: vec3;\n}\n\n/**\n * Class for representing a coordinate transform specified by a user.\n *\n * Typically it represents a transform from a local coordinate space to a global coordinate space.\n */\nexport class CoordinateTransform implements WatchableValueInterface<mat4> {\n  changed = new NullarySignal();\n\n  get value() {\n    return this.transform;\n  }\n\n  constructor(public transform = mat4.create()) {}\n\n  /**\n   * Resets to the identity transform.\n   */\n  reset() {\n    mat4.copy(this.transform, identityMat4);\n    this.changed.dispatch();\n  }\n\n  toJSON() {\n    if (mat4.equals(identityMat4, this.transform)) {\n      return undefined;\n    }\n    const m = this.transform;\n    return [\n      [m[0], m[4], m[8], m[12]],   //\n      [m[1], m[5], m[9], m[13]],   //\n      [m[2], m[6], m[10], m[14]],  //\n      [m[3], m[7], m[11], m[15]],  //\n    ];\n  }\n\n  restoreState(obj: any) {\n    if (obj == null) {\n      this.reset();\n      return;\n    }\n    if (Array.isArray(obj)) {\n      if (obj.length === 4) {\n        try {\n          for (let i = 0; i < 4; ++i) {\n            parseFiniteVec(this.transform.subarray(i * 4, (i + 1) * 4), obj[i]);\n          }\n          mat4.transpose(this.transform, this.transform);\n        } catch (ignoredError) {\n          this.reset();\n        }\n        return;\n      }\n      if (obj.length === 16) {\n        try {\n          parseFiniteVec(this.transform, obj);\n          mat4.transpose(this.transform, this.transform);\n        } catch (ignoredError) {\n          this.reset();\n        }\n        return;\n      }\n      // Invalid size.\n      this.reset();\n      return;\n    }\n\n    if (typeof obj === 'object') {\n      const rotation = quat.create();\n      const translation = vec3.create();\n      const scale = vec3.fromValues(1, 1, 1);\n      try {\n        parseFiniteVec(rotation, obj['rotation']);\n        quat.normalize(rotation, rotation);\n      } catch (ignoredError) {\n        quat.identity(rotation);\n      }\n\n      try {\n        parseFiniteVec(translation, obj['translation']);\n      } catch (ignoredError) {\n        vec3.copy(translation, kZeroVec);\n      }\n\n      try {\n        parseFiniteVec(scale, obj['scale']);\n      } catch (ignoredError) {\n        vec3.copy(scale, kOneVec);\n      }\n      mat4.fromRotationTranslationScale(this.transform, rotation, translation, scale);\n      this.changed.dispatch();\n    } else {\n      this.reset();\n    }\n  }\n\n  clone() {\n    return new CoordinateTransform(mat4.clone(this.transform));\n  }\n}\n\nexport function makeDerivedCoordinateTransform(\n    derivedTransform: CoordinateTransform, baseTransform: CoordinateTransform,\n    update: (output: mat4, input: mat4) => void): () => void {\n  update(derivedTransform.transform, baseTransform.transform);\n  return baseTransform.changed.add(() => {\n    update(derivedTransform.transform, baseTransform.transform);\n    derivedTransform.changed.dispatch();\n  });\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {tile2dArray} from 'neuroglancer/util/array';\nimport {getMemoizedBuffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\n\nexport function getSquareCornersArray(\n    startX = -1, startY = -1, endX = 1, endY = 1, minorTiles = 1, majorTiles = 1) {\n  return tile2dArray(\n      new Float32Array([\n        startX, startY,  //\n        startX, endY,    //\n        endX, endY,      //\n        endX, startY,    //\n      ]),\n      /*majorDimension=*/2, minorTiles, majorTiles);\n}\n\nexport function getCubeCornersArray(\n    startX = -1, startY = -1, startZ = -1, endX = 1, endY = 1, endZ = 1, minorTiles = 1,\n    majorTiles = 1) {\n  return tile2dArray(\n      new Float32Array([\n        startX, startY, startZ,  //\n        endX,   startY, startZ,  //\n        startX, endY,   startZ,  //\n        endX,   endY,   startZ,  //\n        startX, startY, endZ,    //\n        endX,   startY, endZ,    //\n        startX, endY,   endZ,    //\n        endX,   endY,   endZ,    //\n      ]),\n      /*majorDimension=*/3, minorTiles, majorTiles);\n}\n\nexport function getSquareCornersBuffer(\n    gl: GL, startX = -1, startY = -1, endX = 1, endY = 1, minorTiles = 1, majorTiles = 1) {\n  return getMemoizedBuffer(\n             gl, WebGL2RenderingContext.ARRAY_BUFFER, getSquareCornersArray, startX, startY, endX,\n             endY, minorTiles, majorTiles)\n      .value;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {VisibilityTrackedRenderLayer} from 'neuroglancer/layer';\nimport {PickIDManager} from 'neuroglancer/object_picking';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {ShaderModule} from 'neuroglancer/webgl/shader';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\nexport interface PerspectiveViewReadyRenderContext {\n  dataToDevice: mat4;\n\n  /**\n   * Width of GL viewport in pixels.\n   */\n  viewportWidth: number;\n\n  /**\n   * Height of GL viewport in pixels.\n   */\n  viewportHeight: number;\n}\n\nexport interface PerspectiveViewRenderContext extends PerspectiveViewReadyRenderContext {\n  lightDirection: vec3;\n  ambientLighting: number;\n  directionalLighting: number;\n  pickIDs: PickIDManager;\n  emitter: ShaderModule;\n\n  /**\n   * Specifies whether the emitted color value will be used.\n   */\n  emitColor: boolean;\n\n  /**\n   * Specifies whether the emitted pick ID will be used.\n   */\n  emitPickID: boolean;\n\n  /**\n   * Specifies whether there was a previous pick ID pass.\n   */\n  alreadyEmittedPickID: boolean;\n}\n\nexport class PerspectiveViewRenderLayer extends VisibilityTrackedRenderLayer {\n  draw(_renderContext: PerspectiveViewRenderContext) {\n    // Must be overridden by subclasses.\n  }\n\n  isReady(_renderContext: PerspectiveViewReadyRenderContext) {\n    return true;\n  }\n\n  isTransparent: boolean|undefined;\n  isAnnotation: boolean|undefined;\n  backend: SharedObject|undefined;\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationSource} from 'neuroglancer/annotation';\nimport {MultiscaleAnnotationSource} from 'neuroglancer/annotation/frontend_source';\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {RenderLayerRole} from 'neuroglancer/layer';\nimport {SegmentationDisplayState} from 'neuroglancer/segmentation_display_state/frontend';\nimport {TrackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {TrackableBoolean} from 'neuroglancer/trackable_boolean';\nimport {WatchableValue} from 'neuroglancer/trackable_value';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4} from 'neuroglancer/util/geom';\n\nexport class AnnotationHoverState extends\n    WatchableValue<{id: string, partIndex: number}|undefined> {}\n\nexport class AnnotationLayerState extends RefCounted {\n  transform: CoordinateTransform;\n  source: Owned<AnnotationSource|MultiscaleAnnotationSource>;\n  hoverState: AnnotationHoverState;\n  role: RenderLayerRole;\n  color: TrackableRGB;\n  fillOpacity: TrackableAlphaValue;\n\n  /**\n   * undefined means may have a segmentation state.  null means no segmentation state is supported.\n   */\n  segmentationState: WatchableValue<SegmentationDisplayState|undefined|null>;\n  filterBySegmentation: TrackableBoolean;\n\n  private transformCacheGeneration = -1;\n  private cachedObjectToGlobal = mat4.create();\n  private cachedGlobalToObject = mat4.create();\n\n  private updateTransforms() {\n    const {transform, transformCacheGeneration} = this;\n    const generation = transform.changed.count;\n    if (generation === transformCacheGeneration) {\n      return;\n    }\n    const {cachedObjectToGlobal} = this;\n    mat4.multiply(cachedObjectToGlobal, this.transform.transform, this.source.objectToLocal);\n    mat4.invert(this.cachedGlobalToObject, cachedObjectToGlobal);\n  }\n\n  get objectToGlobal() {\n    this.updateTransforms();\n    return this.cachedObjectToGlobal;\n  }\n\n  get globalToObject() {\n    this.updateTransforms();\n    return this.cachedGlobalToObject;\n  }\n\n  constructor(options: {\n    transform?: CoordinateTransform, source: Owned<AnnotationSource|MultiscaleAnnotationSource>,\n    hoverState?: AnnotationHoverState,\n    role?: RenderLayerRole, color: TrackableRGB, fillOpacity: TrackableAlphaValue,\n    segmentationState?: WatchableValue<SegmentationDisplayState|undefined|null>,\n    filterBySegmentation?: TrackableBoolean,\n  }) {\n    super();\n    const {\n      transform = new CoordinateTransform(),\n      source,\n      hoverState = new AnnotationHoverState(undefined),\n      role = RenderLayerRole.ANNOTATION,\n      color,\n      fillOpacity,\n      segmentationState = new WatchableValue(null),\n      filterBySegmentation = new TrackableBoolean(false),\n    } = options;\n    this.transform = transform;\n    this.source = this.registerDisposer(source);\n    this.hoverState = hoverState;\n    this.role = role;\n    this.color = color;\n    this.fillOpacity = fillOpacity;\n    this.segmentationState = segmentationState;\n    this.filterBySegmentation = filterBySegmentation;\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for rendering bounding box annotations.\n */\n\nimport {AnnotationType, AxisAlignedBoundingBox} from 'neuroglancer/annotation';\nimport {AnnotationRenderContext, AnnotationRenderHelper, registerAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {BoundingBoxCrossSectionRenderHelper, vertexBasePositions} from 'neuroglancer/sliceview/bounding_box_shader_helper';\nimport {SliceViewPanelRenderContext} from 'neuroglancer/sliceview/panel';\nimport {tile2dArray} from 'neuroglancer/util/array';\nimport {mat4, projectPointToLineSegment, vec3} from 'neuroglancer/util/geom';\nimport {Buffer, getMemoizedBuffer} from 'neuroglancer/webgl/buffer';\nimport {CircleShader, VERTICES_PER_CIRCLE} from 'neuroglancer/webgl/circles';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {LineShader, VERTICES_PER_LINE} from 'neuroglancer/webgl/lines';\nimport {emitterDependentShaderGetter, ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nconst EDGES_PER_BOX = 12;\nconst CORNERS_PER_BOX = 8;\n\nconst FULL_OBJECT_PICK_OFFSET = 0;\nconst CORNERS_PICK_OFFSET = FULL_OBJECT_PICK_OFFSET + 1;\nconst EDGES_PICK_OFFSET = CORNERS_PICK_OFFSET + CORNERS_PER_BOX;\nconst FACES_PICK_OFFSET = EDGES_PICK_OFFSET + EDGES_PER_BOX;\nconst PICK_IDS_PER_INSTANCE = FACES_PICK_OFFSET + 6;\n\nconst edgeBoxCornerOffsetData = Float32Array.from([\n  // a1\n  0, 0, 0,\n  // b1\n  0, 0, 1,\n  // c1\n  EDGES_PICK_OFFSET + 0,\n\n  // a2\n  1, 0, 0,\n  // b2\n  1, 0, 1,\n  // c2\n  EDGES_PICK_OFFSET + 1,\n\n  // a3\n  0, 1, 0,\n  // b3\n  0, 1, 1,\n  // c3\n  EDGES_PICK_OFFSET + 2,\n\n  // a4\n  1, 1, 0,\n  // b4\n  1, 1, 1,\n  // c4\n  EDGES_PICK_OFFSET + 3,\n\n  // a5\n  0, 0, 0,\n  // b5\n  0, 1, 0,\n  // c5\n  EDGES_PICK_OFFSET + 4,\n\n  // a6\n  0, 0, 1,\n  // b6\n  0, 1, 1,\n  // c6\n  EDGES_PICK_OFFSET + 5,\n\n  // a7\n  1, 0, 0,\n  // b7\n  1, 1, 0,\n  // c7\n  EDGES_PICK_OFFSET + 6,\n\n  // a8\n  1, 0, 1,\n  // b8\n  1, 1, 1,\n  // c8\n  EDGES_PICK_OFFSET + 7,\n\n  // a9\n  0, 0, 0,\n  // b9\n  1, 0, 0,\n  // c9\n  EDGES_PICK_OFFSET + 8,\n\n  // a10\n  0, 0, 1,\n  // b10\n  1, 0, 1,\n  // c10\n  EDGES_PICK_OFFSET + 9,\n\n  // a11\n  0, 1, 0,\n  // b11\n  1, 1, 0,\n  // c11\n  EDGES_PICK_OFFSET + 10,\n\n  // a12\n  0, 1, 1,\n  // b12\n  1, 1, 1,\n  // c12\n  EDGES_PICK_OFFSET + 11\n]);\n\nabstract class RenderHelper extends AnnotationRenderHelper {\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    // Position of point in camera coordinates.\n    builder.addAttribute('highp vec3', 'aLower');\n    builder.addAttribute('highp vec3', 'aUpper');\n  }\n\n  enable(shader: ShaderProgram, context: AnnotationRenderContext, callback: () => void) {\n    super.enable(shader, context, () => {\n      const {gl} = shader;\n      const aLower = shader.attribute('aLower');\n      const aUpper = shader.attribute('aUpper');\n      context.buffer.bindToVertexAttrib(\n          aLower, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 6, /*offset=*/ context.bufferOffset);\n      context.buffer.bindToVertexAttrib(\n          aUpper, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 6, /*offset=*/ context.bufferOffset + 4 * 3);\n\n      gl.vertexAttribDivisor(aLower, 1);\n      gl.vertexAttribDivisor(aUpper, 1);\n      callback();\n      gl.vertexAttribDivisor(aLower, 0);\n      gl.vertexAttribDivisor(aUpper, 0);\n      gl.disableVertexAttribArray(aLower);\n      gl.disableVertexAttribArray(aUpper);\n    });\n  }\n}\n\nclass PerspectiveViewRenderHelper extends RenderHelper {\n  private lineShader = this.registerDisposer(new LineShader(this.gl, EDGES_PER_BOX));\n\n  private edgeBoxCornerOffsetsBuffer = this.registerDisposer(Buffer.fromData(\n      this.gl,\n      tile2dArray(\n          edgeBoxCornerOffsetData, /*majorDimension=*/ 7, /*minorTiles=*/ 1,\n          /*majorTiles=*/ VERTICES_PER_LINE)));\n\n  private edgeShaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n        this.defineShader(builder);\n        this.lineShader.defineShader(builder);\n\n        // XYZ corners of box ranging from [0, 0, 0] to [1, 1, 1].\n        builder.addAttribute('highp vec3', 'aBoxCornerOffset1');\n\n        // Last component of aBoxCornerOffset2 is the edge index.\n        builder.addAttribute('highp vec4', 'aBoxCornerOffset2');\n        builder.setVertexMain(`\nvec3 vertexPosition1 = mix(aLower, aUpper, aBoxCornerOffset1);\nvec3 vertexPosition2 = mix(aLower, aUpper, aBoxCornerOffset2.xyz);\nemitLine(uProjection, vertexPosition1, vertexPosition2);\n${this.setPartIndex(builder, 'uint(aBoxCornerOffset2.w)')};\n`);\n        builder.setFragmentMain(`\nemitAnnotation(vec4(vColor.rgb, getLineAlpha()));\n`);\n      });\n\n  private circleShader = this.registerDisposer(new CircleShader(this.gl, CORNERS_PER_BOX));\n\n  private boxCornerOffsetsBuffer = this.registerDisposer(Buffer.fromData(\n      this.gl,\n      tile2dArray(\n          vertexBasePositions, /*majorDimension=*/ 3, /*minorTiles=*/ 1,\n          /*majorTiles=*/ VERTICES_PER_CIRCLE)));\n\n  private cornerShaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n        this.defineShader(builder);\n        this.circleShader.defineShader(builder, this.targetIsSliceView);\n\n        // XYZ corners of box ranging from [0, 0, 0] to [1, 1, 1].\n        builder.addAttribute('highp vec3', 'aBoxCornerOffset');\n\n        builder.setVertexMain(`\nvec3 vertexPosition = mix(aLower, aUpper, aBoxCornerOffset);\nemitCircle(uProjection * vec4(vertexPosition, 1.0));\nuint cornerIndex = uint(aBoxCornerOffset.x + aBoxCornerOffset.y * 2.0 + aBoxCornerOffset.z * 4.0);\nuint cornerPickOffset = ${CORNERS_PICK_OFFSET}u + cornerIndex;\n${this.setPartIndex(builder, 'cornerPickOffset')};\n`);\n        builder.setFragmentMain(`\nvec4 borderColor = vec4(0.0, 0.0, 0.0, 1.0);\nemitAnnotation(getCircleColor(vColor, borderColor));\n`);\n      });\n\n  drawEdges(context: AnnotationRenderContext) {\n    const shader = this.edgeShaderGetter(context.renderContext.emitter);\n    const {gl} = this;\n    this.enable(shader, context, () => {\n      const aBoxCornerOffset1 = shader.attribute('aBoxCornerOffset1');\n      const aBoxCornerOffset2 = shader.attribute('aBoxCornerOffset2');\n\n      this.edgeBoxCornerOffsetsBuffer.bindToVertexAttrib(\n          aBoxCornerOffset1, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 7, /*offset=*/ 0);\n\n      this.edgeBoxCornerOffsetsBuffer.bindToVertexAttrib(\n          aBoxCornerOffset2, /*components=*/ 4, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 7, /*offset=*/ 4 * 3);\n\n      this.lineShader.draw(shader, context.renderContext, /*lineWidth=*/ 1, 1, context.count);\n      gl.disableVertexAttribArray(aBoxCornerOffset1);\n      gl.disableVertexAttribArray(aBoxCornerOffset2);\n    });\n  }\n\n  drawCorners(context: AnnotationRenderContext) {\n    const shader = this.cornerShaderGetter(context.renderContext.emitter);\n    const {gl} = this;\n    this.enable(shader, context, () => {\n      const aBoxCornerOffset = shader.attribute('aBoxCornerOffset');\n      this.boxCornerOffsetsBuffer.bindToVertexAttrib(\n          aBoxCornerOffset, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false);\n      this.circleShader.draw(\n          shader, context.renderContext,\n          {interiorRadiusInPixels: 1, borderWidthInPixels: 0, featherWidthInPixels: 1},\n          context.count);\n      gl.disableVertexAttribArray(aBoxCornerOffset);\n    });\n  }\n\n  draw(context: AnnotationRenderContext) {\n    this.drawEdges(context);\n    this.drawCorners(context);\n  }\n}\n\nfunction getBaseIntersectionVertexIndexArray() {\n  return new Float32Array([0, 1, 2, 3, 4, 5]);\n}\n\nfunction getIntersectionVertexIndexArray() {\n  return tile2dArray(\n      getBaseIntersectionVertexIndexArray(),\n      /*majorDimension=*/ 1,\n      /*minorTiles=*/ 1,\n      /*majorTiles=*/ VERTICES_PER_LINE);\n}\n\n\nclass SliceViewRenderHelper extends RenderHelper {\n  private lineShader = new LineShader(this.gl, 6);\n  private intersectionVertexIndexBuffer =\n      getMemoizedBuffer(\n          this.gl, WebGL2RenderingContext.ARRAY_BUFFER, getIntersectionVertexIndexArray)\n          .value;\n  private filledIntersectionVertexIndexBuffer =\n      getMemoizedBuffer(\n          this.gl, WebGL2RenderingContext.ARRAY_BUFFER, getBaseIntersectionVertexIndexArray)\n          .value;\n  private boundingBoxCrossSectionHelper =\n      this.registerDisposer(new BoundingBoxCrossSectionRenderHelper(this.gl));\n\n  constructor(public gl: GL) {\n    super(gl);\n  }\n\n  private faceShaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n        super.defineShader(builder);\n        this.boundingBoxCrossSectionHelper.defineShader(builder);\n        this.lineShader.defineShader(builder);\n\n        builder.addAttribute('highp float', 'aVertexIndexFloat');\n        builder.setVertexMain(`\nint vertexIndex1 = int(aVertexIndexFloat);\nint vertexIndex2 = vertexIndex1 == 5 ? 0 : vertexIndex1 + 1;\nvec3 vertexPosition1 = getBoundingBoxPlaneIntersectionVertexPosition(aUpper - aLower, aLower, aLower, aUpper, vertexIndex1);\nvec3 vertexPosition2 = getBoundingBoxPlaneIntersectionVertexPosition(aUpper - aLower, aLower, aLower, aUpper, vertexIndex2);\nemitLine(uProjection, vertexPosition1, vertexPosition2);\n${this.setPartIndex(builder)};\n`);\n        builder.setFragmentMain(`\nemitAnnotation(vec4(vColor.rgb, vColor.a * getLineAlpha()));\n`);\n      });\n\n  private fillShaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n        super.defineShader(builder);\n        this.boundingBoxCrossSectionHelper.defineShader(builder);\n        builder.addAttribute('highp float', 'aVertexIndexFloat');\n        builder.addUniform('highp float', 'uFillOpacity');\n        builder.setVertexMain(`\nint vertexIndex = int(aVertexIndexFloat);\nvec3 vertexPosition = getBoundingBoxPlaneIntersectionVertexPosition(aUpper - aLower, aLower, aLower, aUpper, vertexIndex);\ngl_Position = uProjection * vec4(vertexPosition, 1);\n${this.setPartIndex(builder)};\n`);\n        builder.setFragmentMain(`\nemitAnnotation(vec4(vColor.rgb, uFillOpacity));\n`);\n      });\n\n  draw(context: AnnotationRenderContext&{renderContext: SliceViewPanelRenderContext}) {\n    const fillOpacity = context.annotationLayer.state.fillOpacity.value;\n    const shader = (fillOpacity ? this.fillShaderGetter : this.faceShaderGetter)(\n        context.renderContext.emitter);\n    let {gl} = this;\n    this.enable(shader, context, () => {\n      this.boundingBoxCrossSectionHelper.setViewportPlane(\n          shader, context.renderContext.sliceView.viewportAxes[2],\n          context.renderContext.sliceView.centerDataPosition,\n          context.annotationLayer.state.globalToObject);\n      const aVertexIndexFloat = shader.attribute('aVertexIndexFloat');\n\n      (fillOpacity ? this.filledIntersectionVertexIndexBuffer : this.intersectionVertexIndexBuffer)\n          .bindToVertexAttrib(\n              aVertexIndexFloat, /*components=*/ 1, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n              /*normalized=*/ false);\n\n      if (fillOpacity) {\n        gl.uniform1f(shader.uniform('uFillOpacity'), fillOpacity);\n        gl.drawArraysInstanced(WebGL2RenderingContext.TRIANGLE_FAN, 0, 6, context.count);\n      } else {\n        const lineWidth = context.renderContext.emitColor ? 1 : 5;\n        this.lineShader.draw(shader, context.renderContext, lineWidth, 1.0, context.count);\n      }\n      gl.disableVertexAttribArray(aVertexIndexFloat);\n    });\n  }\n}\nfunction getEdgeCorners(corners: Float32Array, edgeIndex: number) {\n  const i = edgeIndex * 7;\n  const cA = vec3.create(), cB = vec3.create();\n  for (let j = 0; j < 3; ++j) {\n    const ma = edgeBoxCornerOffsetData[i + j];\n    const mb = edgeBoxCornerOffsetData[i + j + 3];\n    const a = Math.min(corners[j], corners[j + 3]), b = Math.max(corners[j], corners[j + 3]);\n    cA[j] = (1 - ma) * a + ma * b;\n    cB[j] = (1 - mb) * a + mb * b;\n  }\n\n  return {cornerA: cA, cornerB: cB};\n}\nfunction snapPositionToEdge(\n    position: vec3, objectToData: mat4, corners: Float32Array, edgeIndex: number) {\n  let edgeCorners = getEdgeCorners(corners, edgeIndex);\n  vec3.transformMat4(edgeCorners.cornerA, edgeCorners.cornerA, objectToData);\n  vec3.transformMat4(edgeCorners.cornerB, edgeCorners.cornerB, objectToData);\n\n  projectPointToLineSegment(position, edgeCorners.cornerA, edgeCorners.cornerB, position);\n}\n\nfunction snapPositionToCorner(\n    position: vec3, objectToData: mat4, corners: Float32Array, cornerIndex: number) {\n  const i = cornerIndex * 3;\n  for (let j = 0; j < 3; ++j) {\n    const m = vertexBasePositions[i + j];\n    const a = Math.min(corners[j], corners[j + 3]), b = Math.max(corners[j], corners[j + 3]);\n    position[j] = (1 - m) * a + m * b;\n  }\n  vec3.transformMat4(position, position, objectToData);\n}\n\nregisterAnnotationTypeRenderHandler(AnnotationType.AXIS_ALIGNED_BOUNDING_BOX, {\n  bytes: 6 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 6);\n    return (annotation: AxisAlignedBoundingBox, index: number) => {\n      const {pointA, pointB} = annotation;\n      const coordinateOffset = index * 6;\n      coordinates[coordinateOffset] = Math.min(pointA[0], pointB[0]);\n      coordinates[coordinateOffset + 1] = Math.min(pointA[1], pointB[1]);\n      coordinates[coordinateOffset + 2] = Math.min(pointA[2], pointB[2]);\n      coordinates[coordinateOffset + 3] = Math.max(pointA[0], pointB[0]);\n      coordinates[coordinateOffset + 4] = Math.max(pointA[1], pointB[1]);\n      coordinates[coordinateOffset + 5] = Math.max(pointA[2], pointB[2]);\n    };\n  },\n  sliceViewRenderHelper: SliceViewRenderHelper,\n  perspectiveViewRenderHelper: PerspectiveViewRenderHelper,\n  pickIdsPerInstance: PICK_IDS_PER_INSTANCE,\n  snapPosition: (position, objectToData, data, offset, partIndex) => {\n    const corners = new Float32Array(data, offset, 6);\n    if (partIndex >= CORNERS_PICK_OFFSET && partIndex < EDGES_PICK_OFFSET) {\n      snapPositionToCorner(position, objectToData, corners, partIndex - CORNERS_PICK_OFFSET);\n    } else if (partIndex >= EDGES_PICK_OFFSET && partIndex < FACES_PICK_OFFSET) {\n      snapPositionToEdge(position, objectToData, corners, partIndex - EDGES_PICK_OFFSET);\n    } else {\n      // vec3.transformMat4(position, annotation.point, objectToData);\n    }\n  },\n  getRepresentativePoint: (objectToData, ann, partIndex) => {\n    let repPoint = vec3.create();\n    // if the full object is selected pick the first corner as representative\n    if (partIndex === FULL_OBJECT_PICK_OFFSET) {\n      vec3.transformMat4(repPoint, ann.pointA, objectToData);\n    } else if (partIndex >= CORNERS_PICK_OFFSET && partIndex < EDGES_PICK_OFFSET) {\n      // picked a corner\n      // FIXME: figure out how to return corner point\n      vec3.transformMat4(repPoint, ann.pointA, objectToData);\n    } else if (partIndex >= EDGES_PICK_OFFSET && partIndex < FACES_PICK_OFFSET) {\n      // FIXME: can't figure out how to resize based upon edge grabbed\n      vec3.transformMat4(repPoint, ann.pointA, objectToData);\n      // snapPositionToCorner(repPoint, objectToData, corners, 5);\n    } else {  // for now faces will move the whole object so pick the first corner\n      vec3.transformMat4(repPoint, ann.pointA, objectToData);\n    }\n    return repPoint;\n  },\n\n  updateViaRepresentativePoint:\n      (oldAnnotation: AxisAlignedBoundingBox, position: vec3, dataToObject: mat4,\n       partIndex: number) => {\n        let newPt = vec3.transformMat4(vec3.create(), position, dataToObject);\n        let baseBox = {...oldAnnotation};\n        // if the full object is selected pick the first corner as representative\n        let delta = vec3.sub(vec3.create(), oldAnnotation.pointB, oldAnnotation.pointA);\n        if (partIndex === FULL_OBJECT_PICK_OFFSET) {\n          baseBox.pointA = newPt;\n          baseBox.pointB = vec3.add(vec3.create(), newPt, delta);\n        } else if (partIndex >= CORNERS_PICK_OFFSET && partIndex < EDGES_PICK_OFFSET) {\n          // picked a corner\n          baseBox.pointA = newPt;\n          baseBox.pointB = vec3.add(vec3.create(), newPt, delta);\n        } else if (partIndex >= EDGES_PICK_OFFSET && partIndex < FACES_PICK_OFFSET) {\n          baseBox.pointA = newPt;\n          baseBox.pointB = vec3.add(vec3.create(), newPt, delta);\n        } else {  // for now faces will move the whole object so pick the first corner\n          baseBox.pointA = newPt;\n          baseBox.pointB = vec3.add(vec3.create(), newPt, delta);\n        }\n        return baseBox;\n      }\n});\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for rendering line annotations.\n */\n\nimport {AnnotationType, Line} from 'neuroglancer/annotation';\nimport {AnnotationRenderContext, AnnotationRenderHelper, registerAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {tile2dArray} from 'neuroglancer/util/array';\nimport {mat4, projectPointToLineSegment, vec3} from 'neuroglancer/util/geom';\nimport {getMemoizedBuffer} from 'neuroglancer/webgl/buffer';\nimport {CircleShader, VERTICES_PER_CIRCLE} from 'neuroglancer/webgl/circles';\nimport {LineShader} from 'neuroglancer/webgl/lines';\nimport {emitterDependentShaderGetter, ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nconst FULL_OBJECT_PICK_OFFSET = 0;\nconst ENDPOINTS_PICK_OFFSET = FULL_OBJECT_PICK_OFFSET + 1;\nconst PICK_IDS_PER_INSTANCE = ENDPOINTS_PICK_OFFSET + 2;\n\nfunction getEndpointIndexArray() {\n  return tile2dArray(\n      new Uint8Array([0, 1]), /*majorDimension=*/ 1, /*minorTiles=*/ 1,\n      /*majorTiles=*/ VERTICES_PER_CIRCLE);\n}\n\nclass RenderHelper extends AnnotationRenderHelper {\n  private lineShader = this.registerDisposer(new LineShader(this.gl, 1));\n  private circleShader = this.registerDisposer(new CircleShader(this.gl, 2));\n\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    // Position of endpoints in camera coordinates.\n    builder.addAttribute('highp vec3', 'aEndpointA');\n    builder.addAttribute('highp vec3', 'aEndpointB');\n  }\n\n  private edgeShaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n        this.defineShader(builder);\n        this.lineShader.defineShader(builder);\n        builder.setVertexMain(`\nemitLine(uProjection, aEndpointA, aEndpointB);\n${this.setPartIndex(builder)};\n`);\n        builder.setFragmentMain(`\nemitAnnotation(vec4(vColor.rgb, vColor.a * getLineAlpha() * ${this.getCrossSectionFadeFactor()}));\n`);\n      });\n\n  private endpointIndexBuffer =\n      this\n          .registerDisposer(getMemoizedBuffer(\n              this.gl, WebGL2RenderingContext.ARRAY_BUFFER, getEndpointIndexArray))\n          .value;\n\n  private endpointShaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n        this.defineShader(builder);\n        this.circleShader.defineShader(builder, this.targetIsSliceView);\n        builder.addAttribute('highp uint', 'aEndpointIndex');\n        builder.setVertexMain(`\nvec3 vertexPosition = mix(aEndpointA, aEndpointB, float(aEndpointIndex));\nemitCircle(uProjection * vec4(vertexPosition, 1.0));\n${this.setPartIndex(builder, 'aEndpointIndex + 1u')};\n`);\n        builder.setFragmentMain(`\nvec4 borderColor = vec4(0.0, 0.0, 0.0, 1.0);\nemitAnnotation(getCircleColor(vColor, borderColor));\n`);\n      });\n\n  enable(shader: ShaderProgram, context: AnnotationRenderContext, callback: () => void) {\n    super.enable(shader, context, () => {\n      const {gl} = shader;\n      const aLower = shader.attribute('aEndpointA');\n      const aUpper = shader.attribute('aEndpointB');\n\n      context.buffer.bindToVertexAttrib(\n          aLower, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 6, /*offset=*/ context.bufferOffset);\n      context.buffer.bindToVertexAttrib(\n          aUpper, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 6, /*offset=*/ context.bufferOffset + 4 * 3);\n\n      gl.vertexAttribDivisor(aLower, 1);\n      gl.vertexAttribDivisor(aUpper, 1);\n      callback();\n      gl.vertexAttribDivisor(aLower, 0);\n      gl.vertexAttribDivisor(aUpper, 0);\n      gl.disableVertexAttribArray(aLower);\n      gl.disableVertexAttribArray(aUpper);\n    });\n  }\n\n  drawEdges(context: AnnotationRenderContext) {\n    const shader = this.edgeShaderGetter(context.renderContext.emitter);\n    this.enable(shader, context, () => {\n      this.lineShader.draw(shader, context.renderContext, /*lineWidth=*/ 1, 1.0, context.count);\n    });\n  }\n\n  drawEndpoints(context: AnnotationRenderContext) {\n    const shader = this.endpointShaderGetter(context.renderContext.emitter);\n    this.enable(shader, context, () => {\n      const aEndpointIndex = shader.attribute('aEndpointIndex');\n      this.endpointIndexBuffer.bindToVertexAttribI(\n          aEndpointIndex, /*components=*/ 1,\n          /*attributeType=*/ WebGL2RenderingContext.UNSIGNED_BYTE);\n      this.circleShader.draw(\n          shader, context.renderContext,\n          {interiorRadiusInPixels: 6, borderWidthInPixels: 2, featherWidthInPixels: 1},\n          context.count);\n      shader.gl.disableVertexAttribArray(aEndpointIndex);\n    });\n  }\n\n  draw(context: AnnotationRenderContext) {\n    this.drawEdges(context);\n    this.drawEndpoints(context);\n  }\n}\n\nfunction snapPositionToLine(position: vec3, objectToData: mat4, endpoints: Float32Array) {\n  const cornerA = vec3.transformMat4(vec3.create(), <vec3>endpoints.subarray(0, 3), objectToData);\n  const cornerB = vec3.transformMat4(vec3.create(), <vec3>endpoints.subarray(3, 6), objectToData);\n  projectPointToLineSegment(position, cornerA, cornerB, position);\n}\n\nfunction snapPositionToEndpoint(\n    position: vec3, objectToData: mat4, endpoints: Float32Array, endpointIndex: number) {\n  const startOffset = 3 * endpointIndex;\n  const point = <vec3>endpoints.subarray(startOffset, startOffset + 3);\n  vec3.transformMat4(position, point, objectToData);\n}\n\nregisterAnnotationTypeRenderHandler(AnnotationType.LINE, {\n  bytes: 6 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 6);\n    return (annotation: Line, index: number) => {\n      const {pointA, pointB} = annotation;\n      const coordinateOffset = index * 6;\n      coordinates[coordinateOffset] = pointA[0];\n      coordinates[coordinateOffset + 1] = pointA[1];\n      coordinates[coordinateOffset + 2] = pointA[2];\n      coordinates[coordinateOffset + 3] = pointB[0];\n      coordinates[coordinateOffset + 4] = pointB[1];\n      coordinates[coordinateOffset + 5] = pointB[2];\n    };\n  },\n  sliceViewRenderHelper: RenderHelper,\n  perspectiveViewRenderHelper: RenderHelper,\n  pickIdsPerInstance: PICK_IDS_PER_INSTANCE,\n  snapPosition: (position, objectToData, data, offset, partIndex) => {\n    const endpoints = new Float32Array(data, offset, 6);\n    if (partIndex === FULL_OBJECT_PICK_OFFSET) {\n      snapPositionToLine(position, objectToData, endpoints);\n    } else {\n      snapPositionToEndpoint(position, objectToData, endpoints, partIndex - ENDPOINTS_PICK_OFFSET);\n    }\n  },\n  getRepresentativePoint: (objectToData, ann, partIndex) => {\n    let repPoint = vec3.create();\n    // if the full object is selected just pick the first point as representative\n    if (partIndex === FULL_OBJECT_PICK_OFFSET) {\n      vec3.transformMat4(repPoint, ann.pointA, objectToData);\n    } else {\n      if ((partIndex - ENDPOINTS_PICK_OFFSET) === 0) {\n        vec3.transformMat4(repPoint, ann.pointA, objectToData);\n      } else {\n        vec3.transformMat4(repPoint, ann.pointB, objectToData);\n      }\n    }\n    return repPoint;\n  },\n  updateViaRepresentativePoint: (oldAnnotation, position, dataToObject, partIndex) => {\n    let newPt = vec3.transformMat4(vec3.create(), position, dataToObject);\n    let baseLine = {...oldAnnotation};\n    switch (partIndex) {\n      case FULL_OBJECT_PICK_OFFSET:\n        let delta = vec3.sub(vec3.create(), oldAnnotation.pointB, oldAnnotation.pointA);\n        baseLine.pointA = newPt;\n        baseLine.pointB = vec3.add(vec3.create(), newPt, delta);\n        break;\n      case FULL_OBJECT_PICK_OFFSET + 1:\n        baseLine.pointA = newPt;\n        baseLine.pointB = oldAnnotation.pointB;\n        break;\n      case FULL_OBJECT_PICK_OFFSET + 2:\n        baseLine.pointA = oldAnnotation.pointA;\n        baseLine.pointB = newPt;\n    }\n    return baseLine;\n  }\n});\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for rendering point annotations.\n */\n\nimport {AnnotationType, Point} from 'neuroglancer/annotation';\nimport {AnnotationRenderContext, AnnotationRenderHelper, registerAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {CircleShader} from 'neuroglancer/webgl/circles';\nimport {emitterDependentShaderGetter, ShaderBuilder} from 'neuroglancer/webgl/shader';\n\nclass RenderHelper extends AnnotationRenderHelper {\n  private circleShader = this.registerDisposer(new CircleShader(this.gl));\n  private shaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => this.defineShader(builder));\n\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    this.circleShader.defineShader(builder, /*crossSectionFade=*/this.targetIsSliceView);\n    // Position of point in camera coordinates.\n    builder.addAttribute('highp vec3', 'aVertexPosition');\n    builder.setVertexMain(`\nemitCircle(uProjection * vec4(aVertexPosition, 1.0));\n${this.setPartIndex(builder)};\n`);\n    builder.setFragmentMain(`\nvec4 borderColor = vec4(0.0, 0.0, 0.0, 1.0);\nemitAnnotation(getCircleColor(vColor, borderColor));\n`);\n  }\n\n  draw(context: AnnotationRenderContext) {\n    const shader = this.shaderGetter(context.renderContext.emitter);\n    this.enable(shader, context, () => {\n      const {gl} = this;\n      const aVertexPosition = shader.attribute('aVertexPosition');\n      context.buffer.bindToVertexAttrib(\n          aVertexPosition, /*components=*/3, /*attributeType=*/WebGL2RenderingContext.FLOAT,\n          /*normalized=*/false,\n          /*stride=*/0, /*offset=*/context.bufferOffset);\n      gl.vertexAttribDivisor(aVertexPosition, 1);\n      this.circleShader.draw(\n          shader, context.renderContext,\n          {interiorRadiusInPixels: 6, borderWidthInPixels: 2, featherWidthInPixels: 1},\n          context.count);\n      gl.vertexAttribDivisor(aVertexPosition, 0);\n      gl.disableVertexAttribArray(aVertexPosition);\n    });\n  }\n}\n\nregisterAnnotationTypeRenderHandler(AnnotationType.POINT, {\n  bytes: 3 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 3);\n    return (annotation: Point, index: number) => {\n      const {point} = annotation;\n      const coordinateOffset = index * 3;\n      coordinates[coordinateOffset] = point[0];\n      coordinates[coordinateOffset + 1] = point[1];\n      coordinates[coordinateOffset + 2] = point[2];\n    };\n  },\n  sliceViewRenderHelper: RenderHelper,\n  perspectiveViewRenderHelper: RenderHelper,\n  pickIdsPerInstance: 1,\n  snapPosition: (position: vec3, objectToData, data, offset) => {\n    vec3.transformMat4(position, <vec3>new Float32Array(data, offset, 3), objectToData);\n  },\n  getRepresentativePoint: (objectToData, ann) => {\n    let repPoint = vec3.create();\n    vec3.transformMat4(repPoint, ann.point, objectToData);\n    return repPoint;\n  },\n  updateViaRepresentativePoint: (oldAnnotation: Point, position: vec3, dataToObject: mat4) => {\n    let annotation = {...oldAnnotation};\n    annotation.point = vec3.transformMat4(vec3.create(), position, dataToObject);\n    // annotation.id = '';\n    return annotation;\n  }\n});\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Ellipse-related shader functions.\n */\n\nimport {mat3, vec2, vec3} from 'neuroglancer/util/geom';\n\n/**\n * Specifies the parameters of an ellipse in quadratic form.\n */\nexport const glsl_EllipseQuadraticForm = `\nstruct EllipseQuadraticForm {\n  highp float A;  // x*x coefficient\n  highp float B;  // x*y coefficient\n  highp float C;  // y*y coefficient\n  highp float D;  // x coefficient\n  highp float E;  // y coefficient\n  highp float F;  // 1 coefficient\n};\n`;\n\n/**\n * Given a 3-d ellipsoid, finds the ellipse corresponding to the z=0 cross-section.\n * @param A The positive semi-definite matrix defining the ellipsoid shape.\n * @param c The centroid.\n */\nexport const glsl_computeCrossSectionEllipse = [glsl_EllipseQuadraticForm, `\nEllipseQuadraticForm computeCrossSectionEllipse(mat3 A, vec3 c) {\n  EllipseQuadraticForm p;\n  p.A = A[0][0];\n  p.B = A[0][1] + A[1][0];\n  p.C = A[1][1];\n  p.D = -2.0 * c[0] * A[0][0] - c[1] * (A[0][1] + A[1][0]) +\n        c[2] * (A[0][2] + A[2][0]);\n  p.E = -c[0] * (A[0][1] + A[1][0]) - 2.0 * c[1] * A[1][1] +\n        c[2] * (A[1][2] + A[2][1]);\n  p.F = c[0] * c[0] * A[0][0] + c[0] * c[1] * (A[0][1] + A[1][0]) -\n        c[0] * c[2] * (A[0][2] + A[2][0]) + c[1] * c[1] * A[1][1] -\n        c[1] * c[2] * (A[1][2] + A[2][1]) + c[2] * c[2] * A[2][2] - 1.0;\n  return p;\n}\n`];\n\nexport function computeCrossSectionEllipseDebug(Ao: mat3, c: vec3) {\n  const A = [[Ao[0], Ao[1], Ao[2]], [Ao[3], Ao[4], Ao[5]], [Ao[6], Ao[7], Ao[8]]];\n  return {\n    A: A[0][0],\n    B: A[0][1] + A[1][0],\n    C: A[1][1],\n    D: -2.0 * c[0] * A[0][0] - c[1] * (A[0][1] + A[1][0]) + c[2] * (A[0][2] + A[2][0]),\n    E: -c[0] * (A[0][1] + A[1][0]) - 2.0 * c[1] * A[1][1] + c[2] * (A[1][2] + A[2][1]),\n    F: c[0] * c[0] * A[0][0] + c[0] * c[1] * (A[0][1] + A[1][0]) -\n        c[0] * c[2] * (A[0][2] + A[2][0]) + c[1] * c[1] * A[1][1] -\n        c[1] * c[2] * (A[1][2] + A[2][1]) + c[2] * c[2] * A[2][2] - 1.0,\n  };\n}\n\nexport const glsl_CenterOrientEllipse = `\nstruct CenterOrientEllipse {\n  vec2 k;   // center\n  vec2 u1;  // minor axis direction\n  vec2 u2;  // major axis direction\n  float a;  // semimajor axis\n  float b;  // semiminor axis\n  bool valid; // indicates if the ellipse is valid\n};\n`;\n\n/**\n * Compute the center-orient parameterization of an ellipse from the quadratic parameterization.\n *\n * See: https://www.geometrictools.com/Documentation/InformationAboutEllipses.pdf\n */\nexport const glsl_computeCenterOrientEllipse = [\n  glsl_EllipseQuadraticForm, glsl_CenterOrientEllipse, `\nCenterOrientEllipse computeCenterOrientEllipse(EllipseQuadraticForm p) {\n  CenterOrientEllipse r;\n  float a11 = p.A;\n  float a12 = p.B / 2.0;\n  float a22 = p.C;\n  float b1 = p.D;\n  float b2 = p.E;\n  float c = p.F;\n  float kdenom = 2.0 * (a12 * a12 - a11 * a22);\n  float k1 = r.k.x = (a22 * b1 - a12 * b2) / kdenom;\n  float k2 = r.k.y = (a11 * b2 - a12 * b1) / kdenom;\n  float mu = 1.0 / (a11 * k1 * k1 + 2.0 * a12 * k1 * k2 + a22 * k2 * k2 - c);\n  float m11 = mu * a11;\n  float m12 = mu * a12;\n  float m22 = mu * a22;\n  float lambdaTerm1 = m11 + m22;\n  float lambdaTerm2 = sqrt((m11 - m22) * (m11 - m22) + 4.0 * m12 * m12);\n  float lambda1 = ((lambdaTerm1 + lambdaTerm2) / 2.0);\n  float lambda2 = ((lambdaTerm1 - lambdaTerm2) / 2.0);\n  r.a = 1.0 / sqrt(lambda1);\n  r.b = 1.0 / sqrt(lambda2);\n  r.valid = lambda1 > 0.0 && lambda2 > 0.0;\n  if (abs(m12) < 1e-10) {\n    r.u1 = vec2(1.0, 0.0);\n  } else if (m11 >= m22) {\n    r.u1 = normalize(vec2(lambda1 - m22, m12));\n  } else {\n    r.u1 = normalize(vec2(m12, lambda1 - m11));\n  }\n  r.u2 = vec2(-r.u1.y, r.u1.x);\n  return r;\n}\n`\n];\n\nexport function computeCenterOrientEllipseDebug(\n    p: {A: number, B: number, C: number, D: number, E: number, F: number}) {\n  const a11 = p.A;\n  const a12 = p.B / 2.0;\n  const a22 = p.C;\n  const b1 = p.D;\n  const b2 = p.E;\n  const c = p.F;\n  const kdenom = 2.0 * (a12 * a12 - a11 * a22);\n  const k1 = (a22 * b1 - a12 * b2) / kdenom;\n  const k2 = (a11 * b2 - a12 * b1) / kdenom;\n  const mu = 1.0 / (a11 * k1 * k1 + 2.0 * a12 * k1 * k2 + a22 * k2 * k2 - c);\n  const m11 = mu * a11;\n  const m12 = mu * a12;\n  const m22 = mu * a22;\n  const lambdaTerm1 = m11 + m22;\n  const lambdaTerm2 = Math.sqrt((m11 - m22) * (m11 - m22) + 4.0 * m12 * m12);\n  const lambda1 = ((lambdaTerm1 + lambdaTerm2) / 2.0);\n  const lambda2 = ((lambdaTerm1 - lambdaTerm2) / 2.0);\n  const a = 1.0 / Math.sqrt(lambda1);\n  const b = 1.0 / Math.sqrt(lambda2);\n  let u1: vec2;\n  if (Math.abs(m12) < 1e-10) {\n    u1 = vec2.fromValues(1, 0);\n  } else if (m11 >= m22) {\n    u1 = vec2.fromValues(lambda1 - m22, m12);\n  } else {\n    u1 = vec2.fromValues(m12, lambda1 - m11);\n  }\n  vec2.normalize(u1, u1);\n  const u2 = vec2.fromValues(-u1[1], u1[0]);\n  return {k: vec2.fromValues(k1, k2), u1, u2, a, b, lambda1, lambda2, m11, m12, m22};\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for drawing spheres in WebGL\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Buffer, getMemoizedBuffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nexport function getSphereVertexArray(latitudeBands: number, longitudeBands: number) {\n  const result = new Float32Array((latitudeBands + 1) * (longitudeBands + 1) * 3);\n  let i = 0;\n  for (let latIndex = 0; latIndex <= latitudeBands; ++latIndex) {\n    const theta = latIndex * Math.PI / latitudeBands;\n    const sinTheta = Math.sin(theta);\n    const cosTheta = Math.cos(theta);\n    for (let lonIndex = 0; lonIndex <= longitudeBands; ++lonIndex) {\n      const phi = lonIndex * 2 * Math.PI / longitudeBands;\n      const sinPhi = Math.sin(phi);\n      const cosPhi = Math.cos(phi);\n      result[i++] = cosPhi * sinTheta;  // x\n      result[i++] = cosTheta;           // y\n      result[i++] = sinPhi * sinTheta;  // z\n    }\n  }\n  return result;\n}\n\nexport function getSphereIndexArray(latitudeBands: number, longitudeBands: number) {\n  const result = new Uint16Array(latitudeBands * longitudeBands * 6);\n  let i = 0;\n  for (let latIndex = 0; latIndex < latitudeBands; latIndex++) {\n    for (let lonIndex = 0; lonIndex < longitudeBands; lonIndex++) {\n      const first = (latIndex * (longitudeBands + 1)) + lonIndex;\n      const second = first + longitudeBands + 1;\n      result[i++] = first;\n      result[i++] = second;\n      result[i++] = first + 1;\n\n      result[i++] = second;\n      result[i++] = second + 1;\n      result[i++] = first + 1;\n    }\n  }\n  return result;\n}\n\nexport class SphereRenderHelper extends RefCounted {\n  private vertexBuffer: Buffer;\n  private indexBuffer: Buffer;\n  private numIndices: number;\n\n  constructor(gl: GL, latitudeBands: number, longitudeBands: number) {\n    super();\n    this.vertexBuffer =\n        this.registerDisposer(getMemoizedBuffer(\n                                  gl, WebGL2RenderingContext.ARRAY_BUFFER, getSphereVertexArray,\n                                  latitudeBands, longitudeBands))\n            .value;\n    this.indexBuffer =\n        this.registerDisposer(getMemoizedBuffer(\n                                  gl, WebGL2RenderingContext.ELEMENT_ARRAY_BUFFER,\n                                  getSphereIndexArray, latitudeBands, longitudeBands))\n            .value;\n    this.numIndices = latitudeBands * longitudeBands * 6;\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    builder.addAttribute('highp vec3', 'aSphereVertex');\n    builder.addVarying('highp float', 'vLightingFactor');\n\n    // projectionMatrix = cameraMatrix * modelViewMat\n    // normalTransformMatrix = (modelViewMat^{-1})^T\n\n    // eff modelViewMat = modelViewMat * scalMat(radii)\n    // normalTransformMatrix =  (modelViewMat * scalMat)^{-1}^T\n    // =   (scalMat^{-1} * modelViewMat^{-1})^T\n    // =   modelViewMat^{-1}^T * (scalMat^{-1})^T\n    builder.addVertexCode(`\nvoid emitSphere(mat4 projectionMatrix, mat4 normalTransformMatrix, vec3 centerPosition, vec3 radii, vec4 lightDirection) {\n  vec3 vertexPosition = aSphereVertex * radii + centerPosition;\n  gl_Position = projectionMatrix * vec4(vertexPosition, 1.0);\n  vec3 normal = normalize((normalTransformMatrix * vec4(aSphereVertex / radii, 0.0)).xyz);\n  vLightingFactor = abs(dot(normal, uLightDirection.xyz)) + uLightDirection.w;\n}\n`);\n  }\n\n  draw(shader: ShaderProgram, numInstances: number) {\n    const aSphereVertex = shader.attribute('aSphereVertex');\n    this.vertexBuffer.bindToVertexAttrib(\n        aSphereVertex, /*components=*/3, /*attributeType=*/WebGL2RenderingContext.FLOAT,\n        /*normalized=*/false);\n    this.indexBuffer.bind();\n    shader.gl.drawElementsInstanced(\n        WebGL2RenderingContext.TRIANGLES, this.numIndices, WebGL2RenderingContext.UNSIGNED_SHORT,\n        /*offset=*/0, numInstances);\n    shader.gl.disableVertexAttribArray(aSphereVertex);\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for rendering ellipsoid annotations.\n */\n\nimport {AnnotationType, Ellipsoid} from 'neuroglancer/annotation';\nimport {AnnotationRenderContext, AnnotationRenderHelper, registerAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {PerspectiveViewRenderContext} from 'neuroglancer/perspective_view/render_layer';\nimport {SliceViewPanelRenderContext} from 'neuroglancer/sliceview/panel';\nimport {mat3, mat4, vec3} from 'neuroglancer/util/geom';\nimport {computeCenterOrientEllipseDebug, computeCrossSectionEllipseDebug, glsl_computeCenterOrientEllipse, glsl_computeCrossSectionEllipse} from 'neuroglancer/webgl/ellipse';\nimport {QuadRenderHelper} from 'neuroglancer/webgl/quad';\nimport {emitterDependentShaderGetter, ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {SphereRenderHelper} from 'neuroglancer/webgl/spheres';\nimport {getSquareCornersBuffer} from 'neuroglancer/webgl/square_corners_buffer';\n\nconst tempMat4 = mat4.create();\n\nconst DEBUG = false;\n\nabstract class RenderHelper extends AnnotationRenderHelper {\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    builder.addAttribute('highp vec3', 'aCenter');\n    builder.addAttribute('highp vec3', 'aRadii');\n  }\n\n  enable(shader: ShaderProgram, context: AnnotationRenderContext, callback: () => void) {\n    super.enable(shader, context, () => {\n      const aCenter = shader.attribute('aCenter');\n      const aRadii = shader.attribute('aRadii');\n      const {gl} = shader;\n      context.buffer.bindToVertexAttrib(\n          aCenter, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 6, /*offset=*/ context.bufferOffset);\n      context.buffer.bindToVertexAttrib(\n          aRadii, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 6, /*offset=*/ context.bufferOffset + 4 * 3);\n      gl.vertexAttribDivisor(aCenter, 1);\n      gl.vertexAttribDivisor(aRadii, 1);\n      callback();\n      gl.vertexAttribDivisor(aCenter, 0);\n      gl.vertexAttribDivisor(aRadii, 0);\n      gl.disableVertexAttribArray(aCenter);\n      gl.disableVertexAttribArray(aRadii);\n    });\n  }\n}\n\n/**\n * Render an ellipsoid as a transformed triangulated sphere.\n */\nclass PerspectiveRenderHelper extends RenderHelper {\n  private sphereRenderHelper = this.registerDisposer(new SphereRenderHelper(this.gl, 10, 10));\n\n  private shaderGetter = emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n    this.defineShader(builder);\n    this.sphereRenderHelper.defineShader(builder);\n    builder.addUniform('highp vec4', 'uLightDirection');\n    builder.addUniform('highp mat4', 'uNormalTransform');\n    builder.setVertexMain(`\nemitSphere(uProjection, uNormalTransform, aCenter, aRadii, uLightDirection);\n${this.setPartIndex(builder)};\n`);\n    builder.setFragmentMain(`\nemitAnnotation(vec4(vColor.rgb * vLightingFactor, vColor.a));\n`);\n  });\n\n  private tempLightVec = new Float32Array(4);\n\n  draw(context: AnnotationRenderContext&{renderContext: PerspectiveViewRenderContext}) {\n    const shader = this.shaderGetter(context.renderContext.emitter);\n    this.enable(shader, context, () => {\n      const {gl} = shader;\n      let lightVec = <vec3>this.tempLightVec;\n      let {lightDirection, ambientLighting, directionalLighting} = context.renderContext;\n      vec3.scale(lightVec, lightDirection, directionalLighting);\n      lightVec[3] = ambientLighting;\n      gl.uniform4fv(shader.uniform('uLightDirection'), lightVec);\n      gl.uniformMatrix4fv(\n          shader.uniform('uNormalTransform'), /*transpose=*/ false,\n          mat4.transpose(mat4.create(), context.annotationLayer.state.globalToObject));\n      this.sphereRenderHelper.draw(shader, context.count);\n    });\n  }\n}\n\n/**\n * Render a cross section of an ellipsoid.\n *\n * This is done using the following steps:\n *\n * Vertex shader:\n *\n * 1. We transform the ellipsoid parameters to the cross section coordinate frame (with the z\n *    axis corresponding to the plane normal).\n *\n * 2. We then compute the quadratic form parameters of the ellipse corresponding to the intersection\n *    of the ellipsoid with the `z=0` plane.\n *\n * 3. We convert the quadratic form parameterization into the center-orient parameterization.\n *\n * 4. The vertex shader emits the 4 vertices of the bounding box of the ellipse, equal to:\n *\n *      `k +/- a*u1 +/- b*u2`,\n *\n *    where `k` is the center of the ellipse, `u1` and `u2` are the major and minor axis directions\n *    respectively, and `a` and `b` are the semi-major and semi-minor axis lengths, respectively.\n *    These four vertices are used to draw a quad (two triangles).\n *\n * Fragment shader:\n *\n * 5. The fragment shader discards fragments outside the bounds of the ellipse.\n */\nclass SliceViewRenderHelper extends RenderHelper {\n  private quadRenderHelper = this.registerDisposer(new QuadRenderHelper(this.gl, 1));\n  private squareCornersBuffer =\n      getSquareCornersBuffer(this.gl, -1, -1, 1, 1, /*minorTiles=*/ 1, /*majorTiles=*/ 1);\n\n  private shaderGetter = emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n    this.defineShader(builder);\n    builder.addUniform('highp mat4', 'uViewportToObject');\n    builder.addUniform('highp mat4', 'uObjectToViewport');\n    builder.addUniform('highp mat4', 'uViewportToDevice');\n    builder.addAttribute('highp vec2', 'aCornerOffset');\n    builder.addVarying('highp vec2', 'vCircleCoord');\n    builder.addVertexCode(glsl_computeCrossSectionEllipse);\n    builder.addVertexCode(glsl_computeCenterOrientEllipse);\n    builder.setVertexMain(`\nmat3 Aobject = mat3(0.0);\nfor (int i = 0; i < 3; ++i) {\n  Aobject[i][i] = 1.0 / (aRadii[i] * aRadii[i]);\n}\nmat3 RviewportToObject = mat3(uViewportToObject);\nmat3 Aviewport = transpose(RviewportToObject) * Aobject * RviewportToObject;\nvec3 cViewport = (uObjectToViewport * vec4(aCenter, 1.0)).xyz;\nEllipseQuadraticForm quadraticForm = computeCrossSectionEllipse(Aviewport, cViewport);\nvec2 u1, u2;\nfloat a, b;\nCenterOrientEllipse centerOrient = computeCenterOrientEllipse(quadraticForm);\nvec2 viewportCorner = centerOrient.k +\n  centerOrient.u1 * aCornerOffset.x * centerOrient.a +\n  centerOrient.u2 * aCornerOffset.y * centerOrient.b;\nif (centerOrient.valid) {\n  gl_Position = uViewportToDevice * vec4(viewportCorner, 0.0, 1.0);\n} else {\n  gl_Position = vec4(1.0, 1.0, 0.0, -100.0);\n}\nvCircleCoord = aCornerOffset;\n${this.setPartIndex(builder)};\n`);\n    builder.setFragmentMain(`\nif (dot(vCircleCoord, vCircleCoord) > 1.0) {\n  discard;\n}\nemitAnnotation(vec4(vColor.rgb, 0.5));\n`);\n  });\n\n  draw(context: AnnotationRenderContext&{renderContext: SliceViewPanelRenderContext}) {\n    const shader = this.shaderGetter(context.renderContext.emitter);\n    this.enable(shader, context, () => {\n      const {gl} = shader;\n      const aCornerOffset = shader.attribute('aCornerOffset');\n      this.squareCornersBuffer.bindToVertexAttrib(aCornerOffset, /*components=*/ 2);\n      const viewportToObject = mat4.multiply(\n          tempMat4, context.annotationLayer.state.globalToObject,\n          context.renderContext.sliceView.viewportToData);\n      gl.uniformMatrix4fv(\n          shader.uniform('uViewportToObject'), /*transpose=*/ false, viewportToObject);\n      gl.uniformMatrix4fv(\n          shader.uniform('uViewportToDevice'), /*transpose=*/ false,\n          context.renderContext.sliceView.viewportToDevice);\n      const objectToViewport = tempMat4;\n      mat4.invert(objectToViewport, viewportToObject);\n      gl.uniformMatrix4fv(\n          shader.uniform('uObjectToViewport'), /*transpose=*/ false, objectToViewport);\n      this.quadRenderHelper.draw(gl, context.count);\n      shader.gl.disableVertexAttribArray(aCornerOffset);\n\n\n      if (DEBUG) {\n        const center = vec3.fromValues(2184, 1700, 3981);\n        const radii = vec3.fromValues(133, 133, 133);\n\n        const Aobject = mat3.create();\n        Aobject[0] = 1 / (radii[0] * radii[0]);\n        Aobject[4] = 1 / (radii[1] * radii[1]);\n        Aobject[8] = 1 / (radii[2] * radii[2]);\n\n        const RviewportToObject = mat3.fromMat4(mat3.create(), viewportToObject);\n        const Aviewport =\n            mat3.multiply(mat3.create(), mat3.transpose(mat3.create(), RviewportToObject), Aobject);\n        mat3.multiply(Aviewport, Aviewport, RviewportToObject);\n        const cViewport = vec3.transformMat4(vec3.create(), center, objectToViewport);\n\n        console.log('Aviewport', Aviewport);\n        console.log('cViewport', cViewport);\n\n        const p = computeCrossSectionEllipseDebug(Aviewport, cViewport);\n        const centerOrient = computeCenterOrientEllipseDebug(p);\n        console.log(p);\n        console.log(centerOrient);\n      }\n    });\n  }\n}\n\nregisterAnnotationTypeRenderHandler(AnnotationType.ELLIPSOID, {\n  bytes: 6 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 6);\n    return (annotation: Ellipsoid, index: number) => {\n      const {center, radii} = annotation;\n      const coordinateOffset = index * 6;\n      coordinates.set(center, coordinateOffset);\n      coordinates.set(radii, coordinateOffset + 3);\n    };\n  },\n  sliceViewRenderHelper: SliceViewRenderHelper,\n  perspectiveViewRenderHelper: PerspectiveRenderHelper,\n  pickIdsPerInstance: 1,\n  snapPosition: (/*position, objectToData, annotation, partIndex*/) => {\n    // FIXME: snap to nearest point on ellipsoid surface\n  },\n  getRepresentativePoint: (objectToData, ann) => {\n    let repPoint = vec3.create();\n    vec3.transformMat4(repPoint, ann.center, objectToData);\n    return repPoint;\n  },\n  updateViaRepresentativePoint: (oldAnnotation: Ellipsoid, position: vec3, dataToObject: mat4) => {\n    let annotation = {...oldAnnotation};\n    annotation.center = vec3.transformMat4(vec3.create(), position, dataToObject);\n    return annotation;\n  }\n});\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/annotation/bounding_box';\nimport 'neuroglancer/annotation/line';\nimport 'neuroglancer/annotation/point';\nimport 'neuroglancer/annotation/ellipsoid';\n\nimport {AnnotationBase, AnnotationSource, annotationTypes} from 'neuroglancer/annotation';\nimport {AnnotationLayerState} from 'neuroglancer/annotation/annotation_layer_state';\nimport {ANNOTATION_PERSPECTIVE_RENDER_LAYER_RPC_ID, ANNOTATION_RENDER_LAYER_RPC_ID, ANNOTATION_RENDER_LAYER_UPDATE_SEGMENTATION_RPC_ID} from 'neuroglancer/annotation/base';\nimport {AnnotationGeometryData, MultiscaleAnnotationSource} from 'neuroglancer/annotation/frontend_source';\nimport {AnnotationRenderContext, AnnotationRenderHelper, getAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {MouseSelectionState, VisibilityTrackedRenderLayer} from 'neuroglancer/layer';\nimport {PerspectiveViewRenderContext, PerspectiveViewRenderLayer} from 'neuroglancer/perspective_view/render_layer';\nimport {forEachVisibleSegment, getObjectKey} from 'neuroglancer/segmentation_display_state/base';\nimport {SegmentationDisplayState} from 'neuroglancer/segmentation_display_state/frontend';\nimport {SharedWatchableValue} from 'neuroglancer/shared_watchable_value';\nimport {SliceViewPanelRenderLayer} from 'neuroglancer/sliceview/panel';\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {binarySearch} from 'neuroglancer/util/array';\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4} from 'neuroglancer/util/geom';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {withSharedVisibility} from 'neuroglancer/visibility_priority/frontend';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {registerSharedObjectOwner, SharedObject} from 'neuroglancer/worker_rpc';\n\nconst tempMat = mat4.create();\n\nfunction segmentationFilter(segmentationState: SegmentationDisplayState|undefined|null) {\n  if (segmentationState == null) {\n    return () => false;\n  }\n  const {visibleSegments, segmentEquivalences} = segmentationState;\n  return (annotation: AnnotationBase) => {\n    const {segments} = annotation;\n    if (segments === undefined) {\n      return false;\n    }\n    for (const segment of segments) {\n      if (visibleSegments.has(segmentEquivalences.get(segment))) {\n        return true;\n      }\n    }\n    return false;\n  };\n}\n\nfunction serializeAnnotationSet(\n    annotationSet: AnnotationSource, filter?: (annotation: AnnotationBase) => boolean) {\n  const typeToIds: string[][] = [];\n  for (const annotationType of annotationTypes) {\n    typeToIds[annotationType] = [];\n  }\n  for (const annotation of annotationSet) {\n    if (filter === undefined || filter(annotation)) {\n      typeToIds[annotation.type].push(annotation.id);\n    }\n  }\n  let totalBytes = 0;\n  let numPickIds = 0;\n  const typeToOffset: number[] = [];\n  for (const annotationType of annotationTypes) {\n    typeToOffset[annotationType] = totalBytes;\n    const count = typeToIds[annotationType].length;\n    const handler = getAnnotationTypeRenderHandler(annotationType);\n    totalBytes += count * handler.bytes;\n    numPickIds += handler.pickIdsPerInstance * count;\n  }\n  const data = new ArrayBuffer(totalBytes);\n  for (const annotationType of annotationTypes) {\n    const ids = typeToIds[annotationType];\n    const handler = getAnnotationTypeRenderHandler(annotationType);\n    const serializer = handler.serializer(data, typeToOffset[annotationType], ids.length);\n    ids.forEach((id, index) => serializer(annotationSet.get(id)!, index));\n  }\n  return {typeToIds, typeToOffset, data, numPickIds};\n}\n\n@registerSharedObjectOwner(ANNOTATION_RENDER_LAYER_RPC_ID)\nclass AnnotationLayerSharedObject extends withSharedVisibility(SharedObject) {\n  constructor(\n      public chunkManager: Borrowed<ChunkManager>,\n      public source: Borrowed<MultiscaleAnnotationSource>,\n      public state: WatchableValueInterface<SegmentationDisplayState|undefined|null>,\n      public filterBySegmentation: WatchableValueInterface<boolean>) {\n    super();\n\n    this.initializeCounterpart(this.chunkManager.rpc!, {\n      chunkManager: this.chunkManager.rpcId,\n      source: source.rpcId,\n      segmentationState: this.serializeDisplayState(),\n    });\n\n    const update = () => {\n      const msg: any = {id: this.rpcId, segmentationState: this.serializeDisplayState()};\n      this.rpc!.invoke(ANNOTATION_RENDER_LAYER_UPDATE_SEGMENTATION_RPC_ID, msg);\n    };\n\n    this.registerDisposer(state.changed.add(update));\n    this.registerDisposer(filterBySegmentation.changed.add(update));\n  }\n\n  private serializeDisplayState() {\n    const state = this.state.value;\n    if (state == null) {\n      return state;\n    }\n    if (!this.filterBySegmentation.value) {\n      return null;\n    }\n    return {\n      segmentEquivalences: state.segmentEquivalences.rpcId,\n      visibleSegments: state.visibleSegments.rpcId\n    };\n  }\n}\n\nexport class AnnotationLayer extends RefCounted {\n  /**\n   * Stores a serialized representation of the information needed to render the annotations.\n   */\n  buffer: Buffer;\n\n  /**\n   * The value of this.state.annotationSet.changed.count when `buffer` was last updated.\n   */\n  private generation = -1;\n\n  redrawNeeded = new NullarySignal();\n  typeToIds: string[][];\n  typeToOffset: number[];\n  numPickIds: number;\n  data: Uint8Array|undefined;\n\n  get source() {\n    return this.state.source;\n  }\n  get transform() {\n    return this.state.transform;\n  }\n  get hoverState() {\n    return this.state.hoverState;\n  }\n\n  private segmentationState: SegmentationDisplayState|undefined|null;\n\n  private handleChangeAffectingBuffer = (() => {\n    this.generation = -1;\n    this.redrawNeeded.dispatch();\n  });\n\n  private unregisterSegmentationState() {\n    const {segmentationState} = this;\n    if (segmentationState != null) {\n      segmentationState.visibleSegments.changed.remove(this.handleSegmentationChanged);\n      segmentationState.segmentEquivalences.changed.remove(this.handleSegmentationChanged);\n      this.segmentationState = undefined;\n    }\n  }\n\n  private handleSegmentationChanged = (() => {\n    if (this.state.filterBySegmentation.value) {\n      this.handleChangeAffectingBuffer();\n    }\n  });\n\n  sharedObject: AnnotationLayerSharedObject|undefined;\n\n  get visibility() {\n    const {sharedObject} = this;\n    if (sharedObject === undefined) {\n      return undefined;\n    }\n    return sharedObject.visibility;\n  }\n\n  constructor(public chunkManager: ChunkManager, public state: Owned<AnnotationLayerState>) {\n    super();\n    this.registerDisposer(state);\n    this.buffer = this.registerDisposer(new Buffer(chunkManager.gl));\n    this.registerDisposer(this.source.changed.add(this.handleChangeAffectingBuffer));\n    this.registerDisposer(state.filterBySegmentation.changed.add(this.handleChangeAffectingBuffer));\n    this.registerDisposer(() => this.unregisterSegmentationState());\n    this.registerDisposer(state.segmentationState.changed.add(() => {\n      const segmentationState = state.segmentationState.value;\n      if (segmentationState !== this.segmentationState) {\n        this.unregisterSegmentationState();\n        if (segmentationState != null) {\n          segmentationState.visibleSegments.changed.add(this.handleSegmentationChanged);\n          segmentationState.segmentEquivalences.changed.add(this.handleSegmentationChanged);\n        }\n        this.segmentationState = segmentationState;\n        this.handleSegmentationChanged();\n      }\n    }));\n    if (!(this.source instanceof AnnotationSource)) {\n      this.sharedObject = this.registerDisposer(new AnnotationLayerSharedObject(\n          chunkManager, this.source, state.segmentationState, state.filterBySegmentation));\n    }\n    this.registerDisposer(this.state.color.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(this.state.fillOpacity.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(this.hoverState.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(this.transform.changed.add(this.redrawNeeded.dispatch));\n  }\n\n  get gl() {\n    return this.chunkManager.gl;\n  }\n\n  updateBuffer() {\n    const {source} = this;\n    if (source instanceof AnnotationSource) {\n      const generation = source.changed.count;\n      if (this.generation !== generation) {\n        this.generation = generation;\n        const {data, typeToIds, typeToOffset, numPickIds} = serializeAnnotationSet(\n            source,\n            this.state.filterBySegmentation.value ? segmentationFilter(this.segmentationState) :\n                                                    undefined);\n        this.data = new Uint8Array(data);\n        this.buffer.setData(this.data);\n        this.typeToIds = typeToIds;\n        this.typeToOffset = typeToOffset;\n        this.numPickIds = numPickIds;\n      }\n    }\n  }\n}\n\nclass AnnotationPerspectiveRenderLayerBase extends PerspectiveViewRenderLayer {\n  constructor(public base: Owned<AnnotationLayer>) {\n    super();\n  }\n}\n\nclass AnnotationSliceViewRenderLayerBase extends SliceViewPanelRenderLayer {\n  constructor(public base: Owned<AnnotationLayer>) {\n    super();\n  }\n}\n\ninterface AnnotationGeometryDataInterface {\n  data: Uint8Array|undefined;\n  buffer: Buffer|undefined;\n  numPickIds: number|undefined;\n  typeToIds: string[][]|undefined;\n  typeToOffset: number[]|undefined;\n}\n\nfunction AnnotationRenderLayer<TBase extends {\n  new (...args: any[]): VisibilityTrackedRenderLayer &\n  {\n    base: AnnotationLayer\n  }\n}>(Base: TBase, renderHelperType: 'sliceViewRenderHelper'|'perspectiveViewRenderHelper') {\n  class C extends Base {\n    base: AnnotationLayer;\n    private renderHelpers: AnnotationRenderHelper[] = [];\n    constructor(...args: any[]) {\n      super(...args);\n      const base = this.registerDisposer(this.base);\n      const baseVisibility = base.visibility;\n      if (baseVisibility !== undefined) {\n        this.registerDisposer(baseVisibility.add(this.visibility));\n      }\n      this.role = base.state.role;\n      const {renderHelpers, gl} = this;\n      for (const annotationType of annotationTypes) {\n        const handler = getAnnotationTypeRenderHandler(annotationType);\n        const renderHelperConstructor = handler[renderHelperType];\n        const helper = renderHelpers[annotationType] =\n            this.registerDisposer(new renderHelperConstructor(gl));\n        helper.pickIdsPerInstance = handler.pickIdsPerInstance;\n        helper.targetIsSliceView = renderHelperType === 'sliceViewRenderHelper';\n      }\n      this.registerDisposer(base.redrawNeeded.add(() => {\n        this.redrawNeeded.dispatch();\n      }));\n      this.setReady(true);\n    }\n\n    get gl() {\n      return this.base.chunkManager.gl;\n    }\n\n    drawGeometryChunkData(\n        chunk: AnnotationGeometryData, renderContext: PerspectiveViewRenderContext) {\n      if (!chunk.bufferValid) {\n        let {buffer} = chunk;\n        if (buffer === undefined) {\n          buffer = chunk.buffer = new Buffer(this.gl);\n        }\n        buffer.setData(chunk.data!);\n        chunk.bufferValid = true;\n      }\n      this.drawGeometry(chunk, renderContext);\n    }\n\n    drawGeometry(\n        chunk: AnnotationGeometryDataInterface, renderContext: PerspectiveViewRenderContext) {\n      const {base} = this;\n      const typeToIds = chunk.typeToIds!;\n      const typeToOffset = chunk.typeToOffset!;\n      let pickId = 0;\n      if (renderContext.emitPickID) {\n        pickId = renderContext.pickIDs.register(this, chunk.numPickIds, 0, 0, chunk);\n      }\n      const hoverValue = base.hoverState.value;\n      const projectionMatrix =\n          mat4.multiply(tempMat, renderContext.dataToDevice, base.state.objectToGlobal);\n      for (const annotationType of annotationTypes) {\n        const ids = typeToIds[annotationType];\n        if (ids.length > 0) {\n          const count = ids.length;\n          const handler = getAnnotationTypeRenderHandler(annotationType);\n          let selectedIndex = 0xFFFFFFFF;\n          if (hoverValue !== undefined) {\n            const index = binarySearch(ids, hoverValue.id, (a, b) => a < b ? -1 : a === b ? 0 : 1);\n            if (index >= 0) {\n              selectedIndex = index * handler.pickIdsPerInstance;\n              // If we wanted to include the partIndex, we would add:\n              // selectedIndex += hoverValue.partIndex;\n            }\n          }\n          const context: AnnotationRenderContext = {\n            annotationLayer: base,\n            renderContext,\n            selectedIndex,\n            basePickId: pickId,\n            buffer: chunk.buffer!,\n            bufferOffset: typeToOffset[annotationType],\n            count,\n            projectionMatrix,\n          };\n          this.renderHelpers[annotationType].draw(context);\n          pickId += count * handler.pickIdsPerInstance;\n        }\n      }\n    }\n\n    draw(renderContext: PerspectiveViewRenderContext) {\n      const {source} = this.base;\n      if (source instanceof AnnotationSource) {\n        const {base} = this;\n        base.updateBuffer();\n        this.drawGeometry(base, renderContext);\n      } else {\n        this.drawGeometryChunkData(source.temporary.data!, renderContext);\n        if (this.base.state.filterBySegmentation.value) {\n          const segmentationState = this.base.state.segmentationState.value;\n          if (segmentationState == null) {\n            return;\n          }\n          const chunks = source.segmentFilteredSource.chunks;\n          forEachVisibleSegment(segmentationState, objectId => {\n            const key = getObjectKey(objectId);\n            const chunk = chunks.get(key);\n            if (chunk !== undefined) {\n              this.drawGeometryChunkData(chunk.data!, renderContext);\n            }\n          });\n        } else {\n          for (const alternatives of source.sources) {\n            for (const geometrySource of alternatives) {\n              for (const chunk of geometrySource.chunks.values()) {\n                if (chunk.state !== ChunkState.GPU_MEMORY) {\n                  continue;\n                }\n                this.drawGeometryChunkData(chunk.data!, renderContext);\n              }\n            }\n          }\n        }\n      }\n    }\n\n    updateMouseState(\n        mouseState: MouseSelectionState, _pickedValue: Uint64, pickedOffset: number, data: any) {\n      const chunk = <AnnotationGeometryDataInterface>data;\n      const typeToIds = chunk.typeToIds!;\n      const typeToOffset = chunk.typeToOffset!;\n      for (const annotationType of annotationTypes) {\n        const ids = typeToIds[annotationType];\n        const handler = getAnnotationTypeRenderHandler(annotationType);\n        const {pickIdsPerInstance} = handler;\n        if (pickedOffset < ids.length * pickIdsPerInstance) {\n          const instanceIndex = Math.floor(pickedOffset / pickIdsPerInstance);\n          const id = ids[instanceIndex];\n          const partIndex = pickedOffset % pickIdsPerInstance;\n          mouseState.pickedAnnotationId = id;\n          mouseState.pickedAnnotationLayer = this.base.state;\n          mouseState.pickedOffset = partIndex;\n          mouseState.pickedAnnotationBuffer = chunk.data!.buffer;\n          mouseState.pickedAnnotationBufferOffset = chunk.data!.byteOffset + typeToOffset[annotationType] + instanceIndex * handler.bytes;\n          handler.snapPosition(\n              mouseState.position, this.base.state.objectToGlobal, mouseState.pickedAnnotationBuffer,\n              mouseState.pickedAnnotationBufferOffset,\n              partIndex);\n          return;\n        }\n        pickedOffset -= ids.length * pickIdsPerInstance;\n      }\n    }\n\n    transformPickedValue(_pickedValue: Uint64, _pickedOffset: number) {\n      return undefined;\n    }\n\n    isReady() {\n      const {base} = this;\n      const {source} = base;\n      if (!(source instanceof MultiscaleAnnotationSource)) {\n        return true;\n      }\n      if (!base.state.filterBySegmentation.value) {\n        return true;\n      }\n\n      const segmentationState = this.base.state.segmentationState.value;\n      if (segmentationState === undefined) {\n        // We are still waiting to attach segmentation.\n        return false;\n      }\n      if (segmentationState === null) {\n        return true;\n      }\n      const chunks = source.segmentFilteredSource.chunks;\n      let missing = false;\n      forEachVisibleSegment(segmentationState, objectId => {\n        const key = getObjectKey(objectId);\n        if (!chunks.has(key)) {\n          missing = true;\n        }\n      });\n      return !missing;\n    }\n\n    isAnnotation = true;\n  }\n  return C;\n}\n\nconst PerspectiveViewAnnotationLayerBase =\n    AnnotationRenderLayer(AnnotationPerspectiveRenderLayerBase, 'perspectiveViewRenderHelper');\nexport class PerspectiveViewAnnotationLayer extends PerspectiveViewAnnotationLayerBase {\n  backend = (() => {\n    const {source} = this.base;\n    if (source instanceof MultiscaleAnnotationSource) {\n      const sharedObject = this.registerDisposer(new SharedObject());\n      const rpc = source.chunkManager.rpc!;\n      sharedObject.RPC_TYPE_ID = ANNOTATION_PERSPECTIVE_RENDER_LAYER_RPC_ID;\n      sharedObject.initializeCounterpart(rpc, {\n        source: source.rpcId,\n        filterBySegmentation: this.registerDisposer(SharedWatchableValue.makeFromExisting(\n                                                        rpc, this.base.state.filterBySegmentation))\n                                  .rpcId\n      });\n      return sharedObject;\n    }\n    return undefined;\n  })();\n  isReady() {\n    if (!super.isReady()) {\n      return false;\n    }\n    const {base} = this;\n    const {source} = base;\n    if (source instanceof MultiscaleAnnotationSource) {\n      if (!base.state.filterBySegmentation.value) {\n        const geometrySource = source.sources[0][0];\n        const chunk = geometrySource.chunks.get('0,0,0');\n        if (chunk === undefined || chunk.state !== ChunkState.GPU_MEMORY) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n}\n\nexport const SliceViewAnnotationLayer =\n    AnnotationRenderLayer(AnnotationSliceViewRenderLayerBase, 'sliceViewRenderHelper');\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport {AnnotationHoverState, AnnotationLayerState} from 'neuroglancer/annotation/annotation_layer_state';\nexport {MultiscaleAnnotationSource} from 'neuroglancer/annotation/frontend_source';\nexport {AnnotationLayer, PerspectiveViewAnnotationLayer, SliceViewAnnotationLayer} from 'neuroglancer/annotation/renderlayer';\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CredentialsProvider} from 'neuroglancer/credentials_provider';\nimport {fetchWithCredentials} from 'neuroglancer/credentials_provider/http_request';\nimport {CancellationToken, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {responseArrayBuffer, responseJson} from 'neuroglancer/util/http_request';\n\nexport type BrainmapsCredentialsProvider = CredentialsProvider<Credentials>;\n\n/**\n * OAuth2 token\n */\nexport interface Credentials {\n  tokenType: string;\n  accessToken: string;\n}\n\n/**\n * Key used for retrieving the CredentialsProvider from a CredentialsManager.\n */\nexport const credentialsKey = 'google-brainmaps';\n\nexport interface BrainmapsInstance {\n  description: string;\n  /**\n   * One or more server URLs to use to connect to the instance.\n   */\n  serverUrl: string;\n}\n\n/**\n * API-related interfaces.\n */\n\nexport interface ChangeSpecPayload {\n  change_stack_id?: string;\n  time_stamp?: number;\n  skip_equivalences?: boolean;\n}\n\nexport interface ChangeStackAwarePayload {\n  change_spec?: ChangeSpecPayload;\n}\n\nexport interface GeometryPayload {\n  corner: string;\n  size: string;\n  scale: number;\n}\n\nexport interface GeometryAwarePayload {\n  geometry: GeometryPayload;\n}\n\nexport interface ImageFormatOptionsPayload {\n  image_format?: 'AUTO'|'JPEG'|'PNG'|'JSON';\n  jpeg_quality?: number;\n  compressed_segmentation_block_size?: string;\n}\n\nexport interface SubvolumePayload extends ChangeStackAwarePayload, GeometryAwarePayload {\n  image_format_options?: ImageFormatOptionsPayload;\n  subvolume_format?: 'RAW'|'SINGLE_IMAGE';\n}\n\nexport interface SkeletonPayload extends ChangeStackAwarePayload {\n  object_id: string;\n}\n\nexport interface MeshFragmentPayload extends ChangeStackAwarePayload {\n  fragment_key: string;\n  object_id: string;\n}\n\nexport interface BatchMeshFragment {\n  object_id: string;\n  fragment_keys: string[];\n}\n\nexport interface BatchMeshFragmentPayload {\n  volume_id: string;\n  mesh_name: string;\n  batches: BatchMeshFragment[];\n}\n\nexport interface HttpCall {\n  method: 'GET'|'POST';\n  path: string;\n  payload?: string;\n}\n\nexport function makeRequest(\n    instance: BrainmapsInstance, credentialsProvider: BrainmapsCredentialsProvider,\n    httpCall: HttpCall&{responseType: 'arraybuffer'},\n    cancellationToken?: CancellationToken): Promise<ArrayBuffer>;\nexport function makeRequest(\n    instance: BrainmapsInstance, credentialsProvider: BrainmapsCredentialsProvider,\n    httpCall: HttpCall&{responseType: 'json'}, cancellationToken?: CancellationToken): Promise<any>;\n\nexport function makeRequest(\n    instance: BrainmapsInstance, credentialsProvider: BrainmapsCredentialsProvider,\n    httpCall: HttpCall&{responseType: XMLHttpRequestResponseType},\n    cancellationToken: CancellationToken = uncancelableToken): any {\n  return fetchWithCredentials(\n      credentialsProvider, `${instance.serverUrl}${httpCall.path}`,\n      {method: httpCall.method, body: httpCall.payload},\n      httpCall.responseType === 'json' ? responseJson : responseArrayBuffer,\n      (credentials, init) => {\n        const headers = new Headers(init.headers);\n        headers.set('Authorization', `${credentials.tokenType} ${credentials.accessToken}`);\n        return {...init, headers};\n      },\n      error => {\n        const {status} = error;\n        if (status === 401) {\n          // 401: Authorization needed.  OAuth2 token may have expired.\n          return 'refresh';\n        } else if (status === 504 || status === 503) {\n          // 503: Service unavailable.  Retry.\n          // 504: Gateway timeout.  Can occur if the server takes too long to reply.  Retry.\n          return 'retry';\n        }\n        throw error;\n      },\n      cancellationToken);\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for drawing circles in WebGL as quads (triangle fan).\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {QuadRenderHelper} from 'neuroglancer/webgl/quad';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {getSquareCornersBuffer} from 'neuroglancer/webgl/square_corners_buffer';\n\nexport const VERTICES_PER_CIRCLE = 4;\n\nexport class CircleShader extends RefCounted {\n  private squareCornersBuffer: Buffer;\n  private quadHelper: QuadRenderHelper;\n\n  constructor(gl: GL, public circlesPerInstance: number = 1) {\n    super();\n    this.squareCornersBuffer = getSquareCornersBuffer(\n        gl, -1, -1, 1, 1, /*minorTiles=*/circlesPerInstance, /*majorTiles=*/1);\n    this.quadHelper = this.registerDisposer(new QuadRenderHelper(gl, circlesPerInstance));\n  }\n\n  defineShader(builder: ShaderBuilder, crossSectionFade: boolean) {\n    // XY corners of square ranging from [-1, -1] to [1, 1].\n    builder.addAttribute('highp vec2', 'aCircleCornerOffset');\n\n    // x and y components: The x and y radii of the point in normalized device coordinates.\n    // z component: Starting point of border from [0, 1]..\n    // w component: Fraction of total radius that is feathered.\n    builder.addUniform('highp vec4', 'uCircleParams');\n\n    // 2-D position within circle quad, ranging from [-1, -1] to [1, 1].\n    builder.addVarying('highp vec2', 'vCircleCoord');\n    builder.addVertexCode(`\nvoid emitCircle(vec4 position) {\n  gl_Position = position;\n  gl_Position.xy += aCircleCornerOffset * uCircleParams.xy * gl_Position.w;\n  vCircleCoord = aCircleCornerOffset;\n}\n`);\n    if (crossSectionFade) {\n      builder.addFragmentCode(`\nfloat getCircleAlphaMultiplier() {\n  return 1.0 - 2.0 * abs(0.5 - gl_FragCoord.z);\n}\n`);\n    } else {\n      builder.addFragmentCode(`\nfloat getCircleAlphaMultiplier() {\n  return 1.0;\n}\n`);\n    }\n    builder.addFragmentCode(`\nvec4 getCircleColor(vec4 interiorColor, vec4 borderColor) {\n  float radius = length(vCircleCoord);\n  if (radius > 1.0) {\n    discard;\n  }\n\n  float borderColorFraction = clamp((radius - uCircleParams.z) / uCircleParams.w, 0.0, 1.0);\n  float feather = clamp((1.0 - radius) / uCircleParams.w, 0.0, 1.0);\n  vec4 color = mix(interiorColor, borderColor, borderColorFraction);\n\n  return vec4(color.rgb, color.a * feather * getCircleAlphaMultiplier());\n}\n`);\n  }\n\n  draw(\n      shader: ShaderProgram, renderContext: {viewportWidth: number, viewportHeight: number},\n      options: {\n        interiorRadiusInPixels: number,\n        borderWidthInPixels: number,\n        featherWidthInPixels: number\n      },\n      count: number) {\n    const {gl} = shader;\n    const aCircleCornerOffset = shader.attribute('aCircleCornerOffset');\n    this.squareCornersBuffer.bindToVertexAttrib(aCircleCornerOffset, /*components=*/2);\n    const totalRadius =\n        options.interiorRadiusInPixels + options.borderWidthInPixels + options.featherWidthInPixels;\n    gl.uniform4f(\n        shader.uniform('uCircleParams'), totalRadius / renderContext.viewportWidth,\n        totalRadius / renderContext.viewportHeight, options.interiorRadiusInPixels / totalRadius,\n        options.featherWidthInPixels === 0 ? 1e-6 : options.featherWidthInPixels / totalRadius);\n    this.quadHelper.draw(gl, count);\n    shader.gl.disableVertexAttribArray(aCircleCornerOffset);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CredentialsProvider} from 'neuroglancer/credentials_provider';\nimport {fetchWithCredentials} from 'neuroglancer/credentials_provider/http_request';\nimport {CancellationToken, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {ResponseTransform} from 'neuroglancer/util/http_request';\n\nexport type BossToken = string;\n\n/**\n * Key used for retrieving the CredentialsProvider from a CredentialsManager.\n */\nexport const credentialsKey = 'boss';\n\nexport function fetchWithBossCredentials<T>(\n    credentialsProvider: CredentialsProvider<BossToken>, input: RequestInfo, init: RequestInit,\n    transformResponse: ResponseTransform<T>,\n    cancellationToken: CancellationToken = uncancelableToken): Promise<T> {\n  return fetchWithCredentials(\n      credentialsProvider, input, init, transformResponse,\n      credentials => {\n        const headers = new Headers(init.headers);\n        headers.set('Authorization', `Bearer ${credentials}`);\n        return {...init, headers};\n      },\n      error => {\n        const {status} = error;\n        if (status === 403 || status === 401) {\n          // Authorization needed.  Retry with refreshed token.\n          return 'refresh';\n        }\n        if (status === 504) {\n          // Gateway timeout can occur if the server takes too long to reply.  Retry.\n          return 'retry';\n        }\n        throw error;\n      },\n      cancellationToken);\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Annotation, AnnotationId, AnnotationReference, AnnotationType, annotationTypes, deserializeAnnotation, getAnnotationTypeHandler, makeAnnotationId, AnnotationSourceSignals} from 'neuroglancer/annotation';\nimport {ANNOTATION_COMMIT_UPDATE_RESULT_RPC_ID, ANNOTATION_COMMIT_UPDATE_RPC_ID, ANNOTATION_GEOMETRY_CHUNK_SOURCE_RPC_ID, ANNOTATION_METADATA_CHUNK_SOURCE_RPC_ID, ANNOTATION_REFERENCE_ADD_RPC_ID, ANNOTATION_REFERENCE_DELETE_RPC_ID, ANNOTATION_SUBSET_GEOMETRY_CHUNK_SOURCE_RPC_ID, AnnotationGeometryChunkSpecification} from 'neuroglancer/annotation/base';\nimport {getAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {Chunk, ChunkManager, ChunkSource} from 'neuroglancer/chunk_manager/frontend';\nimport {getObjectKey} from 'neuroglancer/segmentation_display_state/base';\nimport {SliceViewSourceOptions} from 'neuroglancer/sliceview/base';\nimport {MultiscaleSliceViewChunkSource, SliceViewChunk, SliceViewChunkSource, SliceViewChunkSourceOptions} from 'neuroglancer/sliceview/frontend';\nimport {RenderLayer} from 'neuroglancer/sliceview/renderlayer';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {binarySearch} from 'neuroglancer/util/array';\nimport {Borrowed, Owned} from 'neuroglancer/util/disposable';\nimport {mat4} from 'neuroglancer/util/geom';\nimport {Signal, NullarySignal} from 'neuroglancer/util/signal';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {registerRPC, registerSharedObjectOwner, RPC, SharedObject} from 'neuroglancer/worker_rpc';\n\ninterface AnnotationGeometryChunkSourceOptions extends SliceViewChunkSourceOptions {\n  spec: AnnotationGeometryChunkSpecification;\n  parameters: any;\n  parent: Borrowed<MultiscaleAnnotationSource>;\n}\n\nexport class AnnotationGeometryData {\n  buffer: Buffer|undefined;\n  bufferValid = false;\n  data: Uint8Array|undefined;\n  typeToOffset: number[]|undefined;\n  numPickIds: number;\n  typeToIds: string[][]|undefined;\n\n  constructor(x: any) {\n    this.data = x.data;\n    const typeToIds = this.typeToIds = x.typeToIds;\n    let numPickIds = 0;\n    for (const annotationType of annotationTypes) {\n      numPickIds += getAnnotationTypeRenderHandler(annotationType).pickIdsPerInstance *\n          typeToIds[annotationType].length;\n    }\n    this.numPickIds = numPickIds;\n    this.typeToOffset = x.typeToOffset;\n  }\n  freeGPUMemory(gl: GL) {\n    gl;\n    const {buffer} = this;\n    if (buffer !== undefined) {\n      buffer.dispose();\n      this.bufferValid = false;\n      this.buffer = undefined;\n    }\n  }\n}\n\nexport class AnnotationSubsetGeometryChunk extends Chunk {\n  source: AnnotationSubsetGeometryChunkSource;\n  data: AnnotationGeometryData;\n  constructor(source: AnnotationSubsetGeometryChunkSource, x: any) {\n    super(source);\n    this.data = new AnnotationGeometryData(x);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    this.data.freeGPUMemory(gl);\n  }\n\n  dispose() {\n    this.data = <any>undefined;\n  }\n}\n\nexport class AnnotationGeometryChunk extends SliceViewChunk {\n  source: AnnotationGeometryChunkSource;\n  data: AnnotationGeometryData;\n\n  constructor(source: AnnotationGeometryChunkSource, x: any) {\n    super(source, x);\n    this.data = new AnnotationGeometryData(x);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    this.data.freeGPUMemory(gl);\n  }\n\n  dispose() {\n    this.data = <any>undefined;\n  }\n}\n\n@registerSharedObjectOwner(ANNOTATION_GEOMETRY_CHUNK_SOURCE_RPC_ID)\nexport class AnnotationGeometryChunkSource extends SliceViewChunkSource {\n  parent: Borrowed<MultiscaleAnnotationSource>;\n  chunks: Map<string, AnnotationGeometryChunk>;\n  spec: AnnotationGeometryChunkSpecification;\n  parameters: any;\n  immediateChunkUpdates = true;\n\n  constructor(chunkManager: Borrowed<ChunkManager>, options: AnnotationGeometryChunkSourceOptions) {\n    super(chunkManager, options);\n    this.parent = options.parent;\n    this.parameters = options.parameters;\n    this.spec = options.spec;\n  }\n\n  initializeCounterpart(rpc: RPC, options: any) {\n    options['parameters'] = this.parameters;\n    options['parent'] = this.parent.rpcId;\n    super.initializeCounterpart(rpc, options);\n  }\n\n  addChunk(key: string, chunk: AnnotationGeometryChunk) {\n    super.addChunk(key, chunk);\n    // TODO: process local deletions\n  }\n\n  getChunk(x: any) {\n    return new AnnotationGeometryChunk(this, x);\n  }\n}\n\n@registerSharedObjectOwner(ANNOTATION_SUBSET_GEOMETRY_CHUNK_SOURCE_RPC_ID)\nexport class AnnotationSubsetGeometryChunkSource extends ChunkSource {\n  immediateChunkUpdates = true;\n  chunks: Map<string, AnnotationSubsetGeometryChunk>;\n\n  constructor(\n      chunkManager: Borrowed<ChunkManager>, public parent: Borrowed<MultiscaleAnnotationSource>) {\n    super(chunkManager, {});\n  }\n\n  initializeCounterpart(rpc: RPC, options: any) {\n    options['parent'] = this.parent.rpcId;\n    super.initializeCounterpart(rpc, options);\n  }\n\n  addChunk(key: string, chunk: AnnotationSubsetGeometryChunk) {\n    super.addChunk(key, chunk);\n    // TODO: process local deletions\n  }\n\n  getChunk(x: any): AnnotationSubsetGeometryChunk {\n    return new AnnotationSubsetGeometryChunk(this, x);\n  }\n}\n\nexport class AnnotationMetadataChunk extends Chunk {\n  annotation: Annotation|null;\n  constructor(source: Borrowed<AnnotationMetadataChunkSource>, x: any) {\n    super(source);\n    this.annotation = deserializeAnnotation(x.annotation);\n  }\n}\n\n@registerSharedObjectOwner(ANNOTATION_METADATA_CHUNK_SOURCE_RPC_ID)\nexport class AnnotationMetadataChunkSource extends ChunkSource {\n  chunks: Map<string, AnnotationMetadataChunk>;\n  constructor(\n      chunkManager: Borrowed<ChunkManager>, public parent: Borrowed<MultiscaleAnnotationSource>) {\n    super(chunkManager);\n  }\n  getChunk(x: any): AnnotationMetadataChunk {\n    return new AnnotationMetadataChunk(this, x);\n  }\n  addChunk(key: string, chunk: AnnotationMetadataChunk) {\n    super.addChunk(key, chunk);\n    const {references} = this.parent;\n    const reference = references.get(key);\n    if (reference !== undefined) {\n      reference.value = chunk.annotation;\n      reference.changed.dispatch();\n    }\n  }\n  deleteChunk(key: string) {\n    const {references} = this.parent;\n    const reference = references.get(key);\n    if (reference !== undefined) {\n      reference.value = undefined;\n      reference.changed.dispatch();\n    }\n  }\n  initializeCounterpart(rpc: RPC, options: any) {\n    options['parent'] = this.parent.rpcId;\n    super.initializeCounterpart(rpc, options);\n  }\n}\n\nfunction updateAnnotation(chunk: AnnotationGeometryData, annotation: Annotation) {\n  // Find insertion point.\n  const type = annotation.type;\n  let ids = chunk.typeToIds![type];\n  const handler = getAnnotationTypeHandler(type);\n  const numBytes = handler.serializedBytes;\n  const renderHandler = getAnnotationTypeRenderHandler(type);\n  let insertionPoint = binarySearch(ids, annotation.id, (a, b) => a < b ? -1 : a === b ? 0 : 1);\n  let offset = 0;\n  if (insertionPoint < 0) {\n    // Doesn't already exist.\n    insertionPoint = ~insertionPoint;\n    ids.splice(insertionPoint, 0, annotation.id);\n    const newData = new Uint8Array(chunk.data!.length + numBytes);\n    chunk.numPickIds += renderHandler.pickIdsPerInstance;\n    offset = chunk.typeToOffset![type] + numBytes * insertionPoint;\n    newData.set(chunk.data!.subarray(0, offset), 0);\n    newData.set(chunk.data!.subarray(offset), offset + numBytes);\n    chunk.data = newData;\n  } else {\n    offset = chunk.typeToOffset![type] + handler.serializedBytes * insertionPoint;\n  }\n  const serializer = handler.serializer(chunk.data!.buffer, chunk.typeToOffset![type], ids.length);\n  serializer(annotation, insertionPoint);\n  for (const otherType of annotationTypes) {\n    if (otherType > type) {\n      chunk.typeToOffset![otherType] += numBytes;\n    }\n  }\n  chunk.bufferValid = false;\n}\n\nfunction deleteAnnotation(chunk: AnnotationGeometryData, type: AnnotationType, id: AnnotationId) {\n  let ids = chunk.typeToIds![type];\n  const handler = getAnnotationTypeRenderHandler(type);\n  const numBytes = handler.bytes;\n  let insertionPoint = binarySearch(ids, id, (a, b) => a < b ? -1 : a === b ? 0 : 1);\n  if (insertionPoint < 0) {\n    return false;\n  }\n  chunk.numPickIds -= handler.pickIdsPerInstance;\n  ids.splice(insertionPoint, 1);\n  const offset = chunk.typeToOffset![type] + handler.bytes * insertionPoint;\n  const newData = new Uint8Array(chunk.data!.length - numBytes);\n  newData.set(chunk.data!.subarray(0, offset), 0);\n  newData.set(chunk.data!.subarray(offset + numBytes), offset);\n  chunk.data = newData;\n  for (const otherType of annotationTypes) {\n    if (otherType > type) {\n      chunk.typeToOffset![otherType] -= numBytes;\n    }\n  }\n  chunk.bufferValid = false;\n  return true;\n}\n\ninterface LocalUpdateUndoState {\n  /**\n   * If commitInProgress === undefined, this must be undefined.  Otherwise, it specifies a commit\n   * that has been requested and which will be initiated as soon as the in-progress request\n   * completes.\n   */\n  pendingCommit: Annotation|null|undefined;\n\n  reference: Owned<AnnotationReference>;\n\n  /**\n   * The state of the annotation prior to any local modifications.\n   */\n  existingAnnotation: Annotation|undefined;\n\n  /**\n   * If not undefined, a commit has been sent to the backend, and we are waiting for the result.\n   */\n  commitInProgress: Annotation|null|undefined;\n  type: AnnotationType;\n}\n\nfunction makeTemporaryChunk() {\n  const typeToIds: string[][] = [];\n  const typeToOffset: number[] = [];\n  for (const annotationType of annotationTypes) {\n    typeToIds[annotationType] = [];\n    typeToOffset[annotationType] = 0;\n  }\n  return new AnnotationGeometryChunk(\n      <AnnotationGeometryChunkSource><any>undefined,\n      {data: new Uint8Array(0), numPickIds: 0, typeToOffset, typeToIds});\n}\n\nexport class MultiscaleAnnotationSource extends SharedObject implements\n    MultiscaleSliceViewChunkSource, AnnotationSourceSignals {\n  metadataChunkSource =\n      this.registerDisposer(new AnnotationMetadataChunkSource(this.chunkManager, this));\n  sources: Owned<AnnotationGeometryChunkSource>[][];\n  segmentFilteredSource: Owned<AnnotationSubsetGeometryChunkSource>;\n  objectToLocal = mat4.create();\n  constructor(public chunkManager: Borrowed<ChunkManager>, options: {\n    sourceSpecifications: {parameters: any, spec: AnnotationGeometryChunkSpecification}[][]\n  }) {\n    super();\n    this.sources = options.sourceSpecifications.map(\n        alternatives => alternatives.map(\n            ({parameters, spec}) => this.registerDisposer(new AnnotationGeometryChunkSource(\n                chunkManager, {spec, parameters, parent: this}))));\n    this.segmentFilteredSource =\n        this.registerDisposer(new AnnotationSubsetGeometryChunkSource(chunkManager, this));\n  }\n\n  getSources(_options: SliceViewSourceOptions): AnnotationGeometryChunkSource[][] {\n    const {sources} = this;\n    sources.forEach(alternatives => alternatives.forEach(source => source.addRef()));\n    return sources;\n  }\n\n  temporary = makeTemporaryChunk();\n\n  references = new Map<AnnotationId, Borrowed<AnnotationReference>>();\n\n  localUpdates = new Map<AnnotationId, LocalUpdateUndoState>();\n\n  initializeCounterpart(rpc: RPC, options: any) {\n    this.metadataChunkSource.initializeCounterpart(rpc, {});\n    for (const alternatives of this.sources) {\n      for (const source of alternatives) {\n        source.initializeCounterpart(rpc, {});\n      }\n    }\n    this.segmentFilteredSource.initializeCounterpart(rpc, {});\n    options.segmentFilteredSource = this.segmentFilteredSource.addCounterpartRef();\n    options.metadataChunkSource = this.metadataChunkSource.addCounterpartRef();\n    options.sources =\n        this.sources.map(alternatives => alternatives.map(source => source.addCounterpartRef()));\n    options.chunkManager = this.chunkManager.rpcId;\n    super.initializeCounterpart(rpc, options);\n  }\n\n  add(annotation: Annotation, commit: boolean = true): AnnotationReference {\n    annotation.id = makeAnnotationId();\n    const reference = new AnnotationReference(annotation.id);\n    reference.value = annotation;\n    this.references.set(reference.id, reference);\n    reference.registerDisposer(() => {\n      this.references.delete(reference.id);\n    });\n    this.applyLocalUpdate(\n        reference, /*existing=*/ false, /*commit=*/ commit, /*newAnnotation=*/ annotation);\n    return reference;\n  }\n\n  private applyLocalUpdate(\n      reference: Borrowed<AnnotationReference>, existing: boolean, commit: boolean,\n      newAnnotation: Annotation|null): void {\n    const {localUpdates} = this;\n    const {id} = reference;\n    let localUpdate = this.localUpdates.get(id);\n    const annotation = reference.value;\n    if (annotation == null) {\n      throw new Error(`Cannot create local update from null annotation`);\n    }\n    if (localUpdate === undefined) {\n      localUpdate = {\n        type: annotation.type,\n        reference: reference.addRef(),\n        existingAnnotation: existing ? annotation : undefined,\n        pendingCommit: undefined,\n        commitInProgress: undefined,\n      };\n      localUpdates.set(id, localUpdate);\n      this.forEachPossibleChunk(annotation, chunk => {\n        deleteAnnotation(chunk.data, annotation.type, id);\n      });\n      if (newAnnotation !== null) {\n        // Add to temporary chunk.\n        updateAnnotation(this.temporary.data, newAnnotation);\n      }\n    } else {\n      if (newAnnotation === null) {\n        // Annotation has a local update already, so we need to delete it from the temporary chunk.\n        deleteAnnotation(this.temporary.data, annotation.type, annotation.id);\n      } else {\n        // Modify existing entry in temporary chunk.\n        updateAnnotation(this.temporary.data, newAnnotation);\n      }\n      reference.value = newAnnotation;\n    }\n    if (commit) {\n      if (localUpdate.commitInProgress !== undefined) {\n        localUpdate.pendingCommit = newAnnotation;\n      } else {\n        if (newAnnotation === null && localUpdate.existingAnnotation === undefined) {\n          // Local update, which we would now like to delete, has never been committed.\n          // Therefore we can just delete it locally.\n          localUpdates.delete(id);\n          localUpdate.reference.dispose();\n          return;\n        }\n        this.sendCommitRequest(localUpdate, newAnnotation);\n      }\n    }\n    this.notifyChanged(reference.id, newAnnotation || undefined);\n  }\n\n  private sendCommitRequest(localUpdate: LocalUpdateUndoState, newAnnotation: Annotation|null) {\n    this.updateCommitsInProgress(1);\n    localUpdate.commitInProgress = newAnnotation;\n    this.rpc!.invoke(ANNOTATION_COMMIT_UPDATE_RPC_ID, {\n      id: this.rpcId,\n      annotationId: localUpdate.existingAnnotation && localUpdate.reference.id,\n      newAnnotation,\n    });\n  }\n\n  delete(reference: Borrowed<AnnotationReference>) {\n    this.applyLocalUpdate(reference, /*existing=*/ true, /*commit=*/ true, /*newAnnotation=*/ null);\n  }\n\n  update(reference: AnnotationReference, newAnnotation: Annotation) {\n    this.applyLocalUpdate(\n        reference, /*existing=*/ true, /*commit=*/ false, /*newAnnotation=*/ newAnnotation);\n  }\n\n  private notifyChanged(id: AnnotationId, annotation: Annotation|undefined) {\n    const reference = this.references.get(id);\n    const chunk = this.metadataChunkSource.chunks.get(id);\n    if (chunk !== undefined) {\n      chunk.annotation = annotation || null;\n    }\n    if (reference !== undefined) {\n      reference.value = annotation || null;\n      reference.changed.dispatch();\n    }\n    this.chunkManager.chunkQueueManager.visibleChunksChanged.dispatch();\n  }\n\n  /**\n   * Must be called after `add` or `update` to commit the result.\n   */\n  commit(reference: Borrowed<AnnotationReference>) {\n    this.applyLocalUpdate(reference, /*existing=*/ true, /*commit=*/ true, reference.value!);\n  }\n\n  getReference(id: AnnotationId): Owned<AnnotationReference> {\n    let existing = this.references.get(id);\n    if (existing !== undefined) {\n      return existing.addRef();\n    }\n    existing = new AnnotationReference(id);\n    this.references.set(id, existing);\n    this.rpc!.invoke(ANNOTATION_REFERENCE_ADD_RPC_ID, {id: this.rpcId, annotation: id});\n    existing.registerDisposer(() => {\n      this.references.delete(id);\n      this.rpc!.invoke(ANNOTATION_REFERENCE_DELETE_RPC_ID, {id: this.rpcId, annotation: id});\n    });\n    const chunk = this.metadataChunkSource.chunks.get(id);\n    if (chunk !== undefined) {\n      existing.value = chunk.annotation;\n    }\n    return existing;\n  }\n\n  private forEachPossibleChunk(\n      annotation: Annotation,\n      callback: (chunk: AnnotationGeometryChunk|AnnotationSubsetGeometryChunk) => void) {\n    const {sources} = this;\n    if (sources.length !== 1 || sources[0].length !== 1) {\n      throw new Error('Not implemented');\n    }\n    const source = sources[0][0];\n    if (source.chunks.size > 1) {\n      throw new Error('Not implemented');\n    }\n    annotation;\n    for (const chunk of source.chunks.values()) {\n      callback(chunk);\n    }\n\n    const {segments} = annotation;\n    if (segments === undefined || segments.length === 0) {\n      return;\n    }\n    const {segmentFilteredSource} = this;\n    for (const segment of segments) {\n      const chunk = segmentFilteredSource.chunks.get(getObjectKey(segment));\n      if (chunk === undefined) {\n        continue;\n      }\n      callback(chunk);\n    }\n  }\n\n  static encodeOptions(_options: {}): {[key: string]: any} {\n    return {};\n  }\n\n  handleSuccessfulUpdate(id: AnnotationId, newAnnotation: Annotation|null) {\n    const localUpdate = this.localUpdates.get(id);\n    if (localUpdate === undefined || localUpdate.commitInProgress === undefined) {\n      throw new Error(`Received invalid successful update notification`);\n    }\n    this.updateCommitsInProgress(-1);\n    if (newAnnotation !== null && localUpdate.reference.id !== newAnnotation.id) {\n      if (localUpdate.commitInProgress === null) {\n        throw new Error(`Received invalid successful update notification`);\n      }\n      localUpdate.reference.id = newAnnotation.id;\n      this.references.delete(id);\n      this.references.set(newAnnotation.id, localUpdate.reference);\n      this.localUpdates.delete(id);\n      this.localUpdates.set(newAnnotation.id, localUpdate);\n      if (localUpdate.reference.value !== null) {\n        localUpdate.reference.value!.id = newAnnotation.id;\n        deleteAnnotation(this.temporary.data, localUpdate.type, id);\n        updateAnnotation(this.temporary.data, localUpdate.reference.value!);\n      }\n      localUpdate.reference.changed.dispatch();\n    }\n    localUpdate.existingAnnotation = newAnnotation || undefined;\n    localUpdate.commitInProgress = undefined;\n    let {pendingCommit} = localUpdate;\n    localUpdate.pendingCommit = undefined;\n    if (newAnnotation === null) {\n      pendingCommit = undefined;\n    }\n    if (pendingCommit !== undefined) {\n      if (pendingCommit !== null) {\n        pendingCommit.id = newAnnotation!.id;\n      }\n      this.sendCommitRequest(localUpdate, pendingCommit);\n    } else {\n      this.revertLocalUpdate(localUpdate);\n    }\n  }\n\n  private numCommitsInProgress = 0;\n\n  private commitStatus: StatusMessage|undefined;\n\n  disposed() {\n    const {commitStatus} = this;\n    if (commitStatus !== undefined) {\n      commitStatus.dispose();\n    }\n  }\n\n  private updateCommitsInProgress(amount: number) {\n    this.numCommitsInProgress += amount;\n    if (this.numCommitsInProgress === 0) {\n      if (this.commitStatus !== undefined) {\n        this.commitStatus.dispose();\n        this.commitStatus = undefined;\n      }\n    } else if (this.commitStatus === undefined) {\n      const status = this.commitStatus = new StatusMessage(/*delay=*/ true);\n      status.setText('Commiting annotations');\n    }\n  }\n\n  handleFailedUpdate(id: AnnotationId, message: string) {\n    const localUpdate = this.localUpdates.get(id);\n    if (localUpdate === undefined || localUpdate.commitInProgress === undefined) {\n      throw new Error(`Received invalid update notification`);\n    }\n    const status = new StatusMessage();\n    status.setErrorMessage(`Error commiting annotation update: ${message}`);\n    this.revertLocalUpdate(localUpdate);\n    this.updateCommitsInProgress(-1);\n  }\n\n  private revertLocalUpdate(localUpdate: LocalUpdateUndoState) {\n    deleteAnnotation(this.temporary.data, localUpdate.type, localUpdate.reference.id);\n    const {existingAnnotation} = localUpdate;\n    if (existingAnnotation !== undefined) {\n      this.forEachPossibleChunk(existingAnnotation, chunk => {\n        updateAnnotation(chunk.data, existingAnnotation);\n      });\n    }\n    const {reference} = localUpdate;\n    const {id} = reference;\n\n    reference.value = existingAnnotation || null;\n    reference.changed.dispatch();\n\n    reference.dispose();\n\n    this.localUpdates.delete(id);\n  }\n\n  // FIXME\n  changed = new NullarySignal();\n  * [Symbol.iterator](): Iterator<Annotation> {}\n  readonly = false;\n  childAdded: Signal<(annotation: Annotation) => void>;\n  childUpdated: Signal<(annotation: Annotation) => void>;\n  childDeleted: Signal<(annotationId: string) => void>;\n}\n\nregisterRPC(ANNOTATION_COMMIT_UPDATE_RESULT_RPC_ID, function(x) {\n  const source = <MultiscaleAnnotationSource>this.get(x.id);\n  const annotationId: AnnotationId = x.annotationId;\n  const error: string|undefined = x.error;\n  if (error !== undefined) {\n    source.handleFailedUpdate(annotationId, error);\n  } else {\n    const newAnnotation: Annotation|null = deserializeAnnotation(x.newAnnotation);\n    source.handleSuccessfulUpdate(annotationId, newAnnotation);\n  }\n});\n\nexport class DataFetchSliceViewRenderLayer extends RenderLayer {\n  sources: AnnotationGeometryChunkSource[][];\n\n  constructor(multiscaleSource: MultiscaleAnnotationSource) {\n    super(multiscaleSource.chunkManager, multiscaleSource.getSources({}), {});\n  }\n\n  // Does nothing.\n  draw() {}\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport type RelativeDragHandler = (event: MouseEvent, deltaX: number, deltaY: number) => void;\nexport function startRelativeMouseDrag(\n    initialEvent: MouseEvent, handler: RelativeDragHandler,\n    finishDragHandler?: RelativeDragHandler) {\n  let {document} = initialEvent.view;\n  let prevClientX = initialEvent.clientX, prevClientY = initialEvent.clientY;\n  const mouseMoveHandler = (e: PointerEvent) => {\n    const deltaX = e.clientX - prevClientX;\n    const deltaY = e.clientY - prevClientY;\n    prevClientX = e.clientX;\n    prevClientY = e.clientY;\n    handler(e, deltaX, deltaY);\n  };\n  const button = initialEvent.button;\n  const cancel = (e: PointerEvent) => {\n    document.removeEventListener('pointermove', mouseMoveHandler, true);\n    document.removeEventListener('pointerup', mouseUpHandler, false);\n\n    if (finishDragHandler !== undefined) {\n      finishDragHandler(e, e.clientX - prevClientX, e.clientY - prevClientY);\n    }\n  };\n  const mouseUpHandler = (e: PointerEvent) => {\n    if (e.button === button) {\n      cancel(e);\n    }\n  };\n  document.addEventListener('pointermove', mouseMoveHandler, true);\n  document.addEventListener('pointerup', mouseUpHandler, false);\n  document.addEventListener('pointercancel', cancel, false);\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for drawing anti-aliased lines in WebGL as quads.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {QuadRenderHelper, VERTICES_PER_QUAD} from 'neuroglancer/webgl/quad';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {getSquareCornersBuffer} from 'neuroglancer/webgl/square_corners_buffer';\n\nexport const VERTICES_PER_LINE = VERTICES_PER_QUAD;\n\nexport class LineShader extends RefCounted {\n  private lineOffsetsBuffer: Buffer;\n  private quadHelper: QuadRenderHelper;\n\n  constructor(gl: GL, public linesPerInstance: number = 1) {\n    super();\n    this.lineOffsetsBuffer =\n        getSquareCornersBuffer(gl, 0, -1, 1, 1, /*minorTiles=*/linesPerInstance, /*majorTiles=*/1);\n    this.quadHelper = this.registerDisposer(new QuadRenderHelper(gl, linesPerInstance));\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    builder.addAttribute('highp vec2', 'aLineOffset');\n\n    // x: line width in normalized device x coordinates\n    // y: line height in normalized device y coordinates\n    // z: Fraction of line width that is feathered\n    builder.addUniform('highp vec3', 'uLineParams');\n    builder.addVarying('highp float', 'vLineCoord');\n\n    builder.addVertexCode(`\nuint getLineEndpointIndex() { return uint(aLineOffset.x); }\n`);\n\n    builder.addVertexCode(`\nvoid emitLine(mat4 projection, vec3 vertexA, vec3 vertexB) {\n  vec3 vertexPosition = mix(vertexA, vertexB, aLineOffset.x);\n  vec3 otherVertexPosition = mix(vertexB, vertexA, aLineOffset.x);\n\n  vec4 vertexPositionClip = projection * vec4(vertexPosition, 1.0);\n  vec4 otherVertexPositionClip = projection * vec4(otherVertexPosition, 1.0);\n\n  vec3 vertexPositionDevice = vertexPositionClip.xyz / vertexPositionClip.w;\n  vec3 otherVertexPositionDevice = otherVertexPositionClip.xyz / otherVertexPositionClip.w;\n\n  vec2 lineDirection = normalize(otherVertexPositionDevice.xy - vertexPositionDevice.xy);\n  vec2 lineNormal = vec2(lineDirection.y, -lineDirection.x);\n\n  gl_Position = vertexPositionClip;\n  gl_Position.xy += aLineOffset.y * (2.0 * aLineOffset.x - 1.0) * lineNormal * uLineParams.xy * 0.5 * gl_Position.w;\n  vLineCoord = aLineOffset.y;\n}\n`);\n\n    builder.addFragmentCode(`\nfloat getLineAlpha() {\n  return clamp((1.0 - abs(vLineCoord)) / uLineParams.z, 0.0, 1.0);\n}\n`);\n  }\n\n  draw(\n      shader: ShaderProgram, renderContext: {viewportWidth: number, viewportHeight: number},\n      lineWidthInPixels: number, featherWidthInPixels: number, numInstances: number) {\n    const aLineOffset = shader.attribute('aLineOffset');\n    this.lineOffsetsBuffer.bindToVertexAttrib(aLineOffset, /*components=*/2);\n\n    const lineWidthIncludingFeather = lineWidthInPixels + featherWidthInPixels;\n    const {gl} = shader;\n    gl.uniform3f(\n        shader.uniform('uLineParams'), lineWidthIncludingFeather / renderContext.viewportWidth,\n        lineWidthIncludingFeather / renderContext.viewportHeight,\n        featherWidthInPixels === 0 ? 1e-6 : featherWidthInPixels / lineWidthIncludingFeather);\n    this.quadHelper.draw(gl, numInstances);\n    gl.disableVertexAttribArray(aLineOffset);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Permits a CredentialsProvider to be shared with another thread.\n */\n\nimport {CREDENTIALS_PROVIDER_RPC_ID, CREDENTIALS_PROVIDER_GET_RPC_ID} from 'neuroglancer/credentials_provider/shared_common';\nimport {CredentialsProvider, CredentialsWithGeneration} from 'neuroglancer/credentials_provider';\nimport {CancellationToken} from 'neuroglancer/util/cancellation';\nimport {Owned} from 'neuroglancer/util/disposable';\nimport {registerPromiseRPC, registerSharedObjectOwner, RPC, RPCPromise, SharedObject} from 'neuroglancer/worker_rpc';\n\n@registerSharedObjectOwner(CREDENTIALS_PROVIDER_RPC_ID)\nexport class SharedCredentialsProvider<Credentials> extends SharedObject implements\n    CredentialsProvider<Credentials> {\n  constructor(public provider: Owned<CredentialsProvider<Credentials>>, rpc: RPC) {\n    super();\n    this.registerDisposer(provider);\n    this.initializeCounterpart(rpc);\n  }\n\n  get(invalidCredentials?: CredentialsWithGeneration<Credentials>,\n      cancellationToken?: CancellationToken): Promise<CredentialsWithGeneration<Credentials>> {\n    return this.provider.get(invalidCredentials, cancellationToken);\n  }\n}\n\nregisterPromiseRPC(\n    CREDENTIALS_PROVIDER_GET_RPC_ID,\n    function(\n        this: RPC, x: {providerId: number, invalidCredentials: any}, cancellationToken: CancellationToken):\n        RPCPromise<CredentialsWithGeneration<any>> {\n          const obj = <SharedCredentialsProvider<any>>this.get(x.providerId);\n          return obj.get(x.invalidCredentials, cancellationToken).then(credentials => ({\n                                                                         value: credentials\n                                                                       }));\n        });\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nexport const CREDENTIALS_PROVIDER_RPC_ID = 'CredentialsProvider';\nexport const CREDENTIALS_PROVIDER_GET_RPC_ID = 'CredentialsProvider.get';\n\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities to simplify defining subclasses of ChunkSource that use a CredentialsProvider.\n */\n\nimport {ChunkManager, ChunkSourceConstructor} from 'neuroglancer/chunk_manager/frontend';\nimport {CredentialsProvider} from 'neuroglancer/credentials_provider';\nimport {SharedCredentialsProvider} from 'neuroglancer/credentials_provider/shared';\nimport {Borrowed, Owned} from 'neuroglancer/util/disposable';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {RPC, SharedObject} from 'neuroglancer/worker_rpc';\n\n/**\n * Returns a counterpart ref to be sent to the backend to retrieve a\n * SharedCredentialsProviderCounterpart that forwards to `credentialsProvider`.\n */\nexport function getCredentialsProviderCounterpart<Credentials>(\n    chunkManager: ChunkManager, credentialsProvider: Borrowed<CredentialsProvider<Credentials>>) {\n  const sharedCredentialsProvider = chunkManager.memoize.get(\n      {type: 'getSharedCredentialsProvider', credentialsProvider: getObjectId(credentialsProvider)},\n      () => new SharedCredentialsProvider(credentialsProvider.addRef(), chunkManager.rpc!));\n  const counterpartRef = sharedCredentialsProvider.addCounterpartRef();\n  sharedCredentialsProvider.dispose();\n  return counterpartRef;\n}\n\n/**\n * Mixin for adding a credentialsProvider member to a ChunkSource.\n */\nexport function WithCredentialsProvider<Credentials>() {\n  return function<BaseOptions, TBase extends ChunkSourceConstructor<\n                      BaseOptions, SharedObject&{chunkManager: ChunkManager}>>(Base: TBase) {\n    type Options = BaseOptions&{credentialsProvider: Borrowed<CredentialsProvider<Credentials>>};\n    return class extends Base {\n      credentialsProvider: Owned<CredentialsProvider<Credentials>>;\n      constructor(...args: any[]) {\n        super(...args);\n        const options: Options = args[1];\n        this.credentialsProvider = options.credentialsProvider.addRef();\n      }\n      initializeCounterpart(rpc: RPC, options: any) {\n        options['credentialsProvider'] =\n            getCredentialsProviderCounterpart(this.chunkManager, this.credentialsProvider);\n        super.initializeCounterpart(rpc, options);\n      }\n      static encodeOptions(options: Options) {\n        const encoding = super.encodeOptions(options);\n        encoding.credentialsProvider = getObjectId(options.credentialsProvider);\n        return encoding;\n      }\n    };\n  };\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {RenderLayer as GenericRenderLayer} from 'neuroglancer/layer';\nimport {RenderScaleHistogram, trackableRenderScaleTarget} from 'neuroglancer/render_scale_statistics';\nimport {SharedWatchableValue} from 'neuroglancer/shared_watchable_value';\nimport {getTransformedSources, SLICEVIEW_RENDERLAYER_RPC_ID, SLICEVIEW_RENDERLAYER_UPDATE_TRANSFORM_RPC_ID, TransformedSource} from 'neuroglancer/sliceview/base';\nimport {SliceView, SliceViewChunkSource} from 'neuroglancer/sliceview/frontend';\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {RpcId} from 'neuroglancer/worker_rpc';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\nexport interface RenderLayerOptions {\n  transform?: CoordinateTransform;\n  renderScaleTarget?: WatchableValueInterface<number>;\n  renderScaleHistogram?: RenderScaleHistogram;\n}\n\nexport abstract class RenderLayer extends GenericRenderLayer {\n  rpcId: RpcId|null = null;\n  transform: CoordinateTransform;\n  transformedSources: TransformedSource<SliceViewChunkSource>[][];\n  transformedSourcesGeneration = -1;\n  renderScaleTarget: WatchableValueInterface<number>;\n  renderScaleHistogram?: RenderScaleHistogram;\n\n  constructor(\n      public chunkManager: ChunkManager, public sources: SliceViewChunkSource[][],\n      options: RenderLayerOptions) {\n    super();\n\n    const {\n      transform = new CoordinateTransform(),\n      renderScaleTarget = trackableRenderScaleTarget(1)\n    } = options;\n    this.renderScaleTarget = renderScaleTarget;\n    this.renderScaleHistogram = options.renderScaleHistogram;\n    this.transform = transform;\n    const transformedSources = getTransformedSources(this);\n\n    {\n      const {source, chunkLayout} = transformedSources[0][0];\n      const {spec} = source;\n      const voxelSize = this.voxelSize =\n          chunkLayout.localSpatialVectorToGlobal(vec3.create(), spec.voxelSize);\n      for (let i = 0; i < 3; ++i) {\n        voxelSize[i] = Math.abs(voxelSize[i]);\n      }\n    }\n\n    const sharedObject = this.registerDisposer(new SharedObject());\n    const rpc = this.chunkManager.rpc!;\n    sharedObject.RPC_TYPE_ID = SLICEVIEW_RENDERLAYER_RPC_ID;\n    const sourceIds = sources.map(alternatives => alternatives.map(source => source.rpcId!));\n    sharedObject.initializeCounterpart(rpc, {\n      sources: sourceIds,\n      transform: transform.transform,\n      renderScaleTarget:\n          this.registerDisposer(SharedWatchableValue.makeFromExisting(rpc, this.renderScaleTarget))\n              .rpcId\n    });\n    this.rpcId = sharedObject.rpcId;\n\n    this.registerDisposer(transform.changed.add(() => {\n      rpc.invoke(\n          SLICEVIEW_RENDERLAYER_UPDATE_TRANSFORM_RPC_ID,\n          {id: this.rpcId, value: transform.transform});\n    }));\n\n    this.setReady(true);\n  }\n\n  get gl() {\n    return this.chunkManager.chunkQueueManager.gl;\n  }\n\n  setGLBlendMode(gl: WebGL2RenderingContext, renderLayerNum: number): void {\n    // Default blend mode for non-blend-mode-aware layers\n    if (renderLayerNum > 0) {\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n    }\n  }\n  abstract draw(sliceView: SliceView): void;\n}\n","// DO NOT EDIT.  Generated from templates/neuroglancer/util/linked_list.template.ts.\n/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ninterface Node<T> {\n  next0: T|null;\n  prev0: T|null;\n}\n\nexport default class {\n  static insertAfter<T extends Node<T>>(head: T, x: T) {\n    let next = <T>head.next0;\n    x.next0 = next;\n    x.prev0 = head;\n    head.next0 = x;\n    next.prev0 = x;\n  }\n  static insertBefore<T extends Node<T>>(head: T, x: T) {\n    let prev = <T>head.prev0;\n    x.prev0 = prev;\n    x.next0 = head;\n    head.prev0 = x;\n    prev.next0 = x;\n  }\n  static front<T extends Node<T>>(head: T) {\n    let next = head.next0;\n    if (next === head) {\n      return null;\n    }\n    return next;\n  }\n  static back<T extends Node<T>>(head: T) {\n    let next = head.prev0;\n    if (next === head) {\n      return null;\n    }\n    return next;\n  }\n  static pop<T extends Node<T>>(x: T) {\n    let next = <T>x.next0;\n    let prev = <T>x.prev0;\n    next.prev0 = prev;\n    prev.next0 = next;\n    x.next0 = null;\n    x.prev0 = null;\n    return x;\n  }\n  static * iterator<T extends Node<T>>(head: T) {\n    for (let x = <T>head.next0; x !== head; x = <T>x.next0) {\n      yield x;\n    }\n  }\n  static * reverseIterator<T extends Node<T>>(head: T) {\n    for (let x = <T>head.prev0; x !== head; x = <T>x.prev0) {\n      yield x;\n    }\n  }\n  static initializeHead<T extends Node<T>>(head: T) {\n    head.next0 = head.prev0 = head;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport LinkedListOperations from 'neuroglancer/util/linked_list.0';\n\nclass AutomaticFocusList {\n  next0: AutomaticallyFocusedElement|null;\n  prev0: AutomaticallyFocusedElement|null;\n\n  constructor() {\n    LinkedListOperations.initializeHead(<any>this);\n  }\n}\n\nconst automaticFocusList = new AutomaticFocusList();\n\nconst maybeUpdateFocus = debounce(() => {\n  const {activeElement} = document;\n  if (activeElement === null || activeElement === document.body) {\n    const node = LinkedListOperations.front<AutomaticallyFocusedElement>(<any>automaticFocusList);\n    if (node !== null) {\n      node.element.focus();\n    }\n  }\n});\n\nwindow.addEventListener('focus', () => {\n  maybeUpdateFocus();\n}, true);\n\nwindow.addEventListener('blur', () => {\n  maybeUpdateFocus();\n}, true);\n\nexport class AutomaticallyFocusedElement extends RefCounted {\n  prev0: AutomaticallyFocusedElement|null = null;\n  next0: AutomaticallyFocusedElement|null = null;\n\n  private lastFocusedElement: Element|null = null;\n\n  private scheduleUpdateFocus = this.registerCancellable(debounce(() => {\n    const {activeElement} = document;\n    const {element} = this;\n    if (element.contains(activeElement)) {\n      // Never steal focus from descendant.\n      return;\n    }\n    if (activeElement != null &&\n        (activeElement === this.lastFocusedElement || activeElement.contains(element))) {\n      this.element.focus();\n    }\n    this.lastFocusedElement = null;\n  }, 0));\n\n  constructor(public element: HTMLElement) {\n    super();\n    element.tabIndex = -1;\n    this.registerEventListener(element, 'mouseenter', () => {\n      this.lastFocusedElement = document.activeElement;\n      this.scheduleUpdateFocus();\n    });\n    this.registerEventListener(element, 'mouseleave', () => {\n      this.scheduleUpdateFocus.cancel();\n    });\n    // Insert at the end of the list.\n    LinkedListOperations.insertBefore(<any>automaticFocusList, this);\n    this.registerEventListener(element, 'focus', () => {\n      // Move to the beginning of the list.\n      LinkedListOperations.pop<AutomaticallyFocusedElement>(this);\n      LinkedListOperations.insertAfter(<any>automaticFocusList, this);\n    });\n    maybeUpdateFocus();\n  }\n\n  disposed() {\n    LinkedListOperations.pop<AutomaticallyFocusedElement>(this);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AxesLineHelper} from 'neuroglancer/axes_lines';\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {makeRenderedPanelVisibleLayerTracker, VisibilityTrackedRenderLayer} from 'neuroglancer/layer';\nimport {PickIDManager} from 'neuroglancer/object_picking';\nimport {FramePickingData, RenderedDataPanel, RenderedDataViewerState} from 'neuroglancer/rendered_data_panel';\nimport {SliceView, SliceViewRenderHelper} from 'neuroglancer/sliceview/frontend';\nimport {TrackableBoolean} from 'neuroglancer/trackable_boolean';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {ActionEvent, registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {identityMat4, mat4, vec3, vec4} from 'neuroglancer/util/geom';\nimport {startRelativeMouseDrag} from 'neuroglancer/util/mouse_drag';\nimport {TouchRotateInfo} from 'neuroglancer/util/touch_bindings';\nimport {FramebufferConfiguration, OffscreenCopyHelper, TextureBuffer} from 'neuroglancer/webgl/offscreen';\nimport {ShaderBuilder, ShaderModule} from 'neuroglancer/webgl/shader';\nimport {ScaleBarTexture, TrackableScaleBarOptions} from 'neuroglancer/widget/scale_bar';\n\nexport interface SliceViewerState extends RenderedDataViewerState {\n  showScaleBar: TrackableBoolean;\n  scaleBarOptions: TrackableScaleBarOptions;\n  crossSectionBackgroundColor: TrackableRGB;\n}\n\nexport enum OffscreenTextures {\n  COLOR,\n  PICK,\n  NUM_TEXTURES\n}\n\nfunction sliceViewPanelEmitColor(builder: ShaderBuilder) {\n  builder.addOutputBuffer('vec4', 'out_fragColor', null);\n  builder.addFragmentCode(`\nvoid emit(vec4 color, highp uint pickId) {\n  out_fragColor = color;\n}\n`);\n}\n\nfunction sliceViewPanelEmitPickID(builder: ShaderBuilder) {\n  builder.addOutputBuffer('highp float', 'out_pickId', null);\n  builder.addFragmentCode(`\nvoid emit(vec4 color, highp uint pickId) {\n  out_pickId = float(pickId);\n}\n`);\n}\n\n\nexport interface SliceViewPanelRenderContext {\n  dataToDevice: mat4;\n  pickIDs: PickIDManager;\n  emitter: ShaderModule;\n\n  /**\n   * Specifies whether the emitted color value will be used.\n   */\n  emitColor: boolean;\n\n  /**\n   * Specifies whether the emitted pick ID will be used.\n   */\n  emitPickID: boolean;\n\n  /**\n   * Width of GL viewport in pixels.\n   */\n  viewportWidth: number;\n\n  /**\n   * Height of GL viewport in pixels.\n   */\n  viewportHeight: number;\n\n  sliceView: SliceView;\n}\n\nexport class SliceViewPanelRenderLayer extends VisibilityTrackedRenderLayer {\n  draw(_renderContext: SliceViewPanelRenderContext) {\n    // Must be overridden by subclasses.\n  }\n\n  isReady() {\n    return true;\n  }\n}\n\nconst tempVec4 = vec4.create();\n\nexport class SliceViewPanel extends RenderedDataPanel {\n  viewer: SliceViewerState;\n\n  private axesLineHelper = this.registerDisposer(AxesLineHelper.get(this.gl));\n  private sliceViewRenderHelper =\n      this.registerDisposer(SliceViewRenderHelper.get(this.gl, sliceViewPanelEmitColor));\n  private colorFactor = vec4.fromValues(1, 1, 1, 1);\n  private pickIDs = new PickIDManager();\n\n  private visibleLayerTracker = makeRenderedPanelVisibleLayerTracker(\n      this.viewer.layerManager, SliceViewPanelRenderLayer, this.viewer.visibleLayerRoles, this);\n\n  private offscreenFramebuffer = this.registerDisposer(new FramebufferConfiguration(this.gl, {\n    colorBuffers: [\n      new TextureBuffer(\n          this.gl, WebGL2RenderingContext.RGBA8, WebGL2RenderingContext.RGBA,\n          WebGL2RenderingContext.UNSIGNED_BYTE),\n      new TextureBuffer(\n          this.gl, WebGL2RenderingContext.R32F, WebGL2RenderingContext.RED,\n          WebGL2RenderingContext.FLOAT),\n    ]\n  }));\n\n  private offscreenCopyHelper = this.registerDisposer(OffscreenCopyHelper.get(this.gl));\n  private scaleBarCopyHelper = this.registerDisposer(OffscreenCopyHelper.get(this.gl));\n\n  private scaleBarTexture = this.registerDisposer(new ScaleBarTexture(this.gl));\n\n  get navigationState() {\n    return this.sliceView.navigationState;\n  }\n\n  constructor(\n      context: DisplayContext, element: HTMLElement, public sliceView: SliceView,\n      viewer: SliceViewerState) {\n    super(context, element, viewer);\n\n    registerActionListener(element, 'rotate-via-mouse-drag', (e: ActionEvent<MouseEvent>) => {\n      const {mouseState} = this.viewer;\n      if (mouseState.updateUnconditionally()) {\n        const initialPosition = vec3.clone(mouseState.position);\n        startRelativeMouseDrag(e.detail, (_event, deltaX, deltaY) => {\n          let {viewportAxes} = this.sliceView;\n          this.viewer.navigationState.pose.rotateAbsolute(\n              viewportAxes[1], -deltaX / 4.0 * Math.PI / 180.0, initialPosition);\n          this.viewer.navigationState.pose.rotateAbsolute(\n              viewportAxes[0], -deltaY / 4.0 * Math.PI / 180.0, initialPosition);\n        });\n      }\n    });\n\n    registerActionListener(\n        element, 'rotate-in-plane-via-touchrotate', (e: ActionEvent<TouchRotateInfo>) => {\n          const {detail} = e;\n          const {mouseState} = this.viewer;\n          this.handleMouseMove(detail.centerX, detail.centerY);\n          if (mouseState.updateUnconditionally()) {\n            const {viewportAxes} = this.sliceView;\n            this.navigationState.pose.rotateAbsolute(\n                viewportAxes[2], detail.angle - detail.prevAngle, mouseState.position);\n          }\n        });\n\n    this.registerDisposer(sliceView);\n    this.registerDisposer(\n        viewer.crossSectionBackgroundColor.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(sliceView.visibility.add(this.visibility));\n    this.registerDisposer(sliceView.viewChanged.add(() => {\n      if (this.visible) {\n        context.scheduleRedraw();\n      }\n    }));\n    this.registerDisposer(viewer.showAxisLines.changed.add(() => {\n      if (this.visible) {\n        this.scheduleRedraw();\n      }\n    }));\n\n    this.registerDisposer(viewer.showScaleBar.changed.add(() => {\n      if (this.visible) {\n        this.context.scheduleRedraw();\n      }\n    }));\n    this.registerDisposer(viewer.scaleBarOptions.changed.add(() => {\n      if (this.visible) {\n        this.context.scheduleRedraw();\n      }\n    }));\n  }\n\n  translateByViewportPixels(deltaX: number, deltaY: number): void {\n    const {position} = this.viewer.navigationState;\n    const pos = position.spatialCoordinates;\n    vec3.set(pos, -deltaX, -deltaY, 0);\n    vec3.transformMat4(pos, pos, this.sliceView.viewportToData);\n    position.changed.dispatch();\n  }\n\n  translateDataPointByViewportPixels(out: vec3, orig: vec3, deltaX: number, deltaY: number): vec3 {\n    vec3.transformMat4(out, orig, this.sliceView.dataToViewport);\n    vec3.set(out, out[0] + deltaX, out[1] + deltaY, out[2]);\n    vec3.transformMat4(out, out, this.sliceView.viewportToData);\n    return out;\n  }\n\n  isReady() {\n    if (!this.visible) {\n      return false;\n    }\n\n    if (!this.sliceView.isReady()) {\n      return false;\n    }\n\n    let visibleLayers = this.visibleLayerTracker.getVisibleLayers();\n    for (let renderLayer of visibleLayers) {\n      if (!renderLayer.isReady()) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  drawWithPicking(pickingData: FramePickingData): boolean {\n    let {sliceView} = this;\n    sliceView.setViewportSize(this.width, this.height);\n    sliceView.updateRendering();\n    if (!sliceView.hasValidViewport) {\n      return false;\n    }\n    mat4.copy(pickingData.invTransform, sliceView.viewportToData);\n    const {gl} = this;\n\n    const {width, height, dataToDevice} = sliceView;\n    this.offscreenFramebuffer.bind(width, height);\n    gl.disable(WebGL2RenderingContext.SCISSOR_TEST);\n    this.gl.clearColor(0.0, 0.0, 0.0, 0.0);\n    gl.clear(WebGL2RenderingContext.COLOR_BUFFER_BIT);\n\n    // Draw axes lines.\n    // FIXME: avoid use of temporary matrix\n    let mat = mat4.create();\n\n    const backgroundColor = tempVec4;\n    const crossSectionBackgroundColor = this.viewer.crossSectionBackgroundColor.value;\n    backgroundColor[0] = crossSectionBackgroundColor[0];\n    backgroundColor[1] = crossSectionBackgroundColor[1];\n    backgroundColor[2] = crossSectionBackgroundColor[2];\n    backgroundColor[3] = 1;\n\n    this.offscreenFramebuffer.bindSingle(OffscreenTextures.COLOR);\n    this.sliceViewRenderHelper.draw(\n        sliceView.offscreenFramebuffer.colorBuffers[0].texture, identityMat4, this.colorFactor,\n        backgroundColor, 0, 0, 1, 1);\n\n    let visibleLayers = this.visibleLayerTracker.getVisibleLayers();\n    let {pickIDs} = this;\n    pickIDs.clear();\n    let renderContext: SliceViewPanelRenderContext = {\n      dataToDevice: sliceView.dataToDevice,\n      pickIDs: pickIDs,\n      emitter: sliceViewPanelEmitColor,\n      emitColor: true,\n      emitPickID: false,\n      viewportWidth: width,\n      viewportHeight: height,\n      sliceView,\n    };\n    gl.enable(WebGL2RenderingContext.BLEND);\n    gl.blendFunc(WebGL2RenderingContext.SRC_ALPHA, WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA);\n    for (let renderLayer of visibleLayers) {\n      renderLayer.draw(renderContext);\n    }\n    gl.disable(WebGL2RenderingContext.BLEND);\n    this.offscreenFramebuffer.bindSingle(OffscreenTextures.PICK);\n    renderContext.emitColor = false;\n    renderContext.emitPickID = true;\n    renderContext.emitter = sliceViewPanelEmitPickID;\n\n    for (let renderLayer of visibleLayers) {\n      renderLayer.draw(renderContext);\n    }\n\n    if (this.viewer.showAxisLines.value || this.viewer.showScaleBar.value) {\n      if (this.viewer.showAxisLines.value) {\n        // Construct matrix that maps [-1, +1] x/y range to the full viewport data\n        // coordinates.\n        mat4.copy(mat, dataToDevice);\n        for (let i = 0; i < 3; ++i) {\n          mat[12 + i] = 0;\n        }\n\n        for (let i = 0; i < 4; ++i) {\n          mat[2 + 4 * i] = 0;\n        }\n\n\n        let axisLength = Math.min(width, height) / 4 * 1.5;\n        let pixelSize = sliceView.pixelSize;\n        for (let i = 0; i < 12; ++i) {\n          // pixelSize is nm / pixel\n          //\n          mat[i] *= axisLength * pixelSize;\n        }\n      }\n      this.offscreenFramebuffer.bindSingle(OffscreenTextures.COLOR);\n      if (this.viewer.showAxisLines.value) {\n        this.axesLineHelper.draw(mat);\n      }\n      if (this.viewer.showScaleBar.value) {\n        gl.enable(WebGL2RenderingContext.BLEND);\n        gl.blendFunc(WebGL2RenderingContext.SRC_ALPHA, WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA);\n        const options = this.viewer.scaleBarOptions.value;\n        const {scaleBarTexture} = this;\n        const {dimensions} = scaleBarTexture;\n        dimensions.targetLengthInPixels = Math.min(\n            options.maxWidthFraction * width, options.maxWidthInPixels * options.scaleFactor);\n        dimensions.nanometersPerPixel = sliceView.pixelSize;\n        scaleBarTexture.update(options);\n        gl.viewport(\n            options.leftPixelOffset * options.scaleFactor,\n            options.bottomPixelOffset * options.scaleFactor, scaleBarTexture.width,\n            scaleBarTexture.height);\n        this.scaleBarCopyHelper.draw(scaleBarTexture.texture);\n        gl.disable(WebGL2RenderingContext.BLEND);\n      }\n    }\n\n    this.offscreenFramebuffer.unbind();\n\n    // Draw the texture over the whole viewport.\n    this.setGLViewport();\n    this.offscreenCopyHelper.draw(\n        this.offscreenFramebuffer.colorBuffers[OffscreenTextures.COLOR].texture);\n    return true;\n  }\n\n  panelSizeChanged() {\n    this.sliceView.setViewportSizeDebounced(this.width, this.height);\n  }\n\n  issuePickRequest(glWindowX: number, glWindowY: number) {\n    const {offscreenFramebuffer} = this;\n    offscreenFramebuffer.readPixelFloat32IntoBuffer(\n        OffscreenTextures.PICK, glWindowX, glWindowY, 0);\n  }\n\n  completePickRequest(\n      glWindowX: number, glWindowY: number, data: Float32Array, pickingData: FramePickingData) {\n    const {mouseState} = this.viewer;\n    mouseState.pickedRenderLayer = null;\n    const out = mouseState.position;\n    const {viewportWidth, viewportHeight} = pickingData;\n    const y = pickingData.viewportHeight - glWindowY;\n    vec3.set(out, glWindowX - viewportWidth / 2, y - viewportHeight / 2, 0);\n    vec3.transformMat4(out, out, pickingData.invTransform);\n    this.pickIDs.setMouseState(mouseState, data[0]);\n    mouseState.setActive(true);\n  }\n\n  /**\n   * Zooms by the specified factor, maintaining the data position that projects to the current mouse\n   * position.\n   */\n  zoomByMouse(factor: number) {\n    let {navigationState} = this;\n    if (!navigationState.valid) {\n      return;\n    }\n    let {sliceView} = this;\n    let {width, height} = sliceView;\n    let {mouseX, mouseY} = this;\n    mouseX -= width / 2;\n    mouseY -= height / 2;\n    let oldZoom = this.navigationState.zoomFactor.value;\n    // oldPosition + (mouseX * viewportAxes[0] + mouseY * viewportAxes[1]) * oldZoom\n    //     === newPosition + (mouseX * viewportAxes[0] + mouseY * viewportAxes[1]) * newZoom\n\n    // Therefore, we compute newPosition by:\n    // newPosition = oldPosition + (viewportAxes[0] * mouseX +\n    //                              viewportAxes[1] * mouseY) * (oldZoom - newZoom).\n    navigationState.zoomBy(factor);\n    let newZoom = navigationState.zoomFactor.value;\n\n    let {spatialCoordinates} = navigationState.position;\n    vec3.scaleAndAdd(\n        spatialCoordinates, spatialCoordinates, sliceView.viewportAxes[0],\n        mouseX * (oldZoom - newZoom));\n    vec3.scaleAndAdd(\n        spatialCoordinates, spatialCoordinates, sliceView.viewportAxes[1],\n        mouseY * (oldZoom - newZoom));\n    navigationState.position.changed.dispatch();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Converts an HSV color (with h, s, v in [0,1]) to RGB (in range [0,1]).\n *\n * Based on goog/color/color.js in the Google Closure library.\n */\nexport function hsvToRgb(out: Float32Array, h: number, s: number, v: number): Float32Array {\n  h *= 6;\n  let hueIndex = Math.floor(h);\n  let remainder = h - hueIndex;\n  let val1 = v * (1 - s);\n  let val2 = v * (1 - (s * remainder));\n  let val3 = v * (1 - (s * (1 - remainder)));\n  switch (hueIndex % 6) {\n    case 0:\n      out[0] = v;\n      out[1] = val3;\n      out[2] = val1;\n      break;\n    case 1:\n      out[0] = val2;\n      out[1] = v;\n      out[2] = val1;\n      break;\n    case 2:\n      out[0] = val1;\n      out[1] = v;\n      out[2] = val3;\n      break;\n    case 3:\n      out[0] = val1;\n      out[1] = val2;\n      out[2] = v;\n      break;\n    case 4:\n      out[0] = val3;\n      out[1] = val1;\n      out[2] = v;\n      break;\n    case 5:\n      out[0] = v;\n      out[1] = val1;\n      out[2] = val2;\n      break;\n  }\n  return out;\n}\n\n\n/**\n * Converts from RGB values (with r,g,b in range [0,1]) to an array of HSV values (in range [0, 1])\n *\n * Based on goog/color/color.js in the Google Closure library.\n */\nexport function rgbToHsv(out: Float32Array, r: number, g: number, b:number): Float32Array {\n\n    const max = Math.max(Math.max(r, g), b);\n    const min = Math.min(Math.min(r, g), b);\n    out[2] = max;\n    if (min === max) {\n      out[0] = 0;\n      out[1] = 0;\n    } else {\n      const delta = (max - min);\n      out[1] = delta / max;\n\n      if (r === max) {\n        out[0] = (g - b) / delta;\n      } else if (g === max) {\n        out[0] = 2 + ((b - r) / delta);\n      } else {\n        out[0] = 4 + ((r - g) / delta);\n      }\n      out[0] /= 6.0;\n      if (out[0] < 0.0) {\n        out[0] += 1.0;\n      }\n      if (out[0] > 1.0) {\n        out[0] -= 1.0;\n      }\n    }\n    return out;\n  };\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Generic facility for providing authentication/authorization credentials.\n */\n\nimport {CancellationToken, MultipleConsumerCancellationTokenSource} from 'neuroglancer/util/cancellation';\nimport {Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {StringMemoize} from 'neuroglancer/util/memoize';\n\n/**\n * Wraps an arbitrary JSON credentials object with a generation number.\n *\n * The generation number is used for tracking whether the credentials have been updated/renewed.\n */\nexport interface CredentialsWithGeneration<T> {\n  generation: number;\n  credentials: T;\n}\n\nexport abstract class CredentialsProvider<Credentials> extends RefCounted {\n  /**\n   * Request valid credentials.  If `invalidCredentials` is specified, it indicates that the\n   * specified credentials are invalid.\n   *\n   * This method can be conveniently defined using the `makeCredentialsGetter` function.\n   */\n  abstract get:\n      (invalidCredentials?: CredentialsWithGeneration<Credentials>,\n       cancellationToken?: CancellationToken) => Promise<CredentialsWithGeneration<Credentials>>;\n}\n\nexport function makeCachedCredentialsGetter<Credentials>(\n    getUncached: (\n        invalidCredentials: CredentialsWithGeneration<Credentials>|undefined,\n        cancellationToken: CancellationToken) => Promise<CredentialsWithGeneration<Credentials>>) {\n  let cachedCredentials: CredentialsWithGeneration<Credentials>|undefined;\n  let pendingCredentials: Promise<CredentialsWithGeneration<Credentials>>|undefined;\n  let pendingCancellationToken: MultipleConsumerCancellationTokenSource|undefined;\n  return (invalidCredentials?: CredentialsWithGeneration<Credentials>,\n          cancellationToken?: CancellationToken) => {\n    if (pendingCredentials !== undefined &&\n        (cachedCredentials === undefined || invalidCredentials === undefined ||\n         cachedCredentials.generation !== invalidCredentials.generation)) {\n      if (cachedCredentials === undefined) {\n        pendingCancellationToken!.addConsumer(cancellationToken);\n      }\n      return pendingCredentials;\n    }\n    cachedCredentials = undefined;\n    pendingCancellationToken = new MultipleConsumerCancellationTokenSource();\n    pendingCredentials = getUncached(invalidCredentials, pendingCancellationToken)\n                             .then(\n                                 credentials => {\n                                   cachedCredentials = credentials;\n                                   pendingCancellationToken = undefined;\n                                   return credentials;\n                                 },\n                                 reason => {\n                                   if (pendingCancellationToken!.isCanceled) {\n                                     pendingCancellationToken = undefined;\n                                     pendingCredentials = undefined;\n                                   }\n                                   throw reason;\n                                 });\n    return pendingCredentials;\n  };\n}\n\nexport function makeCredentialsGetter<Credentials>(\n    getWithoutGeneration: (cancellationToken: CancellationToken) => Promise<Credentials>) {\n  let generation = 0;\n  return makeCachedCredentialsGetter<Credentials>(\n      (_invalidCredentials, cancellationToken) =>\n          getWithoutGeneration(cancellationToken)\n              .then(credentials => ({generation: ++generation, credentials})));\n}\n\n/**\n * Interface for obtaining a CredentialsProvider based on a string key.\n */\nexport interface CredentialsManager {\n  getCredentialsProvider<Credentials>(key: string, parameters?: any):\n      Owned<CredentialsProvider<Credentials>>;\n}\n\n/**\n * CredentialsManager that supports registration.\n */\nexport class MapBasedCredentialsManager implements CredentialsManager {\n  providers = new Map<string, (parameters: any) => Owned<CredentialsProvider<any>>>();\n  register<Credentials>(\n      key: string, providerGetter: (parameters: any) => Owned<CredentialsProvider<Credentials>>) {\n    this.providers.set(key, providerGetter);\n  }\n\n  getCredentialsProvider<Credentials>(key: string, parameters?: any):\n      Owned<CredentialsProvider<Credentials>> {\n    const getter = this.providers.get(key);\n    if (getter === undefined) {\n      throw new Error(`No registered credentials provider: ${JSON.stringify(key)}`);\n    }\n    return getter(parameters);\n  }\n}\n\n/**\n * CredentialsManager that wraps another and caches the CredentialsProvider objects.\n */\nexport class CachingCredentialsManager<Base extends CredentialsManager> extends RefCounted\n    implements CredentialsManager {\n  memoize = new StringMemoize();\n\n  constructor(public base: Base) {\n    super();\n  }\n\n  getCredentialsProvider<Credentials>(key: string, parameters?: any):\n      Owned<CredentialsProvider<Credentials>> {\n    return this.memoize.get(\n        {key, parameters},\n        () => this.registerDisposer(\n            this.base.getCredentialsProvider<Credentials>(key, parameters).addRef()));\n  }\n}\n\nexport class CachingMapBasedCredentialsManager extends\n    CachingCredentialsManager<MapBasedCredentialsManager> {\n  constructor() {\n    super(new MapBasedCredentialsManager());\n  }\n\n  register<Credentials>(\n      key: string, providerGetter: (parameters: any) => Owned<CredentialsProvider<Credentials>>) {\n    this.base.register(key, providerGetter);\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for converting between strings and RGB/RGBA colors.\n */\n\nimport {WatchableValue} from 'neuroglancer/trackable_value';\nimport {float32ToString} from 'neuroglancer/util/float32_to_string';\nimport {vec3, vec4} from 'neuroglancer/util/geom';\nimport {hexEncodeByte} from 'neuroglancer/util/hex';\n\n/**\n * Parse the serialization of a color.\n *\n * This is based on the definition here:\n * https://html.spec.whatwg.org/multipage/canvas.html#serialisation-of-a-color\n */\nexport function parseColorSerialization(x: string) {\n  const rgbaPattern = /^rgba\\(([0-9]+), ([0-9]+), ([0-9]+), (0(?:\\.[0-9]+)?)\\)$/;\n  {\n    const m = x.match(rgbaPattern);\n    if (m !== null) {\n      return [parseInt(m[1], 10), parseInt(m[2], 10), parseInt(m[3], 10), parseFloat(m[4])];\n    }\n  }\n  const hexPattern = /^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/;\n  {\n    const m = x.match(hexPattern);\n    if (m !== null) {\n      return [parseInt(m[1], 16), parseInt(m[2], 16), parseInt(m[3], 16), 1.0];\n    }\n  }\n  throw new Error(`Invalid serialized color: ${JSON.stringify(x)}.`);\n}\n\nexport function parseRGBAColorSpecification(x: any) {\n  try {\n    if (typeof x !== 'string') {\n      throw new Error(`Expected string, but received ${JSON.stringify(x)}.`);\n    }\n    const context = document.createElement('canvas').getContext('2d')!;\n    context.fillStyle = x;\n    const result = parseColorSerialization(context.fillStyle);\n    return vec4.fromValues(result[0] / 255, result[1] / 255, result[2] / 255, result[3]);\n  } catch (parseError) {\n    throw new Error(`Failed to parse color specification: ${parseError.message}`);\n  }\n}\n\nexport function parseRGBColorSpecification(x: any) {\n  const result = parseRGBAColorSpecification(x);\n  return <vec3>result.subarray(0, 3);\n}\n\nexport function serializeColor(x: vec3|vec4) {\n  if (x[3] === undefined || x[3] === 1) {\n    let result = '#';\n    for (let i = 0; i < 3; ++i) {\n      result += hexEncodeByte(Math.min(255, Math.max(0, Math.round(x[i] * 255))));\n    }\n    return result;\n  } else {\n    let result = 'rgba(';\n    for (let i = 0; i < 3; ++i) {\n      if (i !== 0) {\n        result += ', ';\n      }\n      result += Math.min(255, Math.max(0, Math.round(x[i] * 255)));\n    }\n    result += `, ${float32ToString(x[3])})`;\n    return result;\n  }\n}\n\nexport class TrackableRGB extends WatchableValue<vec3> {\n  constructor(public defaultValue: vec3) {\n    super(vec3.clone(defaultValue));\n  }\n  toString() {\n    return serializeColor(this.value);\n  }\n  toJSON() {\n    if (vec3.equals(this.value, this.defaultValue)) {\n      return undefined;\n    } else {\n      return serializeColor(this.value);\n    }\n  }\n  reset() {\n    this.value = vec3.clone(this.defaultValue);\n  }\n  restoreState(x: any) {\n    if (x === undefined) {\n      this.reset();\n      return;\n    }\n    const {value} = this;\n    const newValue = parseRGBColorSpecification(x);\n    if (!vec3.equals(value, newValue)) {\n      this.value = newValue;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\n\nexport class ColorWidget extends RefCounted {\n  element = document.createElement('input');\n\n  constructor(public model: TrackableRGB) {\n    super();\n    const {element} = this;\n    element.classList.add('neuroglancer-color-widget');\n    element.type = 'color';\n    element.addEventListener('change', () => this.updateModel());\n    this.registerDisposer(model.changed.add(() => this.updateView()));\n    this.updateView();\n  }\n  private updateView() {\n    this.element.value = this.model.toString();\n  }\n  private updateModel() {\n    this.model.restoreState(this.element.value);\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file User interface for display and editing annotations.\n */\n\nimport './annotations.css';\n\nimport debounce from 'lodash/debounce';\nimport {Annotation, AnnotationReference, AnnotationType, AxisAlignedBoundingBox, Ellipsoid, getAnnotationTypeHandler, Line} from 'neuroglancer/annotation';\nimport {AnnotationLayer, AnnotationLayerState, PerspectiveViewAnnotationLayer, SliceViewAnnotationLayer} from 'neuroglancer/annotation/frontend';\nimport {DataFetchSliceViewRenderLayer, MultiscaleAnnotationSource} from 'neuroglancer/annotation/frontend_source';\nimport {setAnnotationHoverStateFromMouseState} from 'neuroglancer/annotation/selection';\nimport {MouseSelectionState, UserLayer} from 'neuroglancer/layer';\nimport {VoxelSize} from 'neuroglancer/navigation_state';\nimport {SegmentationDisplayState} from 'neuroglancer/segmentation_display_state/frontend';\nimport {TrackableAlphaValue, trackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {registerNested, TrackableValueInterface, WatchableRefCounted, WatchableValue} from 'neuroglancer/trackable_value';\nimport {registerTool, Tool} from 'neuroglancer/ui/tool';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren, removeFromParent} from 'neuroglancer/util/dom';\nimport {mat3, mat3FromMat4, mat4, transformVectorByMat4, vec3} from 'neuroglancer/util/geom';\nimport {verifyObject, verifyObjectProperty, verifyOptionalInt, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {formatBoundingBoxVolume, formatIntegerBounds, formatIntegerPoint, formatLength} from 'neuroglancer/util/spatial_units';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\nimport {makeCloseButton} from 'neuroglancer/widget/close_button';\nimport {ColorWidget} from 'neuroglancer/widget/color';\nimport {RangeWidget} from 'neuroglancer/widget/range';\nimport {StackView, Tab} from 'neuroglancer/widget/tab_view';\nimport {makeTextIconButton} from 'neuroglancer/widget/text_icon_button';\nimport {Uint64EntryWidget} from 'neuroglancer/widget/uint64_entry_widget';\n\ntype AnnotationIdAndPart = {\n  id: string,\n  partIndex?: number\n};\n\nexport class AnnotationSegmentListWidget extends RefCounted {\n  element = document.createElement('div');\n  private addSegmentWidget = this.registerDisposer(new Uint64EntryWidget());\n  private segmentationState: SegmentationDisplayState|undefined|null;\n  private debouncedUpdateView = debounce(() => this.updateView(), 0);\n  constructor(\n      public reference: Borrowed<AnnotationReference>,\n      public annotationLayer: AnnotationLayerState) {\n    super();\n    this.element.className = 'neuroglancer-annotation-segment-list';\n    const {addSegmentWidget} = this;\n    addSegmentWidget.element.style.display = 'inline-block';\n    addSegmentWidget.element.title = 'Associate segments';\n    this.element.appendChild(addSegmentWidget.element);\n    this.registerDisposer(annotationLayer.segmentationState.changed.add(this.debouncedUpdateView));\n    this.registerDisposer(() => this.unregisterSegmentationState());\n    this.registerDisposer(this.addSegmentWidget.valuesEntered.add(values => {\n      const annotation = this.reference.value;\n      if (annotation == null) {\n        return;\n      }\n      const existingSegments = annotation.segments;\n      const segments = [...(existingSegments || []), ...values];\n      const newAnnotation = {...annotation, segments};\n      this.annotationLayer.source.update(this.reference, newAnnotation);\n      this.annotationLayer.source.commit(this.reference);\n    }));\n    this.registerDisposer(reference.changed.add(this.debouncedUpdateView));\n    this.updateView();\n  }\n\n  private unregisterSegmentationState() {\n    const {segmentationState} = this;\n    if (segmentationState != null) {\n      segmentationState.visibleSegments.changed.remove(this.debouncedUpdateView);\n      segmentationState.segmentColorHash.changed.remove(this.debouncedUpdateView);\n      segmentationState.segmentSelectionState.changed.remove(this.debouncedUpdateView);\n      this.segmentationState = undefined;\n    }\n  }\n\n  private updateView() {\n    const segmentationState = this.annotationLayer.segmentationState.value;\n    if (segmentationState !== this.segmentationState) {\n      this.unregisterSegmentationState();\n      this.segmentationState = segmentationState;\n      if (segmentationState != null) {\n        segmentationState.visibleSegments.changed.add(this.debouncedUpdateView);\n        segmentationState.segmentColorHash.changed.add(this.debouncedUpdateView);\n        segmentationState.segmentSelectionState.changed.add(this.debouncedUpdateView);\n      }\n    }\n\n    const {element} = this;\n    // Remove existing segment representations.\n    for (let child = this.addSegmentWidget.element.nextElementSibling; child !== null;) {\n      const next = child.nextElementSibling;\n      element.removeChild(child);\n      child = next;\n    }\n    element.style.display = 'none';\n    const annotation = this.reference.value;\n    if (annotation == null) {\n      return;\n    }\n    const segments = annotation.segments;\n    if (segmentationState === null) {\n      return;\n    }\n    element.style.display = '';\n    if (segments === undefined || segments.length === 0) {\n      return;\n    }\n    const segmentColorHash = segmentationState ? segmentationState.segmentColorHash : undefined;\n    segments.forEach((segment, index) => {\n      if (index !== 0) {\n        element.appendChild(document.createTextNode(' '));\n      }\n      const child = document.createElement('span');\n      child.title =\n          'Double click to toggle segment visibility, control+click to disassociate segment from annotation.';\n      child.className = 'neuroglancer-annotation-segment-item';\n      child.textContent = segment.toString();\n      if (segmentationState !== undefined) {\n        child.style.backgroundColor = segmentColorHash!.computeCssColor(segment);\n        child.addEventListener('mouseenter', () => {\n          segmentationState.segmentSelectionState.set(segment);\n        });\n        child.addEventListener('mouseleave', () => {\n          segmentationState.segmentSelectionState.set(null);\n        });\n        child.addEventListener('dblclick', (event: MouseEvent) => {\n          if (event.ctrlKey) {\n            return;\n          }\n          if (segmentationState.visibleSegments.has(segment)) {\n            segmentationState.visibleSegments.delete(segment);\n          } else {\n            segmentationState.visibleSegments.add(segment);\n          }\n        });\n      }\n      child.addEventListener('click', (event: MouseEvent) => {\n        if (!event.ctrlKey) {\n          return;\n        }\n        const existingSegments = annotation.segments || [];\n        const newSegments = existingSegments.filter(x => !Uint64.equal(segment, x));\n        const newAnnotation = {...annotation, segments: newSegments ? newSegments : undefined};\n        this.annotationLayer.source.update(this.reference, newAnnotation);\n        this.annotationLayer.source.commit(this.reference);\n      });\n      element.appendChild(child);\n    });\n  }\n}\n\nexport class SelectedAnnotationState extends RefCounted implements\n    TrackableValueInterface<AnnotationIdAndPart|undefined> {\n  private value_: AnnotationIdAndPart|undefined;\n  changed = new NullarySignal();\n\n  private annotationLayer: AnnotationLayerState|undefined;\n  private reference_: Owned<AnnotationReference>|undefined;\n\n  get reference() {\n    return this.reference_;\n  }\n\n  constructor(public annotationLayerState: Owned<WatchableRefCounted<AnnotationLayerState>>) {\n    super();\n    this.registerDisposer(annotationLayerState);\n    this.registerDisposer(annotationLayerState.changed.add(this.validate));\n    this.updateAnnotationLayer();\n    this.reference_ = undefined;\n    this.value_ = undefined;\n  }\n\n  get value() {\n    return this.value_;\n  }\n\n  get validValue() {\n    return this.annotationLayer && this.value_;\n  }\n\n  set value(value: AnnotationIdAndPart|undefined) {\n    this.value_ = value;\n    const reference = this.reference_;\n    if (reference !== undefined) {\n      if (value === undefined || reference.id !== value.id) {\n        this.unbindReference();\n      }\n    }\n    this.validate();\n    this.changed.dispatch();\n  }\n\n  private updateAnnotationLayer() {\n    const annotationLayer = this.annotationLayerState.value;\n    if (annotationLayer === this.annotationLayer) {\n      return false;\n    }\n    this.unbindLayer();\n    this.annotationLayer = annotationLayer;\n    if (annotationLayer !== undefined) {\n      annotationLayer.source.changed.add(this.validate);\n    }\n    return true;\n  }\n\n  private unbindLayer() {\n    if (this.annotationLayer !== undefined) {\n      this.annotationLayer.source.changed.remove(this.validate);\n      this.annotationLayer = undefined;\n    }\n  }\n\n  disposed() {\n    this.unbindLayer();\n    this.unbindReference();\n    super.disposed();\n  }\n\n  private unbindReference() {\n    const reference = this.reference_;\n    if (reference !== undefined) {\n      reference.changed.remove(this.referenceChanged);\n      this.reference_ = undefined;\n    }\n  }\n\n  private referenceChanged = (() => {\n    this.validate();\n    this.changed.dispatch();\n  });\n\n  private validate = (() => {\n    const updatedLayer = this.updateAnnotationLayer();\n    const {annotationLayer} = this;\n    if (annotationLayer !== undefined) {\n      const value = this.value_;\n      if (value !== undefined) {\n        let reference = this.reference_;\n        if (reference !== undefined && reference.id !== value.id) {\n          // Id changed.\n          value.id = reference.id;\n        } else if (reference === undefined) {\n          reference = this.reference_ = annotationLayer.source.getReference(value.id);\n          reference.changed.add(this.referenceChanged);\n        }\n        if (reference.value === null) {\n          this.unbindReference();\n          this.value = undefined;\n          return;\n        }\n      } else {\n        this.unbindReference();\n      }\n    }\n    if (updatedLayer) {\n      this.changed.dispatch();\n    }\n  });\n\n  toJSON() {\n    const value = this.value_;\n    if (value === undefined) {\n      return undefined;\n    }\n    if (value.partIndex === 0) {\n      return value.id;\n    }\n    return value;\n  }\n  reset() {\n    this.value = undefined;\n  }\n  restoreState(x: any) {\n    if (x === undefined) {\n      this.value = undefined;\n      return;\n    }\n    if (typeof x === 'string') {\n      this.value = {'id': x, 'partIndex': 0};\n      return;\n    }\n    verifyObject(x);\n    this.value = {\n      'id': verifyObjectProperty(x, 'id', verifyString),\n      'partIndex': verifyObjectProperty(x, 'partIndex', verifyOptionalInt),\n    };\n  }\n}\n\nconst tempVec3 = vec3.create();\n\nfunction makePointLink(\n    point: vec3, transform: mat4, voxelSize: VoxelSize,\n    setSpatialCoordinates?: (point: vec3) => void) {\n  const spatialPoint = vec3.transformMat4(vec3.create(), point, transform);\n  const positionText = formatIntegerPoint(voxelSize.voxelFromSpatial(tempVec3, spatialPoint));\n  if (setSpatialCoordinates !== undefined) {\n    const element = document.createElement('span');\n    element.className = 'neuroglancer-voxel-coordinates-link';\n    element.textContent = positionText;\n    element.title = `Center view on voxel coordinates ${positionText}.`;\n    element.addEventListener('click', () => {\n      setSpatialCoordinates(spatialPoint);\n    });\n    return element;\n  } else {\n    return document.createTextNode(positionText);\n  }\n}\n\nexport function getPositionSummary(\n    element: HTMLElement, annotation: Annotation, transform: mat4, voxelSize: VoxelSize,\n    setSpatialCoordinates?: (point: vec3) => void) {\n  const makePointLinkWithTransform = (point: vec3) =>\n      makePointLink(point, transform, voxelSize, setSpatialCoordinates);\n\n  switch (annotation.type) {\n    case AnnotationType.AXIS_ALIGNED_BOUNDING_BOX:\n    case AnnotationType.LINE:\n      element.appendChild(makePointLinkWithTransform(annotation.pointA));\n      element.appendChild(document.createTextNode(''));\n      element.appendChild(makePointLinkWithTransform(annotation.pointB));\n      break;\n    case AnnotationType.POINT:\n      element.appendChild(makePointLinkWithTransform(annotation.point));\n      break;\n    case AnnotationType.ELLIPSOID:\n      element.appendChild(makePointLinkWithTransform(annotation.center));\n      const transformedRadii = transformVectorByMat4(tempVec3, annotation.radii, transform);\n      voxelSize.voxelFromSpatial(transformedRadii, transformedRadii);\n      element.appendChild(document.createTextNode('' + formatIntegerBounds(transformedRadii)));\n      break;\n  }\n}\n\nfunction getCenterPosition(annotation: Annotation, transform: mat4) {\n  const center = vec3.create();\n  switch (annotation.type) {\n    case AnnotationType.AXIS_ALIGNED_BOUNDING_BOX:\n    case AnnotationType.LINE:\n      vec3.add(center, annotation.pointA, annotation.pointB);\n      vec3.scale(center, center, 0.5);\n      break;\n    case AnnotationType.POINT:\n      vec3.copy(center, annotation.point);\n      break;\n    case AnnotationType.ELLIPSOID:\n      vec3.copy(center, annotation.center);\n      break;\n  }\n  return vec3.transformMat4(center, center, transform);\n}\n\nexport class AnnotationLayerView extends Tab {\n  private annotationListContainer = document.createElement('ul');\n  private annotationListElements = new Map<string, HTMLElement>();\n  private previousSelectedId: string|undefined;\n  private previousHoverId: string|undefined;\n  private updated = false;\n\n  constructor(\n      public layer: Borrowed<UserLayerWithAnnotations>,\n      public state: Owned<SelectedAnnotationState>,\n      public annotationLayer: Owned<AnnotationLayerState>,\n      public voxelSize: Owned<VoxelSize>,\n      public setSpatialCoordinates: (point: vec3) => void) {\n    super();\n    this.element.classList.add('neuroglancer-annotation-layer-view');\n    this.annotationListContainer.classList.add('neuroglancer-annotation-list');\n    this.registerDisposer(state);\n    this.registerDisposer(voxelSize);\n    this.registerDisposer(annotationLayer);\n    const {source} = annotationLayer;\n    const updateView = () => {\n      this.updated = false;\n      this.updateView();\n    };\n    this.registerDisposer(source.childAdded.add((annotation) => this.addAnnotationElement(annotation)));\n    this.registerDisposer(source.childUpdated.add((annotation) => this.updateAnnotationElement(annotation)));\n    this.registerDisposer(source.childDeleted.add((annotationId) => this.deleteAnnotationElement(annotationId)));\n    this.registerDisposer(this.visibility.changed.add(() => this.updateView()));\n    this.registerDisposer(annotationLayer.transform.changed.add(updateView));\n    this.updateView();\n\n    const toolbox = document.createElement('div');\n    toolbox.className = 'neuroglancer-annotation-toolbox';\n\n    layer.initializeAnnotationLayerViewTab(this);\n\n    {\n      const widget = this.registerDisposer(new RangeWidget(this.annotationLayer.fillOpacity));\n      widget.promptElement.textContent = 'Fill opacity';\n      this.element.appendChild(widget.element);\n    }\n\n    const colorPicker = this.registerDisposer(new ColorWidget(this.annotationLayer.color));\n    colorPicker.element.title = 'Change annotation display color';\n    toolbox.appendChild(colorPicker.element);\n    if (!annotationLayer.source.readonly) {\n      const pointButton = document.createElement('button');\n      pointButton.textContent = getAnnotationTypeHandler(AnnotationType.POINT).icon;\n      pointButton.title = 'Annotate point';\n      pointButton.addEventListener('click', () => {\n        this.layer.tool.value = new PlacePointTool(this.layer, {});\n      });\n      toolbox.appendChild(pointButton);\n\n\n      const boundingBoxButton = document.createElement('button');\n      boundingBoxButton.textContent =\n          getAnnotationTypeHandler(AnnotationType.AXIS_ALIGNED_BOUNDING_BOX).icon;\n      boundingBoxButton.title = 'Annotate bounding box';\n      boundingBoxButton.addEventListener('click', () => {\n        this.layer.tool.value = new PlaceBoundingBoxTool(this.layer, {});\n      });\n      toolbox.appendChild(boundingBoxButton);\n\n\n      const lineButton = document.createElement('button');\n      lineButton.textContent = getAnnotationTypeHandler(AnnotationType.LINE).icon;\n      lineButton.title = 'Annotate line';\n      lineButton.addEventListener('click', () => {\n        this.layer.tool.value = new PlaceLineTool(this.layer, {});\n      });\n      toolbox.appendChild(lineButton);\n\n\n      const ellipsoidButton = document.createElement('button');\n      ellipsoidButton.textContent = getAnnotationTypeHandler(AnnotationType.ELLIPSOID).icon;\n      ellipsoidButton.title = 'Annotate ellipsoid';\n      ellipsoidButton.addEventListener('click', () => {\n        this.layer.tool.value = new PlaceSphereTool(this.layer, {});\n      });\n      toolbox.appendChild(ellipsoidButton);\n    }\n    this.element.appendChild(toolbox);\n\n    this.element.appendChild(this.annotationListContainer);\n\n    this.annotationListContainer.addEventListener('mouseleave', () => {\n      this.annotationLayer.hoverState.value = undefined;\n    });\n    this.registerDisposer(\n        this.annotationLayer.hoverState.changed.add(() => this.updateHoverView()));\n    this.registerDisposer(this.state.changed.add(() => this.updateSelectionView()));\n  }\n\n  private updateSelectionView() {\n    const selectedValue = this.state.value;\n    let newSelectedId: string|undefined;\n    if (selectedValue !== undefined) {\n      newSelectedId = selectedValue.id;\n    }\n    const {previousSelectedId} = this;\n    if (newSelectedId === previousSelectedId) {\n      return;\n    }\n    if (previousSelectedId !== undefined) {\n      const element = this.annotationListElements.get(previousSelectedId);\n      if (element !== undefined) {\n        element.classList.remove('neuroglancer-annotation-selected');\n      }\n    }\n    if (newSelectedId !== undefined) {\n      const element = this.annotationListElements.get(newSelectedId);\n      if (element !== undefined) {\n        element.classList.add('neuroglancer-annotation-selected');\n        element.scrollIntoView();\n      }\n    }\n    this.previousSelectedId = newSelectedId;\n  }\n\n  private updateHoverView() {\n    const selectedValue = this.annotationLayer.hoverState.value;\n    let newHoverId: string|undefined;\n    if (selectedValue !== undefined) {\n      newHoverId = selectedValue.id;\n    }\n    const {previousHoverId} = this;\n    if (newHoverId === previousHoverId) {\n      return;\n    }\n    if (previousHoverId !== undefined) {\n      const element = this.annotationListElements.get(previousHoverId);\n      if (element !== undefined) {\n        element.classList.remove('neuroglancer-annotation-hover');\n      }\n    }\n    if (newHoverId !== undefined) {\n      const element = this.annotationListElements.get(newHoverId);\n      if (element !== undefined) {\n        element.classList.add('neuroglancer-annotation-hover');\n      }\n    }\n    this.previousHoverId = newHoverId;\n  }\n\n  private addAnnotationElementHelper(annotation: Annotation) {\n    const {annotationLayer, annotationListContainer, annotationListElements} = this;\n    const {objectToGlobal} = annotationLayer;\n\n    const element = this.makeAnnotationListElement(annotation, objectToGlobal);\n    annotationListContainer.appendChild(element);\n    annotationListElements.set(annotation.id, element);\n\n    element.addEventListener('mouseenter', () => {\n      this.annotationLayer.hoverState.value = {id: annotation.id, partIndex: 0};\n    });\n    element.addEventListener('click', () => {\n      this.state.value = {id: annotation.id, partIndex: 0};\n    });\n\n    element.addEventListener('mouseup', (event: MouseEvent) => {\n      if (event.button === 2) {\n        this.setSpatialCoordinates(\n            getCenterPosition(annotation, this.annotationLayer.objectToGlobal));\n      }\n    });\n  }\n\n  private updateView() {\n    if (!this.visible) {\n      return;\n    }\n    if (this.updated) {\n      return;\n    }\n    const {annotationLayer, annotationListContainer, annotationListElements} = this;\n    const {source} = annotationLayer;\n    removeChildren(annotationListContainer);\n    annotationListElements.clear();\n    for(const annotation of source) {\n      this.addAnnotationElementHelper(annotation);\n    }\n    this.resetOnUpdate();\n  }\n\n  private addAnnotationElement(annotation:Annotation) {\n    if(!this.visible) {\n      return;\n    }\n    this.addAnnotationElementHelper(annotation);\n    this.resetOnUpdate();\n  }\n\n  private updateAnnotationElement(annotation:Annotation) {\n    if (!this.visible) {\n      return;\n    }\n    var element = this.annotationListElements.get(annotation.id);\n    if (!element) {\n      return;\n    }\n    if (element.lastElementChild && element.children.length === 3) {\n      if (!annotation.description) {\n        element.removeChild(element.lastElementChild);\n      }\n      else {\n        element.lastElementChild.innerHTML = annotation.description;\n      }\n    }\n    else {\n      const description = document.createElement('div');\n      description.className = 'neuroglancer-annotation-description';\n      description.textContent = annotation.description || '';\n      element.appendChild(description);\n    }\n    this.resetOnUpdate();\n  }\n\n  private deleteAnnotationElement(annotationId: string) {\n    if (!this.visible) {\n      return;\n    }\n    let element = this.annotationListElements.get(annotationId);\n    if (element) {\n      removeFromParent(element);\n      this.annotationListElements.delete(annotationId);\n    }\n    this.resetOnUpdate();\n  }\n\n  private resetOnUpdate() {\n    this.previousSelectedId = undefined;\n    this.previousHoverId = undefined;\n    this.updated = true;\n    this.updateHoverView();\n    this.updateSelectionView();\n  }\n\n  private makeAnnotationListElement(annotation: Annotation, transform: mat4) {\n    const element = document.createElement('li');\n    element.title = 'Click to select, right click to recenter view.';\n\n    const icon = document.createElement('div');\n    icon.className = 'neuroglancer-annotation-icon';\n    icon.textContent = getAnnotationTypeHandler(annotation.type).icon;\n    element.appendChild(icon);\n\n    const position = document.createElement('div');\n    position.className = 'neuroglancer-annotation-position';\n    getPositionSummary(position, annotation, transform, this.voxelSize, this.setSpatialCoordinates);\n    element.appendChild(position);\n\n    if (annotation.description) {\n      const description = document.createElement('div');\n      description.className = 'neuroglancer-annotation-description';\n      description.textContent = annotation.description;\n      element.appendChild(description);\n    }\n    return element;\n  }\n}\n\nexport class AnnotationDetailsTab extends Tab {\n  private valid = false;\n  private mouseEntered = false;\n  private hoverState: WatchableValue<{id: string, partIndex?: number}|undefined>|undefined;\n  private segmentListWidget: AnnotationSegmentListWidget|undefined;\n  constructor(\n      public state: Owned<SelectedAnnotationState>, public voxelSize: VoxelSize,\n      public setSpatialCoordinates: (point: vec3) => void) {\n    super();\n    this.element.classList.add('neuroglancer-annotation-details');\n    this.registerDisposer(state);\n    this.registerDisposer(voxelSize);\n    this.registerDisposer(this.state.changed.add(() => {\n      this.valid = false;\n      this.updateView();\n    }));\n    this.registerDisposer(this.visibility.changed.add(() => this.updateView()));\n    this.state.changed.add(() => {\n      this.valid = false;\n      this.updateView();\n    });\n    this.element.addEventListener('mouseenter', () => {\n      this.mouseEntered = true;\n      if (this.hoverState !== undefined) {\n        this.hoverState.value = this.state.value;\n      }\n    });\n    this.element.addEventListener('mouseleave', () => {\n      this.mouseEntered = false;\n      if (this.hoverState !== undefined) {\n        this.hoverState.value = undefined;\n      }\n    });\n    this.updateView();\n  }\n\n  private updateView() {\n    if (!this.visible) {\n      this.element.style.display = 'none';\n      this.hoverState = undefined;\n      return;\n    }\n    this.element.style.display = null;\n    if (this.valid) {\n      return;\n    }\n    const {element} = this;\n    removeChildren(element);\n    this.valid = true;\n    const {reference} = this.state;\n    if (reference === undefined) {\n      return;\n    }\n    const value = this.state.value!;\n    const annotation = reference.value;\n    if (annotation == null) {\n      return;\n    }\n    const annotationLayer = this.state.annotationLayerState.value!;\n    this.hoverState = annotationLayer.hoverState;\n    if (this.mouseEntered) {\n      this.hoverState.value = value;\n    }\n\n    const {objectToGlobal} = annotationLayer;\n    const {voxelSize} = this;\n\n    const handler = getAnnotationTypeHandler(annotation.type);\n\n    const title = document.createElement('div');\n    title.className = 'neuroglancer-annotation-details-title';\n\n    const icon = document.createElement('div');\n    icon.className = 'neuroglancer-annotation-details-icon';\n    icon.textContent = handler.icon;\n\n    const titleText = document.createElement('div');\n    titleText.className = 'neuroglancer-annotation-details-title-text';\n    titleText.textContent = `${handler.description}`;\n    title.appendChild(icon);\n    title.appendChild(titleText);\n\n    if (!annotationLayer.source.readonly) {\n      const deleteButton = makeTextIconButton('', 'Delete annotation');\n      deleteButton.addEventListener('click', () => {\n        const ref = annotationLayer.source.getReference(value.id);\n        try {\n          annotationLayer.source.delete(ref);\n        } finally {\n          ref.dispose();\n        }\n      });\n      title.appendChild(deleteButton);\n    }\n\n    const closeButton = makeCloseButton();\n    closeButton.title = 'Hide annotation details';\n    closeButton.addEventListener('click', () => {\n      this.state.value = undefined;\n    });\n    title.appendChild(closeButton);\n\n    element.appendChild(title);\n\n    const position = document.createElement('div');\n    position.className = 'neuroglancer-annotation-details-position';\n    getPositionSummary(position, annotation, objectToGlobal, voxelSize, this.setSpatialCoordinates);\n    element.appendChild(position);\n\n    if (annotation.type === AnnotationType.AXIS_ALIGNED_BOUNDING_BOX) {\n      const volume = document.createElement('div');\n      volume.className = 'neuroglancer-annotation-details-volume';\n      volume.textContent =\n          formatBoundingBoxVolume(annotation.pointA, annotation.pointB, objectToGlobal);\n      element.appendChild(volume);\n\n      // FIXME: only do this if it is axis aligned\n      const spatialOffset = transformVectorByMat4(\n          tempVec3, vec3.subtract(tempVec3, annotation.pointA, annotation.pointB), objectToGlobal);\n      const voxelVolume = document.createElement('div');\n      voxelVolume.className = 'neuroglancer-annotation-details-volume-in-voxels';\n      const voxelOffset = voxelSize.voxelFromSpatial(tempVec3, spatialOffset);\n      voxelVolume.textContent = `${formatIntegerBounds(voxelOffset)}`;\n      element.appendChild(voxelVolume);\n    } else if (annotation.type === AnnotationType.LINE) {\n      const spatialOffset = transformVectorByMat4(\n          tempVec3, vec3.subtract(tempVec3, annotation.pointA, annotation.pointB), objectToGlobal);\n      const length = document.createElement('div');\n      length.className = 'neuroglancer-annotation-details-length';\n      const spatialLengthText = formatLength(vec3.length(spatialOffset));\n      let voxelLengthText = '';\n      if (voxelSize.valid) {\n        const voxelLength = vec3.length(voxelSize.voxelFromSpatial(tempVec3, spatialOffset));\n        voxelLengthText = `, ${Math.round(voxelLength)} vx`;\n      }\n      length.textContent = spatialLengthText + voxelLengthText;\n      element.appendChild(length);\n    }\n\n    let {segmentListWidget} = this;\n    if (segmentListWidget !== undefined) {\n      if (segmentListWidget.reference !== reference) {\n        segmentListWidget.dispose();\n        this.unregisterDisposer(segmentListWidget);\n        segmentListWidget = this.segmentListWidget = undefined;\n      }\n    }\n    if (segmentListWidget === undefined) {\n      this.segmentListWidget = segmentListWidget =\n          this.registerDisposer(new AnnotationSegmentListWidget(reference, annotationLayer));\n    }\n    element.appendChild(segmentListWidget.element);\n\n    const description = document.createElement('textarea');\n    description.value = annotation.description || '';\n    description.rows = 3;\n    description.className = 'neuroglancer-annotation-details-description';\n    description.placeholder = 'Description';\n    if (annotationLayer.source.readonly) {\n      description.readOnly = true;\n    } else {\n      description.addEventListener('change', () => {\n        const x = description.value;\n        annotationLayer.source.update(reference, {...annotation, description: x ? x : undefined});\n        annotationLayer.source.commit(reference);\n      });\n    }\n    element.appendChild(description);\n  }\n}\n\nexport class AnnotationTab extends Tab {\n  private stack = this.registerDisposer(\n      new StackView<AnnotationLayerState, AnnotationLayerView>(annotationLayerState => {\n        return new AnnotationLayerView(\n            this.layer, this.state.addRef(), annotationLayerState.addRef(), this.voxelSize.addRef(),\n            this.setSpatialCoordinates);\n      }, this.visibility));\n  private detailsTab = this.registerDisposer(\n      new AnnotationDetailsTab(this.state, this.voxelSize.addRef(), this.setSpatialCoordinates));\n  constructor(\n      public layer: Borrowed<UserLayerWithAnnotations>,\n      public state: Owned<SelectedAnnotationState>, public voxelSize: Owned<VoxelSize>,\n      public setSpatialCoordinates: (point: vec3) => void) {\n    super();\n    this.registerDisposer(state);\n    this.registerDisposer(voxelSize);\n    const {element} = this;\n    element.classList.add('neuroglancer-annotations-tab');\n    this.stack.element.classList.add('neuroglancer-annotations-stack');\n    element.appendChild(this.stack.element);\n    element.appendChild(this.detailsTab.element);\n    const updateDetailsVisibility = () => {\n      this.detailsTab.visibility.value = this.state.validValue !== undefined && this.visible ?\n          WatchableVisibilityPriority.VISIBLE :\n          WatchableVisibilityPriority.IGNORED;\n    };\n    this.registerDisposer(this.state.changed.add(updateDetailsVisibility));\n    this.registerDisposer(this.visibility.changed.add(updateDetailsVisibility));\n    const setAnnotationLayerView = () => {\n      this.stack.selected = this.state.annotationLayerState.value;\n    };\n    this.registerDisposer(this.state.annotationLayerState.changed.add(setAnnotationLayerView));\n    setAnnotationLayerView();\n  }\n}\n\nfunction getSelectedAssocatedSegment(annotationLayer: AnnotationLayerState) {\n  let segments: Uint64[]|undefined;\n  const segmentationState = annotationLayer.segmentationState.value;\n  if (segmentationState != null) {\n    if (segmentationState.segmentSelectionState.hasSelectedSegment) {\n      segments = [segmentationState.segmentSelectionState.selectedSegment.clone()];\n    }\n  }\n  return segments;\n}\n\nabstract class PlaceAnnotationTool extends Tool {\n  group: string;\n  annotationDescription: string|undefined;\n  constructor(public layer: UserLayerWithAnnotations, options: any) {\n    super();\n    if (layer.annotationLayerState === undefined) {\n      throw new Error(`Invalid layer for annotation tool.`);\n    }\n    this.annotationDescription = verifyObjectProperty(options, 'description', verifyOptionalString);\n  }\n\n  get annotationLayer() {\n    return this.layer.annotationLayerState.value;\n  }\n}\n\nconst ANNOTATE_POINT_TOOL_ID = 'annotatePoint';\nconst ANNOTATE_LINE_TOOL_ID = 'annotateLine';\nconst ANNOTATE_BOUNDING_BOX_TOOL_ID = 'annotateBoundingBox';\nconst ANNOTATE_ELLIPSOID_TOOL_ID = 'annotateSphere';\n\nexport class PlacePointTool extends PlaceAnnotationTool {\n  constructor(layer: UserLayerWithAnnotations, options: any) {\n    super(layer, options);\n  }\n\n  trigger(mouseState: MouseSelectionState) {\n    const {annotationLayer} = this;\n    if (annotationLayer === undefined) {\n      // Not yet ready.\n      return;\n    }\n    if (mouseState.active) {\n      const annotation: Annotation = {\n        id: '',\n        description: '',\n        segments: getSelectedAssocatedSegment(annotationLayer),\n        point:\n            vec3.transformMat4(vec3.create(), mouseState.position, annotationLayer.globalToObject),\n        type: AnnotationType.POINT,\n      };\n      const reference = annotationLayer.source.add(annotation, /*commit=*/true);\n      this.layer.selectedAnnotation.value = {id: reference.id};\n      reference.dispose();\n    }\n  }\n\n  get description() {\n    return `annotate point`;\n  }\n\n  toJSON() {\n    return ANNOTATE_POINT_TOOL_ID;\n  }\n}\n\nfunction getMousePositionInAnnotationCoordinates(\n    mouseState: MouseSelectionState, annotationLayer: AnnotationLayerState) {\n  return vec3.transformMat4(vec3.create(), mouseState.position, annotationLayer.globalToObject);\n}\n\nabstract class TwoStepAnnotationTool extends PlaceAnnotationTool {\n  inProgressAnnotation:\n      {annotationLayer: AnnotationLayerState, reference: AnnotationReference, disposer: () => void}|\n      undefined;\n\n  abstract getInitialAnnotation(\n      mouseState: MouseSelectionState, annotationLayer: AnnotationLayerState): Annotation;\n  abstract getUpdatedAnnotation(\n      oldAnnotation: Annotation, mouseState: MouseSelectionState,\n      annotationLayer: AnnotationLayerState): Annotation;\n\n  trigger(mouseState: MouseSelectionState) {\n    const {annotationLayer} = this;\n    if (annotationLayer === undefined) {\n      // Not yet ready.\n      return;\n    }\n    if (mouseState.active) {\n      const updatePointB = () => {\n        const state = this.inProgressAnnotation!;\n        const reference = state.reference;\n        const newAnnotation =\n            this.getUpdatedAnnotation(reference.value!, mouseState, annotationLayer);\n        state.annotationLayer.source.update(reference, newAnnotation);\n        this.layer.selectedAnnotation.value = {id: reference.id};\n      };\n\n      if (this.inProgressAnnotation === undefined) {\n        const reference = annotationLayer.source.add(\n            this.getInitialAnnotation(mouseState, annotationLayer), /*commit=*/false);\n        this.layer.selectedAnnotation.value = {id: reference.id};\n        const mouseDisposer = mouseState.changed.add(updatePointB);\n        const disposer = () => {\n          mouseDisposer();\n          reference.dispose();\n        };\n        this.inProgressAnnotation = {\n          annotationLayer,\n          reference,\n          disposer,\n        };\n      } else {\n        updatePointB();\n        this.inProgressAnnotation.annotationLayer.source.commit(\n            this.inProgressAnnotation.reference);\n        this.inProgressAnnotation.disposer();\n        this.inProgressAnnotation = undefined;\n      }\n    }\n  }\n\n  disposed() {\n    this.deactivate();\n    super.disposed();\n  }\n\n  deactivate() {\n    if (this.inProgressAnnotation !== undefined) {\n      this.inProgressAnnotation.annotationLayer.source.delete(this.inProgressAnnotation.reference);\n      this.inProgressAnnotation.disposer();\n      this.inProgressAnnotation = undefined;\n    }\n  }\n}\n\n\nabstract class PlaceTwoCornerAnnotationTool extends TwoStepAnnotationTool {\n  annotationType: AnnotationType.LINE|AnnotationType.AXIS_ALIGNED_BOUNDING_BOX;\n\n  getInitialAnnotation(mouseState: MouseSelectionState, annotationLayer: AnnotationLayerState):\n      Annotation {\n    const point = getMousePositionInAnnotationCoordinates(mouseState, annotationLayer);\n    return <AxisAlignedBoundingBox|Line>{\n      id: '',\n      type: this.annotationType,\n      description: '',\n      pointA: point,\n      pointB: point,\n    };\n  }\n\n  getUpdatedAnnotation(\n      oldAnnotation: AxisAlignedBoundingBox|Line, mouseState: MouseSelectionState,\n      annotationLayer: AnnotationLayerState): Annotation {\n    const point = getMousePositionInAnnotationCoordinates(mouseState, annotationLayer);\n    return {...oldAnnotation, pointB: point};\n  }\n}\n\nexport class PlaceBoundingBoxTool extends PlaceTwoCornerAnnotationTool {\n  get description() {\n    return `annotate bounding box`;\n  }\n\n  toJSON() {\n    return ANNOTATE_BOUNDING_BOX_TOOL_ID;\n  }\n}\nPlaceBoundingBoxTool.prototype.annotationType = AnnotationType.AXIS_ALIGNED_BOUNDING_BOX;\n\nexport class PlaceLineTool extends PlaceTwoCornerAnnotationTool {\n  get description() {\n    return `annotate line`;\n  }\n\n  getInitialAnnotation(mouseState: MouseSelectionState, annotationLayer: AnnotationLayerState): Annotation {\n    const result = super.getInitialAnnotation(mouseState, annotationLayer);\n    result.segments = getSelectedAssocatedSegment(annotationLayer);\n    return result;\n  }\n\n  getUpdatedAnnotation(\n      oldAnnotation: Line|AxisAlignedBoundingBox, mouseState: MouseSelectionState,\n      annotationLayer: AnnotationLayerState) {\n    const result = super.getUpdatedAnnotation(oldAnnotation, mouseState, annotationLayer);\n    const segments = result.segments;\n    if (segments !== undefined && segments.length > 0) {\n      segments.length = 1;\n    }\n    let newSegments = getSelectedAssocatedSegment(annotationLayer);\n    if (newSegments && segments) {\n      newSegments = newSegments.filter(x => segments.findIndex(y => Uint64.equal(x, y)) === -1);\n    }\n    result.segments = [...(segments || []), ...(newSegments || [])] || undefined;\n    return result;\n  }\n\n  toJSON() {\n    return ANNOTATE_LINE_TOOL_ID;\n  }\n}\nPlaceLineTool.prototype.annotationType = AnnotationType.LINE;\n\nclass PlaceSphereTool extends TwoStepAnnotationTool {\n  getInitialAnnotation(mouseState: MouseSelectionState, annotationLayer: AnnotationLayerState):\n      Annotation {\n    const point = getMousePositionInAnnotationCoordinates(mouseState, annotationLayer);\n\n    return <Ellipsoid>{\n      type: AnnotationType.ELLIPSOID,\n      id: '',\n      description: '',\n      segments: getSelectedAssocatedSegment(annotationLayer),\n      center: point,\n      radii: vec3.fromValues(0, 0, 0),\n    };\n  }\n\n  getUpdatedAnnotation(\n      oldAnnotation: Ellipsoid, mouseState: MouseSelectionState,\n      annotationLayer: AnnotationLayerState) {\n    const spatialCenter =\n        vec3.transformMat4(vec3.create(), oldAnnotation.center, annotationLayer.objectToGlobal);\n\n    const radius = vec3.distance(spatialCenter, mouseState.position);\n\n    const tempMatrix = mat3.create();\n    tempMatrix[0] = tempMatrix[4] = tempMatrix[8] = 1 / (radius * radius);\n\n\n    const objectToGlobalLinearTransform =\n        mat3FromMat4(mat3.create(), annotationLayer.objectToGlobal);\n    mat3.multiply(tempMatrix, tempMatrix, objectToGlobalLinearTransform);\n    mat3.transpose(objectToGlobalLinearTransform, objectToGlobalLinearTransform);\n    mat3.multiply(tempMatrix, objectToGlobalLinearTransform, tempMatrix);\n\n    return <Ellipsoid>{\n      ...oldAnnotation,\n      radii: vec3.fromValues(\n          1 / Math.sqrt(tempMatrix[0]), 1 / Math.sqrt(tempMatrix[4]), 1 / Math.sqrt(tempMatrix[8])),\n    };\n  }\n  get description() {\n    return `annotate ellipsoid`;\n  }\n\n  toJSON() {\n    return ANNOTATE_ELLIPSOID_TOOL_ID;\n  }\n}\n\nregisterTool(\n    ANNOTATE_POINT_TOOL_ID,\n    (layer, options) => new PlacePointTool(<UserLayerWithAnnotations>layer, options));\nregisterTool(\n    ANNOTATE_BOUNDING_BOX_TOOL_ID,\n    (layer, options) => new PlaceBoundingBoxTool(<UserLayerWithAnnotations>layer, options));\nregisterTool(\n    ANNOTATE_LINE_TOOL_ID,\n    (layer, options) => new PlaceLineTool(<UserLayerWithAnnotations>layer, options));\nregisterTool(\n    ANNOTATE_ELLIPSOID_TOOL_ID,\n  (layer, options) => new PlaceSphereTool(<UserLayerWithAnnotations>layer, options));\n\nexport interface UserLayerWithAnnotations extends UserLayer {\n  annotationLayerState: WatchableRefCounted<AnnotationLayerState>;\n  selectedAnnotation: SelectedAnnotationState;\n  annotationColor: TrackableRGB;\n  annotationFillOpacity: TrackableAlphaValue;\n  initializeAnnotationLayerViewTab(tab: AnnotationLayerView): void;\n}\n\nexport function getAnnotationRenderOptions(userLayer: UserLayerWithAnnotations) {\n  return {color: userLayer.annotationColor, fillOpacity: userLayer.annotationFillOpacity};\n}\n\nconst SELECTED_ANNOTATION_JSON_KEY = 'selectedAnnotation';\nconst ANNOTATION_COLOR_JSON_KEY = 'annotationColor';\nconst ANNOTATION_FILL_OPACITY_JSON_KEY = 'annotationFillOpacity';\nexport function UserLayerWithAnnotationsMixin<TBase extends {new (...args: any[]): UserLayer}>(\n    Base: TBase) {\n  abstract class C extends Base implements UserLayerWithAnnotations {\n    annotationLayerState = this.registerDisposer(new WatchableRefCounted<AnnotationLayerState>());\n    selectedAnnotation =\n        this.registerDisposer(new SelectedAnnotationState(this.annotationLayerState.addRef()));\n    annotationColor = new TrackableRGB(vec3.fromValues(1, 1, 0));\n    annotationFillOpacity = trackableAlphaValue(0.0);\n\n    constructor(...args: any[]) {\n      super(...args);\n      this.selectedAnnotation.changed.add(this.specificationChanged.dispatch);\n      this.annotationColor.changed.add(this.specificationChanged.dispatch);\n      this.annotationFillOpacity.changed.add(this.specificationChanged.dispatch);\n      this.tabs.add('annotations', {\n        label: 'Annotations',\n        order: 10,\n        getter: () => new AnnotationTab(\n            this, this.selectedAnnotation.addRef(), this.manager.voxelSize.addRef(),\n            point => this.manager.setSpatialCoordinates(point))\n      });\n      this.annotationLayerState.changed.add(() => {\n        const state = this.annotationLayerState.value;\n        if (state !== undefined) {\n          const annotationLayer = new AnnotationLayer(this.manager.chunkManager, state.addRef());\n          setAnnotationHoverStateFromMouseState(state, this.manager.layerSelectedValues.mouseState);\n          this.addRenderLayer(new SliceViewAnnotationLayer(annotationLayer));\n          this.addRenderLayer(new PerspectiveViewAnnotationLayer(annotationLayer.addRef()));\n          if (annotationLayer.source instanceof MultiscaleAnnotationSource) {\n            const dataFetchLayer = this.registerDisposer(\n                new DataFetchSliceViewRenderLayer(annotationLayer.source.addRef()));\n            this.registerDisposer(registerNested(state.filterBySegmentation, (context, value) => {\n              if (!value) {\n                this.addRenderLayer(dataFetchLayer.addRef());\n                context.registerDisposer(() => this.removeRenderLayer(dataFetchLayer));\n              }\n            }));\n          }\n        }\n      });\n    }\n\n    restoreState(specification: any) {\n      super.restoreState(specification);\n      this.selectedAnnotation.restoreState(specification[SELECTED_ANNOTATION_JSON_KEY]);\n      this.annotationColor.restoreState(specification[ANNOTATION_COLOR_JSON_KEY]);\n      this.annotationFillOpacity.restoreState(specification[ANNOTATION_FILL_OPACITY_JSON_KEY]);\n    }\n\n    toJSON() {\n      const x = super.toJSON();\n      x[SELECTED_ANNOTATION_JSON_KEY] = this.selectedAnnotation.toJSON();\n      x[ANNOTATION_COLOR_JSON_KEY] = this.annotationColor.toJSON();\n      x[ANNOTATION_FILL_OPACITY_JSON_KEY] = this.annotationFillOpacity.toJSON();\n      return x;\n    }\n\n    initializeAnnotationLayerViewTab(tab: AnnotationLayerView) {\n      tab;\n    }\n  }\n  return C;\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for defining user-selectable annotation tools.\n */\n\nimport {MouseSelectionState, UserLayer} from 'neuroglancer/layer';\nimport {Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {verifyObject, verifyObjectProperty, verifyString} from 'neuroglancer/util/json';\n\nexport abstract class Tool extends RefCounted {\n  setActive(_value: boolean): void {}\n  abstract trigger(mouseState: MouseSelectionState): void;\n  abstract toJSON(): any;\n  deactivate(): void {}\n  description: string;\n}\n\nexport function restoreTool(layer: UserLayer, obj: any) {\n  if (obj === undefined) {\n    return undefined;\n  }\n  if (typeof obj === 'string') {\n    obj = {'type': obj};\n  }\n  verifyObject(obj);\n  const type = verifyObjectProperty(obj, 'type', verifyString);\n  const getter = tools.get(type);\n  if (getter === undefined) {\n    throw new Error(`Invalid tool type: ${JSON.stringify(obj)}.`);\n  }\n  return getter(layer, obj);\n}\n\nexport type ToolGetter = (layer: UserLayer, options: any) => Owned<Tool>;\n\nconst tools = new Map<string, ToolGetter>();\n\nexport function registerTool(type: string, getter: ToolGetter) {\n  tools.set(type, getter);\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {mat3, mat4, prod3, transformVectorByMat4, vec3} from 'neuroglancer/util/geom';\nimport {pickLengthUnit, pickVolumeUnit} from 'neuroglancer/widget/scale_bar';\n\nexport function formatIntegerPoint(point: vec3) {\n  return `(${Math.floor(point[0])}, ${Math.floor(point[1])}, ${Math.floor(point[2])})`;\n}\n\nexport function formatIntegerBounds(bounds: vec3) {\n  let result = '';\n  for (let i = 0; i < 3; ++i) {\n    if (i !== 0) {\n      result += '  ';\n    }\n    result += Math.round(Math.abs(bounds[i]));\n  }\n  return result;\n}\n\nexport function formatLength(lengthInNanometers: number) {\n  const unit = pickLengthUnit(lengthInNanometers);\n  const value = lengthInNanometers / unit.lengthInNanometers;\n  return `${value.toPrecision(3)}\\u202f${unit.unit}`;\n}\n\nexport function formatVolume(volumeInCubicNanometers: number) {\n  const unit = pickVolumeUnit(volumeInCubicNanometers);\n  const value = volumeInCubicNanometers / Math.pow(unit.lengthInNanometers, 3);\n  return `${value.toPrecision(6)}\\u202f${unit.unit}`;\n}\n\nexport function formatBoundingBoxVolume(pointA: vec3, pointB: vec3, transform: mat4) {\n  let dimensionText = '';\n  const vector = vec3.create();\n  for (let axis = 0; axis < 3; ++axis) {\n    vec3.set(vector, 0, 0, 0);\n    vector[axis] = pointB[axis] - pointA[axis];\n    const spatialVector = transformVectorByMat4(vector, vector, transform);\n    const length = vec3.length(spatialVector);\n    if (axis !== 0) {\n      dimensionText += '  ';\n    }\n    dimensionText += formatLength(length);\n  }\n\n  const preTransformVolume = Math.abs(prod3(vec3.subtract(vector, pointB, pointA)));\n  const det = mat3.determinant(mat3.fromMat4(mat3.create(), transform));\n  const postTransformVolume = det * preTransformVolume;\n\n  return `${dimensionText}  [${formatVolume(postTransformVolume)}]`;\n}\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./noselect.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./noselect.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./noselect.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {GL} from 'neuroglancer/webgl/context';\n\n/**\n * Sets parameters to make a texture suitable for use as a raw array: NEAREST\n * filtering, clamping.\n */\nexport function setRawTextureParameters(gl: WebGL2RenderingContext) {\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_MIN_FILTER, WebGL2RenderingContext.NEAREST);\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_MAG_FILTER, WebGL2RenderingContext.NEAREST);\n  // Prevents s-coordinate wrapping (repeating).  Repeating not\n  // permitted for non-power-of-2 textures.\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_WRAP_S, WebGL2RenderingContext.CLAMP_TO_EDGE);\n  // Prevents t-coordinate wrapping (repeating).  Repeating not\n  // permitted for non-power-of-2 textures.\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_WRAP_T, WebGL2RenderingContext.CLAMP_TO_EDGE);\n}\n\nexport function setRawTexture3DParameters(gl: WebGL2RenderingContext) {\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_3D, WebGL2RenderingContext.TEXTURE_MIN_FILTER, WebGL2RenderingContext.NEAREST);\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_3D, WebGL2RenderingContext.TEXTURE_MAG_FILTER, WebGL2RenderingContext.NEAREST);\n  // Prevents s-coordinate wrapping (repeating).  Repeating not\n  // permitted for non-power-of-2 textures.\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_3D, WebGL2RenderingContext.TEXTURE_WRAP_S, WebGL2RenderingContext.CLAMP_TO_EDGE);\n  // Prevents t-coordinate wrapping (repeating).  Repeating not\n  // permitted for non-power-of-2 textures.\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_3D, WebGL2RenderingContext.TEXTURE_WRAP_T, WebGL2RenderingContext.CLAMP_TO_EDGE);\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_3D, WebGL2RenderingContext.TEXTURE_WRAP_R, WebGL2RenderingContext.CLAMP_TO_EDGE);\n}\n\nexport function resizeTexture(\n    gl: GL, texture: WebGLTexture|null, width: number, height: number,\n    internalFormat: number = WebGL2RenderingContext.RGBA8, format: number = WebGL2RenderingContext.RGBA,\n    dataType: number = WebGL2RenderingContext.UNSIGNED_BYTE) {\n  gl.activeTexture(WebGL2RenderingContext.TEXTURE0 + gl.tempTextureUnit);\n  gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, texture);\n  setRawTextureParameters(gl);\n  gl.texImage2D(\n      WebGL2RenderingContext.TEXTURE_2D, 0,\n      /*internalformat=*/internalFormat,\n      /*width=*/width,\n      /*height=*/height,\n      /*border=*/0,\n      /*format=*/format, dataType, <any>null);\n  gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, null);\n}\n\nexport function setTextureFromCanvas(\n    gl: GL, texture: WebGLTexture|null, canvas: HTMLCanvasElement) {\n  gl.activeTexture(WebGL2RenderingContext.TEXTURE0 + gl.tempTextureUnit);\n  gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, texture);\n  gl.texParameteri(\n      WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_MIN_FILTER,\n      WebGL2RenderingContext.LINEAR);\n  gl.texParameteri(\n      WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_MAG_FILTER,\n      WebGL2RenderingContext.LINEAR);\n  // Prevents s-coordinate wrapping (repeating).  Repeating not permitted for non-power-of-2\n  // textures.\n  gl.texParameteri(\n      WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_WRAP_S,\n      WebGL2RenderingContext.CLAMP_TO_EDGE);\n  // Prevents t-coordinate wrapping (repeating).  Repeating not permitted for non-power-of-2\n  // textures.\n  gl.texParameteri(\n      WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_WRAP_T,\n      WebGL2RenderingContext.CLAMP_TO_EDGE);\n  gl.pixelStorei(WebGL2RenderingContext.UNPACK_FLIP_Y_WEBGL, 1);\n  gl.pixelStorei(WebGL2RenderingContext.UNPACK_ALIGNMENT, 4);\n  gl.texImage2D(\n      WebGL2RenderingContext.TEXTURE_2D, /*level=*/ 0,\n      /*internalformat=*/ WebGL2RenderingContext.RGBA8,\n      /*format=*/ WebGL2RenderingContext.RGBA, WebGL2RenderingContext.UNSIGNED_BYTE, canvas);\n  gl.pixelStorei(WebGL2RenderingContext.UNPACK_FLIP_Y_WEBGL, 0);\n  gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, null);\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for drawing quads in WebGL as two triangles.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Buffer, getMemoizedBuffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\n\nexport const VERTICES_PER_QUAD = 4;\nexport const TRIANGLES_PER_QUAD = 2;\nexport const INDICES_PER_QUAD = TRIANGLES_PER_QUAD * 3;\n\n/**\n * Returns a WebGL2RenderingContext.TRIANGLES index array for drawing an instance containing\n * `quadsPerInstance` quads.\n */\nfunction getQuadIndexArray(quadsPerInstance: number) {\n  const result = new Uint16Array(quadsPerInstance * INDICES_PER_QUAD);\n  for (let quad = 0; quad < quadsPerInstance; ++quad) {\n    const v = quad * VERTICES_PER_QUAD;\n    let i = quad * INDICES_PER_QUAD;\n    result[i] = v;\n    result[i + 1] = v + 1;\n    result[i + 2] = v + 2;\n    result[i + 3] = v + 2;\n    result[i + 4] = v + 3;\n    result[i + 5] = v;\n  }\n  return result;\n}\n\nexport class QuadRenderHelper extends RefCounted {\n  quadIndexBuffer: Buffer;\n  constructor(gl: GL, public quadsPerInstance: number) {\n    super();\n    if (quadsPerInstance !== 1) {\n      this.quadIndexBuffer =\n          this.registerDisposer(getMemoizedBuffer(\n                                    gl, WebGL2RenderingContext.ELEMENT_ARRAY_BUFFER,\n                                    getQuadIndexArray, quadsPerInstance))\n              .value;\n    }\n  }\n\n  draw(gl: GL, numInstances: number) {\n    if (this.quadsPerInstance === 1) {\n      gl.drawArraysInstanced(WebGL2RenderingContext.TRIANGLE_FAN, 0, 4, numInstances);\n    } else {\n      this.quadIndexBuffer.bind();\n      gl.drawElementsInstanced(\n          WebGL2RenderingContext.TRIANGLES, INDICES_PER_QUAD * this.quadsPerInstance,\n          WebGL2RenderingContext.UNSIGNED_SHORT, /*offset=*/0, numInstances);\n    }\n  }\n}\n","export default \"\\n\\nvec3 colormapJet(float x) {\\n  vec3 result;\\n  result.r = x < 0.89 ? ((x - 0.35) / 0.31) : (1.0 - (x - 0.89) / 0.11 * 0.5);\\n  result.g = x < 0.64 ? ((x - 0.125) * 4.0) : (1.0 - (x - 0.64) / 0.27);\\n  result.b = x < 0.34 ? (0.5 + x * 0.5 / 0.11) : (1.0 - (x - 0.34) / 0.31);\\n  return clamp(result, 0.0, 1.0);\\n}\\n\\n\\nvec3 colormapCubehelix(float x) {\\n    float xclamp = clamp(x, 0.0, 1.0);\\n    float angle = 2.0 * 3.1415926 * (4.0 / 3.0 + xclamp);\\n    float amp = xclamp * (1.0 - xclamp) / 2.0;\\n    vec3 result;\\n    float cosangle = cos(angle);\\n    float sinangle = sin(angle);\\n    result.r = -0.14861 * cosangle + 1.78277 * sinangle;\\n    result.g = -0.29227 * cosangle + -0.90649 * sinangle;\\n    result.b = 1.97294 * cosangle;\\n    result = clamp(xclamp + amp * result, 0.0, 1.0);\\n    return result;\\n}\\n\"","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './text_icon_button.css';\n\nexport function makeTextIconButton(iconText: string, title?: string) {\n  const element = document.createElement('div');\n  const innerElement = document.createElement('div');\n  innerElement.textContent = iconText;\n  element.className = 'neuroglancer-icon-button';\n  element.appendChild(innerElement);\n  if (title !== undefined) {\n    element.title = title;\n  }\n  return element;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted, RefCountedValue} from 'neuroglancer/util/disposable';\nimport {stableStringify} from 'neuroglancer/util/json';\n\nexport class Memoize<Key, Value extends RefCounted> {\n  private map = new Map<Key, Value>();\n\n  /**\n   * If getter throws an exception, no value is added.\n   */\n  get<T extends Value>(key: Key, getter: () => T): T {\n    let {map} = this;\n    let obj = <T>map.get(key);\n    if (obj === undefined) {\n      obj = getter();\n      obj.registerDisposer(() => {\n        map.delete(key);\n      });\n      map.set(key, obj);\n    } else {\n      obj.addRef();\n    }\n    return obj;\n  }\n}\n\nexport class StringMemoize extends Memoize<string, RefCounted> {\n  get<T extends RefCounted>(x: any, getter: () => T) {\n    if (typeof x !== 'string') {\n      x = stableStringify(x);\n    }\n    return super.get(x, getter);\n  }\n\n  getUncounted<T>(x: any, getter: () => T) {\n    return this.get(x, () => new RefCountedValue(getter())).value;\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationLayerState} from 'neuroglancer/annotation/frontend';\nimport {LayerManager, MouseSelectionState} from 'neuroglancer/layer';\n\nexport function getSelectedAnnotation(mouseState: MouseSelectionState, layerManager: LayerManager) {\n  if (!mouseState.active) {\n    return undefined;\n  }\n  if (mouseState.pickedAnnotationId === undefined) {\n    return undefined;\n  }\n  const renderLayer = mouseState.pickedRenderLayer;\n  if (renderLayer === null) {\n    return undefined;\n  }\n  const annotationLayer = mouseState.pickedAnnotationLayer;\n  if (annotationLayer === undefined) {\n    return undefined;\n  }\n  const managedLayer = layerManager.renderLayerToManagedLayerMap.get(renderLayer);\n  if (managedLayer === undefined) {\n    return undefined;\n  }\n\n  return {\n    layer: managedLayer,\n    annotationLayer,\n    id: mouseState.pickedAnnotationId,\n    partIndex: mouseState.pickedOffset,\n  };\n}\n\nexport function setAnnotationHoverStateFromMouseState(\n    annotationLayer: AnnotationLayerState, mouseState: MouseSelectionState) {\n  annotationLayer.registerDisposer(mouseState.changed.add(() => {\n    if (mouseState.active && mouseState.pickedAnnotationLayer === annotationLayer) {\n      const existingValue = annotationLayer.hoverState.value;\n      if (existingValue === undefined || existingValue.id !== mouseState.pickedAnnotationId! ||\n          existingValue.partIndex !== mouseState.pickedOffset) {\n        annotationLayer.hoverState.value = {\n          id: mouseState.pickedAnnotationId!,\n          partIndex: mouseState.pickedOffset\n        };\n      }\n    } else {\n      annotationLayer.hoverState.value = undefined;\n    }\n  }));\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facility for triggering named actions in response to mouse events.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {ActionEvent, dispatchEventWithModifiers, EventActionMap, EventActionMapInterface, registerActionListener} from 'neuroglancer/util/event_action_map';\n\nexport class MouseEventBinder<EventMap extends EventActionMapInterface> extends RefCounted {\n  private dispatch(baseIdentifier: string, event: MouseEvent) {\n    dispatchEventWithModifiers(baseIdentifier, event, event, this.eventMap);\n  }\n  constructor(public target: EventTarget, public eventMap: EventMap) {\n    super();\n    this.registerEventListener(target, 'wheel', (event: WheelEvent) => {\n      this.dispatch('wheel', event);\n    });\n    this.registerEventListener(target, 'click', (event: MouseEvent) => {\n      this.dispatch(`click${event.button}`, event);\n    });\n    this.registerEventListener(target, 'dblclick', (event: MouseEvent) => {\n      this.dispatch(`dblclick${event.button}`, event);\n    });\n    this.registerEventListener(target, 'mousedown', (event: MouseEvent) => {\n      this.dispatch(`mousedown${event.button}`, event);\n    });\n    this.registerEventListener(target, 'mouseup', (event: MouseEvent) => {\n      this.dispatch(`mouseup${event.button}`, event);\n    });\n  }\n}\n\nexport {EventActionMapInterface, EventActionMap, registerActionListener, ActionEvent};\n","var debounce = require('./debounce'),\n    isObject = require('./isObject');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nmodule.exports = throttle;\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file CredentialsManager for globally registering a CredentialsProvider\n */\n\nimport {CachingMapBasedCredentialsManager} from 'neuroglancer/credentials_provider';\n\nexport const defaultCredentialsManager = new CachingMapBasedCredentialsManager();\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {DataType} from 'neuroglancer/util/data_type';\nimport {vec3} from 'neuroglancer/util/geom';\n\nexport class ComputedVolumeChunkSourceParameters {\n  computationRef: any;\n  sourceRef: any;\n  inputSize: vec3;\n  scaleFactor: vec3;\n\n  static RPC_ID = 'computed/ComputedVolumeChunkSourceParameters';\n}\n\n\nexport interface ComputationBufferSpecification {\n  size: vec3;\n  dataType: DataType;\n  volumeType: VolumeType;\n  numChannels: number;\n}\n\n// Parameters that specify data type, volume type, and size for the input and\n// output buffers relative to a computation. This information will ultimately\n// pass to the VolumeComputationBackend that executes the computation. Extend\n// this interface to add parameters - any additional parameters should be\n// optional to allow direct assignment to work between types.\nexport class ComputationParameters {\n  // Specification for the buffer that is provided to a computation as an\n  // input. The DataType, VolumeType and channel count will match that of the\n  // origin volume chunk provider. Size is specified per-computation,\n  // independently of the origin volume.\n  inputSpec: ComputationBufferSpecification;\n\n  // Same, for the output. Size matches the native size for the\n  // ComputedVolumeChunkSource.\n  outputSpec: ComputationBufferSpecification;\n}\n\nexport function getArrayView(buffer: ArrayBuffer, type: DataType) {\n  switch (type) {\n    case DataType.UINT8:\n      return new Uint8Array(buffer);\n    case DataType.UINT16:\n      return new Uint16Array(buffer);\n    case DataType.UINT32:\n    case DataType.UINT64:\n      return new Uint32Array(buffer);\n    case DataType.FLOAT32:\n      return new Float32Array(buffer);\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nconst tempArray = new Float32Array(1);\n\n/**\n * Converts `x` into its nearest single precision float representation and\n * returns a minimal string representation, with as many digits as necessary\n * to uniquely distinguish single precision `x` from its adjacent single\n * precision values.\n *\n * E.g.: 0.299999999000000017179701217174d  0.30000001192092896f  '0.3')\n */\nexport function float32ToString(x: number) {\n  tempArray[0] = x;\n  x = tempArray[0];\n  for (let digits = 1; digits < 21; ++digits) {\n    let result = x.toPrecision(digits);\n    tempArray[0] = parseFloat(result);\n    if (tempArray[0] === x) {\n      return result;\n    }\n  }\n  return x.toString();\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {makeTextIconButton} from 'neuroglancer/widget/text_icon_button';\n\nexport function makeCloseButton() {\n  return makeTextIconButton('');\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'codemirror/addon/lint/lint.js';\nimport './shader_code_widget.css';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/addon/lint/lint.css';\n\nimport CodeMirror from 'codemirror';\nimport debounce from 'lodash/debounce';\nimport {WatchableValue} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {WatchableShaderError} from 'neuroglancer/webgl/dynamic_shader';\nimport {ShaderCompilationError, ShaderLinkError} from 'neuroglancer/webgl/shader';\n\nrequire<(codeMirror: typeof CodeMirror) => void>('glsl-editor/glsl')(CodeMirror);\n\n/**\n * Time in milliseconds during which the input field must not be modified before the shader is\n * recompiled.\n */\nconst SHADER_UPDATE_DELAY = 500;\n\ninterface ShaderCodeState {\n  shaderError: WatchableShaderError;\n  fragmentMain: WatchableValue<string>;\n  fragmentMainStartLine: string;\n}\n\nexport class ShaderCodeWidget extends RefCounted {\n  textEditor: CodeMirror.Editor;\n  get element() {\n    return this.textEditor.getWrapperElement();\n  }\n  private changingValue = false;\n  private debouncedValueUpdater = debounce(() => {\n    this.changingValue = true;\n    try {\n      this.state.fragmentMain.value = this.textEditor.getValue();\n    } finally {\n      this.changingValue = false;\n    }\n  }, SHADER_UPDATE_DELAY);\n\n  constructor(public state: ShaderCodeState) {\n    super();\n    this.textEditor = CodeMirror(_element => {}, {\n      value: this.state.fragmentMain.value,\n      mode: 'glsl',\n      gutters: ['CodeMirror-lint-markers'],\n    });\n    this.textEditor.on('change', () => {\n      this.setValidState(undefined);\n      this.debouncedValueUpdater();\n    });\n    this.registerDisposer(this.state.fragmentMain.changed.add(() => {\n      if (!this.changingValue) {\n        this.textEditor.setValue(this.state.fragmentMain.value);\n      }\n    }));\n    this.element.classList.add('neuroglancer-shader-code-widget');\n    this.registerDisposer(this.state.shaderError.changed.add(() => {\n      this.updateErrorState();\n    }));\n    this.updateErrorState();\n  }\n\n  updateErrorState() {\n    const error = this.state.shaderError.value;\n    if (error === undefined) {\n      this.setValidState(undefined);\n    } else if (error !== null) {\n      this.textEditor.setOption('lint', {\n        getAnnotations: () => {\n          if (error.name === 'ShaderCompilationError') {\n            let fragmentMainStartLineNumber = (<ShaderCompilationError>error)\n                                                  .source.split('\\n')\n                                                  .indexOf(this.state.fragmentMainStartLine) +\n                2;\n            return (<ShaderCompilationError>error).errorMessages.map(e => {\n              return {\n                message: e.message,\n                severity: 'error',\n                from:\n                    CodeMirror.Pos(e.line === undefined ? 0 : e.line - fragmentMainStartLineNumber),\n              };\n            });\n          } else if (error!.name === 'ShaderLinkError') {\n            return [{\n              message: (<ShaderLinkError>error).log,\n              severity: 'error',\n              from: CodeMirror.Pos(0),\n            }];\n          } else {\n            return [{\n              message: error!.message,\n              severity: 'error',\n              from: CodeMirror.Pos(0),\n            }];\n          }\n        },\n      });\n      this.setValidState(false);\n    } else {\n      this.textEditor.setOption('lint', undefined);\n      this.setValidState(true);\n    }\n  }\n\n  setValidState(valid?: boolean) {\n    let {element} = this;\n    element.classList.remove('invalid-input');\n    element.classList.remove('valid-input');\n    if (valid === true) {\n      element.classList.add('valid-input');\n    } else if (valid === false) {\n      element.classList.add('invalid-input');\n    }\n  }\n\n  disposed() {\n    (<{flush?: () => void}>this.debouncedValueUpdater).flush!();\n    this.debouncedValueUpdater = <any>undefined;\n    removeFromParent(this.element);\n    this.textEditor = <any>undefined;\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Tab for updating a coordinate transform.\n */\n\nimport './coordinate_transform.css';\n\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {float32ToString} from 'neuroglancer/util/float32_to_string';\nimport {Tab} from 'neuroglancer/widget/tab_view';\n\nexport class CoordinateTransformTab extends Tab {\n  private textArea = document.createElement('textarea');\n  private modelGeneration = -1;\n  constructor(public transform: CoordinateTransform) {\n    super();\n    const {element} = this;\n    element.classList.add('neuroglancer-coordinate-transform-widget');\n    const {textArea} = this;\n    const textAreaLabel = document.createElement('label');\n    textAreaLabel.className = 'neuroglancer-coordinate-transform-widget-homogeneous';\n    textAreaLabel.textContent = '34 Homogeneous transformation matrix';\n    textAreaLabel.appendChild(textArea);\n    element.appendChild(textAreaLabel);\n    this.registerDisposer(transform.changed.add(() => this.updateView()));\n    this.registerDisposer(this.visibility.changed.add(() => this.updateView()));\n    textArea.addEventListener('change', () => this.updateModel());\n    textArea.addEventListener('blur', () => this.updateModel());\n    textArea.title = 'Homogeneous transformation matrix';\n    textArea.rows = 3;\n    const resetButton = document.createElement('button');\n    resetButton.textContent = 'Reset to identity';\n    resetButton.addEventListener('click', () => this.transform.reset());\n    element.appendChild(resetButton);\n    this.updateView();\n  }\n\n  private updateView() {\n    if (!this.visible) {\n      return;\n    }\n    const generation = this.transform.changed.count;\n    if (this.modelGeneration !== generation) {\n      let value = '';\n      const {transform} = this.transform;\n      for (let i = 0; i < 3; ++i) {\n        if (i !== 0) {\n          value += '\\n';\n        }\n        for (let j = 0; j < 4; ++j) {\n          const x = transform[j * 4 + i];\n          if (j !== 0) {\n            value += ' ';\n          }\n          value += float32ToString(x);\n        }\n      }\n      this.textArea.value = value;\n      this.modelGeneration = generation;\n    }\n  }\n\n  private updateModel() {\n    const parts = this.textArea.value.split(/[\\s,\\[\\]\\(\\)\\{\\}]/).filter(x => x.length > 0);\n    if (parts.length === 12) {\n      const numbers: number[] = [];\n      for (let i = 0; i < 12; ++i) {\n        const n = parseFloat(parts[i]);\n        if (Number.isNaN(n)) {\n          return false;\n        }\n        numbers[i] = n;\n      }\n      const {transform} = this.transform;\n      transform[3] = transform[7] = transform[10] = 0;\n      transform[15] = 1;\n      for (let i = 0; i < 4; ++i) {\n        for (let j = 0; j < 3; ++j) {\n          transform[i * 4 + j] = numbers[i + j * 4];\n        }\n      }\n      this.transform.changed.dispatch();\n      return true;\n    }\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {UserLayer} from 'neuroglancer/layer';\nimport {CoordinateTransformTab} from 'neuroglancer/widget/coordinate_transform';\n\nconst TRANSFORM_JSON_KEY = 'transform';\n\nexport interface UserLayerWithCoordinateTransform extends UserLayer {\n  transform: CoordinateTransform;\n}\n\n/**\n * Mixin that adds a `transform` property to a user layer.\n */\nexport function UserLayerWithCoordinateTransformMixin<TBase extends {new (...args: any[]): UserLayer}>(\n    Base: TBase) {\n  class C extends Base implements UserLayerWithCoordinateTransform {\n    transform = new CoordinateTransform();\n\n    constructor(...args: any[]) {\n      super(...args);\n      this.transform.changed.add(this.specificationChanged.dispatch);\n      this.tabs.add('transform', {\n        label: 'Transform',\n        order: 100,\n        getter: () => new CoordinateTransformTab(this.transform)\n      });\n      const specification = args[1];\n      this.transform.restoreState(specification[TRANSFORM_JSON_KEY]);\n    }\n\n    toJSON(): any {\n      const x = super.toJSON();\n      x[TRANSFORM_JSON_KEY] = this.transform.toJSON();\n      return x;\n    }\n  }\n  return C;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for computing the intersection points between an axis-aligned bounding box and a\n * plane in a vertex shader.\n *\n * We use the approach described in the following paper to determine the\n * intersection between the\n * viewport plane and a given 3-D chunk inside of a WebGL vertex shader:\n *\n * A Vertex Program for Efficient Box-Plane Intersection\n * Christof Rezk Salama and Adreas Kolb\n * VMV 2005.\n * http://www.cg.informatik.uni-siegen.de/data/Publications/2005/rezksalamaVMV2005.pdf\n *\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4, transformVectorByMat4, vec3, vec3Key} from 'neuroglancer/util/geom';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nconst tempVec3 = vec3.create();\nconst tempVec3b = vec3.create();\n\n/**\n * Amount by which a computed intersection point may lie outside the [0, 1] range and still be\n * considered valid.  This needs to be non-zero in order to avoid vertex placement artifacts.\n */\nconst LAMBDA_EPSILON = 1e-3;\n\n/**\n * If the absolute value of the dot product of a cube edge direction and the viewport plane normal\n * is less than this value, intersections along that cube edge will be exluded.  This needs to be\n * non-zero in order to avoid vertex placement artifacts.\n */\nconst ORTHOGONAL_EPSILON = 1e-3;\n\nfunction findFrontVertexIndex(planeNormal: vec3) {\n  // Determine which vertex is front.\n  let frontVertexIndex = 0;\n  for (var axis_i = 0; axis_i < 3; ++axis_i) {\n    // If plane normal is negative in axis direction, then choose the vertex\n    // with the maximum axis_i-coordinate.\n    if (planeNormal[axis_i] < 0) {\n      frontVertexIndex += (1 << axis_i);\n    }\n  }\n  return frontVertexIndex;\n}\n\n// Specifies the positions of the 8 corners.\nexport const vertexBasePositions = new Float32Array([\n  0, 0, 0,  //\n  1, 0, 0,  //\n  0, 1, 0,  //\n  1, 1, 0,  //\n  0, 0, 1,  //\n  1, 0, 1,  //\n  0, 1, 1,  //\n  1, 1, 1,  //\n]);\n\nexport class SliceViewShaderBuffers extends RefCounted {\n  outputVertexIndices: Buffer;\n  vertexIndices: Int32Array;\n  constructor(gl: GL) {\n    super();\n    this.outputVertexIndices = this.registerDisposer(\n        Buffer.fromData(gl, new Float32Array([0, 1, 2, 3, 4, 5]), gl.ARRAY_BUFFER, gl.STATIC_DRAW));\n\n    // This specifies the original, \"uncorrected\" vertex positions.\n    // var vertexBasePositions = [\n    //   0, 0, 0,\n    //   1, 0, 0,\n    //   0, 1, 0,\n    //   0, 0, 1,\n    //   1, 0, 1,\n    //   1, 1, 0,\n    //   0, 1, 1,\n    //   1, 1, 1,\n    // ];\n\n    // correct_index, vertex_position, uncorrected_index\n    // 0:  0, 0, 0   0\n    // 1:  1, 0, 0   1\n    // 2:  0, 1, 0   2\n    // 4:  0, 0, 1   3\n    // 5:  1, 0, 1   4\n    // 3:  1, 1, 0   5\n    // 6:  0, 1, 1   6\n    // 7:  1, 1, 1   7\n\n    // This maps uncorrected vertex indices to corrected vertex indices.\n    let vertexUncorrectedToCorrected = [0, 1, 2, 4, 5, 3, 6, 7];\n\n    // This maps corrected vertex indices to uncorrected vertex indices.\n    let vertexCorrectedToUncorrected = [0, 1, 2, 5, 3, 4, 6, 7];\n\n\n    // Page 666\n    let vertexBaseIndices = [\n      0, 1, 1, 4, 4, 7, 4, 7,  //\n      1, 5, 0, 1, 1, 4, 4, 7,  //\n      0, 2, 2, 5, 5, 7, 5, 7,  //\n      2, 6, 0, 2, 2, 5, 5, 7,  //\n      0, 3, 3, 6, 6, 7, 6, 7,  //\n      3, 4, 0, 3, 3, 6, 6, 7,  //\n    ];\n\n    // Determined by looking at the figure and determining the corresponding\n    // vertex order for each possible front vertex.\n    let vertexPermutation = [\n      0, 1, 2, 3, 4, 5, 6, 7,  //\n      1, 4, 5, 0, 3, 7, 2, 6,  //\n      2, 6, 0, 5, 7, 3, 1, 4,  //\n      3, 0, 6, 4, 1, 2, 7, 5,  //\n      4, 3, 7, 1, 0, 6, 5, 2,  //\n      5, 2, 1, 7, 6, 0, 4, 3,  //\n      6, 7, 3, 2, 5, 4, 0, 1,  //\n      7, 5, 4, 6, 2, 1, 3, 0,  //\n    ];\n\n    let vertexIndices: number[] = [];\n    for (var p = 0; p < 8; ++p) {\n      for (var i = 0; i < vertexBaseIndices.length; ++i) {\n        const vertexPermutationIndex = vertexCorrectedToUncorrected[p] * 8 + vertexBaseIndices[i];\n        vertexIndices.push(vertexUncorrectedToCorrected[vertexPermutation[vertexPermutationIndex]]);\n      }\n    }\n\n    this.vertexIndices = new Int32Array(vertexIndices);\n  }\n\n  static get(gl: GL) {\n    return gl.memoize.get('SliceViewShaderBuffers', () => new SliceViewShaderBuffers(gl));\n  }\n}\n\nexport class BoundingBoxCrossSectionRenderHelper extends RefCounted {\n  data: SliceViewShaderBuffers;\n  static get(gl: GL) {\n    return gl.memoize.get(\n        'BoundingBoxCrossSectionRenderHelper',\n        () => new BoundingBoxCrossSectionRenderHelper(gl));\n  }\n  constructor(gl: GL) {\n    super();\n    this.data = this.registerDisposer(SliceViewShaderBuffers.get(gl));\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    // Slice plane normal.\n    builder.addUniform('highp vec3', 'uPlaneNormal');\n\n    // Distance from the origin to the slice plane.\n    builder.addUniform('highp float', 'uPlaneDistance');\n\n    // Two-dimensional array of dimensions [6x4], specifying the first and\n    // second vertex index for each of the 4 candidate edges to test for each\n    // computed vertex.\n    builder.addUniform('highp ivec2', 'uVertexIndex', 24);\n\n    // Base vertex positions.\n    builder.addUniform('highp vec3', 'uVertexBasePosition', 8);\n    builder.addInitializer(shader => {\n      shader.gl.uniform3fv(\n          shader.uniform('uVertexBasePosition'), vertexBasePositions);\n    });\n\n    builder.addVertexCode(`\nvec3 getBoundingBoxPlaneIntersectionVertexPosition(vec3 chunkSize, vec3 boxLower, vec3 lowerClipBound, vec3 upperClipBound, int vertexIndex) {\n  for (int e = 0; e < 4; ++e) {\n    highp ivec2 vidx = uVertexIndex[vertexIndex*4 + e];\n    highp vec3 v1 = max(lowerClipBound, min(upperClipBound, chunkSize * uVertexBasePosition[vidx.x] + boxLower));\n    highp vec3 v2 = max(lowerClipBound, min(upperClipBound, chunkSize * uVertexBasePosition[vidx.y] + boxLower));\n    highp vec3 vDir = v2 - v1;\n    highp float denom = dot(vDir, uPlaneNormal);\n    if (abs(denom) > ${ORTHOGONAL_EPSILON}) {\n      highp float lambda = (uPlaneDistance - dot(v1, uPlaneNormal)) / denom;\n      if ((lambda >= -${LAMBDA_EPSILON}) && (lambda <= (1.0 + ${LAMBDA_EPSILON}))) {\n        lambda = clamp(lambda, 0.0, 1.0);\n        highp vec3 position = v1 + lambda * vDir;\n        return position;\n      }\n    }\n  }\n  return vec3(0, 0, 0);\n}\n`);\n  }\n\n  computeVertexPositionDebug(\n      chunkSize: vec3, uLowerClipBound: vec3, uUpperClipBound: vec3, uPlaneDistance: number,\n      uPlaneNormal: vec3, uTranslation: vec3, vertexIndex: number): vec3|undefined {\n    let frontVertexIndex = findFrontVertexIndex(uPlaneNormal);\n    let uVertexIndex =\n        this.data.vertexIndices.subarray(frontVertexIndex * 48, (frontVertexIndex + 1) * 48);\n    let vidx = [0, 0];\n    let v = [vec3.create(), vec3.create()];\n    let vDir = vec3.create(), position = vec3.create();\n    let uVertexBasePosition = (i: number) => <vec3>vertexBasePositions.subarray(i * 3, i * 3 + 3);\n    for (let e = 0; e < 4; ++e) {\n      for (let j = 0; j < 2; ++j) {\n        vidx[j] = uVertexIndex[2 * (vertexIndex * 4 + e) + j];\n        vec3.multiply(v[j], chunkSize, uVertexBasePosition(vidx[j]));\n        vec3.add(v[j], v[j], uTranslation);\n        vec3.min(v[j], v[j], uUpperClipBound);\n        vec3.max(v[j], v[j], uLowerClipBound);\n      }\n      vec3.subtract(vDir, v[1], v[0]);\n      let denom = vec3.dot(vDir, uPlaneNormal);\n      if (Math.abs(denom) > ORTHOGONAL_EPSILON) {\n        let lambda = (uPlaneDistance - vec3.dot(v[0], uPlaneNormal)) / denom;\n        if ((lambda >= -LAMBDA_EPSILON) && (lambda <= 1.0 + LAMBDA_EPSILON)) {\n          lambda = Math.max(0, Math.min(1, lambda));\n          vec3.scaleAndAdd(position, v[0], vDir, lambda);\n          return position;\n        } else {\n          console.log(\n              `vertex ${vertexIndex}, e = ${e}, skipped, deom = ${denom}, ` +\n              `vDir = ${vec3Key(vDir)}, ` +\n              `uPlaneNormal = ${vec3Key(uPlaneNormal)}, ` +\n              `lambda=${lambda}`);\n        }\n      } else {\n        console.log(\n            `vertex ${vertexIndex}, e = ${e}, skipped, deom = ${denom}, ` +\n            `vDir = ${vec3Key(vDir)}, uPlaneNormal = ${vec3Key(uPlaneNormal)}`);\n      }\n    }\n    return undefined;\n  }\n\n  setPlane(shader: ShaderProgram, planeNormal: vec3, planeDistanceToOrigin: number) {\n    const {gl} = shader;\n    gl.uniform3fv(shader.uniform('uPlaneNormal'), planeNormal);\n    gl.uniform1f(shader.uniform('uPlaneDistance'), planeDistanceToOrigin);\n\n    const frontVertexIndex = findFrontVertexIndex(planeNormal);\n    gl.uniform2iv(\n        shader.uniform('uVertexIndex'),\n        this.data.vertexIndices.subarray(frontVertexIndex * 48, (frontVertexIndex + 1) * 48));\n  }\n\n  setViewportPlane(\n      shader: ShaderProgram, viewportZAxis: vec3, viewportCenterPosition: vec3,\n      dataToObjectTransform: mat4) {\n    const localPlaneNormal = transformVectorByMat4(tempVec3, viewportZAxis, dataToObjectTransform);\n    const planeDistanceToOrigin = vec3.dot(\n        vec3.transformMat4(tempVec3b, viewportCenterPosition, dataToObjectTransform),\n        localPlaneNormal);\n    this.setPlane(shader, localPlaneNormal, planeDistanceToOrigin);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SliceViewChunkSource, SliceViewChunkSpecification, SliceViewChunkSpecificationBaseOptions, SliceViewChunkSpecificationOptions, SliceViewSourceOptions} from 'neuroglancer/sliceview/base';\nimport {getCombinedTransform} from 'neuroglancer/sliceview/base';\n\nexport enum VectorGraphicsType {\n  LINE,\n  POINT\n}\n\nexport interface RenderLayer {\n  sources: VectorGraphicsChunkSource[][]|null;\n}\n\nexport interface VectorGraphicsChunkSpecificationSourceOptions {\n  vectorGraphicsSourceOptions: VectorGraphicsSourceOptions;\n}\n\nexport interface VectorGraphicsSourceOptions extends SliceViewSourceOptions {}\n\nexport interface VectorGraphicsChunkSource extends SliceViewChunkSource {\n  spec: VectorGraphicsChunkSpecification;\n}\n\nexport type VectorGraphicsChunkSpecificationOptions = SliceViewChunkSpecificationOptions;\n\nexport interface VectorGraphicsChunkSpecificationDefaultChunkSizeOptions extends\n    SliceViewChunkSpecificationBaseOptions {}\n\n/**\n * Specifies a chunk layout and voxel size.\n */\nexport class VectorGraphicsChunkSpecification extends SliceViewChunkSpecification {\n  constructor(options: VectorGraphicsChunkSpecificationOptions) {\n    super(options);\n  }\n\n  static make(options: VectorGraphicsChunkSpecificationOptions&\n              {vectorGraphicsSourceOptions: VectorGraphicsSourceOptions}) {\n    return new VectorGraphicsChunkSpecification(Object.assign(\n        {}, options,\n        {transform: getCombinedTransform(options.transform, options.vectorGraphicsSourceOptions)}));\n  }\n\n  static fromObject(msg: any) {\n    return new VectorGraphicsChunkSpecification(msg);\n  }\n\n  toObject(): SliceViewChunkSpecificationOptions {\n    return super.toObject();\n  }\n}\n\nexport const VECTOR_GRAPHICS_RPC_ID = 'vectorgraphics';\nexport const VECTOR_GRAPHICS_RENDERLAYER_RPC_ID = 'vectorgraphics/RenderLayer';\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderModule, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nexport function defineCopyFragmentShader(builder: ShaderBuilder) {\n  builder.addOutputBuffer('vec4', 'v4f_fragColor', null);\n  builder.setFragmentMain('v4f_fragColor = getValue0();');\n}\n\nexport function elementWiseTextureShader(\n    gl: GL, shaderModule: ShaderModule = defineCopyFragmentShader,\n    numTextures: number = 1): ShaderProgram {\n  return gl.memoize.get(\n      `elementWiseTextureShader:${numTextures}:${getObjectId(shaderModule)}`, () => {\n        let builder = new ShaderBuilder(gl);\n        builder.addVarying('vec2', 'vTexCoord');\n        builder.addUniform('sampler2D', 'uSampler', numTextures);\n        builder.addInitializer(shader => {\n          let textureIndices: number[] = [];\n          for (let i = 0; i < numTextures; ++i) {\n            textureIndices[i] = i;\n          }\n          gl.uniform1iv(shader.uniform('uSampler'), textureIndices);\n        });\n        for (let i = 0; i < numTextures; ++i) {\n          builder.addFragmentCode(`\nvec4 getValue${i}() {\n  return texture(uSampler[${i}], vTexCoord);\n}\n`);\n        }\n        builder.addUniform('mat4', 'uProjectionMatrix');\n        builder.require(shaderModule);\n        builder.addAttribute('vec4', 'aVertexPosition');\n        builder.addAttribute('vec2', 'aTexCoord');\n        builder.setVertexMain(\n            'vTexCoord = aTexCoord; gl_Position = uProjectionMatrix * aVertexPosition;');\n        return builder.build();\n      });\n}\n\nexport function trivialTextureShader(gl: GL): ShaderProgram {\n  return elementWiseTextureShader(gl, defineCopyFragmentShader, 1);\n}\n\nexport function trivialColorShader(gl: GL): ShaderProgram {\n  return gl.memoize.get('trivialColorShader', () => {\n    let builder = new ShaderBuilder(gl);\n    builder.addVarying('vec4', 'vColor');\n    builder.addOutputBuffer('vec4', 'v4f_fragColor', null);\n    builder.setFragmentMain('v4f_fragColor = vColor;');\n    builder.addAttribute('vec4', 'aVertexPosition');\n    builder.addAttribute('vec4', 'aColor');\n    builder.addUniform('mat4', 'uProjectionMatrix');\n    builder.setVertexMain('vColor = aColor; gl_Position = uProjectionMatrix * aVertexPosition;');\n    return builder.build();\n  });\n}\n\nexport function trivialUniformColorShader(gl: GL): ShaderProgram {\n  return gl.memoize.get('trivialUniformColorShader', () => {\n    let builder = new ShaderBuilder(gl);\n    builder.addUniform('mat4', 'uProjectionMatrix');\n    builder.addAttribute('vec4', 'aVertexPosition');\n    builder.addUniform('vec4', 'uColor');\n    builder.addOutputBuffer('vec4', 'v4f_fragColor', null);\n    builder.setFragmentMain('v4f_fragColor = uColor;');\n    builder.setVertexMain('gl_Position = uProjectionMatrix * aVertexPosition;');\n    return builder.build();\n  });\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function hexEncodeByte(x: number) {\n  return ('0' + x.toString(16)).slice(-2);\n}\n\nexport function hexEncode(arr: Uint8Array) {\n  return Array.prototype.map.call(arr, hexEncodeByte).join('');\n}\n\nexport function hexDecode(x: string) {\n  if (!/^(?:[0-9a-fA-F]{2})*$/.test(x)) {\n    throw new Error('Invalid hex-encoded string');\n  }\n  const length = x.length / 2;\n  const result = new Uint8Array(length);\n  for (let i = 0; i < length; ++i) {\n    result[i] = parseInt(x.substr(i * 2, 2), 16);\n  }\n  return result;\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/widget/render_scale_widget.css';\n\nimport debounce from 'lodash/debounce';\nimport throttle from 'lodash/throttle';\nimport {getRenderScaleFromHistogramOffset, getRenderScaleHistogramOffset, numRenderScaleHistogramBins, RenderScaleHistogram} from 'neuroglancer/render_scale_statistics';\nimport {TrackableValueInterface, WatchableValue} from 'neuroglancer/trackable_value';\nimport {serializeColor} from 'neuroglancer/util/color';\nimport {hsvToRgb} from 'neuroglancer/util/colorspace';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {EventActionMap, registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {MouseEventBinder} from 'neuroglancer/util/mouse_bindings';\nimport {numberToStringFixed} from 'neuroglancer/util/number_to_string';\nimport {pickLengthUnit} from 'neuroglancer/widget/scale_bar';\nimport ResizeObserver from 'resize-observer-polyfill';\n\nconst updateInterval = 200;\n\nconst inputEventMap = EventActionMap.fromObject({\n  'mousedown0': {action: 'set'},\n  'wheel': {action: 'adjust-via-wheel'},\n  'dblclick0': {action: 'reset'},\n});\n\n\nfunction formatPixelNumber(x: number) {\n  if (x < 1 || x > 1024) {\n    const exponent = Math.log2(x) | 0;\n    const coeff = x / 2 ** exponent;\n    return `${numberToStringFixed(coeff, 1)}p${exponent}`;\n  }\n  return Math.round(x) + '';\n}\n\nexport class RenderScaleWidget extends RefCounted {\n  label = document.createElement('div');\n  element = document.createElement('div');\n  canvas = document.createElement('canvas');\n  legend = document.createElement('div');\n  legendRenderScale = document.createElement('div');\n  legendSpatialScale = document.createElement('div');\n  legendChunks = document.createElement('div');\n  private ctx = this.canvas.getContext('2d')!;\n  hoverTarget = new WatchableValue<[number, number]|undefined>(undefined);\n  private throttledUpdateView = this.registerCancellable(\n      throttle(() => this.debouncedUpdateView(), updateInterval, {leading: true, trailing: true}));\n  private debouncedUpdateView = this.registerCancellable(debounce(() => this.updateView(), 0));\n\n\n  constructor(\n      public histogram: RenderScaleHistogram, public target: TrackableValueInterface<number>) {\n    super();\n    const {canvas, label, element, legend, legendRenderScale, legendSpatialScale, legendChunks} =\n        this;\n    label.className = 'neuroglancer-render-scale-widget-prompt';\n    element.className = 'neuroglancer-render-scale-widget';\n    element.title = inputEventMap.describe();\n    legend.className = 'neuroglancer-render-scale-widget-legend';\n    element.appendChild(label);\n    element.appendChild(canvas);\n    element.appendChild(legend);\n    legendRenderScale.title = 'Target resolution of data in screen pixels';\n    legendChunks.title = 'Number of chunks rendered';\n    legend.appendChild(legendRenderScale);\n    legend.appendChild(legendChunks);\n    legend.appendChild(legendSpatialScale);\n    this.registerDisposer(histogram.changed.add(this.throttledUpdateView));\n    this.registerDisposer(histogram.visibility.changed.add(this.debouncedUpdateView));\n    this.registerDisposer(target.changed.add(this.debouncedUpdateView));\n    this.registerDisposer(new MouseEventBinder(canvas, inputEventMap));\n    this.registerDisposer(target.changed.add(this.debouncedUpdateView));\n    this.registerDisposer(this.hoverTarget.changed.add(this.debouncedUpdateView));\n\n    const getTargetValue = (event: MouseEvent) => {\n      const position = event.offsetX / canvas.width * numRenderScaleHistogramBins;\n      return getRenderScaleFromHistogramOffset(position);\n    };\n    this.registerEventListener(canvas, 'pointermove', (event: MouseEvent) => {\n      this.hoverTarget.value = [getTargetValue(event), event.offsetY];\n    });\n\n    this.registerEventListener(canvas, 'pointerleave', () => {\n      this.hoverTarget.value = undefined;\n    });\n\n    this.registerDisposer(registerActionListener<MouseEvent>(canvas, 'set', actionEvent => {\n      this.target.value = getTargetValue(actionEvent.detail);\n    }));\n\n    this.registerDisposer(\n        registerActionListener<WheelEvent>(canvas, 'adjust-via-wheel', actionEvent => {\n          const event = actionEvent.detail;\n          const {deltaY} = event;\n          if (deltaY === 0) {\n            return;\n          }\n          this.hoverTarget.value = undefined;\n          this.target.value *= 2 ** Math.sign(deltaY);\n          event.preventDefault();\n        }));\n\n\n    this.registerDisposer(registerActionListener(canvas, 'reset', event => {\n      this.hoverTarget.value = undefined;\n      this.target.reset();\n      event.preventDefault();\n    }));\n    const resizeObserver = new ResizeObserver(() => this.debouncedUpdateView());\n    resizeObserver.observe(canvas);\n    this.registerDisposer(() => resizeObserver.disconnect());\n    this.updateView();\n  }\n\n  updateView() {\n    const {ctx} = this;\n    const {canvas} = this;\n    const width = canvas.width = canvas.offsetWidth;\n    const height = canvas.height = canvas.offsetHeight;\n    const targetValue = this.target.value;\n    const hoverValue = this.hoverTarget.value;\n\n    {\n      const {legendRenderScale} = this;\n      const value = hoverValue === undefined ? targetValue : hoverValue[0];\n      const valueString = formatPixelNumber(value);\n      legendRenderScale.textContent = valueString + ' px';\n    }\n\n    function binToCanvasX(bin: number) {\n      return bin * width / numRenderScaleHistogramBins;\n    }\n\n    ctx.clearRect(0, 0, width, height);\n\n    const {histogram} = this;\n    // histogram.begin(this.frameNumberCounter.frameNumber);\n    const {value: histogramData, spatialScales} = histogram;\n\n    if (!histogram.visibility.visible) {\n      histogramData.fill(0);\n    }\n\n    const sortedSpatialScales = Array.from(spatialScales.keys());\n    sortedSpatialScales.sort();\n\n    const tempColor = vec3.create();\n\n    let maxCount = 1;\n    const numRows = spatialScales.size;\n    let totalPresent = 0, totalNotPresent = 0;\n    for (let bin = 0; bin < numRenderScaleHistogramBins; ++bin) {\n      let count = 0;\n      for (let row = 0; row < numRows; ++row) {\n        const index = row * numRenderScaleHistogramBins * 2 + bin;\n        const presentCount = histogramData[index];\n        const notPresentCount = histogramData[index + numRenderScaleHistogramBins];\n        totalPresent += presentCount;\n        totalNotPresent += notPresentCount;\n        count += presentCount + notPresentCount;\n      }\n      maxCount = Math.max(count, maxCount);\n    }\n\n    const maxBarHeight = height;\n\n    const yScale = maxBarHeight / Math.log(1 + maxCount);\n\n    function countToCanvasY(count: number) {\n      return height - Math.log(1 + count) * yScale;\n    }\n\n    let hoverSpatialScale: number|undefined = undefined;\n    if (hoverValue !== undefined) {\n      const i = Math.floor(getRenderScaleHistogramOffset(hoverValue[0]));\n      if (i >= 0 && i < numRenderScaleHistogramBins) {\n        let sum = 0;\n        const hoverY = hoverValue[1];\n        for (let spatialScaleIndex = numRows - 1; spatialScaleIndex >= 0; --spatialScaleIndex) {\n          const spatialScale = sortedSpatialScales[spatialScaleIndex];\n          const row = spatialScales.get(spatialScale)!;\n          const index = 2 * row * numRenderScaleHistogramBins + i;\n          const count = histogramData[index] + histogramData[index + numRenderScaleHistogramBins];\n          if (count === 0) continue;\n          const yStart = Math.round(countToCanvasY(sum));\n          sum += count;\n          const yEnd = Math.round(countToCanvasY(sum));\n          if (yEnd <= hoverY && hoverY <= yStart) {\n            hoverSpatialScale = spatialScale;\n            break;\n          }\n        }\n      }\n    }\n    if (hoverSpatialScale !== undefined) {\n      totalPresent = 0;\n      totalNotPresent = 0;\n      const row = spatialScales.get(hoverSpatialScale)!;\n      const baseIndex = 2 * row * numRenderScaleHistogramBins;\n      for (let bin = 0; bin < numRenderScaleHistogramBins; ++bin) {\n        const index = baseIndex + bin;\n        totalPresent += histogramData[index];\n        totalNotPresent += histogramData[index + numRenderScaleHistogramBins];\n      }\n      if (Number.isFinite(hoverSpatialScale)) {\n        const unit = pickLengthUnit(hoverSpatialScale);\n        this.legendSpatialScale.textContent =\n            numberToStringFixed(hoverSpatialScale / unit.lengthInNanometers, 2) + ' ' + unit.unit;\n      } else {\n        this.legendSpatialScale.textContent = 'unknown';\n      }\n    } else {\n      this.legendSpatialScale.textContent = '';\n    }\n\n    this.legendChunks.textContent = `${totalPresent}/${totalPresent + totalNotPresent}`;\n\n    const spatialScaleColors = sortedSpatialScales.map(spatialScale => {\n      const saturation = spatialScale === hoverSpatialScale ? 0.5 : 1;\n      let hue;\n      if (Number.isFinite(spatialScale)) {\n        hue = (((Math.log2(spatialScale) * 0.1) % 1) + 1) % 1;\n      } else {\n        hue = 0;\n      }\n      hsvToRgb(tempColor, hue, saturation, 1);\n      const presentColor = serializeColor(tempColor);\n      hsvToRgb(tempColor, hue, saturation, 0.5);\n      const notPresentColor = serializeColor(tempColor);\n      return [presentColor, notPresentColor];\n    });\n\n    for (let i = 0; i < numRenderScaleHistogramBins; ++i) {\n      let sum = 0;\n      for (let spatialScaleIndex = numRows - 1; spatialScaleIndex >= 0; --spatialScaleIndex) {\n        const spatialScale = sortedSpatialScales[spatialScaleIndex];\n        const row = spatialScales.get(spatialScale)!;\n        const index = row * numRenderScaleHistogramBins * 2 + i;\n        const presentCount = histogramData[index];\n        const notPresentCount = histogramData[index + numRenderScaleHistogramBins];\n        const count = presentCount + notPresentCount;\n        if (count === 0) continue;\n        const xStart = Math.round(binToCanvasX(i));\n        const xEnd = Math.round(binToCanvasX(i + 1));\n        const yStart = Math.round(countToCanvasY(sum));\n        sum += count;\n        const yEnd = Math.round(countToCanvasY(sum));\n        const ySplit = (presentCount * yEnd + notPresentCount * yStart) / count;\n        ctx.fillStyle = spatialScaleColors[spatialScaleIndex][1];\n        ctx.fillRect(xStart, yEnd, xEnd - xStart, ySplit - yEnd);\n        ctx.fillStyle = spatialScaleColors[spatialScaleIndex][0];\n        ctx.fillRect(xStart, ySplit, xEnd - xStart, yStart - ySplit);\n      }\n    }\n\n    {\n      const value = targetValue;\n      ctx.fillStyle = '#fff';\n      const startOffset = binToCanvasX(getRenderScaleHistogramOffset(value));\n      const lineWidth = 1;\n      ctx.fillRect(Math.floor(startOffset), 0, lineWidth, height);\n    }\n\n    if (hoverValue !== undefined) {\n      const value = hoverValue[0];\n      ctx.fillStyle = '#888';\n      const startOffset = binToCanvasX(getRenderScaleHistogramOffset(value));\n      const lineWidth = 1;\n      ctx.fillRect(Math.floor(startOffset), 0, lineWidth, height);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function numberToStringFixed(v: number, maxDigits: number) {\n  let s = '';\n  for (let digits = 0; digits <= maxDigits; ++digits) {\n    s = v.toFixed(digits);\n    if (parseFloat(s) === v) {\n      break;\n    }\n  }\n  return s;\n}\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./button.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./button.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./button.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4} from 'neuroglancer/util/geom';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {trivialColorShader} from 'neuroglancer/webgl/trivial_shaders';\n\nexport class AxesLineHelper extends RefCounted {\n  vertexBuffer: Buffer;\n  colorBuffer: Buffer;\n  trivialColorShader: ShaderProgram;\n\n  constructor(public gl: GL) {\n    super();\n    this.vertexBuffer = this.registerDisposer(Buffer.fromData(\n        gl, new Float32Array([\n          0, 0, 0, 1,  //\n          1, 0, 0, 1,  //\n          0, 0, 0, 1,  //\n          0, 1, 0, 1,  //\n          0, 0, 0, 1,  //\n          0, 0, 1, 1,  //\n        ]),\n        gl.ARRAY_BUFFER, gl.STATIC_DRAW));\n\n    let alpha = 0.5;\n    this.colorBuffer = this.registerDisposer(Buffer.fromData(\n        gl, new Float32Array([\n          1, 0, 0, alpha,  //\n          1, 0, 0, alpha,  //\n          0, 1, 0, alpha,  //\n          0, 1, 0, alpha,  //\n          0, 0, 1, alpha,  //\n          0, 0, 1, alpha,  //\n        ]),\n        gl.ARRAY_BUFFER, gl.STATIC_DRAW));\n    this.trivialColorShader = this.registerDisposer(trivialColorShader(gl));\n  }\n\n  static get(gl: GL) {\n    return gl.memoize.get('SliceViewPanel:AxesLineHelper', () => new AxesLineHelper(gl));\n  }\n\n  draw(mat: mat4, blend = true) {\n    let shader = this.trivialColorShader;\n    let gl = this.gl;\n    shader.bind();\n    gl.uniformMatrix4fv(shader.uniform('uProjectionMatrix'), false, mat);\n    let aVertexPosition = shader.attribute('aVertexPosition');\n    this.vertexBuffer.bindToVertexAttrib(aVertexPosition, 4);\n\n    let aColor = shader.attribute('aColor');\n    this.colorBuffer.bindToVertexAttrib(aColor, 4);\n\n    if (blend) {\n      gl.colorMask(false, false, false, true);\n      gl.clearColor(0, 0, 0, 0);\n      gl.clear(gl.COLOR_BUFFER_BIT);\n      gl.colorMask(true, true, true, true);\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.ONE_MINUS_DST_ALPHA, gl.DST_ALPHA);\n    }\n\n\n    gl.lineWidth(1);\n    gl.drawArrays(gl.LINES, 0, 6);\n\n    if (blend) {\n      gl.disable(gl.BLEND);\n    }\n\n    gl.disableVertexAttribArray(aVertexPosition);\n    gl.disableVertexAttribArray(aColor);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {MouseSelectionState, RenderLayer} from 'neuroglancer/layer';\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nconst DEBUG_PICKING = false;\n\nexport class PickIDManager {\n  /**\n   * This specifies the render layer corresponding to each registered entry.\n   */\n  private renderLayers: (RenderLayer|null)[] = [null];\n\n  private pickData: any[] = [null];\n\n  /**\n   * This contains 3 consecutive values, specifying (startPickID, low, high), for each registered\n   * entry.  startPickID specifies the first uint32 pick ID corresponding to the entry.  low and\n   * high specify two additional numbers associated with the entry.\n   */\n  private values = [0, 0, 0];\n\n  private nextPickID = 1;\n\n  constructor() {}\n\n  clear() {\n    this.renderLayers.length = 1;\n    this.pickData.length = 1;\n    this.values.length = 3;\n    this.nextPickID = 1;\n  }\n\n  registerUint64(renderLayer: RenderLayer, x: Uint64, count = 1): number {\n    return this.register(renderLayer, count, x.low, x.high);\n  }\n\n  register(renderLayer: RenderLayer, count = 1, low = 0, high = 0, data: any = null): number {\n    let {renderLayers, values} = this;\n    let pickID = this.nextPickID;\n    this.nextPickID += count;\n    let index = renderLayers.length;\n    renderLayers[index] = renderLayer;\n    let valuesOffset = index * 3;\n    values[valuesOffset] = pickID;\n    values[valuesOffset + 1] = low;\n    values[valuesOffset + 2] = high;\n    this.pickData[index] = data;\n    return pickID;\n  }\n\n  /**\n   * Set the object state according to the specified pick ID.\n   */\n  setMouseState(mouseState: MouseSelectionState, pickID: number) {\n    // Binary search to find largest registered index with a pick ID <= pickID.\n    const {renderLayers, values} = this;\n    let lower = 0, upper = renderLayers.length - 1;\n    while (lower < upper) {\n      const mid = Math.ceil(lower + (upper - lower) / 2);\n      if (values[mid * 3] > pickID) {\n        upper = mid - 1;\n      } else {\n        lower = mid;\n      }\n    }\n    const pickedRenderLayer = mouseState.pickedRenderLayer = renderLayers[lower];\n    const valuesOffset = lower * 3;\n    const pickedOffset = mouseState.pickedOffset = pickID - values[valuesOffset];\n    if (DEBUG_PICKING) {\n      console.log(`Looking up pick ID ${pickID}: renderLayer`, pickedRenderLayer, `offset=${pickedOffset}`);\n    }\n    let {pickedValue} = mouseState;\n    pickedValue.low = values[valuesOffset + 1];\n    pickedValue.high = values[valuesOffset + 2];\n    mouseState.pickedAnnotationId = undefined;\n    mouseState.pickedAnnotationLayer = undefined;\n    if (pickedRenderLayer !== null) {\n      pickedRenderLayer.updateMouseState(mouseState, pickedValue, pickedOffset, this.pickData[lower]);\n    }\n  }\n}\n","/**\r\n * A collection of shims that provide minimal functionality of the ES6 collections.\r\n *\r\n * These implementations are not meant to be used outside of the ResizeObserver\r\n * modules as they cover only a limited range of use cases.\r\n */\r\n/* eslint-disable require-jsdoc, valid-jsdoc */\r\nvar MapShim = (function () {\r\n    if (typeof Map !== 'undefined') {\r\n        return Map;\r\n    }\r\n    /**\r\n     * Returns index in provided array that matches the specified key.\r\n     *\r\n     * @param {Array<Array>} arr\r\n     * @param {*} key\r\n     * @returns {number}\r\n     */\r\n    function getIndex(arr, key) {\r\n        var result = -1;\r\n        arr.some(function (entry, index) {\r\n            if (entry[0] === key) {\r\n                result = index;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        return result;\r\n    }\r\n    return /** @class */ (function () {\r\n        function class_1() {\r\n            this.__entries__ = [];\r\n        }\r\n        Object.defineProperty(class_1.prototype, \"size\", {\r\n            /**\r\n             * @returns {boolean}\r\n             */\r\n            get: function () {\r\n                return this.__entries__.length;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        /**\r\n         * @param {*} key\r\n         * @returns {*}\r\n         */\r\n        class_1.prototype.get = function (key) {\r\n            var index = getIndex(this.__entries__, key);\r\n            var entry = this.__entries__[index];\r\n            return entry && entry[1];\r\n        };\r\n        /**\r\n         * @param {*} key\r\n         * @param {*} value\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.set = function (key, value) {\r\n            var index = getIndex(this.__entries__, key);\r\n            if (~index) {\r\n                this.__entries__[index][1] = value;\r\n            }\r\n            else {\r\n                this.__entries__.push([key, value]);\r\n            }\r\n        };\r\n        /**\r\n         * @param {*} key\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.delete = function (key) {\r\n            var entries = this.__entries__;\r\n            var index = getIndex(entries, key);\r\n            if (~index) {\r\n                entries.splice(index, 1);\r\n            }\r\n        };\r\n        /**\r\n         * @param {*} key\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.has = function (key) {\r\n            return !!~getIndex(this.__entries__, key);\r\n        };\r\n        /**\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.clear = function () {\r\n            this.__entries__.splice(0);\r\n        };\r\n        /**\r\n         * @param {Function} callback\r\n         * @param {*} [ctx=null]\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.forEach = function (callback, ctx) {\r\n            if (ctx === void 0) { ctx = null; }\r\n            for (var _i = 0, _a = this.__entries__; _i < _a.length; _i++) {\r\n                var entry = _a[_i];\r\n                callback.call(ctx, entry[1], entry[0]);\r\n            }\r\n        };\r\n        return class_1;\r\n    }());\r\n})();\n\n/**\r\n * Detects whether window and document objects are available in current environment.\r\n */\r\nvar isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined' && window.document === document;\n\n// Returns global object of a current environment.\r\nvar global$1 = (function () {\r\n    if (typeof global !== 'undefined' && global.Math === Math) {\r\n        return global;\r\n    }\r\n    if (typeof self !== 'undefined' && self.Math === Math) {\r\n        return self;\r\n    }\r\n    if (typeof window !== 'undefined' && window.Math === Math) {\r\n        return window;\r\n    }\r\n    // eslint-disable-next-line no-new-func\r\n    return Function('return this')();\r\n})();\n\n/**\r\n * A shim for the requestAnimationFrame which falls back to the setTimeout if\r\n * first one is not supported.\r\n *\r\n * @returns {number} Requests' identifier.\r\n */\r\nvar requestAnimationFrame$1 = (function () {\r\n    if (typeof requestAnimationFrame === 'function') {\r\n        // It's required to use a bounded function because IE sometimes throws\r\n        // an \"Invalid calling object\" error if rAF is invoked without the global\r\n        // object on the left hand side.\r\n        return requestAnimationFrame.bind(global$1);\r\n    }\r\n    return function (callback) { return setTimeout(function () { return callback(Date.now()); }, 1000 / 60); };\r\n})();\n\n// Defines minimum timeout before adding a trailing call.\r\nvar trailingTimeout = 2;\r\n/**\r\n * Creates a wrapper function which ensures that provided callback will be\r\n * invoked only once during the specified delay period.\r\n *\r\n * @param {Function} callback - Function to be invoked after the delay period.\r\n * @param {number} delay - Delay after which to invoke callback.\r\n * @returns {Function}\r\n */\r\nfunction throttle (callback, delay) {\r\n    var leadingCall = false, trailingCall = false, lastCallTime = 0;\r\n    /**\r\n     * Invokes the original callback function and schedules new invocation if\r\n     * the \"proxy\" was called during current request.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    function resolvePending() {\r\n        if (leadingCall) {\r\n            leadingCall = false;\r\n            callback();\r\n        }\r\n        if (trailingCall) {\r\n            proxy();\r\n        }\r\n    }\r\n    /**\r\n     * Callback invoked after the specified delay. It will further postpone\r\n     * invocation of the original function delegating it to the\r\n     * requestAnimationFrame.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    function timeoutCallback() {\r\n        requestAnimationFrame$1(resolvePending);\r\n    }\r\n    /**\r\n     * Schedules invocation of the original function.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    function proxy() {\r\n        var timeStamp = Date.now();\r\n        if (leadingCall) {\r\n            // Reject immediately following calls.\r\n            if (timeStamp - lastCallTime < trailingTimeout) {\r\n                return;\r\n            }\r\n            // Schedule new call to be in invoked when the pending one is resolved.\r\n            // This is important for \"transitions\" which never actually start\r\n            // immediately so there is a chance that we might miss one if change\r\n            // happens amids the pending invocation.\r\n            trailingCall = true;\r\n        }\r\n        else {\r\n            leadingCall = true;\r\n            trailingCall = false;\r\n            setTimeout(timeoutCallback, delay);\r\n        }\r\n        lastCallTime = timeStamp;\r\n    }\r\n    return proxy;\r\n}\n\n// Minimum delay before invoking the update of observers.\r\nvar REFRESH_DELAY = 20;\r\n// A list of substrings of CSS properties used to find transition events that\r\n// might affect dimensions of observed elements.\r\nvar transitionKeys = ['top', 'right', 'bottom', 'left', 'width', 'height', 'size', 'weight'];\r\n// Check if MutationObserver is available.\r\nvar mutationObserverSupported = typeof MutationObserver !== 'undefined';\r\n/**\r\n * Singleton controller class which handles updates of ResizeObserver instances.\r\n */\r\nvar ResizeObserverController = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of ResizeObserverController.\r\n     *\r\n     * @private\r\n     */\r\n    function ResizeObserverController() {\r\n        /**\r\n         * Indicates whether DOM listeners have been added.\r\n         *\r\n         * @private {boolean}\r\n         */\r\n        this.connected_ = false;\r\n        /**\r\n         * Tells that controller has subscribed for Mutation Events.\r\n         *\r\n         * @private {boolean}\r\n         */\r\n        this.mutationEventsAdded_ = false;\r\n        /**\r\n         * Keeps reference to the instance of MutationObserver.\r\n         *\r\n         * @private {MutationObserver}\r\n         */\r\n        this.mutationsObserver_ = null;\r\n        /**\r\n         * A list of connected observers.\r\n         *\r\n         * @private {Array<ResizeObserverSPI>}\r\n         */\r\n        this.observers_ = [];\r\n        this.onTransitionEnd_ = this.onTransitionEnd_.bind(this);\r\n        this.refresh = throttle(this.refresh.bind(this), REFRESH_DELAY);\r\n    }\r\n    /**\r\n     * Adds observer to observers list.\r\n     *\r\n     * @param {ResizeObserverSPI} observer - Observer to be added.\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.addObserver = function (observer) {\r\n        if (!~this.observers_.indexOf(observer)) {\r\n            this.observers_.push(observer);\r\n        }\r\n        // Add listeners if they haven't been added yet.\r\n        if (!this.connected_) {\r\n            this.connect_();\r\n        }\r\n    };\r\n    /**\r\n     * Removes observer from observers list.\r\n     *\r\n     * @param {ResizeObserverSPI} observer - Observer to be removed.\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.removeObserver = function (observer) {\r\n        var observers = this.observers_;\r\n        var index = observers.indexOf(observer);\r\n        // Remove observer if it's present in registry.\r\n        if (~index) {\r\n            observers.splice(index, 1);\r\n        }\r\n        // Remove listeners if controller has no connected observers.\r\n        if (!observers.length && this.connected_) {\r\n            this.disconnect_();\r\n        }\r\n    };\r\n    /**\r\n     * Invokes the update of observers. It will continue running updates insofar\r\n     * it detects changes.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.refresh = function () {\r\n        var changesDetected = this.updateObservers_();\r\n        // Continue running updates if changes have been detected as there might\r\n        // be future ones caused by CSS transitions.\r\n        if (changesDetected) {\r\n            this.refresh();\r\n        }\r\n    };\r\n    /**\r\n     * Updates every observer from observers list and notifies them of queued\r\n     * entries.\r\n     *\r\n     * @private\r\n     * @returns {boolean} Returns \"true\" if any observer has detected changes in\r\n     *      dimensions of it's elements.\r\n     */\r\n    ResizeObserverController.prototype.updateObservers_ = function () {\r\n        // Collect observers that have active observations.\r\n        var activeObservers = this.observers_.filter(function (observer) {\r\n            return observer.gatherActive(), observer.hasActive();\r\n        });\r\n        // Deliver notifications in a separate cycle in order to avoid any\r\n        // collisions between observers, e.g. when multiple instances of\r\n        // ResizeObserver are tracking the same element and the callback of one\r\n        // of them changes content dimensions of the observed target. Sometimes\r\n        // this may result in notifications being blocked for the rest of observers.\r\n        activeObservers.forEach(function (observer) { return observer.broadcastActive(); });\r\n        return activeObservers.length > 0;\r\n    };\r\n    /**\r\n     * Initializes DOM listeners.\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.connect_ = function () {\r\n        // Do nothing if running in a non-browser environment or if listeners\r\n        // have been already added.\r\n        if (!isBrowser || this.connected_) {\r\n            return;\r\n        }\r\n        // Subscription to the \"Transitionend\" event is used as a workaround for\r\n        // delayed transitions. This way it's possible to capture at least the\r\n        // final state of an element.\r\n        document.addEventListener('transitionend', this.onTransitionEnd_);\r\n        window.addEventListener('resize', this.refresh);\r\n        if (mutationObserverSupported) {\r\n            this.mutationsObserver_ = new MutationObserver(this.refresh);\r\n            this.mutationsObserver_.observe(document, {\r\n                attributes: true,\r\n                childList: true,\r\n                characterData: true,\r\n                subtree: true\r\n            });\r\n        }\r\n        else {\r\n            document.addEventListener('DOMSubtreeModified', this.refresh);\r\n            this.mutationEventsAdded_ = true;\r\n        }\r\n        this.connected_ = true;\r\n    };\r\n    /**\r\n     * Removes DOM listeners.\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.disconnect_ = function () {\r\n        // Do nothing if running in a non-browser environment or if listeners\r\n        // have been already removed.\r\n        if (!isBrowser || !this.connected_) {\r\n            return;\r\n        }\r\n        document.removeEventListener('transitionend', this.onTransitionEnd_);\r\n        window.removeEventListener('resize', this.refresh);\r\n        if (this.mutationsObserver_) {\r\n            this.mutationsObserver_.disconnect();\r\n        }\r\n        if (this.mutationEventsAdded_) {\r\n            document.removeEventListener('DOMSubtreeModified', this.refresh);\r\n        }\r\n        this.mutationsObserver_ = null;\r\n        this.mutationEventsAdded_ = false;\r\n        this.connected_ = false;\r\n    };\r\n    /**\r\n     * \"Transitionend\" event handler.\r\n     *\r\n     * @private\r\n     * @param {TransitionEvent} event\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.onTransitionEnd_ = function (_a) {\r\n        var _b = _a.propertyName, propertyName = _b === void 0 ? '' : _b;\r\n        // Detect whether transition may affect dimensions of an element.\r\n        var isReflowProperty = transitionKeys.some(function (key) {\r\n            return !!~propertyName.indexOf(key);\r\n        });\r\n        if (isReflowProperty) {\r\n            this.refresh();\r\n        }\r\n    };\r\n    /**\r\n     * Returns instance of the ResizeObserverController.\r\n     *\r\n     * @returns {ResizeObserverController}\r\n     */\r\n    ResizeObserverController.getInstance = function () {\r\n        if (!this.instance_) {\r\n            this.instance_ = new ResizeObserverController();\r\n        }\r\n        return this.instance_;\r\n    };\r\n    /**\r\n     * Holds reference to the controller's instance.\r\n     *\r\n     * @private {ResizeObserverController}\r\n     */\r\n    ResizeObserverController.instance_ = null;\r\n    return ResizeObserverController;\r\n}());\n\n/**\r\n * Defines non-writable/enumerable properties of the provided target object.\r\n *\r\n * @param {Object} target - Object for which to define properties.\r\n * @param {Object} props - Properties to be defined.\r\n * @returns {Object} Target object.\r\n */\r\nvar defineConfigurable = (function (target, props) {\r\n    for (var _i = 0, _a = Object.keys(props); _i < _a.length; _i++) {\r\n        var key = _a[_i];\r\n        Object.defineProperty(target, key, {\r\n            value: props[key],\r\n            enumerable: false,\r\n            writable: false,\r\n            configurable: true\r\n        });\r\n    }\r\n    return target;\r\n});\n\n/**\r\n * Returns the global object associated with provided element.\r\n *\r\n * @param {Object} target\r\n * @returns {Object}\r\n */\r\nvar getWindowOf = (function (target) {\r\n    // Assume that the element is an instance of Node, which means that it\r\n    // has the \"ownerDocument\" property from which we can retrieve a\r\n    // corresponding global object.\r\n    var ownerGlobal = target && target.ownerDocument && target.ownerDocument.defaultView;\r\n    // Return the local global object if it's not possible extract one from\r\n    // provided element.\r\n    return ownerGlobal || global$1;\r\n});\n\n// Placeholder of an empty content rectangle.\r\nvar emptyRect = createRectInit(0, 0, 0, 0);\r\n/**\r\n * Converts provided string to a number.\r\n *\r\n * @param {number|string} value\r\n * @returns {number}\r\n */\r\nfunction toFloat(value) {\r\n    return parseFloat(value) || 0;\r\n}\r\n/**\r\n * Extracts borders size from provided styles.\r\n *\r\n * @param {CSSStyleDeclaration} styles\r\n * @param {...string} positions - Borders positions (top, right, ...)\r\n * @returns {number}\r\n */\r\nfunction getBordersSize(styles) {\r\n    var positions = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        positions[_i - 1] = arguments[_i];\r\n    }\r\n    return positions.reduce(function (size, position) {\r\n        var value = styles['border-' + position + '-width'];\r\n        return size + toFloat(value);\r\n    }, 0);\r\n}\r\n/**\r\n * Extracts paddings sizes from provided styles.\r\n *\r\n * @param {CSSStyleDeclaration} styles\r\n * @returns {Object} Paddings box.\r\n */\r\nfunction getPaddings(styles) {\r\n    var positions = ['top', 'right', 'bottom', 'left'];\r\n    var paddings = {};\r\n    for (var _i = 0, positions_1 = positions; _i < positions_1.length; _i++) {\r\n        var position = positions_1[_i];\r\n        var value = styles['padding-' + position];\r\n        paddings[position] = toFloat(value);\r\n    }\r\n    return paddings;\r\n}\r\n/**\r\n * Calculates content rectangle of provided SVG element.\r\n *\r\n * @param {SVGGraphicsElement} target - Element content rectangle of which needs\r\n *      to be calculated.\r\n * @returns {DOMRectInit}\r\n */\r\nfunction getSVGContentRect(target) {\r\n    var bbox = target.getBBox();\r\n    return createRectInit(0, 0, bbox.width, bbox.height);\r\n}\r\n/**\r\n * Calculates content rectangle of provided HTMLElement.\r\n *\r\n * @param {HTMLElement} target - Element for which to calculate the content rectangle.\r\n * @returns {DOMRectInit}\r\n */\r\nfunction getHTMLElementContentRect(target) {\r\n    // Client width & height properties can't be\r\n    // used exclusively as they provide rounded values.\r\n    var clientWidth = target.clientWidth, clientHeight = target.clientHeight;\r\n    // By this condition we can catch all non-replaced inline, hidden and\r\n    // detached elements. Though elements with width & height properties less\r\n    // than 0.5 will be discarded as well.\r\n    //\r\n    // Without it we would need to implement separate methods for each of\r\n    // those cases and it's not possible to perform a precise and performance\r\n    // effective test for hidden elements. E.g. even jQuery's ':visible' filter\r\n    // gives wrong results for elements with width & height less than 0.5.\r\n    if (!clientWidth && !clientHeight) {\r\n        return emptyRect;\r\n    }\r\n    var styles = getWindowOf(target).getComputedStyle(target);\r\n    var paddings = getPaddings(styles);\r\n    var horizPad = paddings.left + paddings.right;\r\n    var vertPad = paddings.top + paddings.bottom;\r\n    // Computed styles of width & height are being used because they are the\r\n    // only dimensions available to JS that contain non-rounded values. It could\r\n    // be possible to utilize the getBoundingClientRect if only it's data wasn't\r\n    // affected by CSS transformations let alone paddings, borders and scroll bars.\r\n    var width = toFloat(styles.width), height = toFloat(styles.height);\r\n    // Width & height include paddings and borders when the 'border-box' box\r\n    // model is applied (except for IE).\r\n    if (styles.boxSizing === 'border-box') {\r\n        // Following conditions are required to handle Internet Explorer which\r\n        // doesn't include paddings and borders to computed CSS dimensions.\r\n        //\r\n        // We can say that if CSS dimensions + paddings are equal to the \"client\"\r\n        // properties then it's either IE, and thus we don't need to subtract\r\n        // anything, or an element merely doesn't have paddings/borders styles.\r\n        if (Math.round(width + horizPad) !== clientWidth) {\r\n            width -= getBordersSize(styles, 'left', 'right') + horizPad;\r\n        }\r\n        if (Math.round(height + vertPad) !== clientHeight) {\r\n            height -= getBordersSize(styles, 'top', 'bottom') + vertPad;\r\n        }\r\n    }\r\n    // Following steps can't be applied to the document's root element as its\r\n    // client[Width/Height] properties represent viewport area of the window.\r\n    // Besides, it's as well not necessary as the <html> itself neither has\r\n    // rendered scroll bars nor it can be clipped.\r\n    if (!isDocumentElement(target)) {\r\n        // In some browsers (only in Firefox, actually) CSS width & height\r\n        // include scroll bars size which can be removed at this step as scroll\r\n        // bars are the only difference between rounded dimensions + paddings\r\n        // and \"client\" properties, though that is not always true in Chrome.\r\n        var vertScrollbar = Math.round(width + horizPad) - clientWidth;\r\n        var horizScrollbar = Math.round(height + vertPad) - clientHeight;\r\n        // Chrome has a rather weird rounding of \"client\" properties.\r\n        // E.g. for an element with content width of 314.2px it sometimes gives\r\n        // the client width of 315px and for the width of 314.7px it may give\r\n        // 314px. And it doesn't happen all the time. So just ignore this delta\r\n        // as a non-relevant.\r\n        if (Math.abs(vertScrollbar) !== 1) {\r\n            width -= vertScrollbar;\r\n        }\r\n        if (Math.abs(horizScrollbar) !== 1) {\r\n            height -= horizScrollbar;\r\n        }\r\n    }\r\n    return createRectInit(paddings.left, paddings.top, width, height);\r\n}\r\n/**\r\n * Checks whether provided element is an instance of the SVGGraphicsElement.\r\n *\r\n * @param {Element} target - Element to be checked.\r\n * @returns {boolean}\r\n */\r\nvar isSVGGraphicsElement = (function () {\r\n    // Some browsers, namely IE and Edge, don't have the SVGGraphicsElement\r\n    // interface.\r\n    if (typeof SVGGraphicsElement !== 'undefined') {\r\n        return function (target) { return target instanceof getWindowOf(target).SVGGraphicsElement; };\r\n    }\r\n    // If it's so, then check that element is at least an instance of the\r\n    // SVGElement and that it has the \"getBBox\" method.\r\n    // eslint-disable-next-line no-extra-parens\r\n    return function (target) { return (target instanceof getWindowOf(target).SVGElement &&\r\n        typeof target.getBBox === 'function'); };\r\n})();\r\n/**\r\n * Checks whether provided element is a document element (<html>).\r\n *\r\n * @param {Element} target - Element to be checked.\r\n * @returns {boolean}\r\n */\r\nfunction isDocumentElement(target) {\r\n    return target === getWindowOf(target).document.documentElement;\r\n}\r\n/**\r\n * Calculates an appropriate content rectangle for provided html or svg element.\r\n *\r\n * @param {Element} target - Element content rectangle of which needs to be calculated.\r\n * @returns {DOMRectInit}\r\n */\r\nfunction getContentRect(target) {\r\n    if (!isBrowser) {\r\n        return emptyRect;\r\n    }\r\n    if (isSVGGraphicsElement(target)) {\r\n        return getSVGContentRect(target);\r\n    }\r\n    return getHTMLElementContentRect(target);\r\n}\r\n/**\r\n * Creates rectangle with an interface of the DOMRectReadOnly.\r\n * Spec: https://drafts.fxtf.org/geometry/#domrectreadonly\r\n *\r\n * @param {DOMRectInit} rectInit - Object with rectangle's x/y coordinates and dimensions.\r\n * @returns {DOMRectReadOnly}\r\n */\r\nfunction createReadOnlyRect(_a) {\r\n    var x = _a.x, y = _a.y, width = _a.width, height = _a.height;\r\n    // If DOMRectReadOnly is available use it as a prototype for the rectangle.\r\n    var Constr = typeof DOMRectReadOnly !== 'undefined' ? DOMRectReadOnly : Object;\r\n    var rect = Object.create(Constr.prototype);\r\n    // Rectangle's properties are not writable and non-enumerable.\r\n    defineConfigurable(rect, {\r\n        x: x, y: y, width: width, height: height,\r\n        top: y,\r\n        right: x + width,\r\n        bottom: height + y,\r\n        left: x\r\n    });\r\n    return rect;\r\n}\r\n/**\r\n * Creates DOMRectInit object based on the provided dimensions and the x/y coordinates.\r\n * Spec: https://drafts.fxtf.org/geometry/#dictdef-domrectinit\r\n *\r\n * @param {number} x - X coordinate.\r\n * @param {number} y - Y coordinate.\r\n * @param {number} width - Rectangle's width.\r\n * @param {number} height - Rectangle's height.\r\n * @returns {DOMRectInit}\r\n */\r\nfunction createRectInit(x, y, width, height) {\r\n    return { x: x, y: y, width: width, height: height };\r\n}\n\n/**\r\n * Class that is responsible for computations of the content rectangle of\r\n * provided DOM element and for keeping track of it's changes.\r\n */\r\nvar ResizeObservation = /** @class */ (function () {\r\n    /**\r\n     * Creates an instance of ResizeObservation.\r\n     *\r\n     * @param {Element} target - Element to be observed.\r\n     */\r\n    function ResizeObservation(target) {\r\n        /**\r\n         * Broadcasted width of content rectangle.\r\n         *\r\n         * @type {number}\r\n         */\r\n        this.broadcastWidth = 0;\r\n        /**\r\n         * Broadcasted height of content rectangle.\r\n         *\r\n         * @type {number}\r\n         */\r\n        this.broadcastHeight = 0;\r\n        /**\r\n         * Reference to the last observed content rectangle.\r\n         *\r\n         * @private {DOMRectInit}\r\n         */\r\n        this.contentRect_ = createRectInit(0, 0, 0, 0);\r\n        this.target = target;\r\n    }\r\n    /**\r\n     * Updates content rectangle and tells whether it's width or height properties\r\n     * have changed since the last broadcast.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    ResizeObservation.prototype.isActive = function () {\r\n        var rect = getContentRect(this.target);\r\n        this.contentRect_ = rect;\r\n        return (rect.width !== this.broadcastWidth ||\r\n            rect.height !== this.broadcastHeight);\r\n    };\r\n    /**\r\n     * Updates 'broadcastWidth' and 'broadcastHeight' properties with a data\r\n     * from the corresponding properties of the last observed content rectangle.\r\n     *\r\n     * @returns {DOMRectInit} Last observed content rectangle.\r\n     */\r\n    ResizeObservation.prototype.broadcastRect = function () {\r\n        var rect = this.contentRect_;\r\n        this.broadcastWidth = rect.width;\r\n        this.broadcastHeight = rect.height;\r\n        return rect;\r\n    };\r\n    return ResizeObservation;\r\n}());\n\nvar ResizeObserverEntry = /** @class */ (function () {\r\n    /**\r\n     * Creates an instance of ResizeObserverEntry.\r\n     *\r\n     * @param {Element} target - Element that is being observed.\r\n     * @param {DOMRectInit} rectInit - Data of the element's content rectangle.\r\n     */\r\n    function ResizeObserverEntry(target, rectInit) {\r\n        var contentRect = createReadOnlyRect(rectInit);\r\n        // According to the specification following properties are not writable\r\n        // and are also not enumerable in the native implementation.\r\n        //\r\n        // Property accessors are not being used as they'd require to define a\r\n        // private WeakMap storage which may cause memory leaks in browsers that\r\n        // don't support this type of collections.\r\n        defineConfigurable(this, { target: target, contentRect: contentRect });\r\n    }\r\n    return ResizeObserverEntry;\r\n}());\n\nvar ResizeObserverSPI = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of ResizeObserver.\r\n     *\r\n     * @param {ResizeObserverCallback} callback - Callback function that is invoked\r\n     *      when one of the observed elements changes it's content dimensions.\r\n     * @param {ResizeObserverController} controller - Controller instance which\r\n     *      is responsible for the updates of observer.\r\n     * @param {ResizeObserver} callbackCtx - Reference to the public\r\n     *      ResizeObserver instance which will be passed to callback function.\r\n     */\r\n    function ResizeObserverSPI(callback, controller, callbackCtx) {\r\n        /**\r\n         * Collection of resize observations that have detected changes in dimensions\r\n         * of elements.\r\n         *\r\n         * @private {Array<ResizeObservation>}\r\n         */\r\n        this.activeObservations_ = [];\r\n        /**\r\n         * Registry of the ResizeObservation instances.\r\n         *\r\n         * @private {Map<Element, ResizeObservation>}\r\n         */\r\n        this.observations_ = new MapShim();\r\n        if (typeof callback !== 'function') {\r\n            throw new TypeError('The callback provided as parameter 1 is not a function.');\r\n        }\r\n        this.callback_ = callback;\r\n        this.controller_ = controller;\r\n        this.callbackCtx_ = callbackCtx;\r\n    }\r\n    /**\r\n     * Starts observing provided element.\r\n     *\r\n     * @param {Element} target - Element to be observed.\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.observe = function (target) {\r\n        if (!arguments.length) {\r\n            throw new TypeError('1 argument required, but only 0 present.');\r\n        }\r\n        // Do nothing if current environment doesn't have the Element interface.\r\n        if (typeof Element === 'undefined' || !(Element instanceof Object)) {\r\n            return;\r\n        }\r\n        if (!(target instanceof getWindowOf(target).Element)) {\r\n            throw new TypeError('parameter 1 is not of type \"Element\".');\r\n        }\r\n        var observations = this.observations_;\r\n        // Do nothing if element is already being observed.\r\n        if (observations.has(target)) {\r\n            return;\r\n        }\r\n        observations.set(target, new ResizeObservation(target));\r\n        this.controller_.addObserver(this);\r\n        // Force the update of observations.\r\n        this.controller_.refresh();\r\n    };\r\n    /**\r\n     * Stops observing provided element.\r\n     *\r\n     * @param {Element} target - Element to stop observing.\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.unobserve = function (target) {\r\n        if (!arguments.length) {\r\n            throw new TypeError('1 argument required, but only 0 present.');\r\n        }\r\n        // Do nothing if current environment doesn't have the Element interface.\r\n        if (typeof Element === 'undefined' || !(Element instanceof Object)) {\r\n            return;\r\n        }\r\n        if (!(target instanceof getWindowOf(target).Element)) {\r\n            throw new TypeError('parameter 1 is not of type \"Element\".');\r\n        }\r\n        var observations = this.observations_;\r\n        // Do nothing if element is not being observed.\r\n        if (!observations.has(target)) {\r\n            return;\r\n        }\r\n        observations.delete(target);\r\n        if (!observations.size) {\r\n            this.controller_.removeObserver(this);\r\n        }\r\n    };\r\n    /**\r\n     * Stops observing all elements.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.disconnect = function () {\r\n        this.clearActive();\r\n        this.observations_.clear();\r\n        this.controller_.removeObserver(this);\r\n    };\r\n    /**\r\n     * Collects observation instances the associated element of which has changed\r\n     * it's content rectangle.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.gatherActive = function () {\r\n        var _this = this;\r\n        this.clearActive();\r\n        this.observations_.forEach(function (observation) {\r\n            if (observation.isActive()) {\r\n                _this.activeObservations_.push(observation);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Invokes initial callback function with a list of ResizeObserverEntry\r\n     * instances collected from active resize observations.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.broadcastActive = function () {\r\n        // Do nothing if observer doesn't have active observations.\r\n        if (!this.hasActive()) {\r\n            return;\r\n        }\r\n        var ctx = this.callbackCtx_;\r\n        // Create ResizeObserverEntry instance for every active observation.\r\n        var entries = this.activeObservations_.map(function (observation) {\r\n            return new ResizeObserverEntry(observation.target, observation.broadcastRect());\r\n        });\r\n        this.callback_.call(ctx, entries, ctx);\r\n        this.clearActive();\r\n    };\r\n    /**\r\n     * Clears the collection of active observations.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.clearActive = function () {\r\n        this.activeObservations_.splice(0);\r\n    };\r\n    /**\r\n     * Tells whether observer has active observations.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    ResizeObserverSPI.prototype.hasActive = function () {\r\n        return this.activeObservations_.length > 0;\r\n    };\r\n    return ResizeObserverSPI;\r\n}());\n\n// Registry of internal observers. If WeakMap is not available use current shim\r\n// for the Map collection as it has all required methods and because WeakMap\r\n// can't be fully polyfilled anyway.\r\nvar observers = typeof WeakMap !== 'undefined' ? new WeakMap() : new MapShim();\r\n/**\r\n * ResizeObserver API. Encapsulates the ResizeObserver SPI implementation\r\n * exposing only those methods and properties that are defined in the spec.\r\n */\r\nvar ResizeObserver = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of ResizeObserver.\r\n     *\r\n     * @param {ResizeObserverCallback} callback - Callback that is invoked when\r\n     *      dimensions of the observed elements change.\r\n     */\r\n    function ResizeObserver(callback) {\r\n        if (!(this instanceof ResizeObserver)) {\r\n            throw new TypeError('Cannot call a class as a function.');\r\n        }\r\n        if (!arguments.length) {\r\n            throw new TypeError('1 argument required, but only 0 present.');\r\n        }\r\n        var controller = ResizeObserverController.getInstance();\r\n        var observer = new ResizeObserverSPI(callback, controller, this);\r\n        observers.set(this, observer);\r\n    }\r\n    return ResizeObserver;\r\n}());\r\n// Expose public methods of ResizeObserver.\r\n[\r\n    'observe',\r\n    'unobserve',\r\n    'disconnect'\r\n].forEach(function (method) {\r\n    ResizeObserver.prototype[method] = function () {\r\n        var _a;\r\n        return (_a = observers.get(this))[method].apply(_a, arguments);\r\n    };\r\n});\n\nvar index = (function () {\r\n    // Export existing implementation if available.\r\n    if (typeof global$1.ResizeObserver !== 'undefined') {\r\n        return global$1.ResizeObserver;\r\n    }\r\n    return ResizeObserver;\r\n})();\n\nexport default index;\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CredentialsProvider, CredentialsWithGeneration} from 'neuroglancer/credentials_provider';\nimport {CancellationToken, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {cancellableFetchOk, HttpError, ResponseTransform} from 'neuroglancer/util/http_request';\n\nexport async function fetchWithCredentials<Credentials, T>(\n    credentialsProvider: CredentialsProvider<Credentials>, input: RequestInfo, init: RequestInit,\n    transformResponse: ResponseTransform<T>,\n    applyCredentials: (credentials: Credentials, requestInit: RequestInit) => RequestInit,\n    errorHandler: (httpError: HttpError) => 'refresh' | 'retry',\n    cancellationToken: CancellationToken = uncancelableToken): Promise<T> {\n  let credentials: CredentialsWithGeneration<Credentials>|undefined;\n  credentialsLoop: while (true) {\n    credentials = await credentialsProvider.get(credentials, cancellationToken);\n    requestLoop: while (true) {\n      try {\n        return await cancellableFetchOk(\n            input, applyCredentials(credentials.credentials, init), transformResponse,\n            cancellationToken);\n      } catch (error) {\n        if (error instanceof HttpError) {\n          if (errorHandler(error) === 'refresh') continue credentialsLoop;\n          continue requestLoop;\n        }\n        throw error;\n      }\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {verifyEnumString} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\n\nexport class TrackableEnum<T extends number> implements Trackable {\n  changed = new NullarySignal();\n\n  constructor(\n      public enumType: {[x: string]: any},\n      private value_: T,\n      private defaultValue: T = value_,\n  ) {}\n\n  set value(value: T) {\n    if (this.value_ !== value) {\n      this.value_ = value;\n      this.changed.dispatch();\n    }\n  }\n\n  get value() {\n    return this.value_;\n  }\n\n  reset() {\n    this.value = this.defaultValue;\n  }\n\n  restoreState(obj: any) {\n    this.value = <T>verifyEnumString(obj, this.enumType);\n  }\n\n  toJSON(): string {\n    return this.enumType[<number>this.value_].toLowerCase();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {MultiscaleSliceViewChunkSource, SliceViewChunk, SliceViewChunkSource} from 'neuroglancer/sliceview/frontend';\nimport {SliceView} from 'neuroglancer/sliceview/frontend';\nimport {RenderLayer as GenericSliceViewRenderLayer} from 'neuroglancer/sliceview/renderlayer';\nimport {VectorGraphicsChunkSource as VectorGraphicsChunkSourceInterface, VectorGraphicsChunkSpecification, VectorGraphicsSourceOptions} from 'neuroglancer/sliceview/vector_graphics/base';\nimport {Owned} from 'neuroglancer/util/disposable';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderGetter} from 'neuroglancer/webgl/dynamic_shader';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {RpcId} from 'neuroglancer/worker_rpc';\n\nexport abstract class RenderLayer extends GenericSliceViewRenderLayer {\n  sources: VectorGraphicsChunkSource[][];\n  shader: ShaderProgram|undefined = undefined;\n  rpcId: RpcId|null = null;\n  protected shaderGetter: Owned<ShaderGetter>;\n\n  constructor(multiscaleSource: MultiscaleVectorGraphicsChunkSource, {\n    sourceOptions = <VectorGraphicsSourceOptions> {}\n  } = {}) {\n    super(multiscaleSource.chunkManager, multiscaleSource.getSources(sourceOptions), {});\n    this.shaderGetter = this.registerDisposer(new ShaderGetter(\n        this.gl, builder => this.defineShader(builder), () => this.getShaderKey()));\n  }\n\n  protected abstract getShaderKey(): string;\n\n  defineShader(builder: ShaderBuilder) {\n    builder.addFragmentCode(`\nvoid emit(vec4 color) {\n  v4f_fragColor = color;\n}\nvoid emitRGBA(vec4 rgba) {\n  emit(vec4(rgba.rgb, rgba.a * uOpacity));\n}\nvoid emitRGB(vec3 rgb) {\n  emit(vec4(rgb, uOpacity));\n}\nvoid emitGrayscale(float value) {\n  emit(vec4(value, value, value, uOpacity));\n}\nvoid emitTransparent() {\n  emit(vec4(0.0, 0.0, 0.0, 0.0));\n}\n`);\n  }\n\n  beginSlice(_sliceView: SliceView) {\n    let shader = this.shaderGetter.get();\n    if (shader === undefined) {\n      return undefined;\n    }\n    shader.bind();\n    return shader;\n  }\n\n  abstract endSlice(shader: ShaderProgram): void;\n\n  abstract draw(sliceView: SliceView): void;\n}\n\nexport class VectorGraphicsChunk extends SliceViewChunk {\n  source: VectorGraphicsChunkSource;\n  vertexPositions: Float32Array;\n  vertexBuffer: Buffer;\n  numPoints: number;\n\n  constructor(source: VectorGraphicsChunkSource, x: any) {\n    super(source, x);\n    this.vertexPositions = x['vertexPositions'];\n    this.numPoints = Math.floor(this.vertexPositions.length / 3);\n  }\n\n  copyToGPU(gl: GL) {\n    super.copyToGPU(gl);\n    this.vertexBuffer = Buffer.fromData(gl, this.vertexPositions, gl.ARRAY_BUFFER, gl.STATIC_DRAW);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    this.vertexBuffer.dispose();\n  }\n}\n\nexport class VectorGraphicsChunkSource extends SliceViewChunkSource implements\n    VectorGraphicsChunkSourceInterface {\n  chunks: Map<string, VectorGraphicsChunk>;\n  spec: VectorGraphicsChunkSpecification;\n\n  getChunk(x: any): VectorGraphicsChunk {\n    return new VectorGraphicsChunk(this, x);\n  }\n\n  /**\n   * Specifies whether the point vertex coordinates are specified in units of voxels rather than\n   * nanometers.\n   */\n  get vectorGraphicsCoordinatesInVoxels() {\n    return true;\n  }\n}\n\nexport interface MultiscaleVectorGraphicsChunkSource extends MultiscaleSliceViewChunkSource {\n  /**\n   * @return Chunk sources for each scale, ordered by increasing minVoxelSize.  For each scale,\n   * there may be alternative sources with different chunk layouts.\n   */\n  getSources: (options: VectorGraphicsSourceOptions) => VectorGraphicsChunkSource[][];\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {getTransformedSources} from 'neuroglancer/sliceview/base';\nimport {BoundingBoxCrossSectionRenderHelper} from 'neuroglancer/sliceview/bounding_box_shader_helper';\nimport {ChunkLayout} from 'neuroglancer/sliceview/chunk_layout';\nimport {SliceView} from 'neuroglancer/sliceview/frontend';\nimport {RenderLayer as SliceViewRenderLayer, RenderLayerOptions as SliceViewRenderLayerOptions} from 'neuroglancer/sliceview/renderlayer';\nimport {VolumeChunkSpecification, VolumeSourceOptions} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {Owned} from 'neuroglancer/util/disposable';\nimport {BoundingBox, mat4, vec3, vec3Key} from 'neuroglancer/util/geom';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderGetter, WatchableShaderError} from 'neuroglancer/webgl/dynamic_shader';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {getShaderType} from 'neuroglancer/webgl/shader_lib';\n\nconst DEBUG_VERTICES = false;\n\n/**\n * Extra amount by which the chunk position computed in the vertex shader is shifted in the\n * direction of the component-wise absolute value of the plane normal.  In Neuroglancer, a\n * cross-section plane exactly on the boundary between two voxels is a common occurrence and is\n * intended to result in the display of the \"next\" (i.e. higher coordinate) plane rather than the\n * \"previous\" (lower coordinate) plane.  However, due to various sources of floating point\n * inaccuracy (in particular, shader code which has relaxed rules), values exactly on the boundary\n * between voxels may be slightly shifted in either direction.  To ensure that this doesn't result\n * in the display of the wrong data (i.e. the previous rather than next plane), we always shift\n * toward the \"next\" plane by this small amount.\n */\nconst CHUNK_POSITION_EPSILON = 1e-3;\n\nexport const glsl_getPositionWithinChunk = `\nhighp ivec3 getPositionWithinChunk () {\n  return ivec3(min(vChunkPosition, uChunkDataSize - 1.0));\n}\n`;\n\n\nconst tempMat4 = mat4.create();\nconst tempVec3 = vec3.create();\n\nclass VolumeSliceVertexComputationManager extends BoundingBoxCrossSectionRenderHelper {\n  static get(gl: GL) {\n    return gl.memoize.get(\n        'volume.VolumeSliceVertexComputationManager',\n        () => new VolumeSliceVertexComputationManager(gl));\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n\n    // A number in [0, 6) specifying which vertex to compute.\n    builder.addAttribute('highp float', 'aVertexIndexFloat');\n\n    // Specifies translation of the current chunk.\n    builder.addUniform('highp vec3', 'uTranslation');\n\n    // Matrix by which computed vertices will be transformed.\n    builder.addUniform('highp mat4', 'uProjectionMatrix');\n\n    // Chunk size in voxels.\n    builder.addUniform('highp vec3', 'uChunkDataSize');\n\n    // Size of a voxel in nanometers.\n    builder.addUniform('highp vec3', 'uVoxelSize');\n\n    builder.addUniform('highp vec3', 'uLowerClipBound');\n    builder.addUniform('highp vec3', 'uUpperClipBound');\n\n    // Position within chunk of vertex, in floating point range [0, chunkDataSize].\n    builder.addVarying('highp vec3', 'vChunkPosition');\n\n    builder.setVertexMain(`\nvec3 chunkSize = uChunkDataSize * uVoxelSize;\nvec3 position = getBoundingBoxPlaneIntersectionVertexPosition(chunkSize, uTranslation, uLowerClipBound, uUpperClipBound, int(aVertexIndexFloat));\ngl_Position = uProjectionMatrix * vec4(position, 1.0);\nvChunkPosition = (position - uTranslation) / uVoxelSize +\n    ${CHUNK_POSITION_EPSILON} * abs(uPlaneNormal);\n`);\n\n    builder.addFragmentCode(glsl_getPositionWithinChunk);\n  }\n\n  computeVerticesDebug(\n      uChunkDataSize: vec3, uVoxelSize: vec3, uLowerClipBound: vec3, uUpperClipBound: vec3,\n      uPlaneDistance: number, uPlaneNormal: vec3, uTranslation: vec3, uProjectionMatrix: mat4) {\n    let chunkSize = vec3.multiply(vec3.create(), uChunkDataSize, uVoxelSize);\n    let gl_Position = vec3.create(), vChunkPosition = vec3.create(),\n        planeNormalAbs = vec3.fromValues(\n            Math.abs(uPlaneNormal[0]), Math.abs(uPlaneNormal[1]), Math.abs(uPlaneNormal[2]));\n    for (let vertexIndex = 0; vertexIndex < 6; ++vertexIndex) {\n      const position = this.computeVertexPositionDebug(\n          chunkSize, uLowerClipBound, uUpperClipBound, uPlaneDistance, uPlaneNormal, uTranslation,\n          vertexIndex);\n      if (position === undefined) {\n        console.log('no intersection found');\n        return;\n      }\n      vec3.transformMat4(gl_Position, position, uProjectionMatrix);\n      vec3.sub(vChunkPosition, position, uTranslation);\n      vec3.divide(vChunkPosition, vChunkPosition, uVoxelSize);\n      vec3.scaleAndAdd(vChunkPosition, vChunkPosition, planeNormalAbs, CHUNK_POSITION_EPSILON);\n      console.log(`vertex ${vertexIndex}, at ${gl_Position}, vChunkPosition = ${vChunkPosition}`);\n    }\n  }\n\n  beginSlice(_gl: GL, shader: ShaderProgram) {\n    let aVertexIndexFloat = shader.attribute('aVertexIndexFloat');\n    this.data.outputVertexIndices.bindToVertexAttrib(aVertexIndexFloat, 1);\n  }\n\n  endSlice(gl: GL, shader: ShaderProgram) {\n    let aVertexIndexFloat = shader.attribute('aVertexIndexFloat');\n    gl.disableVertexAttribArray(aVertexIndexFloat);\n  }\n\n  beginSource(\n      gl: GL, shader: ShaderProgram, sliceView: SliceView, dataToDeviceMatrix: mat4,\n      spec: VolumeChunkSpecification, chunkLayout: ChunkLayout) {\n    this.setViewportPlane(\n        shader, sliceView.viewportAxes[2], sliceView.centerDataPosition, chunkLayout.invTransform);\n\n    // Compute projection matrix that transforms chunk layout coordinates to device coordinates.\n    gl.uniformMatrix4fv(\n        shader.uniform('uProjectionMatrix'), false,\n        mat4.multiply(tempMat4, dataToDeviceMatrix, chunkLayout.transform));\n\n    gl.uniform3fv(shader.uniform('uVoxelSize'), spec.voxelSize);\n    gl.uniform3fv(shader.uniform('uLowerClipBound'), spec.lowerClipBound);\n    gl.uniform3fv(shader.uniform('uUpperClipBound'), spec.upperClipBound);\n    if (DEBUG_VERTICES) {\n      (<any>window)['debug_sliceView_uVoxelSize'] = spec.voxelSize;\n      (<any>window)['debug_sliceView_uLowerClipBound'] = spec.lowerClipBound;\n      (<any>window)['debug_sliceView_uUpperClipBound'] = spec.upperClipBound;\n      (<any>window)['debug_sliceView'] = sliceView;\n      (<any>window)['debug_sliceView_dataToDevice'] = dataToDeviceMatrix;\n    }\n  }\n\n  setupChunkDataSize(gl: GL, shader: ShaderProgram, chunkDataSize: vec3) {\n    gl.uniform3fv(shader.uniform('uChunkDataSize'), chunkDataSize);\n\n    if (DEBUG_VERTICES) {\n      (<any>window)['debug_sliceView_chunkDataSize'] = chunkDataSize;\n    }\n  }\n\n  drawChunk(gl: GL, shader: ShaderProgram, chunkPosition: vec3) {\n    gl.uniform3fv(shader.uniform('uTranslation'), chunkPosition);\n    gl.drawArrays(gl.TRIANGLE_FAN, 0, 6);\n\n    if (DEBUG_VERTICES) {\n      let sliceView: SliceView = (<any>window)['debug_sliceView'];\n      let chunkDataSize: vec3 = (<any>window)['debug_sliceView_chunkDataSize'];\n      let voxelSize: vec3 = (<any>window)['debug_sliceView_uVoxelSize'];\n      let lowerClipBound: vec3 = (<any>window)['debug_sliceView_uLowerClipBound'];\n      let upperClipBound: vec3 = (<any>window)['debug_sliceView_uUpperClipBound'];\n      console.log(\n          `Drawing chunk: ${vec3Key(chunkPosition)} of data size ${vec3Key(chunkDataSize)}`);\n      let dataToDeviceMatrix: mat4 = (<any>window)['debug_sliceView_dataToDevice'];\n      this.computeVerticesDebug(\n          chunkDataSize, voxelSize, lowerClipBound, upperClipBound,\n          sliceView.viewportPlaneDistanceToOrigin, sliceView.viewportAxes[2], chunkPosition,\n          dataToDeviceMatrix);\n    }\n  }\n}\n\nexport interface RenderLayerOptions extends SliceViewRenderLayerOptions {\n  sourceOptions?: VolumeSourceOptions;\n  shaderError?: WatchableShaderError;\n}\n\nfunction medianOf3(a: number, b: number, c: number) {\n  return a > b ? (c > a ? a : (b > c ? b : c)) : (c > b ? b : (a > c ? a : c));\n}\n\nexport class RenderLayer extends SliceViewRenderLayer {\n  sources: VolumeChunkSource[][];\n  vertexComputationManager: VolumeSliceVertexComputationManager;\n  protected shaderGetter: Owned<ShaderGetter>;\n  constructor(multiscaleSource: MultiscaleVolumeChunkSource, options: RenderLayerOptions) {\n    const {sourceOptions = {}, shaderError} = options;\n    super(multiscaleSource.chunkManager, multiscaleSource.getSources(sourceOptions), options);\n    const {gl} = this;\n    this.shaderGetter = this.registerDisposer(new ShaderGetter(\n        gl, builder => this.defineShader(builder),\n        () => `${this.getShaderKey()}/${this.chunkFormat.shaderKey}`, shaderError));\n    this.vertexComputationManager = VolumeSliceVertexComputationManager.get(gl);\n\n    const transformedSources = getTransformedSources(this);\n\n    {\n      const {source, chunkLayout} = transformedSources[0][0];\n      const spec = <VolumeChunkSpecification>source.spec;\n\n      const boundingBox = this.boundingBox = new BoundingBox(\n          vec3.fromValues(Infinity, Infinity, Infinity),\n          vec3.fromValues(-Infinity, -Infinity, -Infinity));\n      const globalCorner = vec3.create();\n      const localCorner = tempVec3;\n\n      for (let cornerIndex = 0; cornerIndex < 8; ++cornerIndex) {\n        for (let i = 0; i < 3; ++i) {\n          localCorner[i] = cornerIndex & (1 << i) ? spec.upperClipBound[i] : spec.lowerClipBound[i];\n        }\n        chunkLayout.localSpatialToGlobal(globalCorner, localCorner);\n        vec3.min(boundingBox.lower, boundingBox.lower, globalCorner);\n        vec3.max(boundingBox.upper, boundingBox.upper, globalCorner);\n      }\n    }\n  }\n\n  get dataType() {\n    return this.sources![0][0].spec.dataType;\n  }\n\n  get chunkFormat() {\n    return this.sources![0][0].chunkFormat;\n  }\n\n  getValueAt(position: vec3) {\n    for (let alternatives of getTransformedSources(this)) {\n      for (let transformedSource of alternatives) {\n        const source = transformedSource.source as VolumeChunkSource;\n        let result = source.getValueAt(position, transformedSource.chunkLayout);\n        if (result != null) {\n          return result;\n        }\n      }\n    }\n    return null;\n  }\n\n  protected getShaderKey() {\n    return this.chunkFormat.shaderKey;\n  }\n\n  protected defineShader(builder: ShaderBuilder) {\n    this.vertexComputationManager.defineShader(builder);\n    builder.addOutputBuffer('vec4', 'v4f_fragData0', 0);\n    builder.addFragmentCode(`\nvoid emit(vec4 color) {\n  v4f_fragData0 = color;\n}\n`);\n    this.chunkFormat.defineShader(builder);\n    builder.addFragmentCode(`\n${getShaderType(this.dataType)} getDataValue() { return getDataValue(0); }\n`);\n  }\n\n  beginSlice(_sliceView: SliceView) {\n    let gl = this.gl;\n\n    let shader = this.shaderGetter.get();\n    if (shader === undefined) {\n      return;\n    }\n    shader.bind();\n    this.vertexComputationManager.beginSlice(gl, shader);\n    return shader;\n  }\n\n  endSlice(shader: ShaderProgram) {\n    let gl = this.gl;\n    this.vertexComputationManager.endSlice(gl, shader);\n  }\n\n  draw(sliceView: SliceView) {\n    let visibleSources = sliceView.visibleLayers.get(this)!;\n    if (visibleSources.length === 0) {\n      return;\n    }\n\n    let gl = this.gl;\n\n    const shader = this.beginSlice(sliceView);\n    if (shader === undefined) {\n      return;\n    }\n\n    let chunkPosition = vec3.create();\n    const {renderScaleHistogram, vertexComputationManager} = this;\n\n    // All sources are required to have the same texture format.\n    let chunkFormat = this.chunkFormat;\n    chunkFormat.beginDrawing(gl, shader);\n\n    if (renderScaleHistogram !== undefined) {\n      renderScaleHistogram.begin(\n          this.chunkManager.chunkQueueManager.frameNumberCounter.frameNumber);\n    }\n\n    for (let transformedSource of visibleSources) {\n      const chunkLayout = transformedSource.chunkLayout;\n      const source = transformedSource.source as VolumeChunkSource;\n      const chunks = source.chunks;\n\n      let originalChunkSize = chunkLayout.size;\n\n      let chunkDataSize: vec3|undefined;\n      let visibleChunks = sliceView.visibleChunks.get(chunkLayout);\n      if (!visibleChunks) {\n        continue;\n      }\n\n      vertexComputationManager.beginSource(\n          gl, shader, sliceView, sliceView.dataToDevice, source.spec, chunkLayout);\n      let sourceChunkFormat = source.chunkFormat;\n      sourceChunkFormat.beginSource(gl, shader);\n\n      let setChunkDataSize = (newChunkDataSize: vec3) => {\n        chunkDataSize = newChunkDataSize;\n        vertexComputationManager.setupChunkDataSize(gl, shader, chunkDataSize);\n      };\n\n      let presentCount = 0, notPresentCount = 0;\n\n      for (let key of visibleChunks) {\n        let chunk = chunks.get(key);\n        if (chunk && chunk.state === ChunkState.GPU_MEMORY) {\n          let newChunkDataSize = chunk.chunkDataSize;\n          if (newChunkDataSize !== chunkDataSize) {\n            setChunkDataSize(newChunkDataSize);\n          }\n\n          vec3.multiply(chunkPosition, originalChunkSize, chunk.chunkGridPosition);\n          sourceChunkFormat.bindChunk(gl, shader, chunk);\n          vertexComputationManager.drawChunk(gl, shader, chunkPosition);\n          ++presentCount;\n        } else {\n          ++notPresentCount;\n        }\n      }\n\n      if ((presentCount !== 0 || notPresentCount !== 0) && renderScaleHistogram !== undefined) {\n        const {voxelSize} = transformedSource;\n        // TODO(jbms): replace median hack with more accurate estimate, e.g. based on ellipsoid\n        // cross section.\n        const medianVoxelSize = medianOf3(voxelSize[0], voxelSize[1], voxelSize[2]);\n        renderScaleHistogram.add(\n            medianVoxelSize, medianVoxelSize / sliceView.pixelSize, presentCount, notPresentCount);\n      }\n    }\n    chunkFormat.endDrawing(gl, shader);\n    this.endSlice(shader);\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationLayerState} from 'neuroglancer/annotation/frontend';\nimport {GetVolumeOptions} from 'neuroglancer/datasource';\nimport {RenderLayerRole, UserLayer} from 'neuroglancer/layer';\nimport {getVolumeWithStatusMessage} from 'neuroglancer/layer_specification';\nimport {RenderScaleHistogram, trackableRenderScaleTarget} from 'neuroglancer/render_scale_statistics';\nimport {MultiscaleVolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {getAnnotationRenderOptions, UserLayerWithAnnotations, UserLayerWithAnnotationsMixin} from 'neuroglancer/ui/annotations';\nimport {UserLayerWithCoordinateTransform, UserLayerWithCoordinateTransformMixin} from 'neuroglancer/user_layer_with_coordinate_transform';\nimport {verifyObjectProperty, verifyOptionalString} from 'neuroglancer/util/json';\n\nconst SOURCE_JSON_KEY = 'source';\nconst CROSS_SECTION_RENDER_SCALE_JSON_KEY = 'crossSectionRenderScale';\n\ninterface BaseConstructor {\n  new(...args: any[]): UserLayerWithAnnotations&UserLayerWithCoordinateTransform;\n}\n\nfunction helper<TBase extends BaseConstructor>(Base: TBase) {\n  class C extends Base implements UserLayerWithVolumeSource {\n    volumePath: string|undefined;\n    multiscaleSource: Promise<MultiscaleVolumeChunkSource>|undefined;\n    volumeOptions: GetVolumeOptions|undefined;\n    sliceViewRenderScaleHistogram = new RenderScaleHistogram();\n    sliceViewRenderScaleTarget = (() => {\n      const target = trackableRenderScaleTarget(1);\n      target.changed.add(this.specificationChanged.dispatch);\n      return target;\n    })();\n\n    restoreState(specification: any) {\n      super.restoreState(specification);\n      const volumePath = this.volumePath =\n          verifyObjectProperty(specification, SOURCE_JSON_KEY, verifyOptionalString);\n      this.sliceViewRenderScaleTarget.restoreState(\n          specification[CROSS_SECTION_RENDER_SCALE_JSON_KEY]);\n\n      if (volumePath !== undefined) {\n        const multiscaleSource = this.multiscaleSource = getVolumeWithStatusMessage(\n            this.manager.dataSourceProvider, this.manager.chunkManager, volumePath,\n            this.volumeOptions);\n        multiscaleSource.then(volume => {\n          if (!this.wasDisposed) {\n            const staticAnnotations = volume.getStaticAnnotations && volume.getStaticAnnotations();\n            if (staticAnnotations !== undefined) {\n              this.annotationLayerState.value = new AnnotationLayerState({\n                transform: this.transform,\n                source: staticAnnotations,\n                role: RenderLayerRole.DEFAULT_ANNOTATION,\n                ...getAnnotationRenderOptions(this),\n              });\n            }\n          }\n        });\n      }\n    }\n\n    toJSON() {\n      const result = super.toJSON();\n      result[SOURCE_JSON_KEY] = this.volumePath;\n      result[CROSS_SECTION_RENDER_SCALE_JSON_KEY] = this.sliceViewRenderScaleTarget.toJSON();\n      return result;\n    }\n  }\n  return C;\n}\n\nexport interface UserLayerWithVolumeSource extends UserLayerWithAnnotations,\n                                                   UserLayerWithCoordinateTransform {\n  volumePath: string|undefined;\n  multiscaleSource: Promise<MultiscaleVolumeChunkSource>|undefined;\n  sliceViewRenderScaleHistogram: RenderScaleHistogram;\n  sliceViewRenderScaleTarget: TrackableValue<number>;\n}\n\n/**\n * Mixin that adds a `source` property to a user layer.\n */\nexport function UserLayerWithVolumeSourceMixin<TBase extends {new (...args: any[]): UserLayer}>(\n    Base: TBase) {\n  return helper(UserLayerWithAnnotationsMixin(UserLayerWithCoordinateTransformMixin(Base)));\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {Signal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nrequire('neuroglancer/noselect.css');\nrequire('./uint64_entry_widget.css');\n\nexport class Uint64EntryWidget extends RefCounted {\n  element = document.createElement('form');\n  label = document.createElement('label');\n  input = document.createElement('input');\n  valuesEntered = new Signal<(values: Uint64[]) => void>();\n\n  constructor() {\n    super();\n    let {element, label, input} = this;\n    element.className = 'uint64-entry neuroglancer-noselect';\n    element.appendChild(label);\n    label.appendChild(input);\n    this.registerEventListener(element, 'submit', (event: Event) => {\n      event.preventDefault();\n      const values = this.validateInput();\n      if (values !== undefined) {\n        this.input.value = '';\n        this.input.classList.remove('valid-input', 'invalid-input');\n        this.valuesEntered.dispatch(values);\n      }\n    });\n    this.registerEventListener(element, 'input', () => {\n      if (this.input.value === '') {\n        this.input.classList.remove('valid-input', 'invalid-input');\n        return;\n      }\n      if (this.validateInput()) {\n        this.input.classList.remove('invalid-input');\n      } else {\n        this.input.classList.add('invalid-input');\n      }\n    });\n  }\n\n  validateInput(): Uint64[]|undefined {\n    let value = this.input.value;\n    value = value.replace(/[\\s,\\(\\)\\[\\]\\{\\};]+/g, ' ');\n    value = value.trim();\n    const parts = value.split(' ');\n    if (parts.length === 0) {\n      return undefined;\n    }\n    const results: Uint64[] = [];\n    for (const part of parts) {\n      const x = new Uint64();\n      if (!x.tryParseString(part)) {\n        return undefined;\n      }\n      results.push(x);\n    }\n    return results;\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableEnum} from 'neuroglancer/util/trackable_enum';\nimport {RefCounted} from 'neuroglancer/util/disposable';\n\nexport class EnumSelectWidget<T extends number> extends RefCounted {\n  element = document.createElement('select');\n  private valueIndexMap = new Map<T, number>();\n  constructor (public model: TrackableEnum<T>) {\n    super();\n    const {element, valueIndexMap} = this;\n    let index = 0;\n    for (const key of Object.keys(model.enumType)) {\n      if (isNaN(Number(key))) {\n        const option = document.createElement('option');\n        option.textContent = option.value = key.toLowerCase();\n        element.appendChild(option);\n        valueIndexMap.set(model.enumType[key], index);\n        ++index;\n      }\n    }\n    this.registerDisposer(model.changed.add(() => this.updateView()));\n    this.registerEventListener(element, 'change', () => this.updateModel());\n    this.registerEventListener(element, 'wheel', (event: WheelEvent) => {\n      let {deltaY} = event;\n      if (deltaY > 0) {\n        element.selectedIndex =\n            (element.options.length + element.selectedIndex - 1) % element.options.length;\n        this.updateModel();\n      } else if (deltaY < 0) {\n        element.selectedIndex =\n            (element.options.length + element.selectedIndex + 1) % element.options.length;\n        this.updateModel();\n      }\n    });\n    this.updateView();\n  }\n\n  private updateView() {\n    const {element} = this;\n    element.selectedIndex = this.valueIndexMap.get(this.model.value)!;\n  }\n\n  private updateModel() {\n    this.model.restoreState(this.element.value);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst k1 = 0xcc9e2d51;\nconst k2 = 0x1b873593;\n\n// MurmurHash excluding the final mixing steps.\nexport function hashCombine(state: number, value: number) {\n  value >>>= 0;\n  state >>>= 0;\n\n  value = Math.imul(value, k1) >>> 0;\n  value = ((value << 15) | (value >>> 17)) >>> 0;\n  value = Math.imul(value, k2) >>> 0;\n  state = (state ^ value) >>> 0;\n  state = ((state << 13) | (state >>> 19)) >>> 0;\n  state = ((state * 5) + 0xe6546b64) >>> 0;\n  return state;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hashCombine} from 'neuroglancer/gpu_hash/hash_function';\nimport {getRandomValues} from 'neuroglancer/util/random';\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nexport const NUM_ALTERNATIVES = 3;\n\nconst DEFAULT_LOAD_FACTOR = 0.9;\n\nconst DEBUG = false;\n\n// Key that needs to be inserted.  Temporary variables used during insert.  These can safely be\n// global because control never leaves functions defined in this module while these are in use.\nlet pendingLow = 0, pendingHigh = 0, backupPendingLow = 0, backupPendingHigh = 0;\n\nexport abstract class HashTableBase {\n  loadFactor = DEFAULT_LOAD_FACTOR;\n  size = 0;\n  table: Uint32Array;\n  tableSize: number;\n  emptyLow = 4294967295;\n  emptyHigh = 4294967295;\n  maxRehashAttempts = 5;\n  maxAttempts = 5;\n  capacity: number;\n\n  /**\n   * Number of uint32 elements per entry in hash table.\n   */\n  entryStride: number;\n\n  generation = 0;\n\n  mungedEmptyKey = -1;\n\n  constructor(public hashSeeds = HashTableBase.generateHashSeeds(NUM_ALTERNATIVES)) {\n    // Minimum size must be greater than 2 * hashSeeds.length.  Otherwise, tableWithMungedEmptyKey\n    // may loop infinitely.\n    let initialSize = 8;\n    while (initialSize < 2 * hashSeeds.length) {\n      initialSize *= 2;\n    }\n    this.allocate(initialSize);\n  }\n\n  private updateHashFunctions(numHashes: number) {\n    this.hashSeeds = HashTableBase.generateHashSeeds(numHashes);\n    this.mungedEmptyKey = -1;\n  }\n\n  /**\n   * Invokes callback with a modified version of the hash table data array.\n   *\n   * Replaces all slots that appear to be valid entries for (emptyLow, emptyHigh), i.e. slots that\n   * contain (emptyLow, emptyHigh) and to which (emptyLow, emptyHigh) hashes, with (mungedEmptyKey,\n   * mungedEmptyKey).\n   *\n   * mungedEmptyKey is chosen to be a 32-bit value with the property that the 64-bit value\n   * (mungedEmptyKey, mungedEmptyKey) does not hash to any of the same slots as (emptyLow,\n   * emptyHigh).\n   *\n   * This allows the modified data array to be used for lookups without special casing the empty\n   * key.\n   */\n  tableWithMungedEmptyKey(callback: (table: Uint32Array) => void) {\n    const numHashes = this.hashSeeds.length;\n    const emptySlots = new Array<number>(numHashes);\n    for (let i = 0; i < numHashes; ++i) {\n      emptySlots[i] = this.getHash(i, this.emptyLow, this.emptyHigh);\n    }\n    let {mungedEmptyKey} = this;\n    if (mungedEmptyKey === -1) {\n      chooseMungedEmptyKey: while (true) {\n        mungedEmptyKey = (Math.random() * 0x1000000) >>> 0;\n        for (let i = 0; i < numHashes; ++i) {\n          let h = this.getHash(i, mungedEmptyKey, mungedEmptyKey);\n          for (let j = 0; j < numHashes; ++j) {\n            if (emptySlots[j] === h) {\n              continue chooseMungedEmptyKey;\n            }\n          }\n        }\n        this.mungedEmptyKey = mungedEmptyKey;\n        break;\n      }\n    }\n    let {table, emptyLow, emptyHigh} = this;\n    for (let i = 0; i < numHashes; ++i) {\n      let h = emptySlots[i];\n      if (table[h] === emptyLow && table[h + 1] === emptyHigh) {\n        table[h] = mungedEmptyKey;\n        table[h + 1] = mungedEmptyKey;\n      }\n    }\n    try {\n      callback(table);\n    } finally {\n      for (let i = 0; i < numHashes; ++i) {\n        let h = emptySlots[i];\n        if (table[h] === mungedEmptyKey && table[h + 1] === mungedEmptyKey) {\n          table[h] = emptyLow;\n          table[h + 1] = emptyHigh;\n        }\n      }\n    }\n  }\n\n  static generateHashSeeds(numAlternatives = NUM_ALTERNATIVES) {\n    return getRandomValues(new Uint32Array(numAlternatives));\n  }\n\n  getHash(hashIndex: number, low: number, high: number) {\n    let hash = this.hashSeeds[hashIndex];\n    hash = hashCombine(hash, low);\n    hash = hashCombine(hash, high);\n    return this.entryStride * (hash & (this.tableSize - 1));\n  }\n\n  /**\n   * Iterates over the Uint64 keys contained in the hash set.\n   *\n   * The same temp value will be modified and yielded at every iteration.\n   */\n  * keys(temp = new Uint64()) {\n    let {emptyLow, emptyHigh, entryStride} = this;\n    let {table} = this;\n    for (let i = 0, length = table.length; i < length; i += entryStride) {\n      let low = table[i], high = table[i + 1];\n      if (low !== emptyLow || high !== emptyHigh) {\n        temp.low = low;\n        temp.high = high;\n        yield temp;\n      }\n    }\n  }\n\n  indexOfPair(low: number, high: number) {\n    let {table, emptyLow, emptyHigh} = this;\n    if (low === emptyLow && high === emptyHigh) {\n      return -1;\n    }\n    for (let i = 0, numHashes = this.hashSeeds.length; i < numHashes; ++i) {\n      let h = this.getHash(i, low, high);\n      if (table[h] === low && table[h + 1] === high) {\n        return h;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * Returns the offset into the hash table of the specified element, or -1 if the element is not\n   * present.\n   */\n  indexOf(x: Uint64) {\n    return this.indexOfPair(x.low, x.high);\n  }\n\n  /**\n   * Changes the empty key to a value that is not equal to the current empty key and is not present\n   * in the table.\n   *\n   * This is called when an attempt is made to insert the empty key.\n   */\n  private chooseAnotherEmptyKey() {\n    let {emptyLow, emptyHigh, table, entryStride} = this;\n    let newLow: number, newHigh: number;\n    while (true) {\n      newLow = (Math.random() * 0x100000000) >>> 0;\n      newHigh = (Math.random() * 0x100000000) >>> 0;\n      if (newLow === emptyLow && newHigh === emptyHigh) {\n        continue;\n      }\n      if (this.hasPair(newLow, newHigh)) {\n        continue;\n      }\n      break;\n    }\n\n    this.emptyLow = newLow;\n    this.emptyHigh = newHigh;\n\n    // Replace empty keys in the table.\n    for (let h = 0, length = table.length; h < length; h += entryStride) {\n      if (table[h] === emptyLow && table[h + 1] === emptyHigh) {\n        table[h] = newLow;\n        table[h + 1] = newHigh;\n      }\n    }\n  }\n\n  /**\n   * Returns true iff the specified element is present.\n   */\n  has(x: Uint64) {\n    return this.indexOf(x) !== -1;\n  }\n\n  /**\n   * Returns true iff the specified element is present.\n   */\n  hasPair(low: number, high: number) {\n    return this.indexOfPair(low, high) !== -1;\n  }\n\n  delete(x: Uint64) {\n    let index = this.indexOf(x);\n    if (index !== -1) {\n      let {table} = this;\n      table[index] = this.emptyLow;\n      table[index + 1] = this.emptyHigh;\n      ++this.generation;\n      this.size--;\n      return true;\n    }\n    return false;\n  }\n\n  private clearTable() {\n    let {table, entryStride, emptyLow, emptyHigh} = this;\n    let length = table.length;\n\n    for (let h = 0; h < length; h += entryStride) {\n      table[h] = emptyLow;\n      table[h + 1] = emptyHigh;\n    }\n  }\n\n  clear() {\n    if (this.size === 0) {\n      return false;\n    }\n    this.size = 0;\n    ++this.generation;\n    this.clearTable();\n    return true;\n  }\n\n  protected swapPending(table: Uint32Array, offset: number) {\n    let tempLow = pendingLow, tempHigh = pendingHigh;\n    this.storePending(table, offset);\n    table[offset] = tempLow;\n    table[offset + 1] = tempHigh;\n  }\n\n  protected storePending(table: Uint32Array, offset: number) {\n    pendingLow = table[offset];\n    pendingHigh = table[offset + 1];\n  }\n\n  protected backupPending() {\n    backupPendingLow = pendingLow;\n    backupPendingHigh = pendingHigh;\n  }\n\n  protected restorePending() {\n    pendingLow = backupPendingLow;\n    pendingHigh = backupPendingHigh;\n  }\n\n  private tryToInsert() {\n    if (DEBUG) {\n      console.log(`tryToInsert: ${pendingLow}, ${pendingHigh}`);\n    }\n    let attempt = 0;\n    let {emptyLow, emptyHigh, maxAttempts, table} = this;\n    let numHashes = this.hashSeeds.length;\n\n    let tableIndex = Math.floor(Math.random() * numHashes);\n    while (true) {\n      let h = this.getHash(tableIndex, pendingLow, pendingHigh);\n      this.swapPending(table, h);\n      if (pendingLow === emptyLow && pendingHigh === emptyHigh) {\n        return true;\n      }\n      if (++attempt === maxAttempts) {\n        break;\n      }\n      tableIndex = (tableIndex + Math.floor(Math.random() * (numHashes - 1)) + 1) % numHashes;\n    }\n    return false;\n  }\n\n  private allocate(tableSize: number) {\n    this.tableSize = tableSize;\n    let {entryStride} = this;\n    this.table = new Uint32Array(tableSize * entryStride);\n    this.maxAttempts = tableSize;\n    this.clearTable();\n    this.capacity = tableSize * this.loadFactor;\n    this.mungedEmptyKey = -1;\n  }\n\n  private rehash(oldTable: Uint32Array, tableSize: number) {\n    if (DEBUG) {\n      console.log('rehash begin');\n    }\n    this.allocate(tableSize);\n    this.updateHashFunctions(this.hashSeeds.length);\n    let {emptyLow, emptyHigh, entryStride} = this;\n    for (let h = 0, length = oldTable.length; h < length; h += entryStride) {\n      let low = oldTable[h], high = oldTable[h + 1];\n      if (low !== emptyLow || high !== emptyHigh) {\n        this.storePending(oldTable, h);\n        if (!this.tryToInsert()) {\n          if (DEBUG) {\n            console.log('rehash failed');\n          }\n          return false;\n        }\n      }\n    }\n    if (DEBUG) {\n      console.log('rehash end');\n    }\n    return true;\n  }\n\n  private grow(desiredTableSize: number) {\n    if (DEBUG) {\n      console.log(`grow: ${desiredTableSize}`);\n    }\n    let oldTable = this.table;\n    let {tableSize} = this;\n    while (tableSize < desiredTableSize) {\n      tableSize *= 2;\n    }\n    while (true) {\n      for (let rehashAttempt = 0; rehashAttempt < this.maxRehashAttempts; ++rehashAttempt) {\n        if (this.rehash(oldTable, tableSize)) {\n          if (DEBUG) {\n            console.log(`grow end`);\n          }\n          return;\n        }\n      }\n      tableSize *= 2;\n    }\n  }\n\n  protected insertInternal() {\n    ++this.generation;\n\n    if (pendingLow === this.emptyLow && pendingHigh === this.emptyHigh) {\n      this.chooseAnotherEmptyKey();\n    }\n\n    if (++this.size > this.capacity) {\n      this.backupPending();\n      this.grow(this.tableSize * 2);\n      this.restorePending();\n    }\n\n    while (!this.tryToInsert()) {\n      this.backupPending();\n      this.grow(this.tableSize);\n      this.restorePending();\n    }\n  }\n}\n\nexport class HashSetUint64 extends HashTableBase {\n  add(x: Uint64) {\n    let {low, high} = x;\n    if (this.hasPair(low, high)) {\n      return false;\n    }\n    if (DEBUG) {\n      console.log(`add: ${low},${high}`);\n    }\n    pendingLow = low;\n    pendingHigh = high;\n    this.insertInternal();\n    return true;\n  }\n\n  /**\n   * Iterates over the keys.  The same temporary value will be modified and yielded at every\n   * iteration.\n   */\n  [Symbol.iterator]() {\n    return this.keys();\n  }\n}\nHashSetUint64.prototype.entryStride = 2;\n\n// Value that needs to be inserted.  Temporary variables used during insert.  These can safely be\n// global because control never leaves functions defined in this module while these are in use.\nlet pendingValueLow = 0, pendingValueHigh = 0, backupPendingValueLow = 0,\n    backupPendingValueHigh = 0;\n\nexport class HashMapUint64 extends HashTableBase {\n  set(key: Uint64, value: Uint64) {\n    let {low, high} = key;\n    if (this.hasPair(low, high)) {\n      return false;\n    }\n    if (DEBUG) {\n      console.log(`add: ${low},${high} -> ${value.low},${value.high}`);\n    }\n    pendingLow = low;\n    pendingHigh = high;\n    pendingValueLow = value.low;\n    pendingValueHigh = value.high;\n    this.insertInternal();\n    return true;\n  }\n\n  get(key: Uint64, value: Uint64): boolean {\n    let h = this.indexOf(key);\n    if (h === -1) {\n      return false;\n    }\n    let {table} = this;\n    value.low = table[h + 2];\n    value.high = table[h + 3];\n    return true;\n  }\n\n  protected swapPending(table: Uint32Array, offset: number) {\n    let tempLow = pendingValueLow, tempHigh = pendingValueHigh;\n    super.swapPending(table, offset);\n    table[offset + 2] = tempLow;\n    table[offset + 3] = tempHigh;\n  }\n\n  protected storePending(table: Uint32Array, offset: number) {\n    super.storePending(table, offset);\n    pendingValueLow = table[offset + 2];\n    pendingValueHigh = table[offset + 3];\n  }\n\n  protected backupPending() {\n    super.backupPending();\n    backupPendingValueLow = pendingValueLow;\n    backupPendingValueHigh = pendingValueHigh;\n  }\n\n  protected restorePending() {\n    super.restorePending();\n    pendingValueLow = backupPendingValueLow;\n    pendingValueHigh = backupPendingValueHigh;\n  }\n\n  /**\n   * Iterates over entries.  The same temporary value will be modified and yielded at every\n   * iteration.\n   */\n  [Symbol.iterator]() {\n    return this.entries();\n  }\n\n  /**\n   * Iterates over entries.  The same temporary value will be modified and yielded at every\n   * iteration.\n   */\n  * entries(temp: [Uint64, Uint64] = [new Uint64(), new Uint64()]) {\n    let {emptyLow, emptyHigh, entryStride} = this;\n    let {table} = this;\n    let [key, value] = temp;\n    for (let i = 0, length = table.length; i < length; i += entryStride) {\n      let low = table[i], high = table[i + 1];\n      if (low !== emptyLow || high !== emptyHigh) {\n        key.low = low;\n        key.high = high;\n        value.low = table[i + 2];\n        value.high = table[i + 3];\n        yield temp;\n      }\n    }\n  }\n}\nHashMapUint64.prototype.entryStride = 4;\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {HashTableBase, NUM_ALTERNATIVES} from 'neuroglancer/gpu_hash/hash_table';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {glsl_equalUint64, glsl_uint64} from 'neuroglancer/webgl/shader_lib';\nimport {compute1dTextureLayout, computeTextureFormat, OneDimensionalTextureAccessHelper, OneDimensionalTextureLayout, setOneDimensionalTextureData, TextureFormat} from 'neuroglancer/webgl/texture_access';\n\nimport {DataType} from '../util/data_type';\n\n// MumurHash, excluding the final mixing steps.\nexport const glsl_hashCombine = [\n  glsl_uint64, `\nhighp uint hashCombine(highp uint state, highp uint value) {\n  value *= 0xcc9e2d51u;\n  value = (value << 15u) | (value >> 17u);\n  value *= 0x1b873593u;\n  state ^= value;\n  state = (state << 13u) | (state >> 19u);\n  state = (state * 5u) + 0xe6546b64u;\n  return state;\n}\nhighp uint hashCombine(highp uint state, uint64_t x) {\n  state = hashCombine(state, x.value[0]);\n  return hashCombine(state, x.value[1]);\n}\n`\n];\n\nconst textureFormat = computeTextureFormat(new TextureFormat(), DataType.UINT64, 1);\n\nexport class GPUHashTable<HashTable extends HashTableBase> extends RefCounted implements\n    OneDimensionalTextureLayout {\n  generation = -1;\n  textureXBits: number;\n  textureWidth: number;\n  textureHeight: number;\n  texture: WebGLTexture|null = null;\n\n  constructor(public gl: GL, public hashTable: HashTable) {\n    super();\n    // createTexture should never actually return null.\n    this.texture = gl.createTexture();\n  }\n\n  copyToGPU() {\n    let {hashTable} = this;\n    let {generation} = hashTable;\n    if (this.generation === generation) {\n      return;\n    }\n    const {gl, texture} = this;\n    compute1dTextureLayout(\n        this, gl, textureFormat.texelsPerElement, hashTable.tableSize * hashTable.entryStride / 2);\n    this.generation = generation;\n    gl.activeTexture(WebGL2RenderingContext.TEXTURE0 + gl.tempTextureUnit);\n    gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, texture);\n    hashTable.tableWithMungedEmptyKey(table => {\n      setOneDimensionalTextureData(this.gl, this, textureFormat, table);\n    });\n    gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, null);\n  }\n\n  disposed() {\n    let {gl} = this;\n    gl.deleteTexture(this.texture);\n    this.texture = null;\n    this.gl = <any>undefined;\n    this.hashTable = <any>undefined;\n    super.disposed();\n  }\n\n  static get<HashTable extends HashTableBase>(gl: GL, hashTable: HashTable) {\n    return gl.memoize.get(hashTable, () => new this(gl, hashTable));\n  }\n}\n\nexport class HashSetShaderManager {\n  textureUnitSymbol = Symbol.for(`gpuhashtable:${this.prefix}`);\n  private accessHelper = new OneDimensionalTextureAccessHelper(`gpuhashtable_${this.prefix}`);\n  samplerName = this.prefix + '_sampler';\n  hashSeedsName = this.prefix + '_seeds';\n  hashKeyMask = this.prefix + '_keyMask';\n  readTable = this.prefix + '_readTable';\n\n  constructor(public prefix: string, public numAlternatives = NUM_ALTERNATIVES) {}\n\n  defineShader(builder: ShaderBuilder) {\n    let {hashSeedsName, samplerName, numAlternatives, hashKeyMask} = this;\n    builder.addUniform('highp uint', hashSeedsName, numAlternatives);\n    builder.addUniform('highp uint', hashKeyMask);\n    builder.addTextureSampler('usampler2D', samplerName, this.textureUnitSymbol);\n    builder.addFragmentCode(glsl_hashCombine);\n    builder.addFragmentCode(glsl_uint64);\n    builder.addFragmentCode(glsl_equalUint64);\n    this.accessHelper.defineShader(builder);\n    builder.addFragmentCode(\n        this.accessHelper.getAccessor(this.readTable, this.samplerName, DataType.UINT64, 1));\n    let s = '';\n    s += `\nbool ${this.hasFunctionName}(uint64_t x) {\n`;\n    for (let alt = 0; alt < numAlternatives; ++alt) {\n      s += `\n  {\n    uint h = hashCombine(${hashSeedsName}[${alt}], x) & ${hashKeyMask};\n    uint64_t key = ${this.readTable}(h);\n    if (equals(key, x)) {\n      return true;\n    }\n  }\n`;\n    }\n    s += `\n  return false;\n}\n`;\n    builder.addFragmentCode(s);\n  }\n\n  get hasFunctionName() {\n    return `${this.prefix}_has`;\n  }\n\n  enable<HashTable extends HashTableBase>(\n      gl: GL, shader: ShaderProgram, hashTable: GPUHashTable<HashTable>) {\n    hashTable.copyToGPU();\n    const textureUnit = shader.textureUnit(this.textureUnitSymbol);\n    gl.activeTexture(WebGL2RenderingContext.TEXTURE0 + textureUnit);\n    gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, hashTable.texture);\n    this.accessHelper.setupTextureLayout(gl, shader, hashTable);\n    gl.uniform1ui(shader.uniform(this.hashKeyMask), hashTable.hashTable.tableSize - 1);\n    gl.uniform1uiv(shader.uniform(this.hashSeedsName), hashTable.hashTable.hashSeeds);\n  }\n\n  disable(gl: GL, shader: ShaderProgram) {\n    const textureUnit = shader.textureUnit(this.textureUnitSymbol);\n    gl.activeTexture(WebGL2RenderingContext.TEXTURE0 + textureUnit);\n    gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, null);\n  }\n}\n\nexport class HashMapShaderManager extends HashSetShaderManager {\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    let {numAlternatives, hashSeedsName, hashKeyMask} = this;\n    let s = `\nbool ${this.getFunctionName}(uint64_t x, out uint64_t value) {\n`;\n    for (let alt = 0; alt < numAlternatives; ++alt) {\n      s += `\n  {\n    uint h = hashCombine(${hashSeedsName}[${alt}], x) & ${hashKeyMask};\n    uint64_t key = ${this.readTable}(h * 2u);\n    if (equals(key, x)) {\n      value = ${this.readTable}(h * 2u + 1u);\n      return true;\n    }\n  }\n`;\n    }\n    s += `\n  return false;\n}\n`;\n    builder.addFragmentCode(s);\n  }\n\n  get getFunctionName() {\n    return `${this.prefix}_get`;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hashCombine} from 'neuroglancer/gpu_hash/hash_function';\nimport {glsl_hashCombine} from 'neuroglancer/gpu_hash/shader';\nimport {hsvToRgb} from 'neuroglancer/util/colorspace';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {glsl_hsvToRgb, glsl_uint64} from 'neuroglancer/webgl/shader_lib';\nimport {getRandomUint32} from './util/random';\nimport {Trackable} from './util/trackable';\n\nconst NUM_COMPONENTS = 2;\n\nexport class SegmentColorShaderManager {\n  seedName = this.prefix + '_seed';\n\n  constructor(public prefix: string) {}\n\n  defineShader(builder: ShaderBuilder) {\n    const {seedName} = this;\n    builder.addUniform('highp uint', seedName);\n    builder.addFragmentCode(glsl_uint64);\n    builder.addFragmentCode(glsl_hashCombine);\n    builder.addFragmentCode(glsl_hsvToRgb);\n    let s = `\nvec3 ${this.prefix}(uint64_t x) {\n  uint h = hashCombine(${seedName}, x);\n  vec${NUM_COMPONENTS} v;\n`;\n    for (let i = 0; i < NUM_COMPONENTS; ++i) {\n      s += `\n  v[${i}] = float(h & 0xFFu) / 255.0;\n  h >>= 8u;\n`;\n    }\n    s += `\n  vec3 hsv = vec3(v.x, 0.5 + v.y * 0.5, 1.0);\n  return hsvToRgb(hsv);\n}\n`;\n    builder.addFragmentCode(s);\n  }\n\n  enable(gl: GL, shader: ShaderProgram, segmentColorHash: SegmentColorHash) {\n    gl.uniform1ui(shader.uniform(this.seedName), segmentColorHash.hashSeed);\n  }\n}\n\nlet tempColor = new Float32Array(3);\n\nexport class SegmentColorHash implements Trackable {\n  changed = new NullarySignal();\n\n  constructor(public hashSeed: number = getRandomUint32()) {}\n\n  static getDefault() {\n    return new SegmentColorHash(0);\n  }\n\n  compute(out: Float32Array, x: Uint64) {\n    let h = hashCombine(this.hashSeed, x.low);\n    h = hashCombine(h, x.high);\n    const c0 = (h & 0xFF) / 255;\n    const c1 = ((h >> 8) & 0xFF) / 255;\n    hsvToRgb(out, c0, 0.5 + 0.5 * c1, 1.0);\n    return out;\n  }\n\n  computeCssColor(x: Uint64) {\n    this.compute(tempColor, x);\n    return `rgb(${tempColor[0] * 100}%,${tempColor[1] * 100}%,${tempColor[2] * 100}%)`;\n  }\n\n  randomize() {\n    this.hashSeed = getRandomUint32();\n    this.changed.dispatch();\n  }\n\n  toString() {\n    return `new SegmentColorHash(${this.hashSeed})`;\n  }\n\n  toJSON() {\n    return this.hashSeed === 0 ? undefined : this.hashSeed;\n  }\n\n  reset() {\n    this.restoreState(0);\n  }\n\n  restoreState(x: any) {\n    const newSeed = x >>> 0;\n    if (newSeed !== this.hashSeed) {\n      this.hashSeed = newSeed;\n      this.changed.dispatch();\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nconst rankSymbol = Symbol('disjoint_sets:rank');\nconst parentSymbol = Symbol('disjoint_sets:parent');\nconst nextSymbol = Symbol('disjoint_sets:next');\nconst prevSymbol = Symbol('disjoint_sets:prev');\n\nfunction findRepresentative(v: any): any {\n  // First pass: find the root, which will be stored in ancestor.\n  let old = v;\n  let ancestor = v[parentSymbol];\n  while (ancestor !== v) {\n    v = ancestor;\n    ancestor = v[parentSymbol];\n  }\n  // Second pass: set all of the parent pointers along the path from the\n  // original element `old' to refer directly to the root `ancestor'.\n  v = old[parentSymbol];\n  while (ancestor !== v) {\n    old[parentSymbol] = ancestor;\n    old = v;\n    v = old[parentSymbol];\n  }\n  return ancestor;\n}\n\nfunction linkUnequalSetRepresentatives(i: any, j: any): any {\n  let iRank = i[rankSymbol];\n  let jRank = j[rankSymbol];\n  if (iRank > jRank) {\n    j[parentSymbol] = i;\n    return i;\n  }\n\n  i[parentSymbol] = j;\n  if (iRank === jRank) {\n    j[rankSymbol] = jRank + 1;\n  }\n  return j;\n}\n\nfunction spliceCircularLists(i: any, j: any) {\n  let iPrev = i[prevSymbol];\n  let jPrev = j[prevSymbol];\n\n  // Connect end of i to beginning of j.\n  j[prevSymbol] = iPrev;\n  iPrev[nextSymbol] = j;\n\n  // Connect end of j to beginning of i.\n  i[prevSymbol] = jPrev;\n  jPrev[nextSymbol] = i;\n}\n\n\n\nfunction* setElementIterator(i: any) {\n  let j = i;\n  do {\n    yield j;\n    j = j[nextSymbol];\n  } while (j !== i);\n}\n\nfunction initializeElement(v: any) {\n  v[parentSymbol] = v;\n  v[rankSymbol] = 0;\n  v[nextSymbol] = v[prevSymbol] = v;\n}\n\nconst minSymbol = Symbol('disjoint_sets:min');\n\nfunction isRootElement(v: any) {\n  return v[parentSymbol] === v;\n}\n\n/**\n * Represents a collection of disjoint sets of Uint64 values.\n *\n * Supports merging sets, retrieving the minimum Uint64 value contained in a set (the representative\n * value), and iterating over the elements contained in a set.\n */\nexport class DisjointUint64Sets {\n  private map = new Map<string, Uint64>();\n  generation = 0;\n\n  get(x: Uint64): Uint64 {\n    let key = x.toString();\n    let element = this.map.get(key);\n    if (element === undefined) {\n      return x;\n    }\n    return findRepresentative(element)[minSymbol];\n  }\n\n  isMinElement(x: Uint64) {\n    let y = this.get(x);\n    return (y === x || Uint64.equal(y, x));\n  }\n\n  private makeSet(x: Uint64): Uint64 {\n    let key = x.toString();\n    let {map} = this;\n    let element = map.get(key);\n    if (element === undefined) {\n      element = x.clone();\n      initializeElement(element);\n      (<any>element)[minSymbol] = element;\n      map.set(key, element);\n      return element;\n    }\n    return findRepresentative(element);\n  }\n\n  link(a: Uint64, b: Uint64): boolean {\n    a = this.makeSet(a);\n    b = this.makeSet(b);\n    if (a === b) {\n      return false;\n    }\n    this.generation++;\n    let newNode = linkUnequalSetRepresentatives(a, b);\n    spliceCircularLists(a, b);\n    let aMin = (<any>a)[minSymbol];\n    let bMin = (<any>b)[minSymbol];\n    newNode[minSymbol] = Uint64.less(aMin, bMin) ? aMin : bMin;\n    return true;\n  }\n\n  * setElements(a: Uint64): IterableIterator<Uint64> {\n    let key = a.toString();\n    let element = this.map.get(key);\n    if (element === undefined) {\n      yield a;\n    } else {\n      yield* setElementIterator(element);\n    }\n  }\n\n  clear() {\n    let {map} = this;\n    if (map.size === 0) {\n      return false;\n    }\n    ++this.generation;\n    map.clear();\n    return true;\n  }\n\n  get size() {\n    return this.map.size;\n  }\n\n  * mappings(temp = <[Uint64, Uint64]>new Array<Uint64>(2)) {\n    for (let element of this.map.values()) {\n      temp[0] = element;\n      temp[1] = findRepresentative(element)[minSymbol];\n      yield temp;\n    }\n  }\n\n  [Symbol.iterator]() {\n    return this.mappings();\n  }\n\n  /**\n   * Returns an array of arrays of strings, where the arrays contained in the outer array correspond\n   * to the disjoint sets, and the strings are the base-10 string representations of the members of\n   * each set.  The members are sorted in numerical order, and the sets are sorted in numerical\n   * order of their smallest elements.\n   */\n  toJSON(): string[][] {\n    let sets = new Array<Uint64[]>();\n    for (let element of this.map.values()) {\n      if (isRootElement(element)) {\n        let members = new Array<Uint64>();\n        for (let member of setElementIterator(element)) {\n          members.push(member);\n        }\n        members.sort(Uint64.compare);\n        sets.push(members);\n      }\n    }\n    sets.sort((a, b) => Uint64.compare(a[0], b[0]));\n    return sets.map(set => set.map(element => element.toString()));\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DisjointUint64Sets} from 'neuroglancer/util/disjoint_sets';\nimport {parseArray} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {registerRPC, registerSharedObject, RPC, SharedObjectCounterpart} from 'neuroglancer/worker_rpc';\n\nconst RPC_TYPE_ID = 'DisjointUint64Sets';\nconst ADD_METHOD_ID = 'DisjointUint64Sets.add';\nconst CLEAR_METHOD_ID = 'DisjointUint64Sets.clear';\n\n@registerSharedObject(RPC_TYPE_ID)\nexport class SharedDisjointUint64Sets extends SharedObjectCounterpart {\n  disjointSets = new DisjointUint64Sets();\n  changed = new NullarySignal();\n\n  static makeWithCounterpart(rpc: RPC) {\n    let obj = new this();\n    obj.initializeCounterpart(rpc);\n    return obj;\n  }\n\n  disposed() {\n    this.disjointSets = <any>undefined;\n    this.changed = <any>undefined;\n    super.disposed();\n  }\n\n  link(a: Uint64, b: Uint64) {\n    if (this.disjointSets.link(a, b)) {\n      let {rpc} = this;\n      if (rpc) {\n        rpc.invoke(\n            ADD_METHOD_ID,\n            {'id': this.rpcId, 'al': a.low, 'ah': a.high, 'bl': b.low, 'bh': b.high});\n      }\n      this.changed.dispatch();\n    }\n  }\n\n  get(x: Uint64): Uint64 {\n    return this.disjointSets.get(x);\n  }\n\n  clear() {\n    if (this.disjointSets.clear()) {\n      let {rpc} = this;\n      if (rpc) {\n        rpc.invoke(CLEAR_METHOD_ID, {'id': this.rpcId});\n      }\n      this.changed.dispatch();\n    }\n  }\n\n  setElements(a: Uint64) {\n    return this.disjointSets.setElements(a);\n  }\n\n  get size() {\n    return this.disjointSets.size;\n  }\n\n  toJSON() {\n    return this.disjointSets.toJSON();\n  }\n\n  /**\n   * Restores the state from a JSON representation.\n   */\n  restoreState(obj: any) {\n    this.clear();\n    if (obj !== undefined) {\n      let ids = [new Uint64(), new Uint64()];\n      parseArray(obj, z => {\n        parseArray(z, (s, index) => {\n          ids[index % 2].parseString(String(s), 10);\n          if (index !== 0) {\n            this.link(ids[0], ids[1]);\n          }\n        });\n      });\n    }\n  }\n}\n\nconst tempA = new Uint64();\nconst tempB = new Uint64();\n\nregisterRPC(ADD_METHOD_ID, function(x) {\n  let obj = <SharedDisjointUint64Sets>this.get(x['id']);\n  tempA.low = x['al'];\n  tempA.high = x['ah'];\n  tempB.low = x['bl'];\n  tempB.high = x['bh'];\n  if (obj.disjointSets.link(tempA, tempB)) {\n    obj.changed.dispatch();\n  }\n});\n\nregisterRPC(CLEAR_METHOD_ID, function(x) {\n  let obj = <SharedDisjointUint64Sets>this.get(x['id']);\n  if (obj.disjointSets.clear()) {\n    obj.changed.dispatch();\n  }\n});\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {HashMapUint64} from 'neuroglancer/gpu_hash/hash_table';\nimport {GPUHashTable, HashMapShaderManager, HashSetShaderManager} from 'neuroglancer/gpu_hash/shader';\nimport {SegmentColorShaderManager} from 'neuroglancer/segment_color';\nimport {registerRedrawWhenSegmentationDisplayStateChanged, SegmentationDisplayState} from 'neuroglancer/segmentation_display_state/frontend';\nimport {SliceView} from 'neuroglancer/sliceview/frontend';\nimport {RenderLayerOptions} from 'neuroglancer/sliceview/renderlayer';\nimport {VolumeSourceOptions} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {RenderLayer} from 'neuroglancer/sliceview/volume/renderlayer';\nimport {TrackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {TrackableBoolean} from 'neuroglancer/trackable_boolean';\nimport {DisjointUint64Sets} from 'neuroglancer/util/disjoint_sets';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nexport class EquivalencesHashMap {\n  generation = Number.NaN;\n  hashMap = new HashMapUint64();\n  constructor(public disjointSets: DisjointUint64Sets) {}\n  update() {\n    let {disjointSets} = this;\n    const {generation} = disjointSets;\n    if (this.generation !== generation) {\n      this.generation = generation;\n      let {hashMap} = this;\n      hashMap.clear();\n      for (let [objectId, minObjectId] of disjointSets.mappings()) {\n        hashMap.set(objectId, minObjectId);\n      }\n    }\n  }\n}\n\nexport interface SliceViewSegmentationDisplayState extends SegmentationDisplayState,\n                                                           RenderLayerOptions {\n  selectedAlpha: TrackableAlphaValue;\n  notSelectedAlpha: TrackableAlphaValue;\n  volumeSourceOptions?: VolumeSourceOptions;\n  hideSegmentZero: TrackableBoolean;\n}\n\nexport class SegmentationRenderLayer extends RenderLayer {\n  protected segmentColorShaderManager = new SegmentColorShaderManager('segmentColorHash');\n  private hashTableManager = new HashSetShaderManager('visibleSegments');\n  private gpuHashTable = GPUHashTable.get(this.gl, this.displayState.visibleSegments.hashTable);\n  private hashTableManagerHighlighted = new HashSetShaderManager('highlightedSegments');\n  private gpuHashTableHighlighted =\n      GPUHashTable.get(this.gl, this.displayState.highlightedSegments.hashTable);\n\n  private equivalencesShaderManager = new HashMapShaderManager('equivalences');\n  private equivalencesHashMap =\n      new EquivalencesHashMap(this.displayState.segmentEquivalences.disjointSets);\n  private gpuEquivalencesHashTable = GPUHashTable.get(this.gl, this.equivalencesHashMap.hashMap);\n  private hasEquivalences: boolean;\n\n  constructor(\n      multiscaleSource: MultiscaleVolumeChunkSource,\n      public displayState: SliceViewSegmentationDisplayState) {\n    super(multiscaleSource, {\n      sourceOptions: displayState.volumeSourceOptions,\n      transform: displayState.transform,\n      renderScaleHistogram: displayState.renderScaleHistogram,\n      renderScaleTarget: displayState.renderScaleTarget,\n    });\n    registerRedrawWhenSegmentationDisplayStateChanged(displayState, this);\n    this.registerDisposer(displayState.selectedAlpha.changed.add(() => {\n      this.redrawNeeded.dispatch();\n    }));\n    this.registerDisposer(displayState.hideSegmentZero.changed.add(() => {\n      this.redrawNeeded.dispatch();\n      this.shaderGetter.invalidateShader();\n    }));\n    this.hasEquivalences = this.displayState.segmentEquivalences.size !== 0;\n    displayState.segmentEquivalences.changed.add(() => {\n      let {segmentEquivalences} = this.displayState;\n      let hasEquivalences = segmentEquivalences.size !== 0;\n      if (hasEquivalences !== this.hasEquivalences) {\n        this.hasEquivalences = hasEquivalences;\n        this.shaderGetter.invalidateShader();\n        // No need to trigger redraw, since that will happen anyway.\n      }\n    });\n    this.registerDisposer(displayState.notSelectedAlpha.changed.add(() => {\n      this.redrawNeeded.dispatch();\n    }));\n  }\n\n  getShaderKey() {\n    // The shader to use depends on whether there are any equivalences, and on whether we are hiding\n    // segment ID 0.\n    return `sliceview.SegmentationRenderLayer/${this.hasEquivalences}/` +\n        this.displayState.hideSegmentZero.value;\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    this.hashTableManager.defineShader(builder);\n    this.hashTableManagerHighlighted.defineShader(builder);\n    builder.addFragmentCode(`\nuint64_t getUint64DataValue() {\n  return toUint64(getDataValue());\n}\n`);\n    if (this.hasEquivalences) {\n      this.equivalencesShaderManager.defineShader(builder);\n      builder.addFragmentCode(`\nuint64_t getMappedObjectId() {\n  uint64_t value = getUint64DataValue();\n  uint64_t mappedValue;\n  if (${this.equivalencesShaderManager.getFunctionName}(value, mappedValue)) {\n    return mappedValue;\n  }\n  return value;\n}\n`);\n    } else {\n      builder.addFragmentCode(`\nuint64_t getMappedObjectId() {\n  return getUint64DataValue();\n}\n`);\n    }\n    this.segmentColorShaderManager.defineShader(builder);\n    builder.addUniform('highp uvec2', 'uSelectedSegment');\n    builder.addUniform('highp uint', 'uShowAllSegments');\n    builder.addUniform('highp float', 'uSelectedAlpha');\n    builder.addUniform('highp float', 'uNotSelectedAlpha');\n    builder.addUniform('highp float', 'uSaturation');\n    let fragmentMain = `\n  uint64_t value = getMappedObjectId();\n\n  float alpha = uSelectedAlpha;\n  float saturation = uSaturation;\n`;\n    if (this.displayState.hideSegmentZero.value) {\n      fragmentMain += `\n  if (value.value[0] == 0u && value.value[1] == 0u) {\n    emit(vec4(vec4(0, 0, 0, 0)));\n    return;\n  }\n`;\n    }\n    fragmentMain += `\n  bool has = uShowAllSegments != 0u ? true : ${this.hashTableManager.hasFunctionName}(value);\n  if (uSelectedSegment == value.value) {\n    saturation = has ? 0.5 : 0.75;\n  } else if (!has) {\n    alpha = uNotSelectedAlpha;\n  }\n  vec3 rgb = segmentColorHash(value);\n  `;\n\n    // Override color for all highlighted segments.\n    fragmentMain += `\n  if(${this.hashTableManagerHighlighted.hasFunctionName}(value)) {\n    rgb = vec3(0.2,0.2,2.0);\n    saturation = 1.0;\n  };\n`;\n\n    fragmentMain += `\n  emit(vec4(mix(vec3(1.0,1.0,1.0), rgb, saturation), alpha));\n`;\n    builder.setFragmentMain(fragmentMain);\n  }\n\n  beginSlice(sliceView: SliceView) {\n    let shader = super.beginSlice(sliceView);\n    if (shader === undefined) {\n      return undefined;\n    }\n    let gl = this.gl;\n\n    let {displayState} = this;\n    let {segmentSelectionState, visibleSegments} = this.displayState;\n    let selectedSegmentLow = 0, selectedSegmentHigh = 0;\n    if (segmentSelectionState.hasSelectedSegment) {\n      let seg = segmentSelectionState.selectedSegment;\n      selectedSegmentLow = seg.low;\n      selectedSegmentHigh = seg.high;\n    }\n    gl.uniform1f(shader.uniform('uSelectedAlpha'), this.displayState.selectedAlpha.value);\n    gl.uniform1f(shader.uniform('uSaturation'), this.displayState.saturation.value);\n    gl.uniform1f(shader.uniform('uNotSelectedAlpha'), this.displayState.notSelectedAlpha.value);\n    gl.uniform2ui(shader.uniform('uSelectedSegment'), selectedSegmentLow, selectedSegmentHigh);\n    gl.uniform1ui(shader.uniform('uShowAllSegments'), visibleSegments.hashTable.size ? 0 : 1);\n    this.hashTableManager.enable(gl, shader, this.gpuHashTable);\n    this.hashTableManagerHighlighted.enable(gl, shader, this.gpuHashTableHighlighted);\n    if (this.hasEquivalences) {\n      this.equivalencesHashMap.update();\n      this.equivalencesShaderManager.enable(gl, shader, this.gpuEquivalencesHashTable);\n    }\n\n    this.segmentColorShaderManager.enable(gl, shader, displayState.segmentColorHash);\n    return shader;\n  }\n  endSlice(shader: ShaderProgram) {\n    let {gl} = this;\n    this.hashTableManager.disable(gl, shader);\n    this.hashTableManagerHighlighted.disable(gl, shader);\n    super.endSlice(shader);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {HashSetUint64} from 'neuroglancer/gpu_hash/hash_table';\nimport {Signal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {registerRPC, registerSharedObject, RPC, SharedObjectCounterpart} from 'neuroglancer/worker_rpc';\n\n@registerSharedObject('Uint64Set')\nexport class Uint64Set extends SharedObjectCounterpart {\n  hashTable = new HashSetUint64();\n  changed = new Signal<(x: Uint64 | null, add: boolean) => void>();\n\n  static makeWithCounterpart(rpc: RPC) {\n    let obj = new Uint64Set();\n    obj.initializeCounterpart(rpc);\n    return obj;\n  }\n\n  disposed() {\n    super.disposed();\n    this.hashTable = <any>undefined;\n    this.changed = <any>undefined;\n  }\n\n  add_(x: Uint64) {\n    return this.hashTable.add(x);\n  }\n\n  add(x: Uint64) {\n    if (this.add_(x)) {\n      let {rpc} = this;\n      if (rpc) {\n        rpc.invoke('Uint64Set.add', {'id': this.rpcId, 'value': x});\n      }\n      this.changed.dispatch(x, true);\n    }\n  }\n\n  has(x: Uint64) {\n    return this.hashTable.has(x);\n  }\n\n  [Symbol.iterator]() {\n    return this.hashTable.keys();\n  }\n\n  delete_(x: Uint64) {\n    return this.hashTable.delete(x);\n  }\n\n  delete(x: Uint64) {\n    if (this.delete_(x)) {\n      let {rpc} = this;\n      if (rpc) {\n        rpc.invoke('Uint64Set.delete', {'id': this.rpcId, 'value': x});\n      }\n      this.changed.dispatch(x, false);\n    }\n  }\n\n  get size() {\n    return this.hashTable.size;\n  }\n\n  clear() {\n    if (this.hashTable.clear()) {\n      let {rpc} = this;\n      if (rpc) {\n        rpc.invoke('Uint64Set.clear', {'id': this.rpcId});\n      }\n      this.changed.dispatch(null, false);\n    }\n  }\n\n  toJSON() {\n    let result = new Array<string>();\n    for (let id of this) {\n      result.push(id.toString());\n    }\n    // Need to sort entries, otherwise serialization changes every time.\n    result.sort();\n    return result;\n  }\n}\n\nregisterRPC('Uint64Set.add', function(x) {\n  let obj = this.get(x['id']);\n  if (obj.add_(x['value'])) {\n    obj.changed.dispatch();\n  }\n});\n\nregisterRPC('Uint64Set.delete', function(x) {\n  let obj = this.get(x['id']);\n  if (obj.delete_(x['value'])) {\n    obj.changed.dispatch();\n  }\n});\n\nregisterRPC('Uint64Set.clear', function(x) {\n  let obj = this.get(x['id']);\n  if (obj.hashTable.clear()) {\n    obj.changed.dispatch();\n  }\n});\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SegmentationDisplayState} from 'neuroglancer/segmentation_display_state/frontend';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nrequire('neuroglancer/noselect.css');\nrequire('./segment_set_widget.css');\n\ntype ItemElement = HTMLButtonElement;\n\nlet temp = new Uint64();\n\nexport class SegmentSetWidget extends RefCounted {\n  element = document.createElement('div');\n  private clearButton = document.createElement('button');\n  private itemContainer = document.createElement('span');\n  private items = new Map<string, ItemElement>();\n\n  get visibleSegments() {\n    return this.displayState.visibleSegments;\n  }\n  get segmentColorHash() {\n    return this.displayState.segmentColorHash;\n  }\n  get segmentSelectionState() {\n    return this.displayState.segmentSelectionState;\n  }\n\n  constructor(public displayState: SegmentationDisplayState) {\n    super();\n    let {element, clearButton, itemContainer} = this;\n    element.className = 'segment-set-widget neuroglancer-noselect';\n    clearButton.className = 'clear-button';\n    clearButton.title = 'Remove all segment IDs';\n    this.registerEventListener(clearButton, 'click', () => {\n      this.visibleSegments.clear();\n    });\n\n    itemContainer.className = 'item-container';\n    element.appendChild(itemContainer);\n\n    itemContainer.appendChild(clearButton);\n\n    this.registerDisposer(displayState.visibleSegments.changed.add((x, add) => {\n      this.handleSetChanged(x, add);\n    }));\n    this.registerDisposer(displayState.segmentColorHash.changed.add(() => {\n      this.handleColorChanged();\n    }));\n\n    for (let x of displayState.visibleSegments) {\n      this.addElement(x.toString());\n    }\n    this.updateClearButtonVisibility();\n  }\n\n  private updateClearButtonVisibility() {\n    let {clearButton} = this;\n    clearButton.style.display = (this.displayState.visibleSegments.size > 0) ? '' : 'none';\n  }\n\n  private handleSetChanged(x: Uint64|null, added: boolean) {\n    this.updateClearButtonVisibility();\n    let {items} = this;\n    if (x === null) {\n      // Cleared.\n      let {itemContainer, clearButton} = this;\n      while (true) {\n        let lastElement = itemContainer.lastElementChild!;\n        if (lastElement === clearButton) {\n          break;\n        }\n        itemContainer.removeChild(lastElement);\n      }\n      items.clear();\n    } else if (added) {\n      this.addElement(x.toString());\n    } else {\n      let s = x.toString();\n      let itemElement = items.get(s)!;\n      itemElement.parentElement!.removeChild(itemElement);\n      items.delete(s);\n    }\n  }\n\n  private addElement(s: string) {\n    let itemElement = document.createElement('button');\n    itemElement.className = 'segment-button';\n    itemElement.textContent = s;\n    itemElement.title = `Remove segment ID ${s}`;\n    let widget = this;\n    itemElement.addEventListener('click', function(this: ItemElement) {\n      temp.tryParseString(this.textContent!);\n      widget.visibleSegments.delete(temp);\n    });\n    itemElement.addEventListener('mouseenter', function(this: ItemElement) {\n      temp.tryParseString(this.textContent!);\n      widget.segmentSelectionState.set(temp);\n    });\n    itemElement.addEventListener('mouseleave', function(this: ItemElement) {\n      temp.tryParseString(this.textContent!);\n      widget.segmentSelectionState.set(null);\n    });\n    this.setItemColor(itemElement);\n    this.itemContainer.appendChild(itemElement);\n    this.items.set(s, itemElement);\n  }\n\n  private setItemColor(itemElement: ItemElement) {\n    temp.tryParseString(itemElement.textContent!);\n    itemElement.style.backgroundColor = this.segmentColorHash.computeCssColor(temp);\n  }\n\n  private handleColorChanged() {\n    this.items.forEach(itemElement => {\n      this.setItemColor(itemElement);\n    });\n  }\n\n  disposed() {\n    let {element} = this;\n    let {parentElement} = element;\n    if (parentElement) {\n      parentElement.removeChild(element);\n    }\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/noselect.css';\nimport 'neuroglancer/segmentation_user_layer.css';\n\nimport {UserLayer} from 'neuroglancer/layer';\nimport {LayerListSpecification, registerLayerType, registerVolumeLayerType} from 'neuroglancer/layer_specification';\nimport {MeshSource, MultiscaleMeshSource} from 'neuroglancer/mesh/frontend';\nimport {MeshLayer, MultiscaleMeshLayer} from 'neuroglancer/mesh/frontend';\nimport {Overlay} from 'neuroglancer/overlay';\nimport {RenderScaleHistogram, trackableRenderScaleTarget} from 'neuroglancer/render_scale_statistics';\nimport {SegmentColorHash} from 'neuroglancer/segment_color';\nimport {SegmentSelectionState, Uint64MapEntry} from 'neuroglancer/segmentation_display_state/frontend';\nimport {SharedDisjointUint64Sets} from 'neuroglancer/shared_disjoint_sets';\nimport {FRAGMENT_MAIN_START as SKELETON_FRAGMENT_MAIN_START, PerspectiveViewSkeletonLayer, SkeletonLayer, SkeletonRenderingOptions, SkeletonSource, SliceViewPanelSkeletonLayer, ViewSpecificSkeletonRenderingOptions} from 'neuroglancer/skeleton/frontend';\nimport {VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {SegmentationRenderLayer} from 'neuroglancer/sliceview/volume/segmentation_renderlayer';\nimport {trackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {ElementVisibilityFromTrackableBoolean, TrackableBoolean, TrackableBooleanCheckbox} from 'neuroglancer/trackable_boolean';\nimport {ComputedWatchableValue} from 'neuroglancer/trackable_value';\nimport {Uint64Set} from 'neuroglancer/uint64_set';\nimport {UserLayerWithVolumeSourceMixin} from 'neuroglancer/user_layer_with_volume_source';\nimport {Borrowed} from 'neuroglancer/util/disposable';\nimport {parseArray, verifyObjectProperty, verifyOptionalString} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {makeWatchableShaderError} from 'neuroglancer/webgl/dynamic_shader';\nimport {EnumSelectWidget} from 'neuroglancer/widget/enum_widget';\nimport {RangeWidget} from 'neuroglancer/widget/range';\nimport {RenderScaleWidget} from 'neuroglancer/widget/render_scale_widget';\nimport {SegmentSetWidget} from 'neuroglancer/widget/segment_set_widget';\nimport {ShaderCodeWidget} from 'neuroglancer/widget/shader_code_widget';\nimport {Tab} from 'neuroglancer/widget/tab_view';\nimport {Uint64EntryWidget} from 'neuroglancer/widget/uint64_entry_widget';\n\nconst SELECTED_ALPHA_JSON_KEY = 'selectedAlpha';\nconst NOT_SELECTED_ALPHA_JSON_KEY = 'notSelectedAlpha';\nconst OBJECT_ALPHA_JSON_KEY = 'objectAlpha';\nconst SATURATION_JSON_KEY = 'saturation';\nconst HIDE_SEGMENT_ZERO_JSON_KEY = 'hideSegmentZero';\nconst MESH_JSON_KEY = 'mesh';\nconst SKELETONS_JSON_KEY = 'skeletons';\nconst SEGMENTS_JSON_KEY = 'segments';\nconst HIGHLIGHTS_JSON_KEY = 'highlights';\nconst EQUIVALENCES_JSON_KEY = 'equivalences';\nconst COLOR_SEED_JSON_KEY = 'colorSeed';\nconst MESH_RENDER_SCALE_JSON_KEY = 'meshRenderScale';\n\nconst SKELETON_RENDERING_JSON_KEY = 'skeletonRendering';\nconst SKELETON_SHADER_JSON_KEY = 'skeletonShader';\n\nconst Base = UserLayerWithVolumeSourceMixin(UserLayer);\nexport class SegmentationUserLayer extends Base {\n  displayState = {\n    segmentColorHash: SegmentColorHash.getDefault(),\n    segmentSelectionState: new SegmentSelectionState(),\n    selectedAlpha: trackableAlphaValue(0.5),\n    saturation: trackableAlphaValue(1.0),\n    notSelectedAlpha: trackableAlphaValue(0),\n    objectAlpha: trackableAlphaValue(1.0),\n    hideSegmentZero: new TrackableBoolean(true, true),\n    visibleSegments: Uint64Set.makeWithCounterpart(this.manager.worker),\n    highlightedSegments: Uint64Set.makeWithCounterpart(this.manager.worker),\n    segmentEquivalences: SharedDisjointUint64Sets.makeWithCounterpart(this.manager.worker),\n    objectToDataTransform: this.transform,\n    skeletonRenderingOptions: new SkeletonRenderingOptions(),\n    shaderError: makeWatchableShaderError(),\n    renderScaleHistogram: new RenderScaleHistogram(),\n    renderScaleTarget: trackableRenderScaleTarget(1),\n  };\n\n  /**\n   * If meshPath is undefined, a default mesh source provided by the volume may be used.  If\n   * meshPath is null, the default mesh source is not used.\n   */\n  meshPath: string|null|undefined;\n  skeletonsPath: string|undefined;\n  meshLayer: Borrowed<MeshLayer|MultiscaleMeshLayer>|undefined;\n  skeletonLayer: Borrowed<SkeletonLayer>|undefined;\n\n  // Dispatched when either meshLayer or skeletonLayer changes.\n  objectLayerStateChanged = new NullarySignal();\n\n  constructor(public manager: LayerListSpecification, x: any) {\n    super(manager, x);\n    this.displayState.visibleSegments.changed.add(this.specificationChanged.dispatch);\n    this.displayState.segmentEquivalences.changed.add(this.specificationChanged.dispatch);\n    this.displayState.segmentSelectionState.bindTo(manager.layerSelectedValues, this);\n    this.displayState.selectedAlpha.changed.add(this.specificationChanged.dispatch);\n    this.displayState.saturation.changed.add(this.specificationChanged.dispatch);\n    this.displayState.notSelectedAlpha.changed.add(this.specificationChanged.dispatch);\n    this.displayState.objectAlpha.changed.add(this.specificationChanged.dispatch);\n    this.displayState.hideSegmentZero.changed.add(this.specificationChanged.dispatch);\n    this.displayState.skeletonRenderingOptions.changed.add(this.specificationChanged.dispatch);\n    this.displayState.segmentColorHash.changed.add(this.specificationChanged.dispatch);\n    this.displayState.renderScaleTarget.changed.add(this.specificationChanged.dispatch);\n    this.tabs.add(\n        'rendering', {label: 'Rendering', order: -100, getter: () => new DisplayOptionsTab(this)});\n    this.tabs.default = 'rendering';\n  }\n\n  get volumeOptions() {\n    return {volumeType: VolumeType.SEGMENTATION};\n  }\n\n  restoreState(specification: any) {\n    super.restoreState(specification);\n    this.displayState.selectedAlpha.restoreState(specification[SELECTED_ALPHA_JSON_KEY]);\n    this.displayState.saturation.restoreState(specification[SATURATION_JSON_KEY]);\n    this.displayState.notSelectedAlpha.restoreState(specification[NOT_SELECTED_ALPHA_JSON_KEY]);\n    this.displayState.objectAlpha.restoreState(specification[OBJECT_ALPHA_JSON_KEY]);\n    this.displayState.hideSegmentZero.restoreState(specification[HIDE_SEGMENT_ZERO_JSON_KEY]);\n\n    const {skeletonRenderingOptions} = this.displayState;\n    skeletonRenderingOptions.restoreState(specification[SKELETON_RENDERING_JSON_KEY]);\n    const skeletonShader = specification[SKELETON_SHADER_JSON_KEY];\n    if (skeletonShader !== undefined) {\n      skeletonRenderingOptions.shader.restoreState(skeletonShader);\n    }\n    this.displayState.segmentColorHash.restoreState(specification[COLOR_SEED_JSON_KEY]);\n    this.displayState.renderScaleTarget.restoreState(specification[MESH_RENDER_SCALE_JSON_KEY]);\n\n    verifyObjectProperty(specification, EQUIVALENCES_JSON_KEY, y => {\n      this.displayState.segmentEquivalences.restoreState(y);\n    });\n\n    const restoreSegmentsList = (key: string, segments: Uint64Set) => {\n      verifyObjectProperty(specification, key, y => {\n        if (y !== undefined) {\n          let {segmentEquivalences} = this.displayState;\n          parseArray(y, value => {\n            let id = Uint64.parseString(String(value), 10);\n            segments.add(segmentEquivalences.get(id));\n          });\n        }\n      });\n    };\n\n    restoreSegmentsList(SEGMENTS_JSON_KEY, this.displayState.visibleSegments);\n    restoreSegmentsList(HIGHLIGHTS_JSON_KEY, this.displayState.highlightedSegments);\n\n    this.displayState.highlightedSegments.changed.add(() => {\n      this.specificationChanged.dispatch();\n    });\n\n    const {multiscaleSource} = this;\n    let meshPath = this.meshPath = specification[MESH_JSON_KEY] === null ?\n        null :\n        verifyOptionalString(specification[MESH_JSON_KEY]);\n    let skeletonsPath = this.skeletonsPath =\n        verifyObjectProperty(specification, SKELETONS_JSON_KEY, verifyOptionalString);\n\n    let remaining = 0;\n    if (meshPath != null) {\n      ++remaining;\n      this.manager.dataSourceProvider.getMeshSource(this.manager.chunkManager, meshPath)\n          .then(meshSource => {\n            if (!this.wasDisposed) {\n              this.addMesh(meshSource);\n              if (--remaining === 0) {\n                this.isReady = true;\n              }\n            }\n          });\n    }\n\n    if (skeletonsPath !== undefined) {\n      ++remaining;\n      this.manager.dataSourceProvider.getSkeletonSource(this.manager.chunkManager, skeletonsPath)\n          .then(skeletonSource => {\n            if (!this.wasDisposed) {\n              this.addSkeletonSource(skeletonSource);\n              if (--remaining === 0) {\n                this.isReady = true;\n              }\n            }\n          });\n    }\n\n    if (multiscaleSource !== undefined) {\n      ++remaining;\n      multiscaleSource.then(volume => {\n        if (!this.wasDisposed) {\n          const {displayState} = this;\n          this.addRenderLayer(new SegmentationRenderLayer(volume, {\n            ...displayState,\n            transform: displayState.objectToDataTransform,\n            renderScaleHistogram: this.sliceViewRenderScaleHistogram,\n            renderScaleTarget: this.sliceViewRenderScaleTarget,\n          }));\n          if (meshPath === undefined && skeletonsPath === undefined) {\n            ++remaining;\n            Promise.resolve(volume.getMeshSource()).then(objectSource => {\n              if (this.wasDisposed) {\n                if (objectSource !== null) {\n                  objectSource.dispose();\n                }\n                return;\n              }\n              if (--remaining === 0) {\n                this.isReady = true;\n              }\n              if ((objectSource instanceof MeshSource) ||\n                  (objectSource instanceof MultiscaleMeshSource)) {\n                this.addMesh(objectSource);\n              } else if (objectSource instanceof SkeletonSource) {\n                this.addSkeletonSource(objectSource);\n              }\n            });\n          }\n          if (--remaining === 0) {\n            this.isReady = true;\n          }\n        }\n      });\n    }\n  }\n\n  addMesh(meshSource: MeshSource|MultiscaleMeshSource) {\n    if (meshSource instanceof MeshSource) {\n      this.meshLayer = new MeshLayer(this.manager.chunkManager, meshSource, this.displayState);\n    } else {\n      this.meshLayer =\n          new MultiscaleMeshLayer(this.manager.chunkManager, meshSource, this.displayState);\n    }\n    this.addRenderLayer(this.meshLayer);\n    this.objectLayerStateChanged.dispatch();\n  }\n\n  addSkeletonSource(skeletonSource: SkeletonSource) {\n    let base = new SkeletonLayer(\n        this.manager.chunkManager, skeletonSource, this.manager.voxelSize, this.displayState);\n    this.skeletonLayer = base;\n    this.addRenderLayer(new PerspectiveViewSkeletonLayer(base.addRef()));\n    this.addRenderLayer(new SliceViewPanelSkeletonLayer(/* transfer ownership */ base));\n    this.objectLayerStateChanged.dispatch();\n  }\n\n  toJSON() {\n    const x = super.toJSON();\n    x['type'] = 'segmentation';\n    x[MESH_JSON_KEY] = this.meshPath;\n    x[SKELETONS_JSON_KEY] = this.skeletonsPath;\n    x[SELECTED_ALPHA_JSON_KEY] = this.displayState.selectedAlpha.toJSON();\n    x[NOT_SELECTED_ALPHA_JSON_KEY] = this.displayState.notSelectedAlpha.toJSON();\n    x[SATURATION_JSON_KEY] = this.displayState.saturation.toJSON();\n    x[OBJECT_ALPHA_JSON_KEY] = this.displayState.objectAlpha.toJSON();\n    x[HIDE_SEGMENT_ZERO_JSON_KEY] = this.displayState.hideSegmentZero.toJSON();\n    x[COLOR_SEED_JSON_KEY] = this.displayState.segmentColorHash.toJSON();\n    let {visibleSegments} = this.displayState;\n    if (visibleSegments.size > 0) {\n      x[SEGMENTS_JSON_KEY] = visibleSegments.toJSON();\n    }\n    let {highlightedSegments} = this.displayState;\n    if (highlightedSegments.size > 0) {\n      x[HIGHLIGHTS_JSON_KEY] = highlightedSegments.toJSON();\n    }\n    let {segmentEquivalences} = this.displayState;\n    if (segmentEquivalences.size > 0) {\n      x[EQUIVALENCES_JSON_KEY] = segmentEquivalences.toJSON();\n    }\n    x[SKELETON_RENDERING_JSON_KEY] = this.displayState.skeletonRenderingOptions.toJSON();\n    x[MESH_RENDER_SCALE_JSON_KEY] = this.displayState.renderScaleTarget.toJSON();\n    return x;\n  }\n\n  transformPickedValue(value: any) {\n    if (value == null) {\n      return value;\n    }\n    let {segmentEquivalences} = this.displayState;\n    if (segmentEquivalences.size === 0) {\n      return value;\n    }\n    if (typeof value === 'number') {\n      value = new Uint64(value, 0);\n    }\n    let mappedValue = segmentEquivalences.get(value);\n    if (Uint64.equal(mappedValue, value)) {\n      return value;\n    }\n    return new Uint64MapEntry(value, mappedValue);\n  }\n\n  handleAction(action: string) {\n    switch (action) {\n      case 'recolor': {\n        this.displayState.segmentColorHash.randomize();\n        break;\n      }\n      case 'clear-segments': {\n        this.displayState.visibleSegments.clear();\n        break;\n      }\n      case 'select': {\n        let {segmentSelectionState} = this.displayState;\n        if (segmentSelectionState.hasSelectedSegment) {\n          let segment = segmentSelectionState.selectedSegment;\n          let {visibleSegments} = this.displayState;\n          if (visibleSegments.has(segment)) {\n            visibleSegments.delete(segment);\n          } else {\n            visibleSegments.add(segment);\n          }\n        }\n        break;\n      }\n      case 'highlight': {\n        let {segmentSelectionState} = this.displayState;\n        if (segmentSelectionState.hasSelectedSegment) {\n          let segment = segmentSelectionState.selectedSegment;\n          let {highlightedSegments} = this.displayState;\n          if (highlightedSegments.has(segment)) {\n            highlightedSegments.delete(segment);\n          } else {\n            highlightedSegments.add(segment);\n          }\n        }\n        break;\n      }\n    }\n  }\n}\n\nfunction makeSkeletonShaderCodeWidget(layer: SegmentationUserLayer) {\n  return new ShaderCodeWidget({\n    fragmentMain: layer.displayState.skeletonRenderingOptions.shader,\n    shaderError: layer.displayState.shaderError,\n    fragmentMainStartLine: SKELETON_FRAGMENT_MAIN_START,\n  });\n}\n\nclass DisplayOptionsTab extends Tab {\n  visibleSegmentWidget = this.registerDisposer(new SegmentSetWidget(this.layer.displayState));\n  addSegmentWidget = this.registerDisposer(new Uint64EntryWidget());\n  selectedAlphaWidget =\n      this.registerDisposer(new RangeWidget(this.layer.displayState.selectedAlpha));\n  notSelectedAlphaWidget =\n      this.registerDisposer(new RangeWidget(this.layer.displayState.notSelectedAlpha));\n  saturationWidget = this.registerDisposer(new RangeWidget(this.layer.displayState.saturation));\n  objectAlphaWidget = this.registerDisposer(new RangeWidget(this.layer.displayState.objectAlpha));\n  codeWidget: ShaderCodeWidget|undefined;\n  constructor(public layer: SegmentationUserLayer) {\n    super();\n    const {element} = this;\n    element.classList.add('segmentation-dropdown');\n    let {selectedAlphaWidget, notSelectedAlphaWidget, saturationWidget, objectAlphaWidget} = this;\n    selectedAlphaWidget.promptElement.textContent = 'Opacity (on)';\n    notSelectedAlphaWidget.promptElement.textContent = 'Opacity (off)';\n    saturationWidget.promptElement.textContent = 'Saturation';\n    objectAlphaWidget.promptElement.textContent = 'Opacity (3d)';\n\n    if (this.layer.volumePath !== undefined) {\n      element.appendChild(this.selectedAlphaWidget.element);\n      element.appendChild(this.notSelectedAlphaWidget.element);\n      element.appendChild(this.saturationWidget.element);\n\n      {\n        const renderScaleWidget = this.registerDisposer(new RenderScaleWidget(\n            this.layer.sliceViewRenderScaleHistogram, this.layer.sliceViewRenderScaleTarget));\n        renderScaleWidget.label.textContent = 'Resolution (slice)';\n        element.appendChild(renderScaleWidget.element);\n      }\n    }\n    const has3dLayer = this.registerDisposer(new ComputedWatchableValue(\n        () => this.layer.meshPath || this.layer.meshLayer || this.layer.skeletonsPath ||\n                this.layer.skeletonLayer ?\n            true :\n            false,\n        this.layer.objectLayerStateChanged));\n    this.registerDisposer(\n        new ElementVisibilityFromTrackableBoolean(has3dLayer, this.objectAlphaWidget.element));\n\n    {\n      const renderScaleWidget = this.registerDisposer(new RenderScaleWidget(\n          this.layer.displayState.renderScaleHistogram, this.layer.displayState.renderScaleTarget));\n      renderScaleWidget.label.textContent = 'Resolution (mesh)';\n      element.appendChild(renderScaleWidget.element);\n      this.registerDisposer(\n          new ElementVisibilityFromTrackableBoolean(has3dLayer, renderScaleWidget.element));\n    }\n    element.appendChild(this.objectAlphaWidget.element);\n\n    {\n      const checkbox =\n          this.registerDisposer(new TrackableBooleanCheckbox(layer.displayState.hideSegmentZero));\n      checkbox.element.className =\n          'neuroglancer-segmentation-dropdown-hide-segment-zero neuroglancer-noselect';\n      const label = document.createElement('label');\n      label.className =\n          'neuroglancer-segmentation-dropdown-hide-segment-zero neuroglancer-noselect';\n      label.appendChild(document.createTextNode('Hide segment ID 0'));\n      label.appendChild(checkbox.element);\n      element.appendChild(label);\n    }\n\n    this.addSegmentWidget.element.classList.add('add-segment');\n    this.addSegmentWidget.element.title = 'Add one or more segment IDs';\n    element.appendChild(this.registerDisposer(this.addSegmentWidget).element);\n    this.registerDisposer(this.addSegmentWidget.valuesEntered.add((values: Uint64[]) => {\n      for (const value of values) {\n        this.layer.displayState.visibleSegments.add(value);\n      }\n    }));\n    element.appendChild(this.registerDisposer(this.visibleSegmentWidget).element);\n\n    const maybeAddSkeletonShaderUI = () => {\n      if (this.codeWidget !== undefined) {\n        return;\n      }\n      if (this.layer.skeletonsPath === null || this.layer.skeletonLayer === undefined) {\n        return;\n      }\n      const addViewSpecificSkeletonRenderingControls =\n          (options: ViewSpecificSkeletonRenderingOptions, viewName: string) => {\n            {\n              const widget = this.registerDisposer(new EnumSelectWidget(options.mode));\n              const label = document.createElement('label');\n              label.className =\n                  'neuroglancer-segmentation-dropdown-skeleton-render-mode neuroglancer-noselect';\n              label.appendChild(document.createTextNode(`Skeleton mode (${viewName})`));\n              label.appendChild(widget.element);\n              element.appendChild(label);\n            }\n            {\n              const widget = this.registerDisposer(\n                  new RangeWidget(options.lineWidth, {min: 1, max: 40, step: 1}));\n              widget.promptElement.textContent = `Skeleton line width (${viewName})`;\n              element.appendChild(widget.element);\n            }\n          };\n      addViewSpecificSkeletonRenderingControls(\n          layer.displayState.skeletonRenderingOptions.params2d, '2d');\n      addViewSpecificSkeletonRenderingControls(\n          layer.displayState.skeletonRenderingOptions.params3d, '3d');\n      let topRow = document.createElement('div');\n      topRow.className = 'neuroglancer-segmentation-dropdown-skeleton-shader-header';\n      let label = document.createElement('div');\n      label.style.flex = '1';\n      label.textContent = 'Skeleton shader:';\n      let helpLink = document.createElement('a');\n      let helpButton = document.createElement('button');\n      helpButton.type = 'button';\n      helpButton.textContent = '?';\n      helpButton.className = 'help-link';\n      helpLink.appendChild(helpButton);\n      helpLink.title = 'Documentation on skeleton rendering';\n      helpLink.target = '_blank';\n      helpLink.href =\n          'https://github.com/google/neuroglancer/blob/master/src/neuroglancer/sliceview/image_layer_rendering.md';\n\n      let maximizeButton = document.createElement('button');\n      maximizeButton.innerHTML = '&square;';\n      maximizeButton.className = 'maximize-button';\n      maximizeButton.title = 'Show larger editor view';\n      this.registerEventListener(maximizeButton, 'click', () => {\n        new ShaderCodeOverlay(this.layer);\n      });\n\n      topRow.appendChild(label);\n      topRow.appendChild(maximizeButton);\n      topRow.appendChild(helpLink);\n\n      element.appendChild(topRow);\n\n      const codeWidget = this.codeWidget =\n          this.registerDisposer(makeSkeletonShaderCodeWidget(this.layer));\n      element.appendChild(codeWidget.element);\n      codeWidget.textEditor.refresh();\n    };\n    this.registerDisposer(this.layer.objectLayerStateChanged.add(maybeAddSkeletonShaderUI));\n    maybeAddSkeletonShaderUI();\n\n    this.visibility.changed.add(() => {\n      if (this.visible) {\n        if (this.codeWidget !== undefined) {\n          this.codeWidget.textEditor.refresh();\n        }\n      }\n    });\n  }\n}\n\nclass ShaderCodeOverlay extends Overlay {\n  codeWidget = this.registerDisposer(makeSkeletonShaderCodeWidget(this.layer));\n  constructor(public layer: SegmentationUserLayer) {\n    super();\n    this.content.classList.add('neuroglancer-segmentation-layer-skeleton-shader-overlay');\n    this.content.appendChild(this.codeWidget.element);\n    this.codeWidget.textEditor.refresh();\n  }\n}\n\nregisterLayerType('segmentation', SegmentationUserLayer);\nregisterVolumeLayerType(VolumeType.SEGMENTATION, SegmentationUserLayer);\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {BrainmapsInstance} from 'neuroglancer/datasource/brainmaps/api';\nimport {vec3} from 'neuroglancer/util/geom';\n\nexport enum VolumeChunkEncoding {\n  RAW,\n  JPEG,\n  COMPRESSED_SEGMENTATION\n}\n\nexport class ChangeSpec {\n  changeStackId: string;\n  /**\n   * Apply changes prior to this timestamp (in milliseconds since epoch).  If 0, no changes should\n   * be applied.  If negative, all changes should be applied.\n   */\n  timeStamp?: number;\n  skipEquivalences?: boolean;\n}\n\nexport class VolumeSourceParameters {\n  instance: BrainmapsInstance;\n  volumeId: string;\n  scaleIndex: number;\n  encoding: VolumeChunkEncoding;\n  changeSpec: ChangeSpec|undefined;\n\n  static RPC_ID = 'brainmaps/VolumeChunkSource';\n}\n\nexport interface SingleMeshInfo {\n  name: string;\n  type: string;\n}\n\nexport interface MultiscaleMeshLOD {\n  info: SingleMeshInfo;\n  scale: number;\n\n  /**\n   * Shape of the chunk for this level of detail, as a multiple of the base chunk shape.\n   */\n  relativeBlockShape: vec3;\n\n  /**\n   * Size of chunk grid, in chunks.\n   */\n  gridShape: Uint32Array;\n}\n\nexport interface MultiscaleMeshInfo {\n  /**\n   * Prefix\n   */\n  key: string;\n\n  /**\n   * Chunk shape in spatial units (nm) for lod 0.\n   */\n  chunkShape: vec3;\n\n  lods: MultiscaleMeshLOD[];\n}\n\nexport class MultiscaleMeshSourceParameters {\n  instance: BrainmapsInstance;\n  volumeId: string;\n  info: MultiscaleMeshInfo;\n  changeSpec: ChangeSpec|undefined;\n\n  static RPC_ID = 'brainmaps/MultiscaleMeshSource';\n}\n\nexport class MeshSourceParameters  {\n  instance: BrainmapsInstance;\n  volumeId: string;\n  meshName: string;\n  changeSpec: ChangeSpec|undefined;\n  \n  static RPC_ID = 'brainmaps/MeshSource';\n}\n\nexport class SkeletonSourceParameters  {\n  instance: BrainmapsInstance;\n  volumeId: string;\n  meshName: string;\n  changeSpec: ChangeSpec|undefined;\n  \n  static RPC_ID = 'brainmaps/SkeletonSource';\n}\n\nexport class AnnotationSourceParameters {\n  instance: BrainmapsInstance;\n  volumeId: string;\n  changestack: string;\n\n  static RPC_ID = 'brainmaps/Annotation';\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationSource, AnnotationType, makeDataBoundsBoundingBox} from 'neuroglancer/annotation';\nimport {AnnotationGeometryChunkSpecification} from 'neuroglancer/annotation/base';\nimport {MultiscaleAnnotationSource} from 'neuroglancer/annotation/frontend';\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {CredentialsProvider} from 'neuroglancer/credentials_provider';\nimport {WithCredentialsProvider} from 'neuroglancer/credentials_provider/chunk_source_frontend';\nimport {DataSource, GetVolumeOptions} from 'neuroglancer/datasource';\nimport {BrainmapsCredentialsProvider, BrainmapsInstance, Credentials, makeRequest} from 'neuroglancer/datasource/brainmaps/api';\nimport {AnnotationSourceParameters, ChangeSpec, MeshSourceParameters, MultiscaleMeshInfo, MultiscaleMeshSourceParameters, SingleMeshInfo, SkeletonSourceParameters, VolumeChunkEncoding, VolumeSourceParameters} from 'neuroglancer/datasource/brainmaps/base';\nimport {VertexPositionFormat} from 'neuroglancer/mesh/base';\nimport {MeshSource, MultiscaleMeshSource} from 'neuroglancer/mesh/frontend';\nimport {SkeletonSource} from 'neuroglancer/skeleton/frontend';\nimport {ChunkLayoutPreference} from 'neuroglancer/sliceview/base';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {getPrefixMatches, getPrefixMatchesWithDescriptions} from 'neuroglancer/util/completion';\nimport {Borrowed, Owned} from 'neuroglancer/util/disposable';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {parseArray, parseQueryStringParameters, parseXYZ, verifyEnumString, verifyFiniteFloat, verifyFinitePositiveFloat, verifyMapKey, verifyObject, verifyObjectProperty, verifyOptionalString, verifyPositiveInt, verifyString} from 'neuroglancer/util/json';\nimport {getObjectId} from 'neuroglancer/util/object_id';\n\nclass BrainmapsVolumeChunkSource extends\n(WithParameters(\n    WithCredentialsProvider<Credentials>()(VolumeChunkSource), VolumeSourceParameters)) {}\n\nclass BrainmapsMultiscaleMeshSource extends\n(WithParameters(WithCredentialsProvider<Credentials>()(MultiscaleMeshSource), MultiscaleMeshSourceParameters)) {}\n\nclass BrainmapsMeshSource extends\n(WithParameters(WithCredentialsProvider<Credentials>()(MeshSource), MeshSourceParameters)) {}\n\nexport class BrainmapsSkeletonSource extends\n(WithParameters(WithCredentialsProvider<Credentials>()(SkeletonSource), SkeletonSourceParameters)) {\n  get skeletonVertexCoordinatesInVoxels() {\n    return false;\n  }\n}\n\nconst SERVER_DATA_TYPES = new Map<string, DataType>();\nSERVER_DATA_TYPES.set('UINT8', DataType.UINT8);\nSERVER_DATA_TYPES.set('FLOAT', DataType.FLOAT32);\nSERVER_DATA_TYPES.set('UINT64', DataType.UINT64);\n\nfunction parseBoundingBox(obj: any) {\n  verifyObject(obj);\n  try {\n    return {\n      corner:\n          verifyObjectProperty(obj, 'corner', x => parseXYZ(vec3.create(), x, verifyFiniteFloat)),\n      size: verifyObjectProperty(\n          obj, 'size', x => parseXYZ(vec3.create(), x, verifyFinitePositiveFloat)),\n      metadata: verifyObjectProperty(obj, 'metadata', verifyOptionalString),\n    };\n  } catch (parseError) {\n    throw new Error(`Failed to parse bounding box: ${parseError.message}`);\n  }\n}\n\nexport class VolumeInfo {\n  numChannels: number;\n  dataType: DataType;\n  voxelSize: vec3;\n  upperVoxelBound: vec3;\n  boundingBoxes: {corner: vec3, size: vec3, metadata?: string}[];\n  constructor(obj: any) {\n    try {\n      verifyObject(obj);\n      this.numChannels = verifyObjectProperty(obj, 'channelCount', verifyPositiveInt);\n      this.dataType =\n          verifyObjectProperty(obj, 'channelType', x => verifyMapKey(x, SERVER_DATA_TYPES));\n      this.voxelSize = verifyObjectProperty(\n          obj, 'pixelSize', x => parseXYZ(vec3.create(), x, verifyFinitePositiveFloat));\n      this.upperVoxelBound = verifyObjectProperty(\n          obj, 'volumeSize', x => parseXYZ(vec3.create(), x, verifyPositiveInt));\n      this.boundingBoxes = verifyObjectProperty(\n          obj, 'boundingBox', a => a === undefined ? [] : parseArray(a, parseBoundingBox));\n    } catch (parseError) {\n      throw new Error(`Failed to parse BrainMaps volume geometry: ${parseError.message}`);\n    }\n  }\n}\n\nfunction parseMeshInfo(obj: any): SingleMeshInfo {\n  verifyObject(obj);\n  return {\n    name: verifyObjectProperty(obj, 'name', verifyString),\n    type: verifyObjectProperty(obj, 'type', verifyString)\n  };\n}\n\nfunction parseMeshesResponse(meshesResponse: any): SingleMeshInfo[] {\n  try {\n    verifyObject(meshesResponse);\n    return verifyObjectProperty(meshesResponse, 'meshes', y => {\n      if (y === undefined) {\n        return [];\n      }\n      return parseArray(y, parseMeshInfo);\n    });\n  } catch (parseError) {\n    throw new Error(`Failed to parse BrainMaps meshes specification: ${parseError.message}`);\n  }\n}\n\nconst floatPattern = '([0-9]*\\\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)';\nconst intPattern = '([0-9]+)';\nconst lodPattern =\n    new RegExp(`^(.*)_${intPattern}x${intPattern}x${intPattern}_lod([0-9]+)_${floatPattern}$`);\n\nfunction getMultiscaleMeshes(\n  volumeInfo: MultiscaleVolumeInfo, meshes: SingleMeshInfo[]): MultiscaleMeshInfo[] {\n  const multiscaleMeshes = new Map<string, MultiscaleMeshInfo>();\n  const baseVolume = volumeInfo.scales[0];\n\n  const invalidLodMeshes = new Set<string>();\n\n  for (const mesh of meshes) {\n    // Only triangular meshes supported currently.\n    if (mesh.type !== 'TRIANGLES') continue;\n    const m = mesh.name.match(lodPattern);\n    if (m === null) continue;\n    const key = m[1];\n    let info = multiscaleMeshes.get(key);\n    if (info === undefined) {\n      info = {\n        key,\n        chunkShape: vec3.create(),\n        lods: []\n      };\n      multiscaleMeshes.set(key, info);\n    }\n    const lod = parseInt(m[5]);\n    if (info.lods[lod] !== undefined) {\n      invalidLodMeshes.add(key);\n      continue;\n    }\n    const chunkShapeInVoxels =\n      vec3.fromValues(parseInt(m[2], 10), parseInt(m[3], 10), parseInt(m[4], 10));\n    const gridShape = new Uint32Array(3);\n    for (let i = 0; i < 3; ++i) {\n      gridShape[i] = Math.ceil(baseVolume.upperVoxelBound[i] / chunkShapeInVoxels[i]);\n    }\n\n    info.lods[lod] = {\n      info: mesh,\n      scale: parseFloat(m[6]),\n      // Temporarily use the relativeBlockShape field to store the absolute shape in voxels.\n      relativeBlockShape: chunkShapeInVoxels,\n      gridShape,\n    };\n  }\n\n  const output: MultiscaleMeshInfo[] = [];\n  meshLoop: for (const mesh of multiscaleMeshes.values()) {\n    if (invalidLodMeshes.has(mesh.key)) continue meshLoop;\n    const baseLod = mesh.lods[0];\n    if (baseLod === undefined) continue meshLoop;\n    const baseBlockShapeInVoxels = baseLod.relativeBlockShape;\n    vec3.multiply(mesh.chunkShape, baseBlockShapeInVoxels, baseVolume.voxelSize);\n    for (let lodIndex = 1; lodIndex < mesh.lods.length; ++lodIndex) {\n      const lod = mesh.lods[lodIndex];\n      if (lod === undefined) continue meshLoop;\n      const {relativeBlockShape} = lod;\n      for (let i = 0; i < 3; ++i) {\n        const curSize = relativeBlockShape[i];\n        const baseSize = baseBlockShapeInVoxels[i];\n        if (curSize < baseSize || (curSize % baseSize) !== 0) continue meshLoop;\n        relativeBlockShape[i] = curSize / baseSize;\n      }\n    }\n    baseBlockShapeInVoxels.fill(1);\n    output.push(mesh);\n  }\n\n  return output;\n}\n\nexport class MultiscaleVolumeInfo {\n  scales: VolumeInfo[];\n  numChannels: number;\n  dataType: DataType;\n  constructor(volumeInfoResponse: any) {\n    try {\n      verifyObject(volumeInfoResponse);\n      let scales = this.scales = verifyObjectProperty(\n          volumeInfoResponse, 'geometry', y => parseArray(y, x => new VolumeInfo(x)));\n      if (scales.length === 0) {\n        throw new Error('Expected at least one scale.');\n      }\n      let baseScale = scales[0];\n      let numChannels = this.numChannels = baseScale.numChannels;\n      let dataType = this.dataType = baseScale.dataType;\n      for (let scaleIndex = 1, numScales = scales.length; scaleIndex < numScales; ++scaleIndex) {\n        let scale = scales[scaleIndex];\n        if (scale.dataType !== dataType) {\n          throw new Error(\n              `Scale ${scaleIndex} has data type ${DataType[scale.dataType]} ` +\n              `but scale 0 has data type ${DataType[dataType]}.`);\n        }\n        if (scale.numChannels !== numChannels) {\n          throw new Error(\n              `Scale ${scaleIndex} has ${scale.numChannels} channel(s) ` +\n              `but scale 0 has ${numChannels} channels.`);\n        }\n      }\n    } catch (parseError) {\n      throw new Error(\n          `Failed to parse BrainMaps multiscale volume specification: ${parseError.message}`);\n    }\n  }\n}\n\nexport interface GetBrainmapsVolumeOptions extends GetVolumeOptions {\n  encoding?: VolumeChunkEncoding;\n  chunkLayoutPreference?: ChunkLayoutPreference;\n}\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  volumeType: VolumeType;\n  get scales() {\n    return this.multiscaleVolumeInfo.scales;\n  }\n  get dataType() {\n    return this.multiscaleVolumeInfo.dataType;\n  }\n  get numChannels() {\n    return this.multiscaleVolumeInfo.numChannels;\n  }\n  meshes: SingleMeshInfo[];\n  encoding: VolumeChunkEncoding|undefined;\n  chunkLayoutPreference: ChunkLayoutPreference|undefined;\n  constructor(\n      public chunkManager: ChunkManager, public instance: BrainmapsInstance,\n      public credentialsProvider: Borrowed<BrainmapsCredentialsProvider>, public volumeId: string,\n      public changeSpec: ChangeSpec|undefined, public multiscaleVolumeInfo: MultiscaleVolumeInfo,\n      meshesResponse: any, options: GetBrainmapsVolumeOptions) {\n    this.encoding = options.encoding;\n    this.chunkLayoutPreference = options.chunkLayoutPreference;\n\n    // Infer the VolumeType from the data type and number of channels.\n    let volumeType: VolumeType|undefined;\n    if (this.numChannels === 1) {\n      switch (this.dataType) {\n        case DataType.UINT64:\n          volumeType = VolumeType.SEGMENTATION;\n          break;\n      }\n    }\n    if (volumeType === undefined) {\n      if (options.volumeType !== undefined) {\n        volumeType = options.volumeType;\n      } else {\n        volumeType = VolumeType.IMAGE;\n      }\n    }\n    this.volumeType = volumeType;\n    this.meshes = parseMeshesResponse(meshesResponse);\n  }\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    let encoding = VolumeChunkEncoding.RAW;\n    if (this.dataType === DataType.UINT64) {\n      encoding = VolumeChunkEncoding.COMPRESSED_SEGMENTATION;\n    } else if (\n        this.volumeType === VolumeType.IMAGE && this.dataType === DataType.UINT8 &&\n        this.numChannels === 1 && this.encoding !== VolumeChunkEncoding.RAW) {\n      encoding = VolumeChunkEncoding.JPEG;\n    }\n\n    const baseScale = this.scales[0];\n    const upperClipBound =\n        vec3.multiply(vec3.create(), baseScale.upperVoxelBound, baseScale.voxelSize);\n\n    return this.scales.map(\n        (volumeInfo, scaleIndex) =>\n            VolumeChunkSpecification\n                .getDefaults({\n                  voxelSize: volumeInfo.voxelSize,\n                  dataType: volumeInfo.dataType,\n                  numChannels: volumeInfo.numChannels,\n                  upperVoxelBound: volumeInfo.upperVoxelBound,\n                  upperClipBound,\n                  volumeType: this.volumeType,\n                  volumeSourceOptions,\n                  chunkLayoutPreference: this.chunkLayoutPreference,\n                  maxCompressedSegmentationBlockSize: vec3.fromValues(64, 64, 64),\n                })\n                .map(spec => {\n                  return this.chunkManager.getChunkSource(BrainmapsVolumeChunkSource, {\n                    credentialsProvider: this.credentialsProvider,\n                    spec,\n                    parameters: {\n                      'volumeId': this.volumeId,\n                      'changeSpec': this.changeSpec,\n                      'scaleIndex': scaleIndex,\n                      'encoding': encoding,\n                      'instance': this.instance,\n                    }\n                  });\n                }));\n  }\n\n  getMeshSource() {\n    const multiscaleMeshes = getMultiscaleMeshes(this.multiscaleVolumeInfo, this.meshes);\n    for (const mesh of multiscaleMeshes) {\n      return this.chunkManager.getChunkSource(BrainmapsMultiscaleMeshSource, {\n        credentialsProvider: this.credentialsProvider,\n        format: {\n          fragmentRelativeVertices: false,\n          transform: mat4.create(),\n          vertexPositionFormat: VertexPositionFormat.float32,\n        },\n        parameters: {\n          'instance': this.instance,\n          'volumeId': this.volumeId,\n          'info': mesh,\n          'changeSpec': this.changeSpec,\n        }\n      });\n    }\n    for (const mesh of this.meshes) {\n      if (mesh.type === 'TRIANGLES') {\n        return this.chunkManager.getChunkSource(BrainmapsMeshSource, {\n          credentialsProvider: this.credentialsProvider,\n          parameters: {\n            'instance': this.instance,\n            'volumeId': this.volumeId,\n            'meshName': mesh.name,\n            'changeSpec': this.changeSpec,\n          }\n        });\n      } else if (mesh.type === 'LINE_SEGMENTS') {\n        return this.chunkManager.getChunkSource(BrainmapsSkeletonSource, {\n          credentialsProvider: this.credentialsProvider,\n          parameters: {\n            'instance': this.instance,\n            'volumeId': this.volumeId,\n            'meshName': mesh.name,\n            'changeSpec': this.changeSpec,\n          }\n        });\n      }\n    }\n    return null;\n  }\n\n  getStaticAnnotations() {\n    const baseScale = this.scales[0];\n    const annotationSet =\n        new AnnotationSource(mat4.fromScaling(mat4.create(), baseScale.voxelSize));\n    annotationSet.readonly = true;\n    annotationSet.add(makeDataBoundsBoundingBox(vec3.create(), baseScale.upperVoxelBound));\n\n    baseScale.boundingBoxes.forEach((boundingBox, i) => {\n      annotationSet.add({\n        type: AnnotationType.AXIS_ALIGNED_BOUNDING_BOX,\n        description: boundingBox.metadata,\n        pointA: boundingBox.corner,\n        pointB: vec3.add(vec3.create(), boundingBox.corner, boundingBox.size),\n        id: `boundingBox${i}`,\n      });\n    });\n    return annotationSet;\n  }\n}\n\n\nexport function parseVolumeKey(key: string):\n    {volumeId: string, changeSpec: ChangeSpec|undefined, parameters: any} {\n  const match = key.match(/^([^:?]+:[^:?]+:[^:?]+)(?::([^:?]+))?(?:\\?(.*))?$/);\n  if (match === null) {\n    throw new Error(`Invalid Brain Maps volume key: ${JSON.stringify(key)}.`);\n  }\n  let changeSpec: ChangeSpec|undefined;\n  if (match[2] !== undefined) {\n    changeSpec = {changeStackId: match[2]};\n  }\n  const parameters = parseQueryStringParameters(match[3] || '');\n  return {volumeId: match[1], changeSpec, parameters};\n}\n\nconst meshSourcePattern = /^([^\\/]+)\\/(.*)$/;\n\n\ninterface ProjectMetadata {\n  id: string;\n  label: string;\n  description?: string;\n}\n\nfunction parseProject(obj: any): ProjectMetadata {\n  try {\n    verifyObject(obj);\n    return {\n      id: verifyObjectProperty(obj, 'id', verifyString),\n      label: verifyObjectProperty(obj, 'label', verifyString),\n      description: verifyObjectProperty(obj, 'description', verifyOptionalString),\n    };\n  } catch (parseError) {\n    throw new Error(`Failed to parse project: ${parseError.message}`);\n  }\n}\n\nfunction parseProjectList(obj: any) {\n  try {\n    verifyObject(obj);\n    return verifyObjectProperty(\n        obj, 'project', x => x === undefined ? [] : parseArray(x, parseProject));\n  } catch (parseError) {\n    throw new Error(`Error parsing project list: ${parseError.message}`);\n  }\n}\n\nfunction parseAPIResponseList(obj: any, propertyName: string) {\n  try {\n    verifyObject(obj);\n    return verifyObjectProperty(\n        obj, propertyName, x => x === undefined ? [] : parseArray(x, verifyString));\n  } catch (parseError) {\n    throw new Error(`Error parsing dataset list: ${parseError.message}`);\n  }\n}\n\nexport class VolumeList {\n  volumeIds: string[];\n  projects = new Map<string, ProjectMetadata>();\n  hierarchicalVolumeIds = new Map<string, string[]>();\n  constructor(projectsResponse: any, volumesResponse: any) {\n    const {projects} = this;\n    for (let project of parseProjectList(projectsResponse)) {\n      projects.set(project.id, project);\n    }\n    try {\n      verifyObject(volumesResponse);\n      let volumeIds = this.volumeIds = verifyObjectProperty(\n          volumesResponse, 'volumeId', x => x === undefined ? [] : parseArray(x, verifyString));\n      volumeIds.sort();\n      let hierarchicalSets = new Map<string, Set<string>>();\n      for (let volumeId of volumeIds) {\n        let componentStart = 0;\n        while (true) {\n          let nextColon: number|undefined = volumeId.indexOf(':', componentStart);\n          if (nextColon === -1) {\n            nextColon = undefined;\n          } else {\n            ++nextColon;\n          }\n          let groupString = volumeId.substring(0, componentStart);\n          let group = hierarchicalSets.get(groupString);\n          if (group === undefined) {\n            group = new Set<string>();\n            hierarchicalSets.set(groupString, group);\n          }\n          group.add(volumeId.substring(componentStart, nextColon));\n          if (nextColon === undefined) {\n            break;\n          }\n          componentStart = nextColon;\n        }\n      }\n      let {hierarchicalVolumeIds} = this;\n      for (let [group, valueSet] of hierarchicalSets) {\n        hierarchicalVolumeIds.set(group, Array.from(valueSet));\n      }\n    } catch (parseError) {\n      throw new Error(`Failed to parse Brain Maps volume list reply: ${parseError.message}`);\n    }\n  }\n}\n\n\nexport function parseChangeStackList(x: any) {\n  return verifyObjectProperty(\n      x, 'changeStackId', y => y === undefined ? undefined : parseArray(y, verifyString));\n}\n\nfunction makeAnnotationGeometrySourceSpecifications(multiscaleInfo: MultiscaleVolumeInfo) {\n  const baseScale = multiscaleInfo.scales[0];\n  const spec = new AnnotationGeometryChunkSpecification({\n    voxelSize: baseScale.voxelSize,\n    chunkSize: vec3.multiply(vec3.create(), baseScale.upperVoxelBound, baseScale.voxelSize),\n    upperChunkBound: vec3.fromValues(1, 1, 1),\n  });\n  return [[{parameters: undefined, spec}]];\n}\n\nconst MultiscaleAnnotationSourceBase = (WithParameters(\n    WithCredentialsProvider<Credentials>()(MultiscaleAnnotationSource),\n    AnnotationSourceParameters));\n\nexport class BrainmapsAnnotationSource extends MultiscaleAnnotationSourceBase {\n  key: any;\n  constructor(chunkManager: ChunkManager, options: {\n    credentialsProvider: CredentialsProvider<Credentials>,\n    parameters: AnnotationSourceParameters,\n    multiscaleVolumeInfo: MultiscaleVolumeInfo\n  }) {\n    super(chunkManager, <any>{\n      sourceSpecifications:\n          makeAnnotationGeometrySourceSpecifications(options.multiscaleVolumeInfo),\n      ...options\n    });\n    mat4.fromScaling(this.objectToLocal, options.multiscaleVolumeInfo.scales[0].voxelSize);\n  }\n}\n\nexport class BrainmapsDataSource extends DataSource {\n  constructor(\n      public instance: BrainmapsInstance,\n      public credentialsProvider: Owned<BrainmapsCredentialsProvider>) {\n    super();\n  }\n\n  get description() {\n    return this.instance.description;\n  }\n\n  getMeshSource(chunkManager: ChunkManager, url: string) {\n    return chunkManager.getChunkSource(BrainmapsMeshSource, {\n      credentialsProvider: this.credentialsProvider,\n      parameters: this.getMeshSourceParameters(url)\n    });\n  }\n\n\n  getMeshSourceParameters(url: string) {\n    let match = url.match(meshSourcePattern);\n    if (match === null) {\n      throw new Error(`Invalid Brainmaps mesh URL: ${url}`);\n    }\n    let {volumeId, changeSpec} = parseVolumeKey(match[1]);\n    return {instance: this.instance, volumeId, changeSpec, meshName: match[2]};\n  }\n\n  getSkeletonSource(chunkManager: ChunkManager, url: string) {\n    return chunkManager.getChunkSource(BrainmapsSkeletonSource, {\n      credentialsProvider: this.credentialsProvider,\n      parameters: this.getMeshSourceParameters(url)\n    });\n  }\n\n  getMultiscaleInfo(chunkManager: ChunkManager, volumeId: string) {\n    return chunkManager.memoize.getUncounted(\n        {\n          type: 'brainmaps:getMultiscaleInfo',\n          volumeId,\n          instance: this.instance,\n          credentialsProvider: getObjectId(this.credentialsProvider)\n        },\n        () => makeRequest(this.instance, this.credentialsProvider, {\n                method: 'GET',\n                path: `/v1beta2/volumes/${volumeId}`,\n                responseType: 'json'\n              }).then(response => new MultiscaleVolumeInfo(response)));\n  }\n\n  getVolume(chunkManager: ChunkManager, key: string, options: GetVolumeOptions) {\n    const {volumeId, changeSpec, parameters} = parseVolumeKey(key);\n    verifyObject(parameters);\n    const encoding = verifyObjectProperty(\n        parameters, 'encoding',\n        x => x === undefined ? undefined : verifyEnumString(x, VolumeChunkEncoding));\n    const chunkLayoutPreference = verifyObjectProperty(\n        parameters, 'chunkLayout',\n        x => x === undefined ? undefined : verifyEnumString(x, ChunkLayoutPreference));\n    const brainmapsOptions:\n        GetBrainmapsVolumeOptions = {...options, encoding, chunkLayoutPreference};\n    return chunkManager.memoize.getUncounted(\n        {\n          type: 'brainmaps:getVolume',\n          instance: this.instance,\n          volumeId,\n          changeSpec,\n          brainmapsOptions\n        },\n        () => Promise\n                  .all([\n                    this.getMultiscaleInfo(chunkManager, volumeId),\n                    makeRequest(this.instance, this.credentialsProvider, {\n                      method: 'GET',\n                      path: `/v1beta2/objects/${volumeId}/meshes`,\n                      responseType: 'json'\n                    }),\n                  ])\n                  .then(\n                      ([multiscaleVolumeInfo, meshesResponse]) => new MultiscaleVolumeChunkSource(\n                          chunkManager, this.instance, this.credentialsProvider, volumeId,\n                          changeSpec, multiscaleVolumeInfo, meshesResponse, brainmapsOptions)));\n  }\n\n  getAnnotationSource(chunkManager: ChunkManager, key: string) {\n    const {volumeId, changeSpec} = parseVolumeKey(key);\n    if (changeSpec === undefined) {\n      throw new Error(`A changestack must be specified.`);\n    }\n    const parameters = {\n      volumeId,\n      changestack: changeSpec.changeStackId,\n      instance: this.instance,\n    };\n    return chunkManager.memoize.getUncounted(\n        {\n          type: 'brainmaps:getAnnotationSource',\n          instance: this.instance,\n          credentialsProvider: getObjectId(this.credentialsProvider),\n          parameters\n        },\n        () =>\n            this.getMultiscaleInfo(chunkManager, volumeId)\n                .then(\n                    multiscaleVolumeInfo => chunkManager.getChunkSource(BrainmapsAnnotationSource, {\n                      parameters,\n                      credentialsProvider: this.credentialsProvider,\n                      multiscaleVolumeInfo\n                    })));\n  }\n\n  getProjectList(chunkManager: ChunkManager) {\n    return chunkManager.memoize.getUncounted(\n        {instance: this.instance, type: 'brainmaps:getProjectList'}, () => {\n          let promise = makeRequest(this.instance, this.credentialsProvider, {\n                          method: 'GET',\n                          path: '/v1beta2/projects',\n                          responseType: 'json'\n                        }).then((projectsResponse) => {\n            return parseProjectList(projectsResponse);\n          });\n          const description = `${this.instance.description} project list`;\n          StatusMessage.forPromise(promise, {\n            delay: true,\n            initialMessage: `Retrieving ${description}.`,\n            errorPrefix: `Error retrieving ${description}: `,\n          });\n          return promise;\n        });\n  }\n\n  getDatasetList(chunkManager: ChunkManager, project: string) {\n    return chunkManager.memoize.getUncounted(\n        {instance: this.instance, type: `brainmaps:${project}:getDatasetList`}, () => {\n          let promise = makeRequest(this.instance, this.credentialsProvider, {\n                          method: 'GET',\n                          path: `/v1beta2/datasets?project_id=${project}`,\n                          responseType: 'json'\n                        }).then((datasetsResponse) => {\n            return parseAPIResponseList(datasetsResponse, 'datasetIds');\n          });\n          const description = `${this.instance.description} dataset list`;\n          StatusMessage.forPromise(promise, {\n            delay: true,\n            initialMessage: `Retrieving ${description}`,\n            errorPrefix: `Error retrieving ${description}`\n          });\n          return promise;\n        });\n  }\n\n  getVolumeList(chunkManager: ChunkManager, project: string, dataset: string) {\n    return chunkManager.memoize.getUncounted(\n        {instance: this.instance, type: `brainmaps:${project}:${dataset}:getVolumeList`}, () => {\n          let promise = makeRequest(this.instance, this.credentialsProvider, {\n                          method: 'GET',\n                          path: `/v1beta2/volumes?project_id=${project}&dataset_id=${dataset}`,\n                          responseType: 'json'\n                        }).then((volumesResponse) => {\n            const fullyQualifyiedVolumeList = parseAPIResponseList(volumesResponse, 'volumeId');\n            const splitPoint = project.length + dataset.length + 2;\n            const volumeList = [];\n            for (const volume of fullyQualifyiedVolumeList) {\n              volumeList.push(volume.substring(splitPoint));\n            }\n            return volumeList;\n          });\n          const description = `${this.instance.description} volume list`;\n          StatusMessage.forPromise(promise, {\n            delay: true,\n            initialMessage: `Retrieving ${description}`,\n            errorPrefix: `Error retrieving ${description}`\n          });\n          return promise;\n        });\n  }\n\n  getChangeStackList(chunkManager: ChunkManager, volumeId: string) {\n    return chunkManager.memoize.getUncounted(\n        {instance: this.instance, type: 'brainmaps:getChangeStackList', volumeId}, () => {\n          let promise: Promise<string[]|undefined> =\n              makeRequest(this.instance, this.credentialsProvider, {\n                method: 'GET',\n                path: `/v1beta2/changes/${volumeId}/change_stacks`,\n                responseType: 'json'\n              }).then(response => parseChangeStackList(response));\n          const description = `change stacks for ${volumeId}`;\n          StatusMessage.forPromise(promise, {\n            delay: true,\n            initialMessage: `Retrieving ${description}.`,\n            errorPrefix: `Error retrieving ${description}: `,\n          });\n          return promise;\n        });\n  }\n\n  volumeCompleter(url: string, chunkManager: ChunkManager) {\n    let colonCount = 0;\n    const colonIndices = [];\n    for (let lastColon = url.indexOf(':'); lastColon >= 0;\n         lastColon = url.indexOf(':', lastColon + 1)) {\n      colonIndices.push(lastColon);\n      ++colonCount;\n    }\n    switch (colonCount) {\n      case 0: {  // Fetch project names\n        return this.getProjectList(chunkManager).then((projectMetadata) => {\n          let projectList: string[] = [];\n          let descriptionMap = new Map<String, string>();\n\n          for (const projectDatum of projectMetadata) {\n            const projectColon = projectDatum.id + ':';\n            projectList.push(projectColon);\n            descriptionMap.set(projectColon, projectDatum.label);\n          }\n\n          return {\n            offset: 0,\n            completions: getPrefixMatchesWithDescriptions(\n                url, projectList, x => x, x => descriptionMap.get(x))\n          };\n        });\n      }\n\n      case 1: {  // Fetch dataset names, under the current project\n        const colonLocation = colonIndices[0];\n        const projectId = url.substring(0, colonLocation);\n        return this.getDatasetList(chunkManager, projectId).then((datasetList) => {\n          const splitPoint = colonLocation + 1;\n          const matchString = url.substring(splitPoint);\n          const possibleMatches = [];\n          for (const datasetName of datasetList) {\n            possibleMatches.push(datasetName + ':');\n          }\n          possibleMatches.sort();\n\n          return {offset: splitPoint, completions: getPrefixMatches(matchString, possibleMatches)};\n        });\n      }\n\n      case 2: {  // Fetch volume names, under the current project and dataset\n        const projectId = url.substring(0, colonIndices[0]);\n        const datasetId = url.substring(colonIndices[0] + 1, colonIndices[1]);\n        const splitPoint = colonIndices[1] + 1;\n        return this.getVolumeList(chunkManager, projectId, datasetId).then((volumeList) => {\n          const matchString = url.substring(splitPoint);\n\n          return {offset: splitPoint, completions: getPrefixMatches(matchString, volumeList)};\n        });\n      }\n\n      default: {  // Fetch changestack names, under the current volume\n        const volumeId = url.substring(0, colonIndices[2]);\n        const splitPoint = colonIndices[2] + 1;\n        const matchString = url.substring(splitPoint);\n        return this.getChangeStackList(chunkManager, volumeId).then(changeStacks => {\n          if (changeStacks === undefined) {\n            throw null;\n          }\n          return {offset: splitPoint, completions: getPrefixMatches(matchString, changeStacks)};\n        });\n      }\n    }\n  }\n}\n\nexport const productionInstance: BrainmapsInstance = {\n  description: 'Google Brain Maps',\n  serverUrl: 'https://brainmaps.googleapis.com',\n};\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Memoize} from 'neuroglancer/util/memoize';\n\nexport interface GL extends WebGL2RenderingContext {\n  memoize: Memoize<any, RefCounted>;\n  maxTextureSize: number;\n  maxTextureImageUnits: number;\n  tempTextureUnit: number;\n}\n\nexport const DEBUG_SHADERS = false;\n\nexport function initializeWebGL(canvas: HTMLCanvasElement) {\n  let options: any = {\n    'antialias': false,\n    'stencil': true,\n  };\n  if (DEBUG_SHADERS) {\n    console.log('DEBUGGING via preserveDrawingBuffer');\n    options['preserveDrawingBuffer'] = true;\n  }\n  let gl =\n      <GL>canvas.getContext('webgl2', options);\n  if (gl == null) {\n    throw new Error('WebGL not supported.');\n  }\n  gl.memoize = new Memoize<any, RefCounted>();\n  gl.maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n  gl.maxTextureImageUnits = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);\n  gl.tempTextureUnit = gl.maxTextureImageUnits - 1;\n\n  // FIXME: verify that we received a stencil buffer\n  // var contextAttributes = gl.getContextAttributes();\n  // var haveStencilBuffer = contextAttributes.stencil;\n\n  for (const extension of ['EXT_color_buffer_float']) {\n    if (!gl.getExtension(extension)) {\n      throw new Error(`${extension} extension not available`);\n    }\n  }\n\n  // Extensions to attempt to add but not fail if they are not available.\n  for (const extension of [\n           // Some versions of Firefox 67.0 seem to require this extension being added in addition\n           // to EXT_color_buffer_float, despite the note here indicating it is unnecessary:\n           // https://developer.mozilla.org/en-US/docs/Web/API/EXT_float_blend\n           //\n           // See https://github.com/google/neuroglancer/issues/140\n           'EXT_float_blend',\n  ]) {\n    gl.getExtension(extension);\n  }\n  return gl;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {FrameNumberCounter} from 'neuroglancer/chunk_manager/frontend';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\nimport {GL, initializeWebGL} from 'neuroglancer/webgl/context';\nimport ResizeObserver from 'resize-observer-polyfill';\n\nexport abstract class RenderedPanel extends RefCounted {\n  gl: GL;\n  constructor(\n      public context: DisplayContext, public element: HTMLElement,\n      public visibility: WatchableVisibilityPriority) {\n    super();\n    this.gl = context.gl;\n    context.addPanel(this);\n  }\n\n  scheduleRedraw() {\n    if (this.visible) {\n      this.context.scheduleRedraw();\n    }\n  }\n\n  abstract isReady(): boolean;\n\n  setGLViewport() {\n    let element = this.element;\n    const clientRect = element.getBoundingClientRect();\n    const canvasRect = this.context.canvasRect!;\n    const scaleX = canvasRect.width / this.context.canvas.width;\n    const scaleY = canvasRect.height / this.context.canvas.height;\n    let left = (element.clientLeft + clientRect.left - canvasRect.left) * scaleX;\n    let width = element.clientWidth;\n    let top = (clientRect.top - canvasRect.top + element.clientTop) * scaleY;\n    let height = element.clientHeight;\n    let bottom = top + height;\n    let gl = this.gl;\n    gl.enable(gl.SCISSOR_TEST);\n    let glBottom = this.context.canvas.height - bottom;\n    gl.viewport(left, glBottom, width, height);\n    gl.scissor(left, glBottom, width, height);\n  }\n\n  abstract draw(): void;\n\n  abstract translateDataPointByViewportPixels(\n      out: vec3, orig: vec3, deltaX: number, deltaY: number): vec3;\n\n  disposed() {\n    this.context.removePanel(this);\n    super.disposed();\n  }\n\n  get visible() {\n    return this.visibility.visible;\n  }\n}\n\nexport class DisplayContext extends RefCounted implements FrameNumberCounter {\n  canvas = document.createElement('canvas');\n  gl: GL;\n  updateStarted = new NullarySignal();\n  updateFinished = new NullarySignal();\n  changed = this.updateFinished;\n  panels = new Set<RenderedPanel>();\n  private updatePending: number|null = null;\n  canvasRect: ClientRect|undefined;\n\n  /**\n   * Unique number of the next frame.  Incremented once each time a frame is drawn.\n   */\n  frameNumber = 0;\n\n  private resizeObserver = new ResizeObserver(() => this.scheduleRedraw());\n\n  constructor(public container: HTMLElement) {\n    super();\n    const {canvas, resizeObserver} = this;\n    container.style.position = 'relative';\n    canvas.style.position = 'absolute';\n    canvas.style.top = '0px';\n    canvas.style.left = '0px';\n    canvas.style.width = '100%';\n    canvas.style.height = '100%';\n    canvas.style.zIndex = '0';\n    resizeObserver.observe(canvas);\n    container.appendChild(canvas);\n    this.gl = initializeWebGL(canvas);\n  }\n\n  isReady() {\n    for (const panel of this.panels) {\n      if (!panel.visible) {\n        continue;\n      }\n      if (!panel.isReady()) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Returns a child element that overlays the canvas.\n   */\n  makeCanvasOverlayElement() {\n    const element = document.createElement('div');\n    element.style.position = 'absolute';\n    element.style.top = '0px';\n    element.style.left = '0px';\n    element.style.width = '100%';\n    element.style.height = '100%';\n    element.style.zIndex = '2';\n    this.container.appendChild(element);\n    return element;\n  }\n\n  disposed() {\n    this.resizeObserver.disconnect();\n    if (this.updatePending != null) {\n      cancelAnimationFrame(this.updatePending);\n      this.updatePending = null;\n    }\n  }\n\n  addPanel(panel: RenderedPanel) {\n    this.panels.add(panel);\n    this.resizeObserver.observe(panel.element);\n    this.scheduleRedraw();\n  }\n\n  removePanel(panel: RenderedPanel) {\n    this.resizeObserver.unobserve(panel.element);\n    this.panels.delete(panel);\n    panel.dispose();\n    this.scheduleRedraw();\n  }\n\n  scheduleRedraw() {\n    if (this.updatePending === null) {\n      this.updatePending = requestAnimationFrame(this.update.bind(this));\n    }\n  }\n\n  draw() {\n    ++this.frameNumber;\n    this.updateStarted.dispatch();\n    let gl = this.gl;\n    let canvas = this.canvas;\n    canvas.width = canvas.offsetWidth;\n    canvas.height = canvas.offsetHeight;\n    this.canvasRect = canvas.getBoundingClientRect();\n    this.gl.clearColor(0.0, 0.0, 0.0, 0.0);\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    for (let panel of this.panels) {\n      let {element} = panel;\n      if (!panel.visible || element.clientWidth === 0 || element.clientHeight === 0 ||\n          element.offsetWidth === 0 || element.offsetHeight === 0) {\n        // Skip drawing if the panel has zero client area.\n        continue;\n      }\n      panel.setGLViewport();\n      panel.draw();\n    }\n\n    // Ensure the alpha buffer is set to 1.\n    gl.disable(gl.SCISSOR_TEST);\n    this.gl.clearColor(1.0, 1.0, 1.0, 1.0);\n    this.gl.colorMask(false, false, false, true);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    this.gl.colorMask(true, true, true, true);\n    this.updateFinished.dispatch();\n  }\n\n  private update() {\n    this.updatePending = null;\n    this.draw();\n  }\n}\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {vec2} from 'neuroglancer/util/geom';\n\nexport class BossSourceParameters {\n  baseUrl: string;\n  authServer: string;\n  collection: string;\n  experiment: string;\n  channel: string;\n  resolution: string;\n}\n\nexport class VolumeChunkSourceParameters extends BossSourceParameters {\n  encoding: string;\n  window: vec2|undefined;\n\n  static RPC_ID = 'boss/VolumeChunkSource';\n\n  static stringify(parameters: VolumeChunkSourceParameters) {\n    return `boss:volume:${parameters.baseUrl}/${parameters.collection}/${\n        parameters.experiment}/${parameters.channel}/${parameters.resolution}/${\n        parameters.encoding}`;\n  }\n}\n\nexport class MeshSourceParameters {\n  baseUrl: string;\n\n  static RPC_ID = 'boss/MeshChunkSource';\n\n  static stringify(parameters: MeshSourceParameters) {\n    return `boss:mesh:${parameters.baseUrl}`;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Support for The Boss (https://github.com/jhuapl-boss) web services.\n */\n\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {CredentialsManager, CredentialsProvider} from 'neuroglancer/credentials_provider';\nimport {WithCredentialsProvider} from 'neuroglancer/credentials_provider/chunk_source_frontend';\nimport {CompletionResult, DataSource} from 'neuroglancer/datasource';\nimport {BossToken, credentialsKey, fetchWithBossCredentials} from 'neuroglancer/datasource/boss/api';\nimport {MeshSourceParameters, VolumeChunkSourceParameters} from 'neuroglancer/datasource/boss/base';\nimport {MeshSource} from 'neuroglancer/mesh/frontend';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {applyCompletionOffset, getPrefixMatchesWithDescriptions} from 'neuroglancer/util/completion';\nimport {mat4, vec2, vec3} from 'neuroglancer/util/geom';\nimport {responseJson} from 'neuroglancer/util/http_request';\nimport {parseArray, parseQueryStringParameters, verify3dDimensions, verify3dScale, verifyEnumString, verifyFiniteFloat, verifyInt, verifyObject, verifyObjectAsMap, verifyObjectProperty, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\n\nclass BossVolumeChunkSource extends\n(WithParameters(WithCredentialsProvider<BossToken>()(VolumeChunkSource), VolumeChunkSourceParameters)) {}\n\nclass BossMeshSource extends\n(WithParameters(WithCredentialsProvider<BossToken>()(MeshSource), MeshSourceParameters)) {}\n\nlet serverVolumeTypes = new Map<string, VolumeType>();\nserverVolumeTypes.set('image', VolumeType.IMAGE);\nserverVolumeTypes.set('annotation', VolumeType.SEGMENTATION);\n\nconst VALID_ENCODINGS = new Set<string>(['npz', 'jpeg']);\n\nconst DEFAULT_CUBOID_SIZE = vec3.fromValues(512, 512, 16);\n\ninterface ChannelInfo {\n  channelType: string;\n  volumeType: VolumeType;\n  dataType: DataType;\n  downsampled: boolean;\n  scales: ScaleInfo[];\n  description: string;\n  key: string;\n}\n\ninterface CoordinateFrameInfo {\n  voxelSizeBaseNanometers: vec3;\n  voxelOffsetBase: vec3;\n  imageSizeBase: vec3;\n  voxelUnit: VoxelUnitType;\n}\n\nenum VoxelUnitType {\n  NANOMETERS = 0,\n  MICROMETERS = 1,\n  MILLIMETERS = 2,\n  CENTIMETERS = 3\n}\n\ninterface ScaleInfo {\n  voxelSizeNanometers: vec3;\n  imageSize: vec3;\n  key: string;\n}\n\ninterface ExperimentInfo {\n  channels: Map<string, ChannelInfo>;\n  scalingLevels: number;\n  coordFrameKey: string;\n  coordFrame?: CoordinateFrameInfo;\n  key: string;\n  collection: string;\n}\n\nfunction getVoxelUnitInNanometers(voxelUnit: VoxelUnitType): number {\n  switch (voxelUnit) {\n    case VoxelUnitType.MICROMETERS:\n      return 1.e3;\n    case VoxelUnitType.MILLIMETERS:\n      return 1.e6;\n    case VoxelUnitType.CENTIMETERS:\n      return 1.e7;\n    default:\n      return 1.0;\n  }\n}\n\n/**\n * This function adds scaling info by processing coordinate frame object and adding it to the\n * experiment.\n */\nfunction parseCoordinateFrame(coordFrame: any, experimentInfo: ExperimentInfo): ExperimentInfo {\n  verifyObject(coordFrame);\n\n  let voxelSizeBase = vec3.create(), voxelOffsetBase = vec3.create(), imageSizeBase = vec3.create();\n  voxelSizeBase[0] = verifyObjectProperty(coordFrame, 'x_voxel_size', verifyInt);\n  voxelSizeBase[1] = verifyObjectProperty(coordFrame, 'y_voxel_size', verifyInt);\n  voxelSizeBase[2] = verifyObjectProperty(coordFrame, 'z_voxel_size', verifyInt);\n\n  voxelOffsetBase[0] = verifyObjectProperty(coordFrame, 'x_start', verifyInt);\n  voxelOffsetBase[1] = verifyObjectProperty(coordFrame, 'y_start', verifyInt);\n  voxelOffsetBase[2] = verifyObjectProperty(coordFrame, 'z_start', verifyInt);\n\n  imageSizeBase[0] = verifyObjectProperty(coordFrame, 'x_stop', verifyInt);\n  imageSizeBase[1] = verifyObjectProperty(coordFrame, 'y_stop', verifyInt);\n  imageSizeBase[2] = verifyObjectProperty(coordFrame, 'z_stop', verifyInt);\n\n  let voxelUnit =\n      verifyObjectProperty(coordFrame, 'voxel_unit', x => verifyEnumString(x, VoxelUnitType));\n\n  let voxelSizeBaseNanometers: vec3 =\n      vec3.scale(vec3.create(), voxelSizeBase, getVoxelUnitInNanometers(voxelUnit));\n\n  experimentInfo.coordFrame = {voxelSizeBaseNanometers, voxelOffsetBase, imageSizeBase, voxelUnit};\n  return experimentInfo;\n}\n\nfunction getVolumeTypeFromChannelType(channelType: string) {\n  let volumeType = serverVolumeTypes.get(channelType);\n  if (volumeType === undefined) {\n    volumeType = VolumeType.UNKNOWN;\n  }\n  return volumeType;\n}\n\nfunction parseChannelInfo(obj: any): ChannelInfo {\n  verifyObject(obj);\n  let channelType = verifyObjectProperty(obj, 'type', verifyString);\n  let downsampleStatus: boolean = false;\n  let downsampleStr = verifyObjectProperty(obj, 'downsample_status', verifyString);\n  if (downsampleStr === 'DOWNSAMPLED') {\n    downsampleStatus = true;\n  }\n\n  return {\n    channelType,\n    description: verifyObjectProperty(obj, 'description', verifyString),\n    volumeType: getVolumeTypeFromChannelType(channelType),\n    dataType: verifyObjectProperty(obj, 'datatype', x => verifyEnumString(x, DataType)),\n    downsampled: downsampleStatus,\n    scales: [],\n    key: verifyObjectProperty(obj, 'name', verifyString),\n  };\n}\n\nfunction parseExperimentInfo(\n    obj: any, chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, collection: string,\n    experiment: string): Promise<ExperimentInfo> {\n  verifyObject(obj);\n\n  let channelPromiseArray = verifyObjectProperty(\n      obj, 'channels',\n      x => parseArray(\n          x,\n          ch => getChannelInfo(\n              chunkManager, hostname, credentialsProvider, experiment, collection, ch)));\n  return Promise.all(channelPromiseArray).then(channelArray => {\n    // Parse out channel information\n    let channels: Map<string, ChannelInfo> = new Map<string, ChannelInfo>();\n    channelArray.forEach(channel => {\n      channels.set(channel.key, channel);\n    });\n\n    let experimentInfo = {\n      channels: channels,\n      scalingLevels: verifyObjectProperty(obj, 'num_hierarchy_levels', verifyInt),\n      coordFrameKey: verifyObjectProperty(obj, 'coord_frame', verifyString),\n      coordFrame: undefined,\n      key: verifyObjectProperty(obj, 'name', verifyString),\n      collection: verifyObjectProperty(obj, 'collection', verifyString),\n    };\n\n    // Get and parse the coordinate frame\n    return getCoordinateFrame(chunkManager, hostname, credentialsProvider, experimentInfo);\n  });\n}\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  get dataType() {\n    if (this.channelInfo.dataType === DataType.UINT16) {\n      // 16-bit channels automatically rescaled to uint8 by The Boss\n      return DataType.UINT8;\n    }\n    return this.channelInfo.dataType;\n  }\n  get numChannels() {\n    return 1;\n  }\n  get volumeType() {\n    return this.channelInfo.volumeType;\n  }\n\n  /**\n   * The Boss experiment name\n   */\n  experiment: string;\n\n  /**\n   * The Boss channel/layer name.\n   */\n  channel: string;\n\n  /**\n   * Parameters for getting 3D meshes alongside segmentations\n   */\n  meshPath?: string = undefined;\n  meshUrl?: string = undefined;\n\n  channelInfo: ChannelInfo;\n  scales: ScaleInfo[];\n  coordinateFrame: CoordinateFrameInfo;\n\n  encoding: string;\n  window: vec2|undefined;\n\n  constructor(\n      public chunkManager: ChunkManager, public baseUrl: string,\n      public credentialsProvider: CredentialsProvider<BossToken>,\n      public experimentInfo: ExperimentInfo, channel: string|undefined,\n      public parameters: {[index: string]: any}) {\n    if (channel === undefined) {\n      const channelNames = Array.from(experimentInfo.channels.keys());\n      if (channelNames.length !== 1) {\n        throw new Error(`Experiment contains multiple channels: ${JSON.stringify(channelNames)}`);\n      }\n      channel = channelNames[0];\n    }\n    const channelInfo = experimentInfo.channels.get(channel);\n    if (channelInfo === undefined) {\n      throw new Error(\n          `Specified channel ${JSON.stringify(channel)} is not one of the supported channels ${\n              JSON.stringify(Array.from(experimentInfo.channels.keys()))}`);\n    }\n    this.channel = channel;\n    this.channelInfo = channelInfo;\n    this.scales = channelInfo.scales;\n\n    if (experimentInfo.coordFrame === undefined) {\n      throw new Error(`Specified experiment ${\n          JSON.stringify(experimentInfo.key)} does not have a valid coordinate frame`);\n    }\n    this.coordinateFrame = experimentInfo.coordFrame;\n\n    if (this.channelInfo.downsampled === false) {\n      this.scales = [channelInfo.scales[0]];\n    }\n    this.experiment = experimentInfo.key;\n\n    let window = verifyOptionalString(parameters['window']);\n    if (window !== undefined) {\n      let windowobj = vec2.create();\n      let parts = window.split(/,/);\n      if (parts.length === 2) {\n        windowobj[0] = verifyFiniteFloat(parts[0]);\n        windowobj[1] = verifyFiniteFloat(parts[1]);\n      } else if (parts.length === 1) {\n        windowobj[0] = 0.;\n        windowobj[1] = verifyFiniteFloat(parts[1]);\n      } else {\n        throw new Error(`Invalid window. Must be either one value or two comma separated values: ${\n            JSON.stringify(window)}`);\n      }\n      this.window = windowobj;\n      if (this.window[0] === this.window[1]) {\n        throw new Error(`Invalid window. First element must be different from second: ${\n            JSON.stringify(window)}.`);\n      }\n    }\n\n    let meshUrl = verifyOptionalString(parameters['meshurl']);\n    if (meshUrl !== undefined) {\n      this.meshUrl = meshUrl;\n    }\n\n    let encoding = verifyOptionalString(parameters['encoding']);\n    if (encoding === undefined) {\n      encoding = this.volumeType === VolumeType.IMAGE ? 'jpeg' : 'npz';\n    } else {\n      if (!VALID_ENCODINGS.has(encoding)) {\n        throw new Error(`Invalid encoding: ${JSON.stringify(encoding)}.`);\n      }\n    }\n    this.encoding = encoding;\n  }\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    return this.scales.map(scaleInfo => {\n      let {voxelSizeNanometers, imageSize} = scaleInfo;\n      let voxelOffset = this.coordinateFrame.voxelOffsetBase;\n      let baseVoxelOffset = vec3.create();\n      for (let i = 0; i < 3; ++i) {\n        baseVoxelOffset[i] = Math.ceil(voxelOffset[i]);\n      }\n      return VolumeChunkSpecification\n          .getDefaults({\n            numChannels: this.numChannels,\n            volumeType: this.volumeType,\n            dataType: this.dataType,\n            voxelSize: voxelSizeNanometers,\n            chunkDataSizes: [DEFAULT_CUBOID_SIZE],\n            transform: mat4.fromTranslation(\n                mat4.create(), vec3.multiply(vec3.create(), voxelOffset, voxelSizeNanometers)),\n            baseVoxelOffset,\n            upperVoxelBound: imageSize,\n            volumeSourceOptions,\n          })\n          .map(spec => this.chunkManager.getChunkSource(BossVolumeChunkSource, {\n            credentialsProvider: this.credentialsProvider,\n            spec,\n            parameters: {\n              baseUrl: this.baseUrl,\n              collection: this.experimentInfo.collection,\n              experiment: this.experimentInfo.key,\n              channel: this.channel,\n              resolution: scaleInfo.key,\n              encoding: this.encoding,\n              window: this.window,\n            }\n          }));\n    });\n  }\n\n  getMeshSource() {\n    if (this.meshUrl !== undefined) {\n      return this.chunkManager.getChunkSource(\n          BossMeshSource,\n          {credentialsProvider: this.credentialsProvider, parameters: {baseUrl: this.meshUrl}});\n    }\n    return null;\n  }\n}\n\nconst pathPattern = /^([^\\/?]+)\\/([^\\/?]+)(?:\\/([^\\/?]+))?(?:\\?(.*))?$/;\n\nexport function getExperimentInfo(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, experiment: string,\n    collection: string): Promise<ExperimentInfo> {\n  return chunkManager.memoize.getUncounted(\n      {\n        hostname: hostname,\n        collection: collection,\n        experiment: experiment,\n        type: 'boss:getExperimentInfo'\n      },\n      () =>\n          fetchWithBossCredentials(\n              credentialsProvider,\n              `${hostname}/latest/collection/${collection}/experiment/${experiment}/`, {},\n              responseJson)\n              .then(\n                  value => parseExperimentInfo(\n                      value, chunkManager, hostname, credentialsProvider, collection, experiment)));\n}\n\nexport function getChannelInfo(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, experiment: string, collection: string,\n    channel: string): Promise<ChannelInfo> {\n  return chunkManager.memoize.getUncounted(\n      {\n        hostname: hostname,\n        collection: collection,\n        experiment: experiment,\n        channel: channel,\n        type: 'boss:getChannelInfo'\n      },\n      () => fetchWithBossCredentials(\n                credentialsProvider,\n                `${hostname}/latest/collection/${collection}/experiment/${experiment}/channel/${\n                    channel}/`,\n                {}, responseJson)\n                .then(parseChannelInfo));\n}\n\nexport function getDownsampleInfoForChannel(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, collection: string,\n    experimentInfo: ExperimentInfo, channel: string): Promise<ExperimentInfo> {\n  return chunkManager.memoize\n      .getUncounted(\n          {\n            hostname: hostname,\n            collection: collection,\n            experiment: experimentInfo.key,\n            channel: channel,\n            downsample: true,\n            type: 'boss:getDownsampleInfoForChannel'\n          },\n          () => fetchWithBossCredentials(\n              credentialsProvider,\n              `${hostname}/latest/downsample/${collection}/${experimentInfo.key}/${channel}/`, {},\n              responseJson))\n      .then(downsampleObj => {\n        return parseDownsampleInfoForChannel(downsampleObj, experimentInfo, channel);\n      });\n}\n\nexport function parseDownsampleScales(downsampleObj: any, voxelUnit: VoxelUnitType): ScaleInfo[] {\n  verifyObject(downsampleObj);\n\n  let voxelSizes =\n      verifyObjectProperty(downsampleObj, 'voxel_size', x => verifyObjectAsMap(x, verify3dScale));\n\n  let imageSizes =\n      verifyObjectProperty(downsampleObj, 'extent', x => verifyObjectAsMap(x, verify3dDimensions));\n\n  let num_hierarchy_levels = verifyObjectProperty(downsampleObj, 'num_hierarchy_levels', verifyInt);\n\n  let scaleInfo = new Array<ScaleInfo>();\n  for (let i = 0; i < num_hierarchy_levels; i++) {\n    let key: string = String(i);\n    const voxelSize = voxelSizes.get(key);\n    const imageSize = imageSizes.get(key);\n    if (voxelSize === undefined || imageSize === undefined) {\n      throw new Error(`Missing voxel_size/extent for resolution ${key}.`);\n    }\n    let voxelSizeNanometers =\n        vec3.scale(vec3.create(), voxelSize, getVoxelUnitInNanometers(voxelUnit));\n    scaleInfo[i] = {voxelSizeNanometers, imageSize, key};\n  }\n  return scaleInfo;\n}\n\nexport function parseDownsampleInfoForChannel(\n    downsampleObj: any, experimentInfo: ExperimentInfo, channel: string): ExperimentInfo {\n  let coordFrame = experimentInfo.coordFrame;\n  if (coordFrame === undefined) {\n    throw new Error(`Missing coordinate frame information for experiment ${\n        experimentInfo\n            .key}. A valid coordinate frame is required to retrieve downsampling information.`);\n  }\n  let channelInfo = experimentInfo.channels.get(channel);\n  if (channelInfo === undefined) {\n    throw new Error(\n        `Specified channel ${JSON.stringify(channel)} is not one of the supported channels ${\n            JSON.stringify(Array.from(experimentInfo.channels.keys()))}`);\n  }\n  channelInfo.scales = parseDownsampleScales(downsampleObj, coordFrame.voxelUnit);\n  experimentInfo.channels.set(channel, channelInfo);\n  return experimentInfo;\n}\n\nexport function getVolume(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, path: string) {\n  const match = path.match(pathPattern);\n  if (match === null) {\n    throw new Error(`Invalid volume path ${JSON.stringify(path)}`);\n  }\n  const collection = match[1];\n  const experiment = match[2];\n  const channel = match[3];\n  const parameters = parseQueryStringParameters(match[4] || '');\n  // Warning: If additional arguments are added, the cache key should be updated as well.\n  return chunkManager.memoize.getUncounted(\n      {hostname: hostname, path: path, type: 'boss:getVolume'},\n      () => getExperimentInfo(chunkManager, hostname, credentialsProvider, experiment, collection)\n                .then(experimentInfo => {\n                  return getDownsampleInfoForChannel(\n                             chunkManager, hostname, credentialsProvider, collection,\n                             experimentInfo, channel)\n                      .then(\n                          experimentInfoWithDownsample => new MultiscaleVolumeChunkSource(\n                              chunkManager, hostname, credentialsProvider,\n                              experimentInfoWithDownsample, channel, parameters));\n                }));\n}\n\nconst urlPattern = /^((?:http|https):\\/\\/[^\\/?]+)\\/(.*)$/;\n\nexport function getCollections(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>) {\n  return chunkManager.memoize.getUncounted(\n      {hostname: hostname, type: 'boss:getCollections'},\n      () => fetchWithBossCredentials(\n                credentialsProvider, `${hostname}/latest/collection/`, {}, responseJson)\n                .then(\n                    value => verifyObjectProperty(\n                        value, 'collections', x => parseArray(x, verifyString))));\n}\n\nexport function getExperiments(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, collection: string) {\n  return chunkManager.memoize.getUncounted(\n      {hostname: hostname, collection: collection, type: 'boss:getExperiments'},\n      () => fetchWithBossCredentials(\n                credentialsProvider, `${hostname}/latest/collection/${collection}/experiment/`, {},\n                responseJson)\n                .then(\n                    value => verifyObjectProperty(\n                        value, 'experiments', x => parseArray(x, verifyString))));\n}\n\nexport function getCoordinateFrame(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>,\n    experimentInfo: ExperimentInfo): Promise<ExperimentInfo> {\n  let key = experimentInfo.coordFrameKey;\n  return chunkManager.memoize.getUncounted(\n      {\n        hostname: hostname,\n        coordinateframe: key,\n        experimentInfo: experimentInfo,\n        type: 'boss:getCoordinateFrame'\n      },\n      () =>\n          fetchWithBossCredentials(\n              credentialsProvider, `${hostname}/latest/coord/${key}/`, {}, responseJson)\n              .then(\n                  coordinateFrameObj => parseCoordinateFrame(coordinateFrameObj, experimentInfo)));\n}\n\nexport function collectionExperimentChannelCompleter(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, path: string): Promise<CompletionResult> {\n  let channelMatch = path.match(/^(?:([^\\/]+)(?:\\/?([^\\/]*)(?:\\/?([^\\/]*)(?:\\/?([^\\/]*)?))?)?)?$/);\n  if (channelMatch === null) {\n    // URL has incorrect format, don't return any results.\n    return Promise.reject<CompletionResult>(null);\n  }\n  if (channelMatch[1] === undefined) {\n    // No collection. Reject.\n    return Promise.reject<CompletionResult>(null);\n  }\n  if (channelMatch[2] === undefined) {\n    let collectionPrefix = channelMatch[1] || '';\n    // Try to complete the collection.\n    return getCollections(chunkManager, hostname, credentialsProvider).then(collections => {\n      return {\n        offset: 0,\n        completions: getPrefixMatchesWithDescriptions(\n            collectionPrefix, collections, x => x + '/', () => undefined)\n      };\n    });\n  }\n  if (channelMatch[3] === undefined) {\n    let experimentPrefix = channelMatch[2] || '';\n    return getExperiments(chunkManager, hostname, credentialsProvider, channelMatch[1])\n        .then(experiments => {\n          return {\n            offset: channelMatch![1].length + 1,\n            completions: getPrefixMatchesWithDescriptions(\n                experimentPrefix, experiments, y => y + '/', () => undefined)\n          };\n        });\n  }\n  return getExperimentInfo(\n             chunkManager, hostname, credentialsProvider, channelMatch[2], channelMatch[1])\n      .then(experimentInfo => {\n        let completions = getPrefixMatchesWithDescriptions(\n            channelMatch![3], experimentInfo.channels, x => x[0], x => {\n              return `${x[1].channelType} (${DataType[x[1].dataType]})`;\n            });\n        return {offset: channelMatch![1].length + channelMatch![2].length + 2, completions};\n      });\n}\n\nfunction getAuthServer(endpoint: string): string {\n  let baseHostName = endpoint.match(/^(?:https:\\/\\/[^.]+([^\\/]+))/);\n  if (baseHostName === null) {\n    throw new Error(`Unable to construct auth server hostname from base hostname ${endpoint}.`);\n  }\n  let authServer = `https://auth${baseHostName[1]}/auth`;\n  return authServer;\n}\n\nexport class BossDataSource extends DataSource {\n  constructor(public credentialsManager: CredentialsManager) {\n    super();\n  }\n\n  get description() {\n    return 'The Boss';\n  }\n\n  getCredentialsProvider(path: string) {\n    let authServer = getAuthServer(path);\n    return this.credentialsManager.getCredentialsProvider<BossToken>(credentialsKey, authServer);\n  }\n\n  getVolume(chunkManager: ChunkManager, path: string) {\n    let match = path.match(urlPattern);\n    if (match === null) {\n      throw new Error(`Invalid boss volume path: ${JSON.stringify(path)}`);\n    }\n    let credentialsProvider = this.getCredentialsProvider(path);\n\n    return getVolume(chunkManager, match[1], credentialsProvider, match[2]);\n  }\n\n  volumeCompleter(url: string, chunkManager: ChunkManager) {\n    let match = url.match(urlPattern);\n    if (match === null) {\n      // We don't yet have a full hostname.\n      return Promise.reject<CompletionResult>(null);\n    }\n    let hostname = match[1];\n    let credentialsProvider = this.getCredentialsProvider(match[1]);\n    let path = match[2];\n    return collectionExperimentChannelCompleter(chunkManager, hostname, credentialsProvider, path)\n        .then(completions => applyCompletionOffset(match![1].length + 1, completions));\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum VolumeChunkEncoding {\n  JPEG,\n  RAW,\n  COMPRESSED_SEGMENTATION,\n  COMPRESSED_SEGMENTATIONARRAY\n}\n\nexport class DVIDSourceParameters {\n  baseUrl: string;\n  nodeKey: string;\n  dataInstanceKey: string;\n}\n\nexport class VolumeChunkSourceParameters extends DVIDSourceParameters {\n  dataScale: string;\n  encoding: VolumeChunkEncoding;\n  static RPC_ID = 'dvid/VolumeChunkSource';\n}\n\nexport class SkeletonSourceParameters extends DVIDSourceParameters {\n  static RPC_ID = 'dvid/SkeletonSource';\n}\n\nexport class MeshSourceParameters extends DVIDSourceParameters {\n  static RPC_ID = 'dvid/MeshSource';\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Support for DVID (https://github.com/janelia-flyem/dvid) servers.\n */\n\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {CompletionResult, DataSource} from 'neuroglancer/datasource';\nimport {DVIDSourceParameters, MeshSourceParameters, SkeletonSourceParameters, VolumeChunkEncoding, VolumeChunkSourceParameters} from 'neuroglancer/datasource/dvid/base';\nimport {MeshSource} from 'neuroglancer/mesh/frontend';\nimport {SkeletonSource} from 'neuroglancer/skeleton/frontend';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {applyCompletionOffset, getPrefixMatchesWithDescriptions} from 'neuroglancer/util/completion';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {fetchOk} from 'neuroglancer/util/http_request';\nimport {parseArray, parseFixedLengthArray, parseIntVec, verifyFinitePositiveFloat, verifyMapKey, verifyObject, verifyObjectAsMap, verifyObjectProperty, verifyPositiveInt, verifyString} from 'neuroglancer/util/json';\n\nlet serverDataTypes = new Map<string, DataType>();\nserverDataTypes.set('uint8', DataType.UINT8);\nserverDataTypes.set('uint32', DataType.UINT32);\nserverDataTypes.set('uint64', DataType.UINT64);\n\nexport class DataInstanceBaseInfo {\n  get typeName(): string {\n    return this.obj['TypeName'];\n  }\n\n  get compressionName(): string {\n    return this.obj['Compression'];\n  }\n\n  constructor(public obj: any) {\n    verifyObject(obj);\n    verifyObjectProperty(obj, 'TypeName', verifyString);\n  }\n}\n\nexport class DataInstanceInfo {\n  constructor(public obj: any, public name: string, public base: DataInstanceBaseInfo) {}\n}\n\nclass DVIDVolumeChunkSource extends\n(WithParameters(VolumeChunkSource, VolumeChunkSourceParameters)) {}\n\nclass DVIDSkeletonSource extends\n(WithParameters(SkeletonSource, SkeletonSourceParameters)) {}\n\nclass DVIDMeshSource extends\n(WithParameters(MeshSource, MeshSourceParameters)) {}\n\nexport class VolumeDataInstanceInfo extends DataInstanceInfo {\n  dataType: DataType;\n  lowerVoxelBound: vec3;\n  upperVoxelBound: vec3;\n  voxelSize: vec3;\n  numChannels: number;\n  numLevels: number;\n  meshSrc: string;\n  skeletonSrc: string;\n\n  constructor(\n      obj: any, name: string, base: DataInstanceBaseInfo, public encoding: VolumeChunkEncoding,\n      instanceNames: Array<string>) {\n    super(obj, name, base);\n    let extended = verifyObjectProperty(obj, 'Extended', verifyObject);\n    let extendedValues = verifyObjectProperty(extended, 'Values', x => parseArray(x, verifyObject));\n    if (extendedValues.length < 1) {\n      throw new Error(\n          'Expected Extended.Values property to have length >= 1, but received: ${JSON.stringify(extendedValues)}.');\n    }\n    this.numLevels = 1;\n\n    let instSet = new Set<string>(instanceNames);\n    if (encoding === VolumeChunkEncoding.COMPRESSED_SEGMENTATIONARRAY) {\n      // retrieve maximum downres level\n      let maxdownreslevel = verifyObjectProperty(extended, 'MaxDownresLevel', verifyPositiveInt);\n      this.numLevels = maxdownreslevel + 1;\n    } else {\n      // labelblk does not have explicit datatype support for multiscale but\n      // by convention different levels are specified with unique\n      // instances where levels are distinguished by the suffix '_LEVELNUM'\n      while (instSet.has(name + '_' + this.numLevels.toString())) {\n        this.numLevels += 1;\n      }\n    }\n\n    // only allow mesh or skeletons as sources but not both\n    this.meshSrc = '';\n    if (instSet.has(name + '_meshes')) {\n      this.meshSrc = name + '_meshes';\n    }\n\n    this.skeletonSrc = '';\n    if (this.meshSrc !== '') {\n      if (instSet.has(name + '_skeletons')) {\n        this.skeletonSrc = name + '_skeletons';\n      }\n    }\n\n\n    this.dataType =\n        verifyObjectProperty(extendedValues[0], 'DataType', x => verifyMapKey(x, serverDataTypes));\n    this.voxelSize = verifyObjectProperty(\n        extended, 'VoxelSize',\n        x => parseFixedLengthArray(vec3.create(), x, verifyFinitePositiveFloat));\n    this.numChannels = 1;\n  }\n\n  get volumeType() {\n    return (\n        (this.encoding === VolumeChunkEncoding.COMPRESSED_SEGMENTATION ||\n         this.encoding === VolumeChunkEncoding.COMPRESSED_SEGMENTATIONARRAY) ?\n            VolumeType.SEGMENTATION :\n            VolumeType.IMAGE);\n  }\n\n  getSources(\n      chunkManager: ChunkManager, parameters: DVIDSourceParameters,\n      volumeSourceOptions: VolumeSourceOptions) {\n    let {encoding} = this;\n    let sources: VolumeChunkSource[][] = [];\n\n    // must be 64 block size to work with neuroglancer properly\n    let blocksize = 64;\n    for (let level = 0; level < this.numLevels; ++level) {\n      let voxelSize = vec3.scale(vec3.create(), this.voxelSize, Math.pow(2, level));\n      let lowerVoxelBound = vec3.create();\n      let upperVoxelBound = vec3.create();\n      for (let i = 0; i < 3; ++i) {\n        let lowerVoxelNotAligned =\n            Math.floor(this.lowerVoxelBound[i] * (this.voxelSize[i] / voxelSize[i]));\n        // adjust min to be a multiple of blocksize\n        lowerVoxelBound[i] = lowerVoxelNotAligned - (lowerVoxelNotAligned % blocksize);\n        let upperVoxelNotAligned =\n            Math.ceil((this.upperVoxelBound[i] + 1) * (this.voxelSize[i] / voxelSize[i]));\n        upperVoxelBound[i] = upperVoxelNotAligned;\n        // adjust max to be a multiple of blocksize\n        if ((upperVoxelNotAligned % blocksize) !== 0) {\n          upperVoxelBound[i] += (blocksize - (upperVoxelNotAligned % blocksize));\n        }\n      }\n      let dataInstanceKey = parameters.dataInstanceKey;\n\n      if (encoding !== VolumeChunkEncoding.COMPRESSED_SEGMENTATIONARRAY) {\n        if (level > 0) {\n          dataInstanceKey += '_' + level.toString();\n        }\n      }\n\n      let volParameters: VolumeChunkSourceParameters = {\n        'baseUrl': parameters.baseUrl,\n        'nodeKey': parameters.nodeKey,\n        'dataInstanceKey': dataInstanceKey,\n        'dataScale': level.toString(),\n        'encoding': encoding,\n      };\n      let alternatives =\n          VolumeChunkSpecification\n              .getDefaults({\n                voxelSize: voxelSize,\n                dataType: this.dataType,\n                numChannels: this.numChannels,\n                transform: mat4.fromTranslation(\n                    mat4.create(), vec3.multiply(vec3.create(), lowerVoxelBound, voxelSize)),\n                baseVoxelOffset: lowerVoxelBound,\n                upperVoxelBound: vec3.subtract(vec3.create(), upperVoxelBound, lowerVoxelBound),\n                volumeType: this.volumeType,\n                volumeSourceOptions,\n                compressedSegmentationBlockSize:\n                    ((encoding === VolumeChunkEncoding.COMPRESSED_SEGMENTATION ||\n                      encoding === VolumeChunkEncoding.COMPRESSED_SEGMENTATIONARRAY) ?\n                         vec3.fromValues(8, 8, 8) :\n                         undefined)\n              })\n              .map(spec => {\n                return chunkManager.getChunkSource(\n                    DVIDVolumeChunkSource, {spec, parameters: volParameters});\n              });\n      sources.push(alternatives);\n    }\n    return sources;\n  }\n\n  getMeshSource(chunkManager: ChunkManager, parameters: DVIDSourceParameters) {\n    if (this.meshSrc !== '') {\n      return chunkManager.getChunkSource(DVIDMeshSource, {\n        parameters: {\n          'baseUrl': parameters.baseUrl,\n          'nodeKey': parameters.nodeKey,\n          'dataInstanceKey': this.meshSrc,\n        }\n      });\n    } else {\n      return null;\n    }\n  }\n\n  getSkeletonSource(chunkManager: ChunkManager, parameters: DVIDSourceParameters) {\n    if (this.skeletonSrc !== '') {\n      return chunkManager.getChunkSource(DVIDSkeletonSource, {\n        parameters: {\n          'baseUrl': parameters.baseUrl,\n          'nodeKey': parameters.nodeKey,\n          'dataInstanceKey': this.skeletonSrc,\n        }\n      });\n    } else {\n      return null;\n    }\n  }\n}\n\nexport function parseDataInstance(\n    obj: any, name: string, instanceNames: Array<string>): DataInstanceInfo {\n  verifyObject(obj);\n  let baseInfo = verifyObjectProperty(obj, 'Base', x => new DataInstanceBaseInfo(x));\n  switch (baseInfo.typeName) {\n    case 'uint8blk':\n    case 'grayscale8':\n      let isjpegcompress = baseInfo.compressionName.indexOf('jpeg') !== -1;\n      return new VolumeDataInstanceInfo(\n          obj, name, baseInfo,\n          (isjpegcompress ? VolumeChunkEncoding.JPEG : VolumeChunkEncoding.RAW), instanceNames);\n    case 'labels64':\n    case 'labelblk':\n      return new VolumeDataInstanceInfo(\n          obj, name, baseInfo, VolumeChunkEncoding.COMPRESSED_SEGMENTATION, instanceNames);\n    case 'labelarray':\n    case 'labelmap':\n      return new VolumeDataInstanceInfo(\n          obj, name, baseInfo, VolumeChunkEncoding.COMPRESSED_SEGMENTATIONARRAY, instanceNames);\n    default:\n      throw new Error(`DVID data type ${JSON.stringify(baseInfo.typeName)} is not supported.`);\n  }\n}\n\nexport class RepositoryInfo {\n  alias: string;\n  description: string;\n  errors: string[] = [];\n  dataInstances = new Map<string, DataInstanceInfo>();\n  uuid: string;\n  vnodes = new Set<string>();\n  constructor(obj: any) {\n    if (obj instanceof RepositoryInfo) {\n      this.alias = obj.alias;\n      this.description = obj.description;\n      // just copy references\n      this.errors = obj.errors;\n      this.dataInstances = obj.dataInstances;\n      return;\n    }\n    verifyObject(obj);\n    this.alias = verifyObjectProperty(obj, 'Alias', verifyString);\n    this.description = verifyObjectProperty(obj, 'Description', verifyString);\n    let dataInstanceObjs = verifyObjectProperty(obj, 'DataInstances', verifyObject);\n    let instanceKeys = Object.keys(dataInstanceObjs);\n    for (let key of instanceKeys) {\n      try {\n        this.dataInstances.set(key, parseDataInstance(dataInstanceObjs[key], key, instanceKeys));\n      } catch (parseError) {\n        let message = `Failed to parse data instance ${JSON.stringify(key)}: ${parseError.message}`;\n        console.log(message);\n        this.errors.push(message);\n      }\n    }\n\n    let dagObj = verifyObjectProperty(obj, 'DAG', verifyObject);\n    let nodeObjs = verifyObjectProperty(dagObj, 'Nodes', verifyObject);\n    for (let key of Object.keys(nodeObjs)) {\n      this.vnodes.add(key);\n    }\n  }\n}\n\nexport function parseRepositoriesInfo(obj: any) {\n  try {\n    let result = verifyObjectAsMap(obj, x => new RepositoryInfo(x));\n\n    // make all versions available for viewing\n    let allVersions = new Map<string, RepositoryInfo>();\n    for (let [key, info] of result) {\n      allVersions.set(key, info);\n      for (let key2 of info.vnodes) {\n        if (key2 !== key) {\n          // create new repo\n          let rep = new RepositoryInfo(info);\n          allVersions.set(key2, rep);\n        }\n      }\n    }\n\n    for (let [key, info] of allVersions) {\n      info.uuid = key;\n    }\n    return allVersions;\n  } catch (parseError) {\n    throw new Error(`Failed to parse DVID repositories info: ${parseError.message}`);\n  }\n}\n\nexport class ServerInfo {\n  repositories: Map<string, RepositoryInfo>;\n  constructor(obj: any) {\n    this.repositories = parseRepositoriesInfo(obj);\n  }\n\n  getNode(nodeKey: string): RepositoryInfo {\n    // FIXME: Support non-root nodes.\n    let matches: string[] = [];\n    for (let key of this.repositories.keys()) {\n      if (key.startsWith(nodeKey)) {\n        matches.push(key);\n      }\n    }\n    if (matches.length !== 1) {\n      throw new Error(\n          `Node key ${JSON.stringify(nodeKey)} matches ${JSON.stringify(matches)} nodes.`);\n    }\n    return this.repositories.get(matches[0])!;\n  }\n}\n\nexport function getServerInfo(chunkManager: ChunkManager, baseUrl: string) {\n  return chunkManager.memoize.getUncounted({type: 'dvid:getServerInfo', baseUrl}, () => {\n    const result = fetchOk(`${baseUrl}/api/repos/info`)\n                       .then(response => response.json())\n                       .then(response => new ServerInfo(response));\n    const description = `repository info for DVID server ${baseUrl}`;\n    StatusMessage.forPromise(result, {\n      initialMessage: `Retrieving ${description}.`,\n      delay: true,\n      errorPrefix: `Error retrieving ${description}: `,\n    });\n    return result;\n  });\n}\n\n/**\n * Get extra dataInstance info that isn't available on the server level.\n * this requires an extra api call\n */\nexport function getDataInstanceDetails(\n    chunkManager: ChunkManager, baseUrl: string, nodeKey: string, info: VolumeDataInstanceInfo) {\n  return chunkManager.memoize.getUncounted(\n      {type: 'dvid:getInstanceDetails', baseUrl, nodeKey, name: info.name}, () => {\n        let result = fetchOk(`${baseUrl}/api/node/${nodeKey}/${info.name}/info`)\n                         .then(response => response.json());\n        const description = `datainstance info for node ${nodeKey} and instance ${info.name} ` +\n            `on DVID server ${baseUrl}`;\n\n        StatusMessage.forPromise(result, {\n          initialMessage: `Retrieving ${description}.`,\n          delay: true,\n          errorPrefix: `Error retrieving ${description}: `,\n        });\n\n        return result.then(instanceDetails => {\n          let extended = verifyObjectProperty(instanceDetails, 'Extended', verifyObject);\n          info.lowerVoxelBound =\n              verifyObjectProperty(extended, 'MinPoint', x => parseIntVec(vec3.create(), x));\n          info.upperVoxelBound =\n              verifyObjectProperty(extended, 'MaxPoint', x => parseIntVec(vec3.create(), x));\n          return info;\n        });\n      });\n}\n\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  get dataType() {\n    return this.info.dataType;\n  }\n  get numChannels() {\n    return this.info.numChannels;\n  }\n  get volumeType() {\n    return this.info.volumeType;\n  }\n\n  constructor(\n      public chunkManager: ChunkManager, public baseUrl: string, public nodeKey: string,\n      public dataInstanceKey: string, public info: VolumeDataInstanceInfo) {}\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    return this.info.getSources(\n        this.chunkManager, {\n          'baseUrl': this.baseUrl,\n          'nodeKey': this.nodeKey,\n          'dataInstanceKey': this.dataInstanceKey,\n        },\n        volumeSourceOptions);\n  }\n\n  getMeshSource() {\n    let meshSource = this.info.getMeshSource(this.chunkManager, {\n      'baseUrl': this.baseUrl,\n      'nodeKey': this.nodeKey,\n      'dataInstanceKey': this.dataInstanceKey,\n    });\n    if (meshSource === null) {\n      return this.info.getSkeletonSource(this.chunkManager, {\n        'baseUrl': this.baseUrl,\n        'nodeKey': this.nodeKey,\n        'dataInstanceKey': this.dataInstanceKey,\n      });\n    }\n    return meshSource;\n  }\n}\n\nconst urlPattern = /^((?:http|https):\\/\\/[^\\/]+)\\/([^\\/]+)\\/([^\\/]+)$/;\n\nexport function getVolume(chunkManager: ChunkManager, url: string) {\n  let match = url.match(urlPattern);\n  if (match === null) {\n    throw new Error(`Invalid DVID URL: ${JSON.stringify(url)}.`);\n  }\n  const baseUrl = match[1];\n  const nodeKey = match[2];\n  const dataInstanceKey = match[3];\n  return getServerInfo(chunkManager, baseUrl)\n      .then(serverInfo => {\n        let repositoryInfo = serverInfo.getNode(nodeKey);\n        if (repositoryInfo === undefined) {\n          throw new Error(`Invalid node: ${JSON.stringify(nodeKey)}.`);\n        }\n        const dataInstanceInfo = repositoryInfo.dataInstances.get(dataInstanceKey);\n        if (!(dataInstanceInfo instanceof VolumeDataInstanceInfo)) {\n          throw new Error(`Invalid data instance ${dataInstanceKey}.`);\n        }\n        return getDataInstanceDetails(chunkManager, baseUrl, nodeKey, dataInstanceInfo);\n      })\n      .then((info: VolumeDataInstanceInfo) => {\n        return chunkManager.memoize.getUncounted(\n            {\n              type: 'dvid:MultiscaleVolumeChunkSource',\n              baseUrl,\n              nodeKey: nodeKey,\n              dataInstanceKey,\n            },\n            () => new MultiscaleVolumeChunkSource(\n                chunkManager, baseUrl, nodeKey, dataInstanceKey, info));\n      });\n}\n\nexport function completeInstanceName(\n    repositoryInfo: RepositoryInfo, prefix: string): CompletionResult {\n  return {\n    offset: 0,\n    completions: getPrefixMatchesWithDescriptions<DataInstanceInfo>(\n        prefix, repositoryInfo.dataInstances.values(), instance => instance.name,\n        instance => {\n          return `${instance.base.typeName}`;\n        })\n  };\n}\n\nexport function completeNodeAndInstance(serverInfo: ServerInfo, prefix: string): CompletionResult {\n  let match = prefix.match(/^(?:([^\\/]+)(?:\\/([^\\/]*))?)?$/);\n  if (match === null) {\n    throw new Error(`Invalid DVID URL syntax.`);\n  }\n  if (match[2] === undefined) {\n    // Try to complete the node name.\n    return {\n      offset: 0,\n      completions: getPrefixMatchesWithDescriptions<RepositoryInfo>(\n          prefix, serverInfo.repositories.values(), repository => repository.uuid + '/',\n          repository => `${repository.alias}: ${repository.description}`)\n    };\n  }\n  let nodeKey = match[1];\n  let repositoryInfo = serverInfo.getNode(nodeKey);\n  return applyCompletionOffset(nodeKey.length + 1, completeInstanceName(repositoryInfo, match[2]));\n}\n\nexport function volumeCompleter(\n    url: string, chunkManager: ChunkManager): Promise<CompletionResult> {\n  const curUrlPattern = /^((?:http|https):\\/\\/[^\\/]+)\\/(.*)$/;\n  let match = url.match(curUrlPattern);\n  if (match === null) {\n    // We don't yet have a full hostname.\n    return Promise.reject<CompletionResult>(null);\n  }\n  let baseUrl = match[1];\n  let path = match[2];\n  return getServerInfo(chunkManager, baseUrl)\n      .then(\n          serverInfo =>\n              applyCompletionOffset(baseUrl.length + 1, completeNodeAndInstance(serverInfo, path)));\n}\n\nexport class DVIDDataSource extends DataSource {\n  get description() {\n    return 'DVID';\n  }\n\n  getVolume(chunkManager: ChunkManager, url: string) {\n    return getVolume(chunkManager, url);\n  }\n\n  volumeCompleter(url: string, chunkManager: ChunkManager) {\n    return volumeCompleter(url, chunkManager);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class RenderBaseSourceParameters {\n  baseUrl: string;\n  owner: string;\n  project: string;\n  stack: string;\n  channel: string|undefined;\n}\n\nexport class RenderSourceParameters extends RenderBaseSourceParameters {\n  minIntensity: number|undefined;\n  maxIntensity: number|undefined;\n  maxTileSpecsToRender: number|undefined;\n  filter: boolean|undefined;\n}\n\nexport class TileChunkSourceParameters extends RenderSourceParameters {\n  dims: string;\n  level: number;\n  encoding: string;\n\n  static RPC_ID = 'render/TileChunkSource';\n}\n\nexport class PointMatchChunkSourceParameters extends RenderSourceParameters {\n  matchCollection: string;\n  zoffset: number;\n\n  static RPC_ID = 'render/PointMatchSource';\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Support for Render (https://github.com/saalfeldlab/render) servers.\n */\n\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {CompletionResult, DataSource} from 'neuroglancer/datasource';\nimport {PointMatchChunkSourceParameters, TileChunkSourceParameters} from 'neuroglancer/datasource/render/base';\nimport {VectorGraphicsChunkSpecification, VectorGraphicsSourceOptions} from 'neuroglancer/sliceview/vector_graphics/base';\nimport {MultiscaleVectorGraphicsChunkSource as GenericMultiscaleVectorGraphicsChunkSource, VectorGraphicsChunkSource} from 'neuroglancer/sliceview/vector_graphics/frontend';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {applyCompletionOffset, getPrefixMatchesWithDescriptions} from 'neuroglancer/util/completion';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {fetchOk} from 'neuroglancer/util/http_request';\nimport {parseArray, parseQueryStringParameters, verifyFloat, verifyObject, verifyObjectProperty, verifyOptionalBoolean, verifyOptionalInt, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\n\nconst VALID_ENCODINGS = new Set<string>(['jpg']);\n\nconst TileChunkSourceBase = WithParameters(VolumeChunkSource, TileChunkSourceParameters);\nclass TileChunkSource extends TileChunkSourceBase {}\nconst PointMatchSourceBase =\n    WithParameters(VectorGraphicsChunkSource, PointMatchChunkSourceParameters);\nclass PointMatchSource extends PointMatchSourceBase {}\n\nconst VALID_STACK_STATES = new Set<string>(['COMPLETE', 'READ_ONLY']);\nconst PARTIAL_STACK_STATES = new Set<string>(['LOADING']);\n\ninterface OwnerInfo {\n  owner: string;\n  projects: Map<string, ProjectInfo>;\n}\n\ninterface ProjectInfo {\n  stacks: Map<string, StackInfo>;\n}\n\ninterface StackInfo {\n  lowerVoxelBound: vec3;\n  upperVoxelBound: vec3;\n  voxelResolution: vec3; /* in nm */\n  project: string;\n  channels: string[];\n}\n\nfunction parseOwnerInfo(obj: any): OwnerInfo {\n  let stackObjs = parseArray(obj, verifyObject);\n\n  if (stackObjs.length < 1) {\n    throw new Error(`No stacks found for owner object.`);\n  }\n\n  let projects = new Map<string, ProjectInfo>();\n  // Get the owner from the first stack\n  let owner = verifyObjectProperty(stackObjs[0], 'stackId', parseStackOwner);\n\n  for (let stackObj of stackObjs) {\n    let stackName = verifyObjectProperty(stackObj, 'stackId', parseStackName);\n    let stackInfo = parseStackInfo(stackObj);\n\n    if (stackInfo !== undefined) {\n      let projectName = stackInfo.project;\n      let projectInfo = projects.get(projectName);\n\n      if (projectInfo === undefined) {\n        let stacks = new Map<string, StackInfo>();\n        projects.set(projectName, {stacks});\n        projectInfo = projects.get(projectName);\n      }\n\n      projectInfo!.stacks.set(stackName, stackInfo);\n    }\n  }\n\n  return {owner, projects};\n}\n\nfunction parseStackName(stackIdObj: any): string {\n  verifyObject(stackIdObj);\n  return verifyObjectProperty(stackIdObj, 'stack', verifyString);\n}\n\nfunction parseStackOwner(stackIdObj: any): string {\n  verifyObject(stackIdObj);\n  return verifyObjectProperty(stackIdObj, 'owner', verifyString);\n}\n\nfunction parseStackInfo(obj: any): StackInfo|undefined {\n  verifyObject(obj);\n\n  let state = verifyObjectProperty(obj, 'state', verifyString);\n\n  let channels: string[] = [];\n  let lowerVoxelBound: vec3 = vec3.create();\n  let upperVoxelBound: vec3 = vec3.create();\n\n  if (VALID_STACK_STATES.has(state)) {\n    let stackStatsObj = verifyObjectProperty(obj, 'stats', verifyObject);\n\n    lowerVoxelBound = parseLowerVoxelBounds(stackStatsObj);\n    upperVoxelBound = parseUpperVoxelBounds(stackStatsObj);\n\n    if (stackStatsObj.hasOwnProperty('channelNames')) {\n      channels = parseChannelNames(stackStatsObj);\n    }\n  } else if (PARTIAL_STACK_STATES.has(state)) {\n    // Stacks in LOADING state will not have a 'stats' object.\n    // Values will be populated from command arguments in MultiscaleVolumeChunkSource()\n  } else {\n    return undefined;\n  }\n\n  let voxelResolution: vec3 = verifyObjectProperty(obj, 'currentVersion', parseStackVersionInfo);\n\n  let project: string = verifyObjectProperty(obj, 'stackId', parseStackProject);\n\n  return {lowerVoxelBound, upperVoxelBound, voxelResolution, project, channels};\n}\n\nfunction parseUpperVoxelBounds(stackStatsObj: any): vec3 {\n  verifyObject(stackStatsObj);\n  let stackBounds = verifyObjectProperty(stackStatsObj, 'stackBounds', verifyObject);\n\n  let upperVoxelBound: vec3 = vec3.create();\n\n  upperVoxelBound[0] = verifyObjectProperty(stackBounds, 'maxX', verifyFloat)+1;\n  upperVoxelBound[1] = verifyObjectProperty(stackBounds, 'maxY', verifyFloat)+1;\n  upperVoxelBound[2] = verifyObjectProperty(stackBounds, 'maxZ', verifyFloat)+1;\n\n  return upperVoxelBound;\n}\n\nfunction parseLowerVoxelBounds(stackStatsObj: any): vec3 {\n  verifyObject(stackStatsObj);\n  let stackBounds = verifyObjectProperty(stackStatsObj, 'stackBounds', verifyObject);\n\n  let lowerVoxelBound: vec3 = vec3.create();\n\n  lowerVoxelBound[0] = verifyObjectProperty(stackBounds, 'minX', verifyFloat);\n  lowerVoxelBound[1] = verifyObjectProperty(stackBounds, 'minY', verifyFloat);\n  lowerVoxelBound[2] = verifyObjectProperty(stackBounds, 'minZ', verifyFloat);\n\n  return lowerVoxelBound;\n}\n\nfunction parseChannelNames(stackStatsObj: any): string[] {\n  verifyObject(stackStatsObj);\n\n  return verifyObjectProperty(stackStatsObj, 'channelNames', channelNamesObj => {\n    return parseArray(channelNamesObj, verifyString);\n  });\n}\n\nfunction parseStackVersionInfo(stackVersionObj: any): vec3 {\n  verifyObject(stackVersionObj);\n  let voxelResolution: vec3 = vec3.create();\n  try {\n    voxelResolution[0] = verifyObjectProperty(stackVersionObj, 'stackResolutionX', verifyFloat);\n    voxelResolution[1] = verifyObjectProperty(stackVersionObj, 'stackResolutionY', verifyFloat);\n    voxelResolution[2] = verifyObjectProperty(stackVersionObj, 'stackResolutionZ', verifyFloat);\n  } catch (ignoredError) {\n    // default is 1, 1, 1\n    voxelResolution[0] = 1;\n    voxelResolution[1] = 1;\n    voxelResolution[2] = 1;\n  }\n\n  return voxelResolution;\n}\n\nfunction parseStackProject(stackIdObj: any): string {\n  verifyObject(stackIdObj);\n  return verifyObjectProperty(stackIdObj, 'project', verifyString);\n}\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  get dataType() {\n    return DataType.UINT8;\n  }\n  get numChannels() {\n    return 3;\n  }\n  get volumeType() {\n    return VolumeType.IMAGE;\n  }\n\n  channel: string|undefined;\n  stack: string;\n  stackInfo: StackInfo;\n\n  dims: vec3;\n\n  encoding: string;\n  numLevels: number|undefined;\n\n  // Render Parameters\n  minIntensity: number|undefined;\n  maxIntensity: number|undefined;\n\n  // Bounding box override parameters\n  minX: number|undefined;\n  minY: number|undefined;\n  minZ: number|undefined;\n  maxX: number|undefined;\n  maxY: number|undefined;\n  maxZ: number|undefined;\n\n  // Force limited number of tile specs to render for downsampled views of large projects\n  maxTileSpecsToRender: number|undefined;\n\n  filter: boolean|undefined;\n\n  constructor(\n      public chunkManager: ChunkManager, public baseUrl: string, public ownerInfo: OwnerInfo,\n      stack: string|undefined, public project: string, channel: string|undefined,\n      public parameters: {[index: string]: any}) {\n    let projectInfo = ownerInfo.projects.get(project);\n    if (projectInfo === undefined) {\n      throw new Error(\n          `Specified project ${JSON.stringify(project)} does not exist for ` +\n          `specified owner ${JSON.stringify(ownerInfo.owner)}`);\n    }\n\n    if (stack === undefined) {\n      const stackNames = Array.from(projectInfo.stacks.keys());\n      if (stackNames.length !== 1) {\n        throw new Error(`Dataset contains multiple stacks: ${JSON.stringify(stackNames)}`);\n      }\n      stack = stackNames[0];\n    }\n    const stackInfo = projectInfo.stacks.get(stack);\n    if (stackInfo === undefined) {\n      throw new Error(\n          `Specified stack ${JSON.stringify(stack)} is not one of the supported stacks: ` +\n          JSON.stringify(Array.from(projectInfo.stacks.keys())));\n    }\n    this.stack = stack;\n    this.stackInfo = stackInfo;\n\n    if (channel !== undefined && channel.length > 0) {\n      this.channel = channel;\n    }\n\n    this.minIntensity = verifyOptionalInt(parameters['minIntensity']);\n    this.maxIntensity = verifyOptionalInt(parameters['maxIntensity']);\n    this.maxTileSpecsToRender = verifyOptionalInt(parameters['maxTileSpecsToRender']);\n    this.filter = verifyOptionalBoolean(parameters['filter']);\n\n    this.minX = verifyOptionalInt(parameters['minX']);\n    this.minY = verifyOptionalInt(parameters['minY']);\n    this.minZ = verifyOptionalInt(parameters['minZ']);\n    this.maxX = verifyOptionalInt(parameters['maxX']);\n    this.maxY = verifyOptionalInt(parameters['maxY']);\n    this.maxZ = verifyOptionalInt(parameters['maxZ']);\n\n    if (this.minX !== undefined) { stackInfo.lowerVoxelBound[0] = this.minX; }\n    if (this.minY !== undefined) { stackInfo.lowerVoxelBound[1] = this.minY; }\n    if (this.minZ !== undefined) { stackInfo.lowerVoxelBound[2] = this.minZ; }\n    if (this.maxX !== undefined) { stackInfo.upperVoxelBound[0] = this.maxX; }\n    if (this.maxY !== undefined) { stackInfo.upperVoxelBound[1] = this.maxY; }\n    if (this.maxZ !== undefined) { stackInfo.upperVoxelBound[2] = this.maxZ; }\n\n    let encoding = verifyOptionalString(parameters['encoding']);\n    if (encoding === undefined) {\n      encoding = 'jpg';\n    } else {\n      if (!VALID_ENCODINGS.has(encoding)) {\n        throw new Error(`Invalid encoding: ${JSON.stringify(encoding)}.`);\n      }\n    }\n    this.encoding = encoding;\n\n    this.numLevels = verifyOptionalInt(parameters['numlevels']);\n\n    this.dims = vec3.create();\n\n    let tileSize = verifyOptionalInt(parameters['tilesize']);\n    if (tileSize === undefined) {\n      tileSize = 1024;  // Default tile size is 1024 x 1024\n    }\n    this.dims[0] = tileSize;\n    this.dims[1] = tileSize;\n    this.dims[2] = 1;\n  }\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    let sources: VolumeChunkSource[][] = [];\n\n    let numLevels = this.numLevels;\n    if (numLevels === undefined) {\n      numLevels = computeStackHierarchy(this.stackInfo, this.dims[0]);\n    }\n\n    let lowerClipBound = vec3.create(), upperClipBound = vec3.create();\n    // Generate and set the clip bounds based on the highest resolution (lowest scale) data in\n    // render. Otherwise, rounding errors can cause inconsistencies in clip bounds between scaling\n    // levels.\n    for (let i = 0; i < 3; i++) {\n      lowerClipBound[i] = this.stackInfo.lowerVoxelBound[i] * this.stackInfo.voxelResolution[i];\n      upperClipBound[i] = this.stackInfo.upperVoxelBound[i] * this.stackInfo.voxelResolution[i];\n    }\n\n    for (let level = 0; level < numLevels; level++) {\n      let voxelSize = vec3.clone(this.stackInfo.voxelResolution);\n      let chunkDataSize = vec3.fromValues(1, 1, 1);\n      // tiles are NxMx1\n      for (let i = 0; i < 2; ++i) {\n        voxelSize[i] = voxelSize[i] * Math.pow(2, level);\n        chunkDataSize[i] = this.dims[i];\n      }\n\n      let lowerVoxelBound = vec3.create(), upperVoxelBound = vec3.create();\n\n      for (let i = 0; i < 3; i++) {\n        lowerVoxelBound[i] = Math.floor(\n            this.stackInfo.lowerVoxelBound[i] * (this.stackInfo.voxelResolution[i] / voxelSize[i]));\n        upperVoxelBound[i] = Math.ceil(\n            this.stackInfo.upperVoxelBound[i] * (this.stackInfo.voxelResolution[i] / voxelSize[i]));\n      }\n\n      let spec = VolumeChunkSpecification.make({\n        voxelSize,\n        chunkDataSize,\n        numChannels: this.numChannels,\n        dataType: this.dataType,\n        lowerClipBound,\n        upperClipBound,\n        lowerVoxelBound,\n        upperVoxelBound,\n        volumeSourceOptions,\n      });\n\n      let source = this.chunkManager.getChunkSource(TileChunkSource, {\n        spec,\n        parameters: {\n          'baseUrl': this.baseUrl,\n          'owner': this.ownerInfo.owner,\n          'project': this.stackInfo.project,\n          'stack': this.stack,\n          'channel': this.channel,\n          'minIntensity': this.minIntensity,\n          'maxIntensity': this.maxIntensity,\n          'maxTileSpecsToRender': this.maxTileSpecsToRender,\n          'filter': this.filter,\n          'dims': `${this.dims[0]}_${this.dims[1]}`,\n          'level': level,\n          'encoding': this.encoding,\n        }\n      });\n\n      sources.push([source]);\n    }\n    return sources;\n  }\n\n  /**\n   * Meshes are not supported.\n   */\n  getMeshSource(): null {\n    return null;\n  }\n}\n\nexport function computeStackHierarchy(stackInfo: StackInfo, tileSize: number) {\n  let maxBound = 0;\n  for (let i = 0; i < 2; i++) {\n    maxBound < stackInfo.upperVoxelBound[i] ? maxBound = stackInfo.upperVoxelBound[i] :\n                                              maxBound = maxBound;\n  }\n\n  if (tileSize >= maxBound) {\n    return 1;\n  }\n\n  let counter = 0;\n  while (maxBound > tileSize) {\n    maxBound = maxBound / 2;\n    counter++;\n  }\n\n  return counter;\n}\n\nexport function getOwnerInfo(\n    chunkManager: ChunkManager, hostname: string, owner: string): Promise<OwnerInfo> {\n  return chunkManager.memoize.getUncounted(\n      {'type': 'render:getOwnerInfo', hostname, owner},\n      () => fetchOk(`${hostname}/render-ws/v1/owner/${owner}/stacks`)\n                .then(response => response.json())\n                .then(parseOwnerInfo));\n}\n\nconst pathPattern = /^([^\\/?]+)(?:\\/([^\\/?]+))?(?:\\/([^\\/?]+))(?:\\/([^\\/?]*))?(?:\\?(.*))?$/;\nconst urlPattern = /^((?:(?:(?:http|https):\\/\\/[^,\\/]+)[^\\/?]))\\/(.*)$/;\n\nexport function getVolume(chunkManager: ChunkManager, datasourcePath: string) {\n  let hostname: string, path: string;\n  {\n    let match = datasourcePath.match(urlPattern);\n    if (match === null) {\n      throw new Error(`Invalid render volume path: ${JSON.stringify(datasourcePath)}`);\n    }\n    hostname = match[1];\n    path = match[2];\n  }\n  const match = path.match(pathPattern);\n  if (match === null) {\n    throw new Error(`Invalid volume path ${JSON.stringify(path)}`);\n  }\n  const owner = match[1];\n  const project = match[2];\n  const stack = match[3];\n  const channel = match[4];\n\n  const parameters = parseQueryStringParameters(match[5] || '');\n\n  return chunkManager.memoize.getUncounted(\n      {type: 'render:MultiscaleVolumeChunkSource', hostname, path},\n      () => getOwnerInfo(chunkManager, hostname, owner)\n                .then(\n                    ownerInfo => new MultiscaleVolumeChunkSource(\n                        chunkManager, hostname, ownerInfo, stack, project, channel, parameters)));\n}\n\nexport function stackAndProjectCompleter(\n    chunkManager: ChunkManager, hostname: string, path: string): Promise<CompletionResult> {\n  const stackMatch = path.match(/^(?:([^\\/]+)(?:\\/([^\\/]*))?(?:\\/([^\\/]*))?(\\/.*?)?)?$/);\n  if (stackMatch === null) {\n    // URL has incorrect format, don't return any results.\n    return Promise.reject<CompletionResult>(null);\n  }\n  if (stackMatch[2] === undefined) {\n    // Don't autocomplete the owner\n    return Promise.reject<CompletionResult>(null);\n  }\n  if (stackMatch[3] === undefined) {\n    let projectPrefix = stackMatch[2] || '';\n    return getOwnerInfo(chunkManager, hostname, stackMatch[1]).then(ownerInfo => {\n      let completions = getPrefixMatchesWithDescriptions(\n          projectPrefix, ownerInfo.projects, x => x[0] + '/', () => undefined);\n      return {offset: stackMatch[1].length + 1, completions};\n    });\n  }\n  if (stackMatch[4] === undefined) {\n    let stackPrefix = stackMatch[3] || '';\n    return getOwnerInfo(chunkManager, hostname, stackMatch[1]).then(ownerInfo => {\n      let projectInfo = ownerInfo.projects.get(stackMatch[2]);\n      if (projectInfo === undefined) {\n        return Promise.reject<CompletionResult>(null);\n      }\n      let completions =\n          getPrefixMatchesWithDescriptions(stackPrefix, projectInfo.stacks, x => x[0] + '/', x => {\n            return `(${x[1].project})`;\n          });\n      return {offset: stackMatch[1].length + stackMatch[2].length + 2, completions};\n    });\n  }\n  let channelPrefix = stackMatch[4].substr(1) || '';\n  return getOwnerInfo(chunkManager, hostname, stackMatch[1]).then(ownerInfo => {\n    let projectInfo = ownerInfo.projects.get(stackMatch[2]);\n    if (projectInfo === undefined) {\n      return Promise.reject<CompletionResult>(null);\n    }\n    let stackInfo = projectInfo.stacks.get(stackMatch[3]);\n    if (stackInfo === undefined) {\n      return Promise.reject<CompletionResult>(null);\n    }\n    let channels = stackInfo.channels;\n    if (channels.length === 0) {\n      return Promise.reject<CompletionResult>(null);\n    } else {\n      // Try and complete the channel\n      let completions =\n          getPrefixMatchesWithDescriptions(channelPrefix, channels, x => x, () => undefined);\n      return {\n        offset: stackMatch[1].length + stackMatch[2].length + stackMatch[3].length + 3,\n        completions\n      };\n    }\n  });\n}\n\nexport function volumeCompleter(\n    url: string, chunkManager: ChunkManager): Promise<CompletionResult> {\n  let match = url.match(urlPattern);\n  if (match === null) {\n    // We don't yet have a full hostname.\n    return Promise.reject<CompletionResult>(null);\n  }\n  let hostname = match[1];\n  let path = match[2];\n\n  return stackAndProjectCompleter(chunkManager, hostname, path)\n      .then(completions => applyCompletionOffset(match![1].length + 1, completions));\n}\n\nexport class MultiscaleVectorGraphicsChunkSource implements\n    GenericMultiscaleVectorGraphicsChunkSource {\n  stack: string;\n  stackInfo: StackInfo;\n\n  matchCollection: string;\n  zoffset: number;\n\n  dims: vec3;\n\n  constructor(\n      public chunkManager: ChunkManager, public baseUrl: string, public ownerInfo: OwnerInfo,\n      stack: string|undefined, public project: string, public parameters: {[index: string]: any}) {\n    let projectInfo = ownerInfo.projects.get(project);\n    if (projectInfo === undefined) {\n      throw new Error(\n          `Specified project ${JSON.stringify(project)} does not exist for ` +\n          `specified owner ${JSON.stringify(ownerInfo.owner)}`);\n    }\n\n    if (stack === undefined) {\n      const stackNames = Array.from(projectInfo.stacks.keys());\n      if (stackNames.length !== 1) {\n        throw new Error(`Dataset contains multiple stacks: ${JSON.stringify(stackNames)}`);\n      }\n      stack = stackNames[0];\n    }\n    const stackInfo = projectInfo.stacks.get(stack);\n    if (stackInfo === undefined) {\n      throw new Error(\n          `Specified stack ${JSON.stringify(stack)} is not one of the supported stacks: ` +\n          JSON.stringify(Array.from(projectInfo.stacks.keys())));\n    }\n    this.stack = stack;\n    this.stackInfo = stackInfo;\n\n    let matchCollection = verifyOptionalString(parameters['matchCollection']);\n    if (matchCollection === undefined) {\n      matchCollection = stack;\n    }\n    this.matchCollection = matchCollection;\n\n    let zoffset = verifyOptionalInt(parameters['zoffset']);\n    if (zoffset === undefined) {\n      zoffset = 1;\n    }\n    this.zoffset = zoffset;\n\n    this.dims = vec3.create();\n\n    let tileSize = verifyOptionalInt(parameters['tilesize']);\n    if (tileSize === undefined) {\n      tileSize = 1024;  // Default tile size is 1024 x 1024\n    }\n    this.dims[0] = tileSize;\n    this.dims[1] = tileSize;\n    this.dims[2] = 1;\n  }\n  getSources(vectorGraphicsSourceOptions: VectorGraphicsSourceOptions) {\n    const voxelSize = this.stackInfo.voxelResolution;\n    const chunkSize = vec3.subtract(\n        vec3.create(), this.stackInfo.upperVoxelBound, this.stackInfo.lowerVoxelBound);\n    vec3.multiply(chunkSize, chunkSize, voxelSize);\n    chunkSize[2] = voxelSize[2];\n\n    const spec = VectorGraphicsChunkSpecification.make({\n      voxelSize,\n      chunkSize,\n      lowerChunkBound: vec3.fromValues(0, 0, this.stackInfo.lowerVoxelBound[2]),\n      upperChunkBound: vec3.fromValues(1, 1, this.stackInfo.upperVoxelBound[2]),\n      vectorGraphicsSourceOptions\n    });\n    const source = this.chunkManager.getChunkSource(PointMatchSource, {\n      spec,\n      parameters: {\n        'baseUrl': this.baseUrl,\n        'owner': this.ownerInfo.owner,\n        'project': this.stackInfo.project,\n        'stack': this.stack,\n        'encoding': 'points',\n        'matchCollection': this.matchCollection,\n        'zoffset': this.zoffset\n      }\n    });\n\n    return [[source]];\n  }\n}\n\nexport function getPointMatches(chunkManager: ChunkManager, datasourcePath: string) {\n  let hostname: string, path: string;\n  {\n    let match = datasourcePath.match(urlPattern);\n    if (match === null) {\n      throw new Error(`Invalid render point path: ${JSON.stringify(datasourcePath)}`);\n    }\n    hostname = match[1];\n    path = match[2];\n  }\n  const match = path.match(pathPattern);\n  if (match === null) {\n    throw new Error(`Invalid point path ${JSON.stringify(path)}`);\n  }\n  \n  const owner = match[1];\n  const project = match[2];\n  const stack = match[3];\n\n  const parameters = parseQueryStringParameters(match[4] || '');\n\n  return chunkManager.memoize.getUncounted(\n      {type: 'render:MultiscaleVectorGraphicsChunkSource', hostname, path},\n      () => getOwnerInfo(chunkManager, hostname, owner)\n                .then(\n                    ownerInfo => new MultiscaleVectorGraphicsChunkSource(\n                        chunkManager, hostname, ownerInfo, stack, project, parameters)));\n}\n\nexport class RenderDataSource extends DataSource {\n  get description() {\n    return 'Render';\n  }\n  getVolume(chunkManager: ChunkManager, url: string) {\n    return getVolume(chunkManager, url);\n  }\n  volumeCompleter(url: string, chunkManager: ChunkManager) {\n    return volumeCompleter(url, chunkManager);\n  }\n  getVectorGraphicsSource(chunkManager: ChunkManager, url: string) {\n    return getPointMatches(chunkManager, url);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {VertexAttributeInfo} from 'neuroglancer/skeleton/base';\nimport {mat4} from 'neuroglancer/util/geom';\n\nexport enum VolumeChunkEncoding {\n  RAW,\n  JPEG,\n  COMPRESSED_SEGMENTATION\n}\n\nexport class VolumeChunkSourceParameters {\n  url: string;\n  encoding: VolumeChunkEncoding;\n  sharding: ShardingParameters|undefined;\n\n  static RPC_ID = 'precomputed/VolumeChunkSource';\n}\n\n\nexport class MeshSourceParameters {\n  url: string;\n  lod: number;\n\n  static RPC_ID = 'precomputed/MeshSource';\n}\n\nexport enum DataEncoding {\n  RAW = 0,\n  GZIP = 1,\n}\n\nexport enum ShardingHashFunction {\n  IDENTITY = 0,\n  MURMURHASH3_X86_128 = 1,\n}\n\nexport interface ShardingParameters {\n  hash: ShardingHashFunction;\n  preshiftBits: number;\n  minishardBits: number;\n  shardBits: number;\n  minishardIndexEncoding: DataEncoding;\n  dataEncoding: DataEncoding;\n}\n\nexport class MultiscaleMeshMetadata {\n  transform: mat4;\n  lodScaleMultiplier: number;\n  vertexQuantizationBits: number;\n  sharding: ShardingParameters|undefined;\n}\n\nexport class MultiscaleMeshSourceParameters {\n  url: string;\n  metadata: MultiscaleMeshMetadata;\n\n  static RPC_ID = 'precomputed/MultiscaleMeshSource';\n}\n\nexport interface SkeletonMetadata {\n  transform: mat4;\n  vertexAttributes: Map<string, VertexAttributeInfo>;\n  sharding: ShardingParameters|undefined;\n}\n\nexport class SkeletonSourceParameters {\n  url: string;\n  metadata: SkeletonMetadata;\n\n  static RPC_ID = 'precomputed/SkeletonSource';\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationSource, makeDataBoundsBoundingBox} from 'neuroglancer/annotation';\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {DataSource} from 'neuroglancer/datasource';\nimport {DataEncoding, MeshSourceParameters, MultiscaleMeshMetadata, MultiscaleMeshSourceParameters, ShardingHashFunction, ShardingParameters, SkeletonMetadata, SkeletonSourceParameters, VolumeChunkEncoding, VolumeChunkSourceParameters} from 'neuroglancer/datasource/precomputed/base';\nimport {VertexPositionFormat} from 'neuroglancer/mesh/base';\nimport {MeshSource, MultiscaleMeshSource} from 'neuroglancer/mesh/frontend';\nimport {VertexAttributeInfo} from 'neuroglancer/skeleton/base';\nimport {SkeletonSource} from 'neuroglancer/skeleton/frontend';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {fetchOk, parseSpecialUrl} from 'neuroglancer/util/http_request';\nimport {parseArray, parseFixedLengthArray, parseIntVec, verifyEnumString, verifyFiniteFloat, verifyFinitePositiveFloat, verifyInt, verifyObject, verifyObjectProperty, verifyOptionalString, verifyPositiveInt, verifyString} from 'neuroglancer/util/json';\n\nclass PrecomputedVolumeChunkSource extends\n(WithParameters(VolumeChunkSource, VolumeChunkSourceParameters)) {}\n\nclass PrecomputedMeshSource extends\n(WithParameters(MeshSource, MeshSourceParameters)) {}\n\nclass PrecomputedMultiscaleMeshSource extends\n(WithParameters(MultiscaleMeshSource, MultiscaleMeshSourceParameters)) {}\n\nexport class PrecomputedSkeletonSource extends\n(WithParameters(SkeletonSource, SkeletonSourceParameters)) {\n  get skeletonVertexCoordinatesInVoxels() {\n    return false;\n  }\n  get vertexAttributes() {\n    return this.parameters.metadata.vertexAttributes;\n  }\n}\n\nfunction resolvePath(a: string, b: string) {\n  const outputParts = a.split('/');\n  for (const part of b.split('/')) {\n    if (part === '..') {\n      if (outputParts.length !== 0) {\n        outputParts.length = outputParts.length - 1;\n        continue;\n      }\n    }\n    outputParts.push(part);\n  }\n  return outputParts.join('/');\n}\n\nclass ScaleInfo {\n  key: string;\n  encoding: VolumeChunkEncoding;\n  resolution: vec3;\n  voxelOffset: vec3;\n  size: vec3;\n  chunkSizes: vec3[];\n  compressedSegmentationBlockSize: vec3|undefined;\n  sharding: ShardingParameters|undefined;\n  constructor(obj: any) {\n    verifyObject(obj);\n    this.resolution = verifyObjectProperty(\n        obj, 'resolution', x => parseFixedLengthArray(vec3.create(), x, verifyFinitePositiveFloat));\n    this.voxelOffset = verifyObjectProperty(\n        obj, 'voxel_offset', x => x === undefined ? vec3.create() : parseIntVec(vec3.create(), x));\n    this.size = verifyObjectProperty(\n        obj, 'size', x => parseFixedLengthArray(vec3.create(), x, verifyPositiveInt));\n    this.chunkSizes = verifyObjectProperty(\n        obj, 'chunk_sizes',\n        x => parseArray(x, y => parseFixedLengthArray(vec3.create(), y, verifyPositiveInt)));\n    if (this.chunkSizes.length === 0) {\n      throw new Error('No chunk sizes specified.');\n    }\n    this.sharding = verifyObjectProperty(obj, 'sharding', parseShardingParameters);\n    if (this.sharding !== undefined && this.chunkSizes.length !== 1) {\n      throw new Error('Sharding requires a single chunk size per scale');\n    }\n    let encoding = this.encoding =\n        verifyObjectProperty(obj, 'encoding', x => verifyEnumString(x, VolumeChunkEncoding));\n    if (encoding === VolumeChunkEncoding.COMPRESSED_SEGMENTATION) {\n      this.compressedSegmentationBlockSize = verifyObjectProperty(\n          obj, 'compressed_segmentation_block_size',\n          x => parseFixedLengthArray(vec3.create(), x, verifyPositiveInt));\n    }\n    this.key = verifyObjectProperty(obj, 'key', verifyString);\n  }\n}\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  dataType: DataType;\n  numChannels: number;\n  volumeType: VolumeType;\n  mesh: string|undefined;\n  skeletons: string|undefined;\n  scales: ScaleInfo[];\n\n  getMeshSource() {\n    const {mesh} = this;\n    if (mesh !== undefined) {\n      return getMeshSource(this.chunkManager, resolvePath(this.url, mesh));\n    }\n    const {skeletons} = this;\n    if (skeletons !== undefined) {\n      return getSkeletonSource(this.chunkManager, resolvePath(this.url, skeletons));\n    }\n    return null;\n  }\n\n  constructor(public chunkManager: ChunkManager, public url: string, obj: any) {\n    verifyObject(obj);\n    const t = verifyObjectProperty(obj, '@type', verifyOptionalString);\n    if (t !== undefined && t !== 'neuroglancer_multiscale_volume') {\n      throw new Error(`Invalid type: ${JSON.stringify(t)}`);\n    }\n    this.dataType = verifyObjectProperty(obj, 'data_type', x => verifyEnumString(x, DataType));\n    this.numChannels = verifyObjectProperty(obj, 'num_channels', verifyPositiveInt);\n    this.volumeType = verifyObjectProperty(obj, 'type', x => verifyEnumString(x, VolumeType));\n    this.mesh = verifyObjectProperty(obj, 'mesh', verifyOptionalString);\n    this.skeletons = verifyObjectProperty(obj, 'skeletons', verifyOptionalString);\n    this.scales = verifyObjectProperty(obj, 'scales', x => parseArray(x, y => new ScaleInfo(y)));\n  }\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    return this.scales.map(scaleInfo => {\n      return VolumeChunkSpecification\n          .getDefaults({\n            voxelSize: scaleInfo.resolution,\n            dataType: this.dataType,\n            numChannels: this.numChannels,\n            transform: mat4.fromTranslation(\n                mat4.create(),\n                vec3.multiply(vec3.create(), scaleInfo.resolution, scaleInfo.voxelOffset)),\n            upperVoxelBound: scaleInfo.size,\n            volumeType: this.volumeType,\n            chunkDataSizes: scaleInfo.chunkSizes,\n            baseVoxelOffset: scaleInfo.voxelOffset,\n            compressedSegmentationBlockSize: scaleInfo.compressedSegmentationBlockSize,\n            volumeSourceOptions,\n          })\n          .map(spec => this.chunkManager.getChunkSource(PrecomputedVolumeChunkSource, {\n            spec,\n            parameters: {\n              url: resolvePath(this.url, scaleInfo.key),\n              encoding: scaleInfo.encoding,\n              sharding: scaleInfo.sharding,\n            }\n          }));\n    });\n  }\n\n  getStaticAnnotations() {\n    const baseScale = this.scales[0];\n    const annotationSet =\n        new AnnotationSource(mat4.fromScaling(mat4.create(), baseScale.resolution));\n    annotationSet.readonly = true;\n    annotationSet.add(makeDataBoundsBoundingBox(\n        baseScale.voxelOffset, vec3.add(vec3.create(), baseScale.voxelOffset, baseScale.size)));\n    return annotationSet;\n  }\n}\n\nexport function getShardedMeshSource(chunkManager: ChunkManager, parameters: MeshSourceParameters) {\n  return chunkManager.getChunkSource(PrecomputedMeshSource, {parameters});\n}\n\nfunction parseTransform(data: any): mat4 {\n  return verifyObjectProperty(data, 'transform', value => {\n    const transform = mat4.create();\n    if (value !== undefined) {\n      parseFixedLengthArray(transform.subarray(0, 12), value, verifyFiniteFloat);\n    }\n    mat4.transpose(transform, transform);\n    return transform;\n  });\n}\n\nfunction parseMeshMetadata(data: any): MultiscaleMeshMetadata {\n  verifyObject(data);\n  const t = verifyObjectProperty(data, '@type', verifyString);\n  if (t !== 'neuroglancer_multilod_draco') {\n    throw new Error(`Unsupported mesh type: ${JSON.stringify(t)}`);\n  }\n  const lodScaleMultiplier =\n      verifyObjectProperty(data, 'lod_scale_multiplier', verifyFinitePositiveFloat);\n  const vertexQuantizationBits =\n      verifyObjectProperty(data, 'vertex_quantization_bits', verifyPositiveInt);\n  const transform = parseTransform(data);\n  const sharding = verifyObjectProperty(data, 'sharding', parseShardingParameters);\n  return {lodScaleMultiplier, transform, sharding, vertexQuantizationBits};\n}\n\nfunction getMeshMetadata(\n    chunkManager: ChunkManager, url: string): Promise<MultiscaleMeshMetadata|undefined> {\n  return chunkManager.memoize.getUncounted(\n      {'type': 'precomputed:MeshSource', url},\n      () => fetchOk(`${url}/info`)\n                .then(\n                    response => {\n                      return response.json().then(value => parseMeshMetadata(value));\n                    },\n                    // If we fail to fetch the info file, assume it is the legacy\n                    // single-resolution mesh format.\n                    () => undefined));\n}\n\nfunction parseShardingEncoding(y: any): DataEncoding {\n  if (y === undefined) return DataEncoding.RAW;\n  return verifyEnumString(y, DataEncoding);\n}\n\nfunction parseShardingParameters(shardingData: any): ShardingParameters|undefined {\n  if (shardingData === undefined) return undefined;\n  verifyObject(shardingData);\n  const t = verifyObjectProperty(shardingData, '@type', verifyString);\n  if (t !== 'neuroglancer_uint64_sharded_v1') {\n    throw new Error(`Unsupported sharding format: ${JSON.stringify(t)}`);\n  }\n  const hash =\n      verifyObjectProperty(shardingData, 'hash', y => verifyEnumString(y, ShardingHashFunction));\n  const preshiftBits = verifyObjectProperty(shardingData, 'preshift_bits', verifyInt);\n  const shardBits = verifyObjectProperty(shardingData, 'shard_bits', verifyInt);\n  const minishardBits = verifyObjectProperty(shardingData, 'minishard_bits', verifyInt);\n  const minishardIndexEncoding =\n      verifyObjectProperty(shardingData, 'minishard_index_encoding', parseShardingEncoding);\n  const dataEncoding = verifyObjectProperty(shardingData, 'data_encoding', parseShardingEncoding);\n  return {hash, preshiftBits, shardBits, minishardBits, minishardIndexEncoding, dataEncoding};\n}\n\nfunction parseSkeletonMetadata(data: any): SkeletonMetadata {\n  verifyObject(data);\n  const t = verifyObjectProperty(data, '@type', verifyString);\n  if (t !== 'neuroglancer_skeletons') {\n    throw new Error(`Unsupported skeleton type: ${JSON.stringify(t)}`);\n  }\n  const transform = parseTransform(data);\n  const vertexAttributes = new Map<string, VertexAttributeInfo>();\n  verifyObjectProperty(data, 'vertex_attributes', attributes => {\n    if (attributes === undefined) return;\n    parseArray(attributes, attributeData => {\n      verifyObject(attributeData);\n      const id = verifyObjectProperty(attributeData, 'id', verifyString);\n      if (id === '') throw new Error('vertex attribute id must not be empty');\n      if (vertexAttributes.has(id)) {\n        throw new Error(`duplicate vertex attribute id ${JSON.stringify(id)}`);\n      }\n      const dataType =\n          verifyObjectProperty(attributeData, 'data_type', y => verifyEnumString(y, DataType));\n      const numComponents =\n          verifyObjectProperty(attributeData, 'num_components', verifyPositiveInt);\n      vertexAttributes.set(id, {dataType, numComponents});\n    });\n  });\n  const sharding = verifyObjectProperty(data, 'sharding', parseShardingParameters);\n  return {transform, vertexAttributes, sharding};\n}\n\nfunction getSkeletonMetadata(\n    chunkManager: ChunkManager, url: string): Promise<SkeletonMetadata> {\n  return chunkManager.memoize.getUncounted(\n      {'type': 'precomputed:SkeletonSource', url}, async () => {\n        const response = await fetchOk(`${url}/info`);\n        const value = await response.json();\n        return parseSkeletonMetadata(value);\n      });\n}\n\nasync function getMeshSource(chunkManager: ChunkManager, url: string) {\n  const metadata = await getMeshMetadata(chunkManager, url);\n  if (metadata === undefined) {\n    return getShardedMeshSource(chunkManager, {url, lod: 0});\n  }\n  let vertexPositionFormat: VertexPositionFormat;\n  const {vertexQuantizationBits} = metadata;\n  if (vertexQuantizationBits === 10) {\n    vertexPositionFormat = VertexPositionFormat.uint10;\n  } else if (vertexQuantizationBits === 16) {\n    vertexPositionFormat = VertexPositionFormat.uint16;\n  } else {\n    throw new Error(`Invalid vertex quantization bits: ${vertexQuantizationBits}`);\n  }\n  return chunkManager.getChunkSource(PrecomputedMultiscaleMeshSource, {\n    parameters: {url, metadata},\n    format: {\n      fragmentRelativeVertices: true,\n      vertexPositionFormat,\n      transform: metadata.transform,\n    }\n  });\n}\n\nexport async function getSkeletonSource(chunkManager: ChunkManager, url: string) {\n  const metadata = await getSkeletonMetadata(chunkManager, url);\n  return chunkManager.getChunkSource(PrecomputedSkeletonSource, {\n    parameters: {\n      url,\n      metadata,\n    },\n    transform: metadata.transform,\n  });\n}\n\nexport function getVolume(chunkManager: ChunkManager, url: string) {\n  url = parseSpecialUrl(url);\n  return chunkManager.memoize.getUncounted(\n      {'type': 'precomputed:MultiscaleVolumeChunkSource', url},\n      () => fetchOk(`${url}/info`)\n                .then(response => response.json())\n                .then(response => new MultiscaleVolumeChunkSource(chunkManager, url, response)));\n}\n\nexport class PrecomputedDataSource extends DataSource {\n  get description() {\n    return 'Precomputed file-backed data source';\n  }\n  getVolume(chunkManager: ChunkManager, url: string) {\n    return getVolume(chunkManager, url);\n  }\n  getMeshSource(chunkManager: ChunkManager, url: string) {\n    return getMeshSource(chunkManager, parseSpecialUrl(url));\n  }\n  getSkeletonSource(chunkManager: ChunkManager, url: string) {\n    return getSkeletonSource(chunkManager, parseSpecialUrl(url));\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DataType, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {mat4, quat, vec3} from 'neuroglancer/util/geom';\n\nexport const GET_NIFTI_VOLUME_INFO_RPC_ID = 'nifti/getNiftiVolumeInfo';\n\nexport interface NiftiVolumeInfo {\n  numChannels: number;\n  dataType: DataType;\n  volumeType: VolumeType;\n  voxelSize: vec3;\n  affine: mat4;\n  description: string;\n  volumeSize: vec3;\n  qoffset: vec3;\n  quatern: quat;\n  qfac: number;\n  qform_code: number;\n  sform_code: number;\n}\n\nexport enum NiftiDataType {\n  NONE = 0,\n  BINARY = 1,\n  UINT8 = 2,\n  INT16 = 4,\n  INT32 = 8,\n  FLOAT32 = 16,\n  COMPLEX64 = 32,\n  FLOAT64 = 64,\n  RGB24 = 128,\n  INT8 = 256,\n  UINT16 = 512,\n  UINT32 = 768,\n  INT64 = 1024,\n  UINT64 = 1280,\n  FLOAT128 = 1536,\n  COMPLEX128 = 1792,\n  COMPLEX256 = 2048,\n}\n\nexport class VolumeSourceParameters {\n  url: string;\n\n  static RPC_ID = 'nifti/VolumeChunkSource';\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for displaying single NIfTI (https://www.nitrc.org/projects/nifti) files as\n * volumes.\n */\n\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {DataSource} from 'neuroglancer/datasource';\nimport {GET_NIFTI_VOLUME_INFO_RPC_ID, NiftiVolumeInfo, VolumeSourceParameters} from 'neuroglancer/datasource/nifti/base';\nimport {VolumeChunkSpecification, VolumeSourceOptions} from 'neuroglancer/sliceview/volume/base';\nimport {VolumeChunkSource, MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {CancellationToken, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {kOneVec, mat4, translationRotationScaleZReflectionToMat4} from 'neuroglancer/util/geom';\n\nclass NiftiVolumeChunkSource extends\n(WithParameters(VolumeChunkSource, VolumeSourceParameters)) {}\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  constructor(public chunkManager: ChunkManager, public url: string, public info: NiftiVolumeInfo) {\n  }\n  get numChannels() {\n    return this.info.numChannels;\n  }\n  get dataType() {\n    return this.info.dataType;\n  }\n  get volumeType() {\n    return this.info.volumeType;\n  }\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    let {info} = this;\n    const spec = VolumeChunkSpecification.withDefaultCompression({\n      volumeType: info.volumeType,\n      chunkDataSize: info.volumeSize,\n      dataType: info.dataType,\n      voxelSize: info.voxelSize,\n      numChannels: info.numChannels,\n      upperVoxelBound: info.volumeSize,\n      transform: translationRotationScaleZReflectionToMat4(\n          mat4.create(), info.qoffset, info.quatern, kOneVec, info.qfac),\n      volumeSourceOptions,\n    });\n    return [[this.chunkManager.getChunkSource(NiftiVolumeChunkSource, {spec, parameters: {url: this.url}})]];\n  }\n\n  getMeshSource(): null {\n    return null;\n  }\n}\n\nfunction getNiftiVolumeInfo(\n    chunkManager: ChunkManager, url: string, cancellationToken: CancellationToken) {\n  return chunkManager.rpc!.promiseInvoke<NiftiVolumeInfo>(\n      GET_NIFTI_VOLUME_INFO_RPC_ID, {'chunkManager': chunkManager.addCounterpartRef(), 'url': url},\n      cancellationToken);\n}\n\nexport function getVolume(chunkManager: ChunkManager, url: string) {\n  return chunkManager.memoize.getUncounted(\n      {type: 'nifti/getVolume', url},\n      () => getNiftiVolumeInfo(chunkManager, url, uncancelableToken)\n                .then(info => new MultiscaleVolumeChunkSource(chunkManager, url, info)));\n}\n\nexport class NiftiDataSource extends DataSource {\n  get description() { return 'Single NIfTI file'; }\n  getVolume(chunkManager: ChunkManager, url: string) {\n    return getVolume(chunkManager, url);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum VolumeChunkEncoding {\n  RAW,\n  GZIP,\n}\n\nexport class VolumeChunkSourceParameters {\n  url: string;\n  encoding: VolumeChunkEncoding;\n\n  static RPC_ID = 'n5/VolumeChunkSource';\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationSource, makeDataBoundsBoundingBox} from 'neuroglancer/annotation';\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {DataSource} from 'neuroglancer/datasource';\nimport {VolumeChunkEncoding, VolumeChunkSourceParameters} from 'neuroglancer/datasource/n5/base';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {fetchOk, HttpError, parseSpecialUrl} from 'neuroglancer/util/http_request';\nimport {parseArray, parseFixedLengthArray, verifyEnumString, verifyFinitePositiveFloat, verifyObject, verifyObjectProperty, verifyPositiveInt} from 'neuroglancer/util/json';\n\nclass N5VolumeChunkSource extends\n(WithParameters(VolumeChunkSource, VolumeChunkSourceParameters)) {}\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  dataType: DataType;\n  volumeType: VolumeType;\n\n  get numChannels() {\n    return 1;\n  }\n\n  getMeshSource() {\n    return null;\n  }\n\n  baseScaleIndex: number;\n\n  constructor(\n      public chunkManager: ChunkManager, public url: string,\n      public topLevelMetadata: TopLevelMetadata, public scales: (ScaleMetadata|undefined)[]) {\n    let dataType: DataType|undefined;\n    let baseScaleIndex: number|undefined;\n    scales.forEach((scale, i) => {\n      if (scale === undefined) return;\n      if (baseScaleIndex === undefined) {\n        baseScaleIndex = i;\n      }\n      if (dataType !== undefined && scale.dataType !== dataType) {\n        throw new Error(`Scale s${i} has data type ${DataType[scale.dataType]} but expected ${\n            DataType[dataType]}.`);\n      }\n      dataType = scale.dataType;\n    });\n    if (dataType === undefined) {\n      throw new Error(`At least one scale must be specified.`);\n    }\n    this.dataType = dataType;\n    this.volumeType = VolumeType.IMAGE;\n    this.baseScaleIndex = baseScaleIndex!;\n  }\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    const {topLevelMetadata} = this;\n    const sources: VolumeChunkSource[][] = [];\n    this.scales.forEach((scale, i) => {\n      if (scale === undefined) return;\n      sources.push(\n          VolumeChunkSpecification\n              .getDefaults({\n                voxelSize: vec3.multiply(\n                    vec3.create(), topLevelMetadata.pixelResolution, topLevelMetadata.scales[i]),\n                dataType: scale.dataType,\n                numChannels: 1,\n                upperVoxelBound: scale.size,\n                volumeType: this.volumeType,\n                chunkDataSizes: [scale.chunkSize],\n                volumeSourceOptions,\n              })\n              .map(spec => this.chunkManager.getChunkSource(N5VolumeChunkSource, {\n                spec,\n                parameters: {'url': `${this.url}/s${i}`, 'encoding': scale.encoding}\n              })));\n    });\n    return sources;\n  }\n\n  getStaticAnnotations() {\n    const {topLevelMetadata, baseScaleIndex} = this;\n    const annotationSet = new AnnotationSource(mat4.fromScaling(\n        mat4.create(),\n        vec3.multiply(\n            vec3.create(), topLevelMetadata.pixelResolution,\n            topLevelMetadata.scales[baseScaleIndex])));\n    annotationSet.readonly = true;\n    annotationSet.add(makeDataBoundsBoundingBox(vec3.create(), this.scales[baseScaleIndex]!.size));\n    return annotationSet;\n  }\n}\n\nconst pixelResolutionUnits = new Map<string, number>([\n  ['mm', 1e6],\n  ['m', 1e9],\n  ['um', 1000],\n  ['nm', 1],\n]);\n\nclass TopLevelMetadata {\n  pixelResolution: vec3;\n  scales: vec3[];\n  constructor(obj: any) {\n    verifyObject(obj);\n    verifyObjectProperty(obj, 'pixelResolution', resObj => {\n      verifyObject(resObj);\n      const unitScale = verifyObjectProperty(resObj, 'unit', x => {\n        const s = pixelResolutionUnits.get(x);\n        if (s === undefined) {\n          throw new Error(`Unsupported unit: ${JSON.stringify(x)}.`);\n        }\n        return s;\n      });\n      const dimensions = verifyObjectProperty(\n          resObj, 'dimensions',\n          x => parseFixedLengthArray(vec3.create(), x, verifyFinitePositiveFloat));\n      this.pixelResolution = vec3.scale(dimensions, dimensions, unitScale);\n    });\n    this.scales = verifyObjectProperty(\n        obj, 'scales',\n        scalesObj => parseArray(\n            scalesObj,\n            scaleObj => parseFixedLengthArray(vec3.create(), scaleObj, verifyFinitePositiveFloat)));\n  }\n}\n\nclass ScaleMetadata {\n  dataType: DataType;\n  encoding: VolumeChunkEncoding;\n  size: vec3;\n  chunkSize: vec3;\n\n  constructor(obj: any) {\n    verifyObject(obj);\n    this.dataType = verifyObjectProperty(obj, 'dataType', x => verifyEnumString(x, DataType));\n    this.size = verifyObjectProperty(\n        obj, 'dimensions', x => parseFixedLengthArray(vec3.create(), x, verifyPositiveInt));\n    this.chunkSize = verifyObjectProperty(\n      obj, 'blockSize', x => parseFixedLengthArray(vec3.create(), x, verifyPositiveInt));\n\n    let encoding: VolumeChunkEncoding|undefined;\n    verifyObjectProperty(obj, 'compression', compression => {\n      encoding =\n          verifyObjectProperty(compression, 'type', x => verifyEnumString(x, VolumeChunkEncoding));\n    });\n    if (encoding === undefined) {\n      encoding = verifyObjectProperty(\n          obj, 'compressionType', x => verifyEnumString(x, VolumeChunkEncoding));\n    }\n    this.encoding = encoding;\n  }\n}\n\nfunction getTopLevelMetadata(chunkManager: ChunkManager, url: string): Promise<TopLevelMetadata> {\n  return chunkManager.memoize.getUncounted(\n      {'type': 'n5:topLevelMetadata', url},\n      () => fetchOk(url)\n                .then(response => response.json())\n                .then(response => new TopLevelMetadata(response)));\n}\n\nfunction getScaleMetadata(chunkManager: ChunkManager, url: string): Promise<ScaleMetadata> {\n  return chunkManager.memoize.getUncounted(\n      {'type': 'n5:scaleMetadata', url},\n      () => fetchOk(url)\n                .then(response => response.json())\n                .then(response => new ScaleMetadata(response)));\n}\n\nfunction getAllScales(chunkManager: ChunkManager, url: string, topLevelMetadata: TopLevelMetadata):\n    Promise<(ScaleMetadata | undefined)[]> {\n  return Promise.all(topLevelMetadata.scales.map((_scale, i) => {\n    return getScaleMetadata(chunkManager, `${url}/s${i}/attributes.json`).catch(e => {\n      if (e instanceof HttpError && e.status === 404) {\n        return undefined;\n      }\n      throw e;\n    });\n  }));\n}\n\nexport class N5DataSource extends DataSource {\n  get description() {\n    return 'N5 data source';\n  }\n  getVolume(chunkManager: ChunkManager, url: string) {\n    url = parseSpecialUrl(url);\n    const m = url.match(/^(.*)\\/(c[0-9]+)$/);\n    let topLevelMetadataUrl: string;\n    if (m !== null) {\n      topLevelMetadataUrl = `${m[1]}/attributes.json`;\n    } else {\n      topLevelMetadataUrl = `${url}/attributes.json`;\n    }\n    return chunkManager.memoize.getUncounted(\n        {'type': 'n5:MultiscaleVolumeChunkSource', url},\n        () =>\n            getTopLevelMetadata(chunkManager, topLevelMetadataUrl)\n                .then(\n                    topLevelMetadata => getAllScales(chunkManager, url, topLevelMetadata)\n                                            .then(\n                                                scales => new MultiscaleVolumeChunkSource(\n                                                    chunkManager, url, topLevelMetadata, scales))));\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {EXAMPLE_COMPUTATION_RPC_ID, ExampleComputationParameters} from 'neuroglancer/datasource/computed/example/base';\nimport {ComputedVolumeDataSourceParameters, VolumeComputationFrontend, VolumeComputationFrontendProvider} from 'neuroglancer/datasource/computed/frontend';\nimport {verify3dVec} from 'neuroglancer/util/json';\nimport {registerSharedObjectOwner} from 'neuroglancer/worker_rpc';\n\n@registerSharedObjectOwner(EXAMPLE_COMPUTATION_RPC_ID)\nexport class ExampleComputation extends VolumeComputationFrontend {\n  params: ExampleComputationParameters;\n}\n\nexport class ExampleComputationProvider implements VolumeComputationFrontendProvider {\n  getComputation(config: any, {}, params: ComputedVolumeDataSourceParameters) {\n    const computeParams: ExampleComputationParameters = params.computationParameters;\n\n    if (config['inputSize'] !== undefined) {\n      const inputSize = verify3dVec(config['inputSize']);\n      computeParams.inputSpec.size.set(inputSize);\n    }\n\n    if (config['outputSize'] !== undefined) {\n      const outputSize = verify3dVec(config['outputSize']);\n      computeParams.outputSpec.size.set(outputSize);\n    }\n\n    return Promise.resolve(new ExampleComputation(computeParams));\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {ComputationParameters} from 'neuroglancer/datasource/computed/base';\n\nexport const EXAMPLE_COMPUTATION_RPC_ID = 'Computation.ExampleComputation';\n\nexport class ExampleComputationParameters extends ComputationParameters {}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as tfjsModule from '@tensorflow/tfjs';\nimport {InferenceModel, Tensor} from '@tensorflow/tfjs';\nimport {ComputedVolumeDataSourceParameters, VolumeComputationFrontend, VolumeComputationFrontendProvider} from 'neuroglancer/datasource/computed/frontend';\nimport {InferenceRequest, InferenceResult, TENSORFLOW_COMPUTATION_RPC_ID, TENSORFLOW_INFERENCE_RPC_ID, TensorflowArray, TensorflowComputationParameters} from 'neuroglancer/datasource/computed/tensorflow/base';\nimport {DataType, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {CANCELED, CancellationToken} from 'neuroglancer/util/cancellation';\nimport {verifyFloat, verifyString} from 'neuroglancer/util/json';\nimport {registerPromiseRPC, registerSharedObjectOwner, RPCPromise} from 'neuroglancer/worker_rpc';\n\nlet tfjs: null|typeof tfjsModule = null;\n\nexport function loadTFjs() {\n  if (tfjs) {\n    return Promise.resolve();\n  }\n  return import(/* webpackChunkName: \"tfjs-library\" */ '@tensorflow/tfjs').then((module) => {\n    tfjs = module;\n  });\n}\n\n/**\n * Dict-style object that represents a pending inference request.\n */\ninterface PendingInference {\n  // TF.js-compatible typed array, to be used as input.\n  array: TensorflowArray;\n  // If cancelled, reject(CANCELED) is called instead of performing inference.\n  cancellationToken: CancellationToken;\n  // The priority of the output chunk. Requests are handled in priority order.\n  priority: number;\n  // Resolve/Reject lambdas for the Promise awaiting inference.\n  reject: (message: any) => void;\n  resolve: (inferenceResult: InferenceResult) => void;\n}\n\n@registerSharedObjectOwner(TENSORFLOW_COMPUTATION_RPC_ID)\nexport class TensorflowComputation extends VolumeComputationFrontend {\n  params: TensorflowComputationParameters;\n\n  // The queue of pending inference requests. Maintained in order of increasing\n  // priority, so that pop() always returns the next appropriate request.\n  private inferenceQueue_: PendingInference[] = [];\n  // True iff the inference loop is in operation.\n  private running_ = false;\n\n  constructor(params: TensorflowComputationParameters, private model_: InferenceModel) {\n    super(params);\n  }\n\n  /**\n   * Adds a TF.js-compatible typed array to the inference queue and starts the\n   * inference loop, if it isn't already running. Returns a promise that\n   * resolves with the prediction output.\n   *\n   * Creates a PendingInference object and inserts it into the correct position\n   * in the inference queue, which is guaranteed to be less than the length of\n   * the backend computation queue in length. As such, it is most likely\n   * faster to simply iterate the queue to insert the request rather than using\n   * a more sophisticated method like binary insertion or a tree-based queue.\n   * @param array the input data to run inference over\n   * @param priority\n   * @param cancellationToken\n   */\n  predict(array: TensorflowArray, priority: number, cancellationToken: CancellationToken):\n      RPCPromise<InferenceResult> {\n    return new Promise((resolve, reject) => {\n             let i;\n             const queue = this.inferenceQueue_;\n             for (i = 0; i < queue.length && queue[i].priority < priority; ++i) {\n             }\n             queue.splice(i, 0, {array, cancellationToken, priority, resolve, reject});\n             this.startInference();\n           })\n        .then((result: InferenceResult) => {\n          return {value: result, transfers: [result.outputBuffer.buffer]};\n        });\n  }\n\n  /**\n   * Start the inference loop, if it isn't already running.\n   */\n  startInference() {\n    if (this.running_) {\n      return;\n    }\n    this.running_ = true;\n    setTimeout(() => this.runInference_(), 0);\n  }\n\n  /**\n   * Run the inference loop recursively.\n   */\n  private runInference_() {\n    if (this.inferenceQueue_.length === 0) {\n      this.running_ = false;\n      return;\n    }\n\n    const pendingInference = this.inferenceQueue_.pop()!;\n\n    if (pendingInference.cancellationToken.isCanceled) {\n      pendingInference.reject(CANCELED);\n      this.runInference_();\n      return;\n    }\n\n    this.modelInference_(pendingInference).then(() => this.runInference_());\n  }\n\n  /**\n   * Executes tf.js prediction, resolving or rejecting the pending request's\n   * promise, as appropriate.\n   * @param inferenceRequest  the request to infer.\n   */\n  private modelInference_(inferenceRequest: PendingInference): Promise<void> {\n    const inputLength = inferenceRequest.array.length;\n    const expectedLength = this.params.inputTensorNumElements!;\n    if (inputLength !== expectedLength) {\n      inferenceRequest.reject(\n          new Error(`Input array has ${inputLength} elements. Expected ${expectedLength}`));\n      return Promise.resolve();\n    }\n\n    const prediction = tfjs!.tidy(() => {\n      const modelInput =\n          tfjs!.tensor(inferenceRequest.array).reshape(this.params.inputTensorShape!);\n      const model = this.model_!;\n      return <Tensor>model.predict(modelInput, {});\n    });\n\n    return prediction.data()\n        .then((outputBuffer: TensorflowArray) => {\n          prediction.dispose();\n          const result: InferenceResult = {outputBuffer};\n          inferenceRequest.resolve(result);\n        })\n        .then(() => {\n          return new Promise<void>((resolve) => {\n            setTimeout(() => resolve(), 10);\n          });\n        });\n  }\n}\n\nexport class TensorflowComputationProvider implements VolumeComputationFrontendProvider {\n  getComputation(config: any, {}, params: ComputedVolumeDataSourceParameters) {\n    let modelPath = verifyString(config['modelPath']);\n    if (!modelPath.endsWith('/')) {\n      modelPath += '/';\n    }\n\n    let model: InferenceModel;\n    let stdDev = 1.0;\n    let mean = 0.0;\n    let outputType = VolumeType.SEGMENTATION;\n\n    if (config['stdDev'] !== undefined) {\n      stdDev = verifyFloat(config['stdDev']);\n    }\n    if (config['mean'] !== undefined) {\n      mean = verifyFloat(config['mean']);\n    }\n    if (config['atype'] !== undefined) {\n      const atype = verifyString(config['atype']);\n      switch (atype) {\n        case 'classifier':\n          break;\n        case 'regressor':\n          outputType = VolumeType.IMAGE;\n          break;\n        default:\n          throw new Error(`Unknown algorithm type ${atype}. Must be \"classifier\" or \"regressor\"`);\n      }\n    }\n\n    // Load the model, then do a dummy inference run. This allows us to\n    // explicitly discover the output dimensions, and to compile the\n    // model on the gpu.\n    return loadTFjs()\n        .then(() => {\n          return tfjs!.loadFrozenModel(\n              modelPath + 'tensorflowjs_model.pb', modelPath + 'weights_manifest.json');\n        })\n        .then((tfModel: InferenceModel) => {\n          model = tfModel;\n          if (model.inputs.length !== 1) {\n            throw new Error('Only models with exactly one input are supported');\n          }\n          if (model.outputs.length !== 1) {\n            // Todo: support for multiple-output models.\n            throw new Error('Only models with exactly one output are supported');\n          }\n\n          // Create a blank tensor, run prediction, check output size\n          const dummyOutput = tfjs!.tidy(() => {\n            const dummyInput: Tensor = tfjs!.ones(<number[]>model.inputs[0].shape);\n            return <Tensor>model.predict(dummyInput, {});\n          });\n\n          return dummyOutput.data().then(() => {\n            return dummyOutput;\n          });\n        })\n        .then((outputTensor: Tensor) => {\n          const inputShape = [1, 1, 1];\n          const outputShape = [1, 1, 1];\n          const inputTensor = model.inputs[0];\n          const inputDType = inputTensor.dtype;\n\n          let idx = 0;\n          for (let dim of inputTensor.shape!) {\n            if (dim > 1) {\n              inputShape[idx] = dim;\n              ++idx;\n            }\n\n            if (idx >= 3) {\n              throw new Error(\n                  `Cannot support tensorflow model with input ndim > 3: ${inputTensor.shape!}`);\n            }\n          }\n\n          idx = 0;\n          for (let dim of outputTensor.shape!) {\n            if (dim > 1) {\n              outputShape[idx] = dim;\n              ++idx;\n            }\n\n            if (idx >= 3) {\n              throw new Error(\n                  `Cannot support tensorflow model with output ndim > 3: ${outputTensor.shape!}`);\n            }\n          }\n          outputTensor.dispose();\n\n          let numElements = 1.0;\n          for (const dim of inputTensor.shape!) {\n            numElements *= dim;\n          }\n\n          const tfParams: TensorflowComputationParameters = params.computationParameters;\n          tfParams.inputSpec.size.set(inputShape);\n          tfParams.outputSpec.size.set(outputShape);\n          tfParams.outputSpec.dataType = DataType.UINT32;\n          tfParams.outputSpec.volumeType = outputType;\n          tfParams.inputDType = inputDType;\n          tfParams.mean = mean;\n          tfParams.stdDev = stdDev;\n          tfParams.inputTensorShape = inputTensor.shape;\n          tfParams.inputTensorNumElements = numElements;\n\n          return new TensorflowComputation(tfParams, model);\n        });\n  }\n}\n\nregisterPromiseRPC(\n    TENSORFLOW_INFERENCE_RPC_ID, function(x, cancellationToken): RPCPromise<InferenceResult> {\n      const request = <InferenceRequest>x.inferenceRequest;\n      const computation = <TensorflowComputation>this.get(request.computationRef);\n      return computation.predict(request.inputBuffer, request.priority, cancellationToken);\n    });\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {ComputationParameters} from 'neuroglancer/datasource/computed/base';\n\nexport const TENSORFLOW_COMPUTATION_RPC_ID = 'Computation.Tensorflow';\nexport const TENSORFLOW_INFERENCE_RPC_ID = 'Computation.Tensorflow.Inference';\n\nexport class TensorflowComputationParameters extends ComputationParameters {\n  inputDType?: string;\n  mean?: number;\n  stdDev?: number;\n  inputTensorShape?: number[];\n  inputTensorNumElements?: number;\n}\n\nexport type TensorflowArray = Int32Array|Float32Array;\n\nexport interface InferenceRequest {\n  inputBuffer: TensorflowArray;\n  computationRef: any;\n  priority: number;\n}\n\nexport interface InferenceResult {\n  outputBuffer: TensorflowArray;\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","\nvar content = require(\"!!../../css-loader/dist/cjs.js!./codemirror.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../css-loader/dist/cjs.js!./codemirror.css\", function() {\n\t\tvar newContent = require(\"!!../../css-loader/dist/cjs.js!./codemirror.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","\nvar content = require(\"!!../../../css-loader/dist/cjs.js!./lint.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../css-loader/dist/cjs.js!./lint.css\", function() {\n\t\tvar newContent = require(\"!!../../../css-loader/dist/cjs.js!./lint.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./image_user_layer.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./image_user_layer.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./image_user_layer.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./maximize_button.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./maximize_button.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./maximize_button.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  function doFold(cm, pos, options, force) {\n    if (options && options.call) {\n      var finder = options;\n      options = null;\n    } else {\n      var finder = getOption(cm, options, \"rangeFinder\");\n    }\n    if (typeof pos == \"number\") pos = CodeMirror.Pos(pos, 0);\n    var minSize = getOption(cm, options, \"minFoldSize\");\n\n    function getRange(allowFolded) {\n      var range = finder(cm, pos);\n      if (!range || range.to.line - range.from.line < minSize) return null;\n      var marks = cm.findMarksAt(range.from);\n      for (var i = 0; i < marks.length; ++i) {\n        if (marks[i].__isFold && force !== \"fold\") {\n          if (!allowFolded) return null;\n          range.cleared = true;\n          marks[i].clear();\n        }\n      }\n      return range;\n    }\n\n    var range = getRange(true);\n    if (getOption(cm, options, \"scanUp\")) while (!range && pos.line > cm.firstLine()) {\n      pos = CodeMirror.Pos(pos.line - 1, 0);\n      range = getRange(false);\n    }\n    if (!range || range.cleared || force === \"unfold\") return;\n\n    var myWidget = makeWidget(cm, options);\n    CodeMirror.on(myWidget, \"mousedown\", function(e) {\n      myRange.clear();\n      CodeMirror.e_preventDefault(e);\n    });\n    var myRange = cm.markText(range.from, range.to, {\n      replacedWith: myWidget,\n      clearOnEnter: getOption(cm, options, \"clearOnEnter\"),\n      __isFold: true\n    });\n    myRange.on(\"clear\", function(from, to) {\n      CodeMirror.signal(cm, \"unfold\", cm, from, to);\n    });\n    CodeMirror.signal(cm, \"fold\", cm, range.from, range.to);\n  }\n\n  function makeWidget(cm, options) {\n    var widget = getOption(cm, options, \"widget\");\n    if (typeof widget == \"string\") {\n      var text = document.createTextNode(widget);\n      widget = document.createElement(\"span\");\n      widget.appendChild(text);\n      widget.className = \"CodeMirror-foldmarker\";\n    } else if (widget) {\n      widget = widget.cloneNode(true)\n    }\n    return widget;\n  }\n\n  // Clumsy backwards-compatible interface\n  CodeMirror.newFoldFunction = function(rangeFinder, widget) {\n    return function(cm, pos) { doFold(cm, pos, {rangeFinder: rangeFinder, widget: widget}); };\n  };\n\n  // New-style interface\n  CodeMirror.defineExtension(\"foldCode\", function(pos, options, force) {\n    doFold(this, pos, options, force);\n  });\n\n  CodeMirror.defineExtension(\"isFolded\", function(pos) {\n    var marks = this.findMarksAt(pos);\n    for (var i = 0; i < marks.length; ++i)\n      if (marks[i].__isFold) return true;\n  });\n\n  CodeMirror.commands.toggleFold = function(cm) {\n    cm.foldCode(cm.getCursor());\n  };\n  CodeMirror.commands.fold = function(cm) {\n    cm.foldCode(cm.getCursor(), null, \"fold\");\n  };\n  CodeMirror.commands.unfold = function(cm) {\n    cm.foldCode(cm.getCursor(), null, \"unfold\");\n  };\n  CodeMirror.commands.foldAll = function(cm) {\n    cm.operation(function() {\n      for (var i = cm.firstLine(), e = cm.lastLine(); i <= e; i++)\n        cm.foldCode(CodeMirror.Pos(i, 0), null, \"fold\");\n    });\n  };\n  CodeMirror.commands.unfoldAll = function(cm) {\n    cm.operation(function() {\n      for (var i = cm.firstLine(), e = cm.lastLine(); i <= e; i++)\n        cm.foldCode(CodeMirror.Pos(i, 0), null, \"unfold\");\n    });\n  };\n\n  CodeMirror.registerHelper(\"fold\", \"combine\", function() {\n    var funcs = Array.prototype.slice.call(arguments, 0);\n    return function(cm, start) {\n      for (var i = 0; i < funcs.length; ++i) {\n        var found = funcs[i](cm, start);\n        if (found) return found;\n      }\n    };\n  });\n\n  CodeMirror.registerHelper(\"fold\", \"auto\", function(cm, start) {\n    var helpers = cm.getHelpers(start, \"fold\");\n    for (var i = 0; i < helpers.length; i++) {\n      var cur = helpers[i](cm, start);\n      if (cur) return cur;\n    }\n  });\n\n  var defaultOptions = {\n    rangeFinder: CodeMirror.fold.auto,\n    widget: \"\\u2194\",\n    minFoldSize: 0,\n    scanUp: false,\n    clearOnEnter: true\n  };\n\n  CodeMirror.defineOption(\"foldOptions\", null);\n\n  function getOption(cm, options, name) {\n    if (options && options[name] !== undefined)\n      return options[name];\n    var editorOptions = cm.options.foldOptions;\n    if (editorOptions && editorOptions[name] !== undefined)\n      return editorOptions[name];\n    return defaultOptions[name];\n  }\n\n  CodeMirror.defineExtension(\"foldOption\", function(options, name) {\n    return getOption(this, options, name);\n  });\n});\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./tab_view.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./tab_view.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./tab_view.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2018 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-tab-view {\\n  display: flex;\\n  flex-direction: column;\\n}\\n\\n.neuroglancer-tab-view-bar {\\n  display: block;\\n  background-color: #333;\\n  border-bottom: 1px solid white;\\n}\\n\\n.neuroglancer-tab-label {\\n  display: inline-block;\\n  border-top: 1px solid transparent;\\n  border-left: 1px solid transparent;\\n  border-right: 1px solid transparent;\\n  border-bottom: none;\\n  margin-right: 4px;\\n  padding-top: 1px;\\n  padding-left: 2px;\\n  padding-right: 2px;\\n  font: 10pt sans-serif;\\n  font-weight: bold;\\n  cursor: pointer;\\n}\\n.neuroglancer-tab-label:hover {\\n  color: #daa520;\\n}\\n\\n.neuroglancer-tab-label.neuroglancer-selected-tab-label {\\n  background-color: black;\\n  border-top: 1px solid white;\\n  border-left: 1px solid white;\\n  border-right: 1px solid white;\\n  border-bottom: 1px solid black;\\n  padding-bottom: 1px;\\n  margin-bottom: -1px;\\n}\\n\\n.neuroglancer-stack-view {\\n  display: flex;\\n  flex-direction: column;\\n}\\n\\n.neuroglancer-tab-view > .neuroglancer-stack-view {\\n  flex: 1;\\n  /*\\n  border-left: 1px solid white;\\n  border-right: 1px solid white;\\n  border-bottom: 1px solid white;\\n  */\\n  padding: 2px;\\n}\\n\\n.neuroglancer-tab-content {\\n  flex: 1;\\n}\\n\", \"\"]);\n\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./status.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./status.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./status.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n#statusContainer {\\n  position: fixed;\\n  bottom: 0px;\\n  z-index: 100;\\n  background-color: grey;\\n  color: white;\\n  margin: 0px;\\n  padding: 0px;\\n}\\n\\n#statusContainer li {\\n  width: 100vw;\\n  max-height: 25vh;\\n  overflow-y: auto;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./rendered_data_panel.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./rendered_data_panel.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./rendered_data_panel.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-rendered-data-panel {\\n  cursor: crosshair;\\n  position: relative;\\n  outline: 0;\\n  touch-action: none;\\n}\\n\", \"\"]);\n\n","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-noselect {\\n  -webkit-touch-callout: none;\\n  -webkit-user-select: none;\\n  -khtml-user-select: none;\\n  -moz-user-select: none;\\n  -ms-user-select: none;\\n  user-select: none;\\n}\\n\\n.neuroglancer-select-text {\\n  -webkit-touch-callout: default;\\n  -webkit-user-select: text;\\n  -khtml-user-select: text;\\n  -moz-user-select: text;\\n  -ms-user-select: text;\\n  user-select: text;\\n}\\n\", \"\"]);\n\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {BrainmapsDataSource, productionInstance} from 'neuroglancer/datasource/brainmaps/frontend';\nimport {credentialsKey} from 'neuroglancer/datasource/brainmaps/api';\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\n\nregisterProvider(\n    'brainmaps',\n    options => new BrainmapsDataSource(\n        productionInstance, options.credentialsManager.getCredentialsProvider(credentialsKey)));\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {BossDataSource} from 'neuroglancer/datasource/boss/frontend';\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\n\nregisterProvider('boss', options => new BossDataSource(options.credentialsManager));\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DVIDDataSource} from 'neuroglancer/datasource/dvid/frontend';\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\n\nregisterProvider('dvid', () => new DVIDDataSource());\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\nimport {RenderDataSource} from 'neuroglancer/datasource/render/frontend';\n\nregisterProvider('render', () => new RenderDataSource());\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {PrecomputedDataSource} from 'neuroglancer/datasource/precomputed/frontend';\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\n\nregisterProvider('precomputed', () => new PrecomputedDataSource());\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {NiftiDataSource} from 'neuroglancer/datasource/nifti/frontend';\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\n\nregisterProvider('nifti', () => new NiftiDataSource());\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\nimport {N5DataSource} from 'neuroglancer/datasource/n5/frontend';\n\nregisterProvider('n5', () => new N5DataSource());\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {ComputedDataSource} from 'neuroglancer/datasource/computed/frontend';\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\n\nif (true) {\n  registerProvider('computed', () => new ComputedDataSource());\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {ExampleComputationProvider} from 'neuroglancer/datasource/computed/example/frontend';\nimport {ComputedDataSource} from 'neuroglancer/datasource/computed/frontend';\n\nComputedDataSource.registerComputation('example', new ExampleComputationProvider());\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {ComputedDataSource} from 'neuroglancer/datasource/computed/frontend';\nimport {TensorflowComputationProvider} from 'neuroglancer/datasource/computed/tensorflow/frontend';\n\nComputedDataSource.registerComputation('tensorflow', new TensorflowComputationProvider());\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./overlay.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./overlay.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./overlay.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.overlay {\\n  height: 100%;\\n  width: 100%;\\n  position: fixed;\\n  z-index: 99;\\n  top: 0;\\n  left: 0;\\n  background-color: rgba(0, 0, 0, 0.8);\\n}\\n\\n.overlay-content {\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  transform: translate(-50%, -50%);\\n  background-color: white;\\n  z-index: 100;\\n  color: black;\\n  padding: 1em;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./annotations.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./annotations.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./annotations.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2018 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-annotations-tab {\\n  display: flex;\\n  align-items: flex-start;\\n  flex: 1;\\n  flex-direction: column;\\n}\\n\\n.neuroglancer-annotation-list { \\n  list-style-type: none;\\n  margin: 0px;\\n  padding: 5px;\\n  overflow-y: auto;\\n  height: 0px;\\n  flex: 1;\\n  flex-basis: 0px;\\n  min-height: 0px;\\n}\\n\\n.neuroglancer-annotation-layer-view {\\n  display: flex;\\n  flex-direction: column;\\n  flex: 1;\\n}\\n\\n.neuroglancer-annotations-stack {\\n  flex: 1;\\n  align-self: stretch;\\n}\\n\\n.neuroglancer-annotation-icon {\\n  position: absolute;\\n  left: 0px;\\n}\\n\\n.neuroglancer-annotation-description {\\n  text-overflow: ellipsis;\\n  overflow: hidden;\\n  white-space: nowrap;\\n}\\n\\n.neuroglancer-annotation-hover {\\n  background-color: #333;\\n}\\n\\n.neuroglancer-annotation-selected {\\n  outline: 1px solid #ccc;\\n}\\n\\n.neuroglancer-annotation-list > li {\\n  cursor: pointer;\\n  position: relative;\\n  padding-left: 1.5em;\\n}\\n\\n.neuroglancer-tab-content.neuroglancer-annotation-details {\\n  flex: 0 0 auto;\\n  align-self: stretch;\\n  display: flex;\\n  flex-direction: column;\\n\\n  -webkit-touch-callout: default;\\n  -webkit-user-select: text;\\n  -khtml-user-select: text;\\n  -moz-user-select: text;\\n  -ms-user-select: text;\\n  user-select: text;\\n}\\n\\n.neuroglancer-annotation-details-title {\\n  display: flex;\\n  flex-direction: row;\\n  background-color: #03c;\\n  align-self: stretch;\\n  padding: 2px;\\n}\\n\\n.neuroglancer-voxel-coordinates-link {\\n  cursor: pointer;\\n}\\n\\n.neuroglancer-voxel-coordinates-link:hover {\\n  background-color: #db4437;\\n}\\n\\n.neuroglancer-annotation-details-icon {\\n  display: inline-block;\\n  margin-right: 5px;\\n}\\n\\n.neuroglancer-annotation-details-title-text {\\n  display: inline-block;\\n  flex: 1;\\n}\\n\\n.neuroglancer-annotation-details-description {\\n  align-self: stretch;\\n  background-color: #222;\\n  color: white;\\n  font: 10pt sans-serif;\\n  border: 0px;\\n  outline: 0px;\\n  resize: none;\\n  overflow-y: scroll;\\n}\\n\\n.neuroglancer-annotation-details-position {\\n}\\n\\n.neuroglancer-annotation-toolbox {\\n  display: flex;\\n  align-items: stretch;\\n}\\n\\n.neuroglancer-annotation-segment-list {\\n}\\n\\n\\n.neuroglancer-annotation-segment-item {\\n  color: black;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./text_icon_button.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./text_icon_button.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./text_icon_button.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2018 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-icon-button {\\n  display: flex;\\n  flex-direction: row;\\n  align-self: center;\\n  border-radius: 50%;\\n  width: 18px;\\n  height: 18px;\\n  align-items: center;\\n  justify-content: center;\\n  color: white;\\n  font: 12px sans-serif;\\n  cursor: pointer;\\n  font-weight: 900;\\n}\\n\\n.neuroglancer-icon-button:hover {\\n  background-color: #db4437;\\n}\\n\\n.neuroglancer-icon-button div {\\n  display: inline-block;\\n  margin: -2px;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./range.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./range.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./range.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.range-slider {\\n  display: flex;\\n  flex-direction: row;\\n  white-space: nowrap;\\n  justify-content: space-between;\\n}\\n\\n.range-slider input[type='range'] {\\n}\\n\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./uint64_entry_widget.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./uint64_entry_widget.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./uint64_entry_widget.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.uint64-entry input {\\n  width: 19ch;\\n}\\n\\n.uint64-entry input.invalid-input {\\n  color: red;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./coordinate_transform.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./coordinate_transform.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./coordinate_transform.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2018 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-coordinate-transform-widget {\\n  display: flex;\\n  flex-direction: column;\\n  align-items: flex-start;\\n}\\n\\n.neuroglancer-coordinate-transform-widget-homogeneous {\\n  align-self: stretch;\\n  display: block;\\n}\\n\\n.neuroglancer-coordinate-transform-widget textarea {\\n  display: block;\\n  font-family: monospace;\\n  font-size: medium;\\n  margin-left: 1em;\\n  background-color: transparent;\\n  color: white;\\n  border: 0px;\\n  outline: 0px;\\n  resize: none;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./render_scale_widget.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./render_scale_widget.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./render_scale_widget.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2019 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-render-scale-widget {\\n  margin-top: 2px;\\n  margin-bottom: 2px;\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n}\\n\\n.neuroglancer-render-scale-widget-prompt {\\n  white-space: nowrap;\\n}\\n\\n.neuroglancer-render-scale-widget > canvas {\\n  height: 36px;\\n  flex: 1;\\n  flex-basis: 0px;\\n  width: 0px;\\n}\\n\\n\\n.neuroglancer-render-scale-widget-legend {\\n  width: 10ch;\\n  font-size: 11px;\\n  text-align: right;\\n}\\n\\n.neuroglancer-render-scale-widget-legend > div {\\n  height: 12px;\\n}\\n\", \"\"]);\n\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n  var GUTTER_ID = \"CodeMirror-lint-markers\";\n\n  function showTooltip(e, content) {\n    var tt = document.createElement(\"div\");\n    tt.className = \"CodeMirror-lint-tooltip\";\n    tt.appendChild(content.cloneNode(true));\n    document.body.appendChild(tt);\n\n    function position(e) {\n      if (!tt.parentNode) return CodeMirror.off(document, \"mousemove\", position);\n      tt.style.top = Math.max(0, e.clientY - tt.offsetHeight - 5) + \"px\";\n      tt.style.left = (e.clientX + 5) + \"px\";\n    }\n    CodeMirror.on(document, \"mousemove\", position);\n    position(e);\n    if (tt.style.opacity != null) tt.style.opacity = 1;\n    return tt;\n  }\n  function rm(elt) {\n    if (elt.parentNode) elt.parentNode.removeChild(elt);\n  }\n  function hideTooltip(tt) {\n    if (!tt.parentNode) return;\n    if (tt.style.opacity == null) rm(tt);\n    tt.style.opacity = 0;\n    setTimeout(function() { rm(tt); }, 600);\n  }\n\n  function showTooltipFor(e, content, node) {\n    var tooltip = showTooltip(e, content);\n    function hide() {\n      CodeMirror.off(node, \"mouseout\", hide);\n      if (tooltip) { hideTooltip(tooltip); tooltip = null; }\n    }\n    var poll = setInterval(function() {\n      if (tooltip) for (var n = node;; n = n.parentNode) {\n        if (n && n.nodeType == 11) n = n.host;\n        if (n == document.body) return;\n        if (!n) { hide(); break; }\n      }\n      if (!tooltip) return clearInterval(poll);\n    }, 400);\n    CodeMirror.on(node, \"mouseout\", hide);\n  }\n\n  function LintState(cm, options, hasGutter) {\n    this.marked = [];\n    this.options = options;\n    this.timeout = null;\n    this.hasGutter = hasGutter;\n    this.onMouseOver = function(e) { onMouseOver(cm, e); };\n    this.waitingFor = 0\n  }\n\n  function parseOptions(_cm, options) {\n    if (options instanceof Function) return {getAnnotations: options};\n    if (!options || options === true) options = {};\n    return options;\n  }\n\n  function clearMarks(cm) {\n    var state = cm.state.lint;\n    if (state.hasGutter) cm.clearGutter(GUTTER_ID);\n    for (var i = 0; i < state.marked.length; ++i)\n      state.marked[i].clear();\n    state.marked.length = 0;\n  }\n\n  function makeMarker(labels, severity, multiple, tooltips) {\n    var marker = document.createElement(\"div\"), inner = marker;\n    marker.className = \"CodeMirror-lint-marker-\" + severity;\n    if (multiple) {\n      inner = marker.appendChild(document.createElement(\"div\"));\n      inner.className = \"CodeMirror-lint-marker-multiple\";\n    }\n\n    if (tooltips != false) CodeMirror.on(inner, \"mouseover\", function(e) {\n      showTooltipFor(e, labels, inner);\n    });\n\n    return marker;\n  }\n\n  function getMaxSeverity(a, b) {\n    if (a == \"error\") return a;\n    else return b;\n  }\n\n  function groupByLine(annotations) {\n    var lines = [];\n    for (var i = 0; i < annotations.length; ++i) {\n      var ann = annotations[i], line = ann.from.line;\n      (lines[line] || (lines[line] = [])).push(ann);\n    }\n    return lines;\n  }\n\n  function annotationTooltip(ann) {\n    var severity = ann.severity;\n    if (!severity) severity = \"error\";\n    var tip = document.createElement(\"div\");\n    tip.className = \"CodeMirror-lint-message-\" + severity;\n    if (typeof ann.messageHTML != 'undefined') {\n        tip.innerHTML = ann.messageHTML;\n    } else {\n        tip.appendChild(document.createTextNode(ann.message));\n    }\n    return tip;\n  }\n\n  function lintAsync(cm, getAnnotations, passOptions) {\n    var state = cm.state.lint\n    var id = ++state.waitingFor\n    function abort() {\n      id = -1\n      cm.off(\"change\", abort)\n    }\n    cm.on(\"change\", abort)\n    getAnnotations(cm.getValue(), function(annotations, arg2) {\n      cm.off(\"change\", abort)\n      if (state.waitingFor != id) return\n      if (arg2 && annotations instanceof CodeMirror) annotations = arg2\n      cm.operation(function() {updateLinting(cm, annotations)})\n    }, passOptions, cm);\n  }\n\n  function startLinting(cm) {\n    var state = cm.state.lint, options = state.options;\n    /*\n     * Passing rules in `options` property prevents JSHint (and other linters) from complaining\n     * about unrecognized rules like `onUpdateLinting`, `delay`, `lintOnChange`, etc.\n     */\n    var passOptions = options.options || options;\n    var getAnnotations = options.getAnnotations || cm.getHelper(CodeMirror.Pos(0, 0), \"lint\");\n    if (!getAnnotations) return;\n    if (options.async || getAnnotations.async) {\n      lintAsync(cm, getAnnotations, passOptions)\n    } else {\n      var annotations = getAnnotations(cm.getValue(), passOptions, cm);\n      if (!annotations) return;\n      if (annotations.then) annotations.then(function(issues) {\n        cm.operation(function() {updateLinting(cm, issues)})\n      });\n      else cm.operation(function() {updateLinting(cm, annotations)})\n    }\n  }\n\n  function updateLinting(cm, annotationsNotSorted) {\n    clearMarks(cm);\n    var state = cm.state.lint, options = state.options;\n\n    var annotations = groupByLine(annotationsNotSorted);\n\n    for (var line = 0; line < annotations.length; ++line) {\n      var anns = annotations[line];\n      if (!anns) continue;\n\n      var maxSeverity = null;\n      var tipLabel = state.hasGutter && document.createDocumentFragment();\n\n      for (var i = 0; i < anns.length; ++i) {\n        var ann = anns[i];\n        var severity = ann.severity;\n        if (!severity) severity = \"error\";\n        maxSeverity = getMaxSeverity(maxSeverity, severity);\n\n        if (options.formatAnnotation) ann = options.formatAnnotation(ann);\n        if (state.hasGutter) tipLabel.appendChild(annotationTooltip(ann));\n\n        if (ann.to) state.marked.push(cm.markText(ann.from, ann.to, {\n          className: \"CodeMirror-lint-mark-\" + severity,\n          __annotation: ann\n        }));\n      }\n\n      if (state.hasGutter)\n        cm.setGutterMarker(line, GUTTER_ID, makeMarker(tipLabel, maxSeverity, anns.length > 1,\n                                                       state.options.tooltips));\n    }\n    if (options.onUpdateLinting) options.onUpdateLinting(annotationsNotSorted, annotations, cm);\n  }\n\n  function onChange(cm) {\n    var state = cm.state.lint;\n    if (!state) return;\n    clearTimeout(state.timeout);\n    state.timeout = setTimeout(function(){startLinting(cm);}, state.options.delay || 500);\n  }\n\n  function popupTooltips(annotations, e) {\n    var target = e.target || e.srcElement;\n    var tooltip = document.createDocumentFragment();\n    for (var i = 0; i < annotations.length; i++) {\n      var ann = annotations[i];\n      tooltip.appendChild(annotationTooltip(ann));\n    }\n    showTooltipFor(e, tooltip, target);\n  }\n\n  function onMouseOver(cm, e) {\n    var target = e.target || e.srcElement;\n    if (!/\\bCodeMirror-lint-mark-/.test(target.className)) return;\n    var box = target.getBoundingClientRect(), x = (box.left + box.right) / 2, y = (box.top + box.bottom) / 2;\n    var spans = cm.findMarksAt(cm.coordsChar({left: x, top: y}, \"client\"));\n\n    var annotations = [];\n    for (var i = 0; i < spans.length; ++i) {\n      var ann = spans[i].__annotation;\n      if (ann) annotations.push(ann);\n    }\n    if (annotations.length) popupTooltips(annotations, e);\n  }\n\n  CodeMirror.defineOption(\"lint\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      clearMarks(cm);\n      if (cm.state.lint.options.lintOnChange !== false)\n        cm.off(\"change\", onChange);\n      CodeMirror.off(cm.getWrapperElement(), \"mouseover\", cm.state.lint.onMouseOver);\n      clearTimeout(cm.state.lint.timeout);\n      delete cm.state.lint;\n    }\n\n    if (val) {\n      var gutters = cm.getOption(\"gutters\"), hasLintGutter = false;\n      for (var i = 0; i < gutters.length; ++i) if (gutters[i] == GUTTER_ID) hasLintGutter = true;\n      var state = cm.state.lint = new LintState(cm, parseOptions(cm, val), hasLintGutter);\n      if (state.options.lintOnChange !== false)\n        cm.on(\"change\", onChange);\n      if (state.options.tooltips != false && state.options.tooltips != \"gutter\")\n        CodeMirror.on(cm.getWrapperElement(), \"mouseover\", state.onMouseOver);\n\n      startLinting(cm);\n    }\n  });\n\n  CodeMirror.defineExtension(\"performLint\", function() {\n    if (this.state.lint) startLinting(this);\n  });\n});\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./shader_code_widget.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./shader_code_widget.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./shader_code_widget.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-shader-code-widget.invalid-input {\\n  border: 1px solid red;\\n}\\n\\n.neuroglancer-shader-code-widget.valid-input {\\n  border: 1px solid green;\\n}\\n\", \"\"]);\n\n","exports = module.exports = require(\"../../css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/* BASICS */\\n\\n.CodeMirror {\\n  /* Set height, width, borders, and global font properties here */\\n  font-family: monospace;\\n  height: 300px;\\n  color: black;\\n  direction: ltr;\\n}\\n\\n/* PADDING */\\n\\n.CodeMirror-lines {\\n  padding: 4px 0; /* Vertical padding around content */\\n}\\n.CodeMirror pre {\\n  padding: 0 4px; /* Horizontal padding of content */\\n}\\n\\n.CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {\\n  background-color: white; /* The little square between H and V scrollbars */\\n}\\n\\n/* GUTTER */\\n\\n.CodeMirror-gutters {\\n  border-right: 1px solid #ddd;\\n  background-color: #f7f7f7;\\n  white-space: nowrap;\\n}\\n.CodeMirror-linenumbers {}\\n.CodeMirror-linenumber {\\n  padding: 0 3px 0 5px;\\n  min-width: 20px;\\n  text-align: right;\\n  color: #999;\\n  white-space: nowrap;\\n}\\n\\n.CodeMirror-guttermarker { color: black; }\\n.CodeMirror-guttermarker-subtle { color: #999; }\\n\\n/* CURSOR */\\n\\n.CodeMirror-cursor {\\n  border-left: 1px solid black;\\n  border-right: none;\\n  width: 0;\\n}\\n/* Shown when moving in bi-directional text */\\n.CodeMirror div.CodeMirror-secondarycursor {\\n  border-left: 1px solid silver;\\n}\\n.cm-fat-cursor .CodeMirror-cursor {\\n  width: auto;\\n  border: 0 !important;\\n  background: #7e7;\\n}\\n.cm-fat-cursor div.CodeMirror-cursors {\\n  z-index: 1;\\n}\\n.cm-fat-cursor-mark {\\n  background-color: rgba(20, 255, 20, 0.5);\\n  -webkit-animation: blink 1.06s steps(1) infinite;\\n  -moz-animation: blink 1.06s steps(1) infinite;\\n  animation: blink 1.06s steps(1) infinite;\\n}\\n.cm-animate-fat-cursor {\\n  width: auto;\\n  border: 0;\\n  -webkit-animation: blink 1.06s steps(1) infinite;\\n  -moz-animation: blink 1.06s steps(1) infinite;\\n  animation: blink 1.06s steps(1) infinite;\\n  background-color: #7e7;\\n}\\n@-moz-keyframes blink {\\n  0% {}\\n  50% { background-color: transparent; }\\n  100% {}\\n}\\n@-webkit-keyframes blink {\\n  0% {}\\n  50% { background-color: transparent; }\\n  100% {}\\n}\\n@keyframes blink {\\n  0% {}\\n  50% { background-color: transparent; }\\n  100% {}\\n}\\n\\n/* Can style cursor different in overwrite (non-insert) mode */\\n.CodeMirror-overwrite .CodeMirror-cursor {}\\n\\n.cm-tab { display: inline-block; text-decoration: inherit; }\\n\\n.CodeMirror-rulers {\\n  position: absolute;\\n  left: 0; right: 0; top: -50px; bottom: -20px;\\n  overflow: hidden;\\n}\\n.CodeMirror-ruler {\\n  border-left: 1px solid #ccc;\\n  top: 0; bottom: 0;\\n  position: absolute;\\n}\\n\\n/* DEFAULT THEME */\\n\\n.cm-s-default .cm-header {color: blue;}\\n.cm-s-default .cm-quote {color: #090;}\\n.cm-negative {color: #d44;}\\n.cm-positive {color: #292;}\\n.cm-header, .cm-strong {font-weight: bold;}\\n.cm-em {font-style: italic;}\\n.cm-link {text-decoration: underline;}\\n.cm-strikethrough {text-decoration: line-through;}\\n\\n.cm-s-default .cm-keyword {color: #708;}\\n.cm-s-default .cm-atom {color: #219;}\\n.cm-s-default .cm-number {color: #164;}\\n.cm-s-default .cm-def {color: #00f;}\\n.cm-s-default .cm-variable,\\n.cm-s-default .cm-punctuation,\\n.cm-s-default .cm-property,\\n.cm-s-default .cm-operator {}\\n.cm-s-default .cm-variable-2 {color: #05a;}\\n.cm-s-default .cm-variable-3, .cm-s-default .cm-type {color: #085;}\\n.cm-s-default .cm-comment {color: #a50;}\\n.cm-s-default .cm-string {color: #a11;}\\n.cm-s-default .cm-string-2 {color: #f50;}\\n.cm-s-default .cm-meta {color: #555;}\\n.cm-s-default .cm-qualifier {color: #555;}\\n.cm-s-default .cm-builtin {color: #30a;}\\n.cm-s-default .cm-bracket {color: #997;}\\n.cm-s-default .cm-tag {color: #170;}\\n.cm-s-default .cm-attribute {color: #00c;}\\n.cm-s-default .cm-hr {color: #999;}\\n.cm-s-default .cm-link {color: #00c;}\\n\\n.cm-s-default .cm-error {color: #f00;}\\n.cm-invalidchar {color: #f00;}\\n\\n.CodeMirror-composing { border-bottom: 2px solid; }\\n\\n/* Default styles for common addons */\\n\\ndiv.CodeMirror span.CodeMirror-matchingbracket {color: #0b0;}\\ndiv.CodeMirror span.CodeMirror-nonmatchingbracket {color: #a22;}\\n.CodeMirror-matchingtag { background: rgba(255, 150, 0, .3); }\\n.CodeMirror-activeline-background {background: #e8f2ff;}\\n\\n/* STOP */\\n\\n/* The rest of this file contains styles related to the mechanics of\\n   the editor. You probably shouldn't touch them. */\\n\\n.CodeMirror {\\n  position: relative;\\n  overflow: hidden;\\n  background: white;\\n}\\n\\n.CodeMirror-scroll {\\n  overflow: scroll !important; /* Things will break if this is overridden */\\n  /* 30px is the magic margin used to hide the element's real scrollbars */\\n  /* See overflow: hidden in .CodeMirror */\\n  margin-bottom: -30px; margin-right: -30px;\\n  padding-bottom: 30px;\\n  height: 100%;\\n  outline: none; /* Prevent dragging from highlighting the element */\\n  position: relative;\\n}\\n.CodeMirror-sizer {\\n  position: relative;\\n  border-right: 30px solid transparent;\\n}\\n\\n/* The fake, visible scrollbars. Used to force redraw during scrolling\\n   before actual scrolling happens, thus preventing shaking and\\n   flickering artifacts. */\\n.CodeMirror-vscrollbar, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {\\n  position: absolute;\\n  z-index: 6;\\n  display: none;\\n}\\n.CodeMirror-vscrollbar {\\n  right: 0; top: 0;\\n  overflow-x: hidden;\\n  overflow-y: scroll;\\n}\\n.CodeMirror-hscrollbar {\\n  bottom: 0; left: 0;\\n  overflow-y: hidden;\\n  overflow-x: scroll;\\n}\\n.CodeMirror-scrollbar-filler {\\n  right: 0; bottom: 0;\\n}\\n.CodeMirror-gutter-filler {\\n  left: 0; bottom: 0;\\n}\\n\\n.CodeMirror-gutters {\\n  position: absolute; left: 0; top: 0;\\n  min-height: 100%;\\n  z-index: 3;\\n}\\n.CodeMirror-gutter {\\n  white-space: normal;\\n  height: 100%;\\n  display: inline-block;\\n  vertical-align: top;\\n  margin-bottom: -30px;\\n}\\n.CodeMirror-gutter-wrapper {\\n  position: absolute;\\n  z-index: 4;\\n  background: none !important;\\n  border: none !important;\\n}\\n.CodeMirror-gutter-background {\\n  position: absolute;\\n  top: 0; bottom: 0;\\n  z-index: 4;\\n}\\n.CodeMirror-gutter-elt {\\n  position: absolute;\\n  cursor: default;\\n  z-index: 4;\\n}\\n.CodeMirror-gutter-wrapper ::selection { background-color: transparent }\\n.CodeMirror-gutter-wrapper ::-moz-selection { background-color: transparent }\\n\\n.CodeMirror-lines {\\n  cursor: text;\\n  min-height: 1px; /* prevents collapsing before first draw */\\n}\\n.CodeMirror pre {\\n  /* Reset some styles that the rest of the page might have set */\\n  -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0;\\n  border-width: 0;\\n  background: transparent;\\n  font-family: inherit;\\n  font-size: inherit;\\n  margin: 0;\\n  white-space: pre;\\n  word-wrap: normal;\\n  line-height: inherit;\\n  color: inherit;\\n  z-index: 2;\\n  position: relative;\\n  overflow: visible;\\n  -webkit-tap-highlight-color: transparent;\\n  -webkit-font-variant-ligatures: contextual;\\n  font-variant-ligatures: contextual;\\n}\\n.CodeMirror-wrap pre {\\n  word-wrap: break-word;\\n  white-space: pre-wrap;\\n  word-break: normal;\\n}\\n\\n.CodeMirror-linebackground {\\n  position: absolute;\\n  left: 0; right: 0; top: 0; bottom: 0;\\n  z-index: 0;\\n}\\n\\n.CodeMirror-linewidget {\\n  position: relative;\\n  z-index: 2;\\n  padding: 0.1px; /* Force widget margins to stay inside of the container */\\n}\\n\\n.CodeMirror-widget {}\\n\\n.CodeMirror-rtl pre { direction: rtl; }\\n\\n.CodeMirror-code {\\n  outline: none;\\n}\\n\\n/* Force content-box sizing for the elements where we expect it */\\n.CodeMirror-scroll,\\n.CodeMirror-sizer,\\n.CodeMirror-gutter,\\n.CodeMirror-gutters,\\n.CodeMirror-linenumber {\\n  -moz-box-sizing: content-box;\\n  box-sizing: content-box;\\n}\\n\\n.CodeMirror-measure {\\n  position: absolute;\\n  width: 100%;\\n  height: 0;\\n  overflow: hidden;\\n  visibility: hidden;\\n}\\n\\n.CodeMirror-cursor {\\n  position: absolute;\\n  pointer-events: none;\\n}\\n.CodeMirror-measure pre { position: static; }\\n\\ndiv.CodeMirror-cursors {\\n  visibility: hidden;\\n  position: relative;\\n  z-index: 3;\\n}\\ndiv.CodeMirror-dragcursors {\\n  visibility: visible;\\n}\\n\\n.CodeMirror-focused div.CodeMirror-cursors {\\n  visibility: visible;\\n}\\n\\n.CodeMirror-selected { background: #d9d9d9; }\\n.CodeMirror-focused .CodeMirror-selected { background: #d7d4f0; }\\n.CodeMirror-crosshair { cursor: crosshair; }\\n.CodeMirror-line::selection, .CodeMirror-line > span::selection, .CodeMirror-line > span > span::selection { background: #d7d4f0; }\\n.CodeMirror-line::-moz-selection, .CodeMirror-line > span::-moz-selection, .CodeMirror-line > span > span::-moz-selection { background: #d7d4f0; }\\n\\n.cm-searching {\\n  background-color: #ffa;\\n  background-color: rgba(255, 255, 0, .4);\\n}\\n\\n/* Used to force a border model for a node */\\n.cm-force-border { padding-right: .1px; }\\n\\n@media print {\\n  /* Hide the cursor when printing */\\n  .CodeMirror div.CodeMirror-cursors {\\n    visibility: hidden;\\n  }\\n}\\n\\n/* See issue #2901 */\\n.cm-tab-wrap-hack:after { content: ''; }\\n\\n/* Help users use markselection to safely style text background */\\nspan.CodeMirror-selectedtext { background: none; }\\n\", \"\"]);\n\n","exports = module.exports = require(\"../../../css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/* The lint marker gutter */\\n.CodeMirror-lint-markers {\\n  width: 16px;\\n}\\n\\n.CodeMirror-lint-tooltip {\\n  background-color: #ffd;\\n  border: 1px solid black;\\n  border-radius: 4px 4px 4px 4px;\\n  color: black;\\n  font-family: monospace;\\n  font-size: 10pt;\\n  overflow: hidden;\\n  padding: 2px 5px;\\n  position: fixed;\\n  white-space: pre;\\n  white-space: pre-wrap;\\n  z-index: 100;\\n  max-width: 600px;\\n  opacity: 0;\\n  transition: opacity .4s;\\n  -moz-transition: opacity .4s;\\n  -webkit-transition: opacity .4s;\\n  -o-transition: opacity .4s;\\n  -ms-transition: opacity .4s;\\n}\\n\\n.CodeMirror-lint-mark-error, .CodeMirror-lint-mark-warning {\\n  background-position: left bottom;\\n  background-repeat: repeat-x;\\n}\\n\\n.CodeMirror-lint-mark-error {\\n  background-image:\\n  url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAYAAAC09K7GAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sJDw4cOCW1/KIAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAHElEQVQI12NggIL/DAz/GdA5/xkY/qPKMDAwAADLZwf5rvm+LQAAAABJRU5ErkJggg==\\\")\\n  ;\\n}\\n\\n.CodeMirror-lint-mark-warning {\\n  background-image: url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAYAAAC09K7GAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sJFhQXEbhTg7YAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAMklEQVQI12NkgIIvJ3QXMjAwdDN+OaEbysDA4MPAwNDNwMCwiOHLCd1zX07o6kBVGQEAKBANtobskNMAAAAASUVORK5CYII=\\\");\\n}\\n\\n.CodeMirror-lint-marker-error, .CodeMirror-lint-marker-warning {\\n  background-position: center center;\\n  background-repeat: no-repeat;\\n  cursor: pointer;\\n  display: inline-block;\\n  height: 16px;\\n  width: 16px;\\n  vertical-align: middle;\\n  position: relative;\\n}\\n\\n.CodeMirror-lint-message-error, .CodeMirror-lint-message-warning {\\n  padding-left: 18px;\\n  background-position: top left;\\n  background-repeat: no-repeat;\\n}\\n\\n.CodeMirror-lint-marker-error, .CodeMirror-lint-message-error {\\n  background-image: url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAHlBMVEW7AAC7AACxAAC7AAC7AAAAAAC4AAC5AAD///+7AAAUdclpAAAABnRSTlMXnORSiwCK0ZKSAAAATUlEQVR42mWPOQ7AQAgDuQLx/z8csYRmPRIFIwRGnosRrpamvkKi0FTIiMASR3hhKW+hAN6/tIWhu9PDWiTGNEkTtIOucA5Oyr9ckPgAWm0GPBog6v4AAAAASUVORK5CYII=\\\");\\n}\\n\\n.CodeMirror-lint-marker-warning, .CodeMirror-lint-message-warning {\\n  background-image: url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAANlBMVEX/uwDvrwD/uwD/uwD/uwD/uwD/uwD/uwD/uwD6twD/uwAAAADurwD2tQD7uAD+ugAAAAD/uwDhmeTRAAAADHRSTlMJ8mN1EYcbmiixgACm7WbuAAAAVklEQVR42n3PUQqAIBBFUU1LLc3u/jdbOJoW1P08DA9Gba8+YWJ6gNJoNYIBzAA2chBth5kLmG9YUoG0NHAUwFXwO9LuBQL1giCQb8gC9Oro2vp5rncCIY8L8uEx5ZkAAAAASUVORK5CYII=\\\");\\n}\\n\\n.CodeMirror-lint-marker-multiple {\\n  background-image: url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAMAAADzjKfhAAAACVBMVEUAAAAAAAC/v7914kyHAAAAAXRSTlMAQObYZgAAACNJREFUeNo1ioEJAAAIwmz/H90iFFSGJgFMe3gaLZ0od+9/AQZ0ADosbYraAAAAAElFTkSuQmCC\\\");\\n  background-repeat: no-repeat;\\n  background-position: right bottom;\\n  width: 100%; height: 100%;\\n}\\n\", \"\"]);\n\n","module.exports = function(CodeMirror) {\n  CodeMirror.defineMode(\"glsl\", function(config, parserConfig) {\n    var indentUnit = config.indentUnit,\n        keywords = parserConfig.keywords || words(glslKeywords),\n        builtins = parserConfig.builtins || words(glslBuiltins),\n        blockKeywords = parserConfig.blockKeywords || words(\"case do else for if switch while struct\"),\n        atoms = parserConfig.atoms || words(\"null\"),\n        hooks = parserConfig.hooks || {},\n        multiLineStrings = parserConfig.multiLineStrings;\n    var isOperatorChar = /[+\\-*&%=<>!?|\\/]/;\n\n    var curPunc;\n\n    function tokenBase(stream, state) {\n      var ch = stream.next();\n      if (hooks[ch]) {\n        var result = hooks[ch](stream, state);\n        if (result !== false) return result;\n      }\n      if (ch == '\"' || ch == \"'\") {\n        state.tokenize = tokenString(ch);\n        return state.tokenize(stream, state);\n      }\n      if (/[\\[\\]{}\\(\\),;\\:\\.]/.test(ch)) {\n        curPunc = ch;\n        return \"bracket\";\n      }\n      if (/\\d/.test(ch)) {\n        stream.eatWhile(/[\\w\\.]/);\n        return \"number\";\n      }\n      if (ch == \"/\") {\n        if (stream.eat(\"*\")) {\n          state.tokenize = tokenComment;\n          return tokenComment(stream, state);\n        }\n        if (stream.eat(\"/\")) {\n          stream.skipToEnd();\n          return \"comment\";\n        }\n      }\n      if (ch == \"#\") {\n        stream.eatWhile(/[\\S]+/);\n        stream.eatWhile(/[\\s]+/);\n        stream.eatWhile(/[\\S]+/);\n        stream.eatWhile(/[\\s]+/);\n        return \"comment\";\n      }\n      if (isOperatorChar.test(ch)) {\n        stream.eatWhile(isOperatorChar);\n        return \"operator\";\n      }\n      stream.eatWhile(/[\\w\\$_]/);\n      var cur = stream.current();\n      if (keywords.propertyIsEnumerable(cur)) {\n        if (blockKeywords.propertyIsEnumerable(cur)) curPunc = \"newstatement\";\n        return \"keyword\";\n      }\n      if (builtins.propertyIsEnumerable(cur)) {\n        return \"builtin\";\n      }\n      if (atoms.propertyIsEnumerable(cur)) return \"atom\";\n      return \"word\";\n    }\n\n    function tokenString(quote) {\n      return function(stream, state) {\n        var escaped = false, next, end = false;\n        while ((next = stream.next()) != null) {\n          if (next == quote && !escaped) {end = true; break;}\n          escaped = !escaped && next == \"\\\\\";\n        }\n        if (end || !(escaped || multiLineStrings))\n          state.tokenize = tokenBase;\n        return \"string\";\n      };\n    }\n\n    function tokenComment(stream, state) {\n      var maybeEnd = false, ch;\n      while (ch = stream.next()) {\n        if (ch == \"/\" && maybeEnd) {\n          state.tokenize = tokenBase;\n          break;\n        }\n        maybeEnd = (ch == \"*\");\n      }\n      return \"comment\";\n    }\n\n    function Context(indented, column, type, align, prev) {\n      this.indented = indented;\n      this.column = column;\n      this.type = type;\n      this.align = align;\n      this.prev = prev;\n    }\n    function pushContext(state, col, type) {\n      return state.context = new Context(state.indented, col, type, null, state.context);\n    }\n    function popContext(state) {\n      var t = state.context.type;\n      if (t == \")\" || t == \"]\" || t == \"}\")\n        state.indented = state.context.indented;\n      return state.context = state.context.prev;\n    }\n\n    // Interface\n\n    return {\n      startState: function(basecolumn) {\n        return {\n          tokenize: null,\n          context: new Context((basecolumn || 0) - indentUnit, 0, \"top\", false),\n          indented: 0,\n          startOfLine: true\n        };\n      },\n\n      token: function(stream, state) {\n        var ctx = state.context;\n        if (stream.sol()) {\n          if (ctx.align == null) ctx.align = false;\n          state.indented = stream.indentation();\n          state.startOfLine = true;\n        }\n        if (stream.eatSpace()) return null;\n        curPunc = null;\n        var style = (state.tokenize || tokenBase)(stream, state);\n        if (style == \"comment\" || style == \"meta\") return style;\n        if (ctx.align == null) ctx.align = true;\n\n        if ((curPunc == \";\" || curPunc == \":\") && ctx.type == \"statement\") popContext(state);\n        else if (curPunc == \"{\") pushContext(state, stream.column(), \"}\");\n        else if (curPunc == \"[\") pushContext(state, stream.column(), \"]\");\n        else if (curPunc == \"(\") pushContext(state, stream.column(), \")\");\n        else if (curPunc == \"}\") {\n          while (ctx.type == \"statement\") ctx = popContext(state);\n          if (ctx.type == \"}\") ctx = popContext(state);\n          while (ctx.type == \"statement\") ctx = popContext(state);\n        }\n        else if (curPunc == ctx.type) popContext(state);\n        else if (ctx.type == \"}\" || ctx.type == \"top\" || (ctx.type == \"statement\" && curPunc == \"newstatement\"))\n          pushContext(state, stream.column(), \"statement\");\n        state.startOfLine = false;\n        return style;\n      },\n\n      indent: function(state, textAfter) {\n        if (state.tokenize != tokenBase && state.tokenize != null) return 0;\n        var firstChar = textAfter && textAfter.charAt(0), ctx = state.context, closing = firstChar == ctx.type;\n        if (ctx.type == \"statement\") return ctx.indented + (firstChar == \"{\" ? 0 : indentUnit);\n        else if (ctx.align) return ctx.column + (closing ? 0 : 1);\n        else return ctx.indented + (closing ? 0 : indentUnit);\n      },\n\n      electricChars: \"{}\"\n    };\n  });\n\n  function words(str) {\n    var obj = {}, words = str.split(\" \");\n    for (var i = 0; i < words.length; ++i) obj[words[i]] = true;\n    return obj;\n  }\n  var glslKeywords = \"attribute const uniform varying break continue \" +\n    \"do for while if else in out inout float int void bool true false \" +\n    \"lowp mediump highp precision invariant discard return mat2 mat3 \" +\n    \"mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler2D \" +\n    \"samplerCube struct gl_FragCoord gl_FragColor\";\n  var glslBuiltins = \"radians degrees sin cos tan asin acos atan pow \" +\n    \"exp log exp2 log2 sqrt inversesqrt abs sign floor ceil fract mod \" +\n    \"min max clamp mix step smoothstep length distance dot cross \" +\n    \"normalize faceforward reflect refract matrixCompMult lessThan \" +\n    \"lessThanEqual greaterThan greaterThanEqual equal notEqual any all \" +\n    \"not dFdx dFdy fwidth texture2D texture2DProj texture2DLod \" +\n    \"texture2DProjLod textureCube textureCubeLod require export\";\n\n  function cppHook(stream, state) {\n    if (!state.startOfLine) return false;\n    stream.skipToEnd();\n    return \"meta\";\n  }\n\n  ;(function() {\n    // C#-style strings where \"\" escapes a quote.\n    function tokenAtString(stream, state) {\n      var next;\n      while ((next = stream.next()) != null) {\n        if (next == '\"' && !stream.eat('\"')) {\n          state.tokenize = null;\n          break;\n        }\n      }\n      return \"string\";\n    }\n\n    CodeMirror.defineMIME(\"text/x-glsl\", {\n      name: \"glsl\",\n      keywords: words(glslKeywords),\n      builtins: words(glslBuiltins),\n      blockKeywords: words(\"case do else for if switch while struct\"),\n      atoms: words(\"null\"),\n      hooks: {\"#\": cppHook}\n    });\n  }());\n}\n","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.image-dropdown .neuroglancer-shader-code-widget {\\n  height: 6em;\\n  /* width: 60ch; */\\n  border: 1px solid transparent;\\n}\\n\\n.image-dropdown-top-row {\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n}\\n\\n/* .image-dropdown-top-row .range-slider {\\n  flex: 1;\\n} */\\n\\n.image-layer-shader-overlay .neuroglancer-shader-code-widget {\\n  width: 80vw;\\n  height: 80vh;\\n}\\n\\n.neuroglancer-segmentation-dropdown-skeleton-shader-header {\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n}\\n\", \"\"]);\n\n","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.maximize-button {\\n  font-weight: bold;\\n  margin-right: 2px;\\n  margin-left: 2px;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./vec3.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./vec3.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./vec3.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2017 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.vec3-input-row {\\n  display: flex;\\n  flex-direction: row;\\n  white-space: nowrap;\\n  justify-content: space-between;\\n}\\n\\n.vec3-input-label {\\n    padding-right: 50px;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./segmentation_user_layer.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./segmentation_user_layer.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./segmentation_user_layer.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.segmentation-dropdown .add-segment label::before {\\n  content: \\\"+ \\\";\\n  font-weight: bold;\\n}\\n\\n.segmentation-dropdown {\\n  display: flex;\\n  flex-direction: column;\\n}\\n\\n.segmentation-dropdown .add-segment {\\n  margin-bottom: 5px;\\n}\\n\\n.segmentation-dropdown .neuroglancer-shader-code-widget {\\n  height: 6em;\\n  width: 60ch;\\n  border: 1px solid transparent;\\n}\\n\\n.neuroglancer-segmentation-layer-skeleton-shader-overlay .neuroglancer-shader-code-widget {\\n  width: 80vw;\\n  height: 80vh;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./segment_set_widget.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./segment_set_widget.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./segment_set_widget.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.segment-set-widget button {\\n  margin: 3px;\\n}\\n\\n.segment-set-widget {\\n  flex: 1;\\n  overflow-y: auto;\\n  height: 0px;\\n  min-height: 0px;\\n  flex-basis: 0px;\\n}\\n\\n.segment-set-widget .item-container {\\n  flex: 1;\\n  display: flex;\\n  flex-wrap: wrap;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./single_mesh_user_layer.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./single_mesh_user_layer.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./single_mesh_user_layer.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-single-mesh-dropdown .neuroglancer-single-mesh-attribute-widget {\\n  max-height: 6em;\\n}\\n\\n.neuroglancer-single-mesh-dropdown .neuroglancer-shader-code-widget {\\n  height: 6em;\\n  width: 60ch;\\n  border: 1px solid transparent;\\n}\\n\\n.neuroglancer-single-mesh-dropdown-top-row {\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n}\\n\\n.neuroglancer-single-mesh-shader-overlay .neuroglancer-shader-code-widget {\\n  width: 80vw;\\n  height: 80vh;\\n}\\n\\n.neuroglancer-single-mesh-attribute-widget {\\n  word-wrap: break-word;\\n  overflow-y: auto;\\n  width: 60ch;\\n}\\n\\n.neuroglancer-single-mesh-layer-shader-overlay .neuroglancer-single-mesh-attribute-widget {\\n  max-height: 20vh;\\n}\\n\\n.neuroglancer-single-mesh-attribute {\\n  font-family: monospace;\\n  display: flex;\\n  flex-direction: row;\\n}\\n\\n.neuroglancer-single-mesh-attribute-range {\\n  white-space: nowrap;\\n}\\n\\n.neuroglancer-single-mesh-attribute input {\\n  font-family: monospace;\\n  margin-left: 1ch;\\n  flex: 1;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./user_layer.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./user_layer.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./user_layer.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-annotation-point-list-dropdown {\\n  display: flex;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./default_viewer.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./default_viewer.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./default_viewer.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\nhtml, body {\\n  margin: 0px;\\n  padding: 0px;\\n  overflow: hidden;\\n  width: 100vw;\\n  height: 100vh;\\n  background-color: black;\\n  color: white;\\n}\\n\\nbody {\\n  position: relative;\\n  display: flex;\\n  flex-direction: column;\\n}\\n\\n#neuroglancer-container {\\n  width: 100vw;\\n  flex: 1;\\n}\\n\", \"\"]);\n\n","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2017 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n/* This pseudo-element is needed to make the content of the main button element centered.  See\\n * https://stackoverflow.com/a/24685032.\\n */\\n.neuroglancer-button:before {\\n  content: '';\\n  display: inline-block;\\n  vertical-align: middle;\\n  height: 100%;\\n}\\n\\n.neuroglancer-button {\\n  display: inline-block;\\n  color: black;\\n  background-color: #ddd;\\n  border-style: outset;\\n  border-width: 1px;\\n  font-family: sans-serif;\\n  font-size: 10pt;\\n  padding-left: 5px;\\n  padding-right: 5px;\\n  vertical-align: middle;\\n  cursor: default;\\n}\\n.neuroglancer-button:active {\\n  border-style: inset;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./data_panel_layout.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./data_panel_layout.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./data_panel_layout.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2019 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-data-panel-layout-controls {\\n  position: absolute;\\n  top: 2px;\\n  right: 2px;\\n  display: flex;\\n}\\n\\n.neuroglancer-data-panel-layout-controls > button {\\n  display: flex;\\n  margin: 2px;\\n  border: 0px;\\n  background-color: rgba(0, 0, 0, 0.5);\\n  flex-direction: row;\\n  align-self: center;\\n  align-items: center;\\n  justify-content: center;\\n  border: 1px solid white;\\n  font-size: 15px;\\n  width: 18px;\\n  height: 18px;\\n  color: white;\\n}\\n\\n.neuroglancer-data-panel-layout-controls > button > div {\\n  display: inline-block;\\n  text-align: center;\\n  line-height: 12px;\\n  width: 15px;\\n  height: 15px;\\n}\\n\\n.neuroglancer-data-panel-layout-controls > button:hover {\\n  color: #6ff;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./panel.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./panel.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./panel.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\nlabel.perspective-panel-show-slice-views {\\n  pointer-events: none;\\n}\\n\\ninput.perspective-panel-show-slice-views {\\n  pointer-events: all;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./input_event_bindings.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./input_event_bindings.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./input_event_bindings.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.describe-key-bindings {\\n  overflow-x: hidden;\\n}\\n\\n.describe-key-bindings-container {\\n  overflow-y: scroll;\\n  max-height: 80vh;\\n  overflow-x: hidden;\\n}\\n\\n.describe-key-bindings .definition-outer-container {\\n  display: block;\\n}\\n\\n.describe-key-bindings .definition-container {\\n  display: inline-block;\\n  white-space: nowrap;\\n}\\n\\n.describe-key-bindings .dt {\\n  font-family: monospace;\\n  font-weight: bold;\\n  display: inline-block;\\n  width: 20ch;\\n}\\n\\n.describe-key-bindings .dd {\\n  display: inline-block;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./autocomplete.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./autocomplete.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./autocomplete.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.autocomplete-hint, .autocomplete-input {\\n  outline: 0;\\n  width: 100%;\\n  border: 0;\\n  margin: 0;\\n  padding: 0;\\n}\\n\\n.autocomplete-prompt, .autocomplete-hint, .autocomplete-input, .autocomplete-completion {\\n  font-family: monospace;\\n  font-size: medium;\\n}\\n\\n.autocomplete {\\n  display: flex;\\n  flex-direction: row;\\n}\\n\\n.autocomplete-prompt {\\n  display: inline-block;\\n}\\n\\n.autocomplete-prompt:not(:empty) {\\n  margin-right: 1em;\\n}\\n\\n.autocomplete-hint {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  border-color: transparent;\\n  background-color: transparent;\\n  box-shadow: none;\\n  color: #aaa;\\n}\\n\\n.autocomplete-dropdown-wrapper {\\n  display: inline-block;\\n  position: relative;\\n  border: 0;\\n  margin: 0;\\n  padding: 0;\\n  flex: 1;\\n}\\n\\n.autocomplete-input {\\n  position: relative;\\n  top: 0;\\n  left: 0;\\n  /* vertical-align: top; */\\n  color: #333;\\n  background-color: transparent;\\n}\\n\\n.autocomplete-input-wrapper {\\n  display: flex;\\n  position: relative;\\n  outline: 0px;\\n  border: 0;\\n  margin: 0px;\\n  padding: 0px;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  top: 0;\\n}\\n\\n.autocomplete-dropdown {\\n  position: absolute;\\n  display: none;\\n  outline: 0;\\n  margin: 0;\\n  padding: 0;\\n  text-align: left;\\n  cursor: default;\\n  border-style: solid;\\n  border-width: 1px;\\n  border-color: #aaa;\\n  overflow-y: scroll;\\n  overflow-x: hidden;\\n  white-space: pre;\\n  background-color: white;\\n}\\n\\n\\n.autocomplete-completion {\\n  \\n}\\n\\n.autocomplete-completion:hover {\\n  outline: 1px solid #ddd;\\n}\\n\\n.autocomplete-completion-active {\\n  background-color: #ccc;\\n}\\n\\n.autocomplete-completion-with-description {\\n  display: flex;\\n  flex-direction: row;\\n}\\n\\n.autocomplete-completion-description {\\n  text-align: right;\\n  display: inline;\\n  flex: 1;\\n  font-style: italic;\\n  padding-left: 2em;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./layer_dialog.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./layer_dialog.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./layer_dialog.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.add-layer-overlay {\\n  width: 80vw;\\n}\\n\\n.add-layer-name {\\n  display: flex;\\n  flex-direction: row;\\n  font-family: monospace;\\n}\\n\\n.add-layer-overlay .dialog-status {\\n  width: 100%;\\n  height: 4em;\\n  overflow: auto;\\n}\\n\\n.add-layer-overlay form {\\n  display: flex;\\n  flex-direction: row;\\n  width: 100%;\\n}\\n\\n.add-layer-overlay form {\\n  margin-bottom: 5px;\\n}\\n\\n.add-layer-overlay form button {\\n  margin-left: 1em;\\n}\\n\\n.add-layer-overlay form > label {\\n  margin-right: 1em;\\n  min-width: 4em;\\n}\\n\\n.add-layer-name, .add-layer-source {\\n  border: 1px solid black;\\n  padding: 2px;\\n  flex: 1;\\n}\\n\\n.add-layer-name.invalid-input {\\n  border: 1px solid red;\\n}\\n\\n.add-layer-overlay .add-layer-name {\\n  font-family: monospace;\\n  flex: 1;\\n  outline: 0;\\n  margin: 0;\\n}\\n\\n.add-layer-overlay .dialog-status.dialog-status-error {\\n  color: red;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./position_widget.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./position_widget.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./position_widget.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2017 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-position-widget {\\n  display: inline-flex;\\n  align-items: center;\\n}\\n\\n.neuroglancer-position-widget-input-container {\\n  position: relative;\\n  display: inline-block;\\n  outline: 0;\\n  border: 0;\\n  margin: 0;\\n  padding: 0;\\n}\\n\\n.neuroglancer-position-widget input {\\n  font-family: monospace;\\n  font-size: medium;\\n  border: 0;\\n  margin: 0;\\n  top: 0;\\n  left: 0;\\n}\\n\\ninput.neuroglancer-position-widget-input {\\n  color: white;\\n  background-color: transparent;\\n  position: relative;\\n  vertical-align: top;\\n}\\n.neuroglancer-position-widget-input:focus {\\n  outline: 0px;\\n  }\\n\\n.neuroglancer-position-widget-hint {\\n  position: absolute;\\n  background-color: transparent;\\n  border-color: transparent;\\n  box-shadow: none;\\n  color: #aaa;\\n  pointer-events: none;\\n}\\n\\n.neuroglancer-copy-button {\\n  padding: 0px;\\n  margin-right: 2px;\\n  display: inline-block;\\n  user-select: none;\\n  color: black;\\n  background-color: #ccc;\\n}\\n\\n.neuroglancer-copy-button:focus {\\n  outline: 0px;\\n}\\n\\n.neuroglancer-voxel-size-widget {\\n  vertical-align: center;\\n  margin-right: 2px;\\n}\\n\\n.neuroglancer-voxel-size-units {\\n  font-family: monospace;\\n  font-size: medium;\\n  color: white;\\n  margin-left: 3px;\\n  outline: 0px;\\n}\\n.neuroglancer-voxel-size-units::after {\\n  content: \\\"\\\";\\n  \\n}\\n\\n.neuroglancer-voxel-size-dimension {\\n  font-family: monospace;\\n  font-size: medium;\\n  color: white;\\n}\\n\\n.neuroglancer-voxel-size-dimension + .neuroglancer-voxel-size-dimension::before {\\n  content: \\\"\\\";\\n  color: #aaa;\\n}\\n\\n.neuroglancer-mouse-position-widget {\\n  vertical-align: center;\\n  font-family: monospace;\\n  font-size: medium;\\n  color: orange;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./layer_panel.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./layer_panel.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./layer_panel.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-layer-panel {\\n  width: 100%;\\n  display: flex;\\n  flex-direction: row;\\n  flex-wrap: wrap;\\n  background-color: black;\\n  align-items: stretch;\\n  margin-left: -5px;\\n  margin-top: -1px;\\n}\\n\\n.neuroglancer-layer-item {\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  color: white;\\n  cursor: pointer;\\n  border-width: 1px;\\n  border-style: solid;\\n  border-color: #ccc;\\n  font-family: sans-serif;\\n  font-size: 10pt;\\n  background-color: black;\\n  padding: 1px;\\n}\\n\\n.neuroglancer-layer-item, .neuroglancer-layer-add-button {\\n  margin: 1px;\\n  margin-left: 5px;\\n}\\n\\n.neuroglancer-layer-item[layer-selected=true] {\\n  border-color: #8c8;\\n}\\n\\n.neuroglancer-layer-item[layer-selected=true]:hover {\\n  border-color: #3c3;\\n}\\n\\n\\n.neuroglancer-layer-item:hover {\\n  border-color: #daa520;\\n}\\n\\n.clear-button::after {\\n  content: \\\"x\\\";\\n}\\n\\n.neuroglancer-layer-dropdown {\\n  flex-direction: column;\\n  background-color: black;\\n  padding: 5px;\\n  border: 1px solid white;\\n  box-sizing: border-box;\\n}\\n\\n.neuroglancer-layer-item-label {\\n  display: inline-block;\\n  background-color: #222;\\n  padding-right: 3px;\\n}\\n\\n.neuroglancer-layer-item-number {\\n  display: inline-block;\\n  background-color: /*#daa520*/ #9a7518;\\n  font-weight: bold;\\n  padding: 1px;\\n}\\n\\n.neuroglancer-layer-item-value {\\n  display: inline-block;\\n  min-width: 10ch;\\n  max-width: 50ch;\\n  margin-left: 1ch;\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipses;\\n  text-align: center;\\n}\\n\\n.neuroglancer-layer-item[layer-visible=false] .neuroglancer-layer-item-label {\\n  text-decoration: line-through;\\n}\\n\\n.neuroglancer-layer-item[layer-visible=false] .neuroglancer-layer-item-value {\\n  display: none;\\n}\\n\\n\\n.neuroglancer-layer-add-button.neuroglancer-button {\\n  font-weight: bold;\\n}\\n\\n.neuroglancer-layer-item[layer-visible=false] {\\n  color: #bbb;\\n}\\n\\n.neuroglancer-layer-panel-drop-zone {\\n  display: inline-block;\\n  flex: 1;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./context_menu.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./context_menu.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./context_menu.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2017 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-context-menu {\\n  position: absolute;\\n  z-index: 100;\\n  border: 1px solid white;\\n  background-color: black;\\n  box-shadow: 5px 5px 2px 1px rgba(0, 0, 0, 0.5);\\n  font-family: sans-serif;\\n  font-size: 11pt;\\n  padding: 5px;\\n  color: white;\\n  outline: 0px;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./layer_group_viewer.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./layer_group_viewer.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./layer_group_viewer.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-panel {\\n  flex: 1;\\n}\\n\\n.neuroglancer-show-panel-borders .neuroglancer-panel {\\n  border-style: solid;\\n  border-color: black;\\n  border-width: 2px;\\n}\\n\\n.neuroglancer-panel:focus {\\n  border-color: white;\\n}\\n\\n.neuroglancer-layer-group-viewer {\\n  outline: 0px;\\n}\\n\\n.neuroglancer-layer-group-viewer-context-menu {\\n  flex-direction: column;\\n  align-items: stretch;\\n}\\n\\n.neuroglancer-layer-group-viewer-context-menu label {\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: space-between;\\n}\\n\\n.neuroglancer-layer-group-viewer-context-menu select::before {\\n  flex: 1;\\n  content: \\\" \\\";\\n}\\n\\n.neuroglancer-layer-group-viewer-context-menu select {\\n  margin-left: 5px;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./layer_groups_layout.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./layer_groups_layout.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./layer_groups_layout.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2017 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n\\n.neuroglancer-layout-split-drop-zone {\\n  position: absolute;\\n  z-index: 1000;\\n}\\n\\n.neuroglancer-drag-over {\\n  background-color: rgba(0, 0, 255, 0.5);\\n}\\n\\n.neuroglancer-stack-layout-row > .neuroglancer-stack-layout-drop-placeholder {\\n  padding-left: 4px;\\n  padding-right: 4px;\\n  width: 1px;\\n}\\n\\n.neuroglancer-stack-layout-column > .neuroglancer-stack-layout-drop-placeholder {\\n  padding-top: 4px;\\n  padding-bottom: 4px;\\n  height: 1px;\\n}\\n\\n.neuroglancer-stack-layout-drop-placeholder {\\n  background-clip: content-box;\\n  background-color: #666;\\n  z-index: 1;\\n}\\n\\n.neuroglancer-stack-layout-drop-placeholder.neuroglancer-drag-over {\\n  background-clip: border-box;\\n  background-color: rgba(128, 128, 255, 0.5);\\n}\\n\\n.neuroglancer-stack-layout-drop-placeholder:first-child, .neuroglancer-stack-layout-drop-placeholder:last-child {\\n  display: none;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./drag_resize.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./drag_resize.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./drag_resize.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"\\n/**\\n * @license\\n * Copyright 2019 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-resize-gutter-vertical {\\n  height: 1px;\\n  background-color: #333;\\n  background-clip: content-box;\\n  padding-top: 2px;\\n  padding-bottom: 2px;\\n  cursor: row-resize;\\n}\\n\\n.neuroglancer-resize-gutter-horizontal {\\n  width: 1px;\\n  background-color: #333;\\n  background-clip: content-box;\\n  padding-right: 2px;\\n  padding-left: 2px;\\n  cursor: col-resize;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./layer_side_panel.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./layer_side_panel.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./layer_side_panel.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2018 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-layer-side-panel {\\n  display: flex;\\n  flex-direction: column;\\n  align-items: stretch;\\n}\\n\\n.neuroglancer-managed-user-layer-info-panel {\\n  display: flex;\\n  flex-direction: column;\\n  align-items: stretch;\\n  flex: 1;\\n}\\n\\n.neuroglancer-layer-info-panel-container {\\n  flex: 1;\\n}\\n\\n\\n.neuroglancer-layer-side-panel-title {\\n  display: flex;\\n  flex-direction: row;\\n  font-family: sans-serif;\\n  font-size: 10pt;\\n  background-color: #3c3;\\n  padding: 2px;\\n}\\n\\n.neuroglancer-layer-side-panel-title > input {\\n  flex: 1;\\n  background-color: transparent;\\n  border: 0px;\\n  color: white;\\n  outline: 0px;\\n}\\n\\n.neuroglancer-layer-side-panel-info-panel {\\n  flex: 1;\\n  display: flex;\\n  flex-direction: column;\\n  font: 10pt sans-serif;\\n}\\n\\n.neuroglancer-layer-side-panel-content-container {\\n  flex: 1;\\n  display: flex;\\n  flex-direction: column;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./mouse_selection_state_tooltip.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./mouse_selection_state_tooltip.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./mouse_selection_state_tooltip.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2018 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-mouse-selection-tooltip {\\n  color: black;\\n  background-color: white;\\n  padding: 2px;\\n  border: 1px solid black;\\n  font-family: sans-serif;\\n  font-size: 10pt;\\n}\\n\\n.neuroglancer-mouse-selection-tooltip-title {\\n  font-weight: bold;\\n}\\n\\n.neuroglancer-mouse-selection-tooltip-description {\\n}\\n\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./tooltip.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./tooltip.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./tooltip.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2017 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-tooltip {\\n  position: absolute;\\n  z-index: 1000;\\n  pointer-events: none;\\n  max-width: 40%;\\n}\\n\", \"\"]);\n\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode(\"javascript\", function(config, parserConfig) {\n  var indentUnit = config.indentUnit;\n  var statementIndent = parserConfig.statementIndent;\n  var jsonldMode = parserConfig.jsonld;\n  var jsonMode = parserConfig.json || jsonldMode;\n  var isTS = parserConfig.typescript;\n  var wordRE = parserConfig.wordCharacters || /[\\w$\\xa1-\\uffff]/;\n\n  // Tokenizer\n\n  var keywords = function(){\n    function kw(type) {return {type: type, style: \"keyword\"};}\n    var A = kw(\"keyword a\"), B = kw(\"keyword b\"), C = kw(\"keyword c\"), D = kw(\"keyword d\");\n    var operator = kw(\"operator\"), atom = {type: \"atom\", style: \"atom\"};\n\n    return {\n      \"if\": kw(\"if\"), \"while\": A, \"with\": A, \"else\": B, \"do\": B, \"try\": B, \"finally\": B,\n      \"return\": D, \"break\": D, \"continue\": D, \"new\": kw(\"new\"), \"delete\": C, \"void\": C, \"throw\": C,\n      \"debugger\": kw(\"debugger\"), \"var\": kw(\"var\"), \"const\": kw(\"var\"), \"let\": kw(\"var\"),\n      \"function\": kw(\"function\"), \"catch\": kw(\"catch\"),\n      \"for\": kw(\"for\"), \"switch\": kw(\"switch\"), \"case\": kw(\"case\"), \"default\": kw(\"default\"),\n      \"in\": operator, \"typeof\": operator, \"instanceof\": operator,\n      \"true\": atom, \"false\": atom, \"null\": atom, \"undefined\": atom, \"NaN\": atom, \"Infinity\": atom,\n      \"this\": kw(\"this\"), \"class\": kw(\"class\"), \"super\": kw(\"atom\"),\n      \"yield\": C, \"export\": kw(\"export\"), \"import\": kw(\"import\"), \"extends\": C,\n      \"await\": C\n    };\n  }();\n\n  var isOperatorChar = /[+\\-*&%=<>!?|~^@]/;\n  var isJsonldKeyword = /^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)\"/;\n\n  function readRegexp(stream) {\n    var escaped = false, next, inSet = false;\n    while ((next = stream.next()) != null) {\n      if (!escaped) {\n        if (next == \"/\" && !inSet) return;\n        if (next == \"[\") inSet = true;\n        else if (inSet && next == \"]\") inSet = false;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n  }\n\n  // Used as scratch variables to communicate multiple values without\n  // consing up tons of objects.\n  var type, content;\n  function ret(tp, style, cont) {\n    type = tp; content = cont;\n    return style;\n  }\n  function tokenBase(stream, state) {\n    var ch = stream.next();\n    if (ch == '\"' || ch == \"'\") {\n      state.tokenize = tokenString(ch);\n      return state.tokenize(stream, state);\n    } else if (ch == \".\" && stream.match(/^\\d+(?:[eE][+\\-]?\\d+)?/)) {\n      return ret(\"number\", \"number\");\n    } else if (ch == \".\" && stream.match(\"..\")) {\n      return ret(\"spread\", \"meta\");\n    } else if (/[\\[\\]{}\\(\\),;\\:\\.]/.test(ch)) {\n      return ret(ch);\n    } else if (ch == \"=\" && stream.eat(\">\")) {\n      return ret(\"=>\", \"operator\");\n    } else if (ch == \"0\" && stream.match(/^(?:x[\\da-f]+|o[0-7]+|b[01]+)n?/i)) {\n      return ret(\"number\", \"number\");\n    } else if (/\\d/.test(ch)) {\n      stream.match(/^\\d*(?:n|(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)?/);\n      return ret(\"number\", \"number\");\n    } else if (ch == \"/\") {\n      if (stream.eat(\"*\")) {\n        state.tokenize = tokenComment;\n        return tokenComment(stream, state);\n      } else if (stream.eat(\"/\")) {\n        stream.skipToEnd();\n        return ret(\"comment\", \"comment\");\n      } else if (expressionAllowed(stream, state, 1)) {\n        readRegexp(stream);\n        stream.match(/^\\b(([gimyus])(?![gimyus]*\\2))+\\b/);\n        return ret(\"regexp\", \"string-2\");\n      } else {\n        stream.eat(\"=\");\n        return ret(\"operator\", \"operator\", stream.current());\n      }\n    } else if (ch == \"`\") {\n      state.tokenize = tokenQuasi;\n      return tokenQuasi(stream, state);\n    } else if (ch == \"#\") {\n      stream.skipToEnd();\n      return ret(\"error\", \"error\");\n    } else if (isOperatorChar.test(ch)) {\n      if (ch != \">\" || !state.lexical || state.lexical.type != \">\") {\n        if (stream.eat(\"=\")) {\n          if (ch == \"!\" || ch == \"=\") stream.eat(\"=\")\n        } else if (/[<>*+\\-]/.test(ch)) {\n          stream.eat(ch)\n          if (ch == \">\") stream.eat(ch)\n        }\n      }\n      return ret(\"operator\", \"operator\", stream.current());\n    } else if (wordRE.test(ch)) {\n      stream.eatWhile(wordRE);\n      var word = stream.current()\n      if (state.lastType != \".\") {\n        if (keywords.propertyIsEnumerable(word)) {\n          var kw = keywords[word]\n          return ret(kw.type, kw.style, word)\n        }\n        if (word == \"async\" && stream.match(/^(\\s|\\/\\*.*?\\*\\/)*[\\[\\(\\w]/, false))\n          return ret(\"async\", \"keyword\", word)\n      }\n      return ret(\"variable\", \"variable\", word)\n    }\n  }\n\n  function tokenString(quote) {\n    return function(stream, state) {\n      var escaped = false, next;\n      if (jsonldMode && stream.peek() == \"@\" && stream.match(isJsonldKeyword)){\n        state.tokenize = tokenBase;\n        return ret(\"jsonld-keyword\", \"meta\");\n      }\n      while ((next = stream.next()) != null) {\n        if (next == quote && !escaped) break;\n        escaped = !escaped && next == \"\\\\\";\n      }\n      if (!escaped) state.tokenize = tokenBase;\n      return ret(\"string\", \"string\");\n    };\n  }\n\n  function tokenComment(stream, state) {\n    var maybeEnd = false, ch;\n    while (ch = stream.next()) {\n      if (ch == \"/\" && maybeEnd) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      maybeEnd = (ch == \"*\");\n    }\n    return ret(\"comment\", \"comment\");\n  }\n\n  function tokenQuasi(stream, state) {\n    var escaped = false, next;\n    while ((next = stream.next()) != null) {\n      if (!escaped && (next == \"`\" || next == \"$\" && stream.eat(\"{\"))) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n    return ret(\"quasi\", \"string-2\", stream.current());\n  }\n\n  var brackets = \"([{}])\";\n  // This is a crude lookahead trick to try and notice that we're\n  // parsing the argument patterns for a fat-arrow function before we\n  // actually hit the arrow token. It only works if the arrow is on\n  // the same line as the arguments and there's no strange noise\n  // (comments) in between. Fallback is to only notice when we hit the\n  // arrow, and not declare the arguments as locals for the arrow\n  // body.\n  function findFatArrow(stream, state) {\n    if (state.fatArrowAt) state.fatArrowAt = null;\n    var arrow = stream.string.indexOf(\"=>\", stream.start);\n    if (arrow < 0) return;\n\n    if (isTS) { // Try to skip TypeScript return type declarations after the arguments\n      var m = /:\\s*(?:\\w+(?:<[^>]*>|\\[\\])?|\\{[^}]*\\})\\s*$/.exec(stream.string.slice(stream.start, arrow))\n      if (m) arrow = m.index\n    }\n\n    var depth = 0, sawSomething = false;\n    for (var pos = arrow - 1; pos >= 0; --pos) {\n      var ch = stream.string.charAt(pos);\n      var bracket = brackets.indexOf(ch);\n      if (bracket >= 0 && bracket < 3) {\n        if (!depth) { ++pos; break; }\n        if (--depth == 0) { if (ch == \"(\") sawSomething = true; break; }\n      } else if (bracket >= 3 && bracket < 6) {\n        ++depth;\n      } else if (wordRE.test(ch)) {\n        sawSomething = true;\n      } else if (/[\"'\\/]/.test(ch)) {\n        return;\n      } else if (sawSomething && !depth) {\n        ++pos;\n        break;\n      }\n    }\n    if (sawSomething && !depth) state.fatArrowAt = pos;\n  }\n\n  // Parser\n\n  var atomicTypes = {\"atom\": true, \"number\": true, \"variable\": true, \"string\": true, \"regexp\": true, \"this\": true, \"jsonld-keyword\": true};\n\n  function JSLexical(indented, column, type, align, prev, info) {\n    this.indented = indented;\n    this.column = column;\n    this.type = type;\n    this.prev = prev;\n    this.info = info;\n    if (align != null) this.align = align;\n  }\n\n  function inScope(state, varname) {\n    for (var v = state.localVars; v; v = v.next)\n      if (v.name == varname) return true;\n    for (var cx = state.context; cx; cx = cx.prev) {\n      for (var v = cx.vars; v; v = v.next)\n        if (v.name == varname) return true;\n    }\n  }\n\n  function parseJS(state, style, type, content, stream) {\n    var cc = state.cc;\n    // Communicate our context to the combinators.\n    // (Less wasteful than consing up a hundred closures on every call.)\n    cx.state = state; cx.stream = stream; cx.marked = null, cx.cc = cc; cx.style = style;\n\n    if (!state.lexical.hasOwnProperty(\"align\"))\n      state.lexical.align = true;\n\n    while(true) {\n      var combinator = cc.length ? cc.pop() : jsonMode ? expression : statement;\n      if (combinator(type, content)) {\n        while(cc.length && cc[cc.length - 1].lex)\n          cc.pop()();\n        if (cx.marked) return cx.marked;\n        if (type == \"variable\" && inScope(state, content)) return \"variable-2\";\n        return style;\n      }\n    }\n  }\n\n  // Combinator utils\n\n  var cx = {state: null, column: null, marked: null, cc: null};\n  function pass() {\n    for (var i = arguments.length - 1; i >= 0; i--) cx.cc.push(arguments[i]);\n  }\n  function cont() {\n    pass.apply(null, arguments);\n    return true;\n  }\n  function inList(name, list) {\n    for (var v = list; v; v = v.next) if (v.name == name) return true\n    return false;\n  }\n  function register(varname) {\n    var state = cx.state;\n    cx.marked = \"def\";\n    if (state.context) {\n      if (state.lexical.info == \"var\" && state.context && state.context.block) {\n        // FIXME function decls are also not block scoped\n        var newContext = registerVarScoped(varname, state.context)\n        if (newContext != null) {\n          state.context = newContext\n          return\n        }\n      } else if (!inList(varname, state.localVars)) {\n        state.localVars = new Var(varname, state.localVars)\n        return\n      }\n    }\n    // Fall through means this is global\n    if (parserConfig.globalVars && !inList(varname, state.globalVars))\n      state.globalVars = new Var(varname, state.globalVars)\n  }\n  function registerVarScoped(varname, context) {\n    if (!context) {\n      return null\n    } else if (context.block) {\n      var inner = registerVarScoped(varname, context.prev)\n      if (!inner) return null\n      if (inner == context.prev) return context\n      return new Context(inner, context.vars, true)\n    } else if (inList(varname, context.vars)) {\n      return context\n    } else {\n      return new Context(context.prev, new Var(varname, context.vars), false)\n    }\n  }\n\n  function isModifier(name) {\n    return name == \"public\" || name == \"private\" || name == \"protected\" || name == \"abstract\" || name == \"readonly\"\n  }\n\n  // Combinators\n\n  function Context(prev, vars, block) { this.prev = prev; this.vars = vars; this.block = block }\n  function Var(name, next) { this.name = name; this.next = next }\n\n  var defaultVars = new Var(\"this\", new Var(\"arguments\", null))\n  function pushcontext() {\n    cx.state.context = new Context(cx.state.context, cx.state.localVars, false)\n    cx.state.localVars = defaultVars\n  }\n  function pushblockcontext() {\n    cx.state.context = new Context(cx.state.context, cx.state.localVars, true)\n    cx.state.localVars = null\n  }\n  function popcontext() {\n    cx.state.localVars = cx.state.context.vars\n    cx.state.context = cx.state.context.prev\n  }\n  popcontext.lex = true\n  function pushlex(type, info) {\n    var result = function() {\n      var state = cx.state, indent = state.indented;\n      if (state.lexical.type == \"stat\") indent = state.lexical.indented;\n      else for (var outer = state.lexical; outer && outer.type == \")\" && outer.align; outer = outer.prev)\n        indent = outer.indented;\n      state.lexical = new JSLexical(indent, cx.stream.column(), type, null, state.lexical, info);\n    };\n    result.lex = true;\n    return result;\n  }\n  function poplex() {\n    var state = cx.state;\n    if (state.lexical.prev) {\n      if (state.lexical.type == \")\")\n        state.indented = state.lexical.indented;\n      state.lexical = state.lexical.prev;\n    }\n  }\n  poplex.lex = true;\n\n  function expect(wanted) {\n    function exp(type) {\n      if (type == wanted) return cont();\n      else if (wanted == \";\" || type == \"}\" || type == \")\" || type == \"]\") return pass();\n      else return cont(exp);\n    };\n    return exp;\n  }\n\n  function statement(type, value) {\n    if (type == \"var\") return cont(pushlex(\"vardef\", value), vardef, expect(\";\"), poplex);\n    if (type == \"keyword a\") return cont(pushlex(\"form\"), parenExpr, statement, poplex);\n    if (type == \"keyword b\") return cont(pushlex(\"form\"), statement, poplex);\n    if (type == \"keyword d\") return cx.stream.match(/^\\s*$/, false) ? cont() : cont(pushlex(\"stat\"), maybeexpression, expect(\";\"), poplex);\n    if (type == \"debugger\") return cont(expect(\";\"));\n    if (type == \"{\") return cont(pushlex(\"}\"), pushblockcontext, block, poplex, popcontext);\n    if (type == \";\") return cont();\n    if (type == \"if\") {\n      if (cx.state.lexical.info == \"else\" && cx.state.cc[cx.state.cc.length - 1] == poplex)\n        cx.state.cc.pop()();\n      return cont(pushlex(\"form\"), parenExpr, statement, poplex, maybeelse);\n    }\n    if (type == \"function\") return cont(functiondef);\n    if (type == \"for\") return cont(pushlex(\"form\"), forspec, statement, poplex);\n    if (type == \"class\" || (isTS && value == \"interface\")) {\n      cx.marked = \"keyword\"\n      return cont(pushlex(\"form\", type == \"class\" ? type : value), className, poplex)\n    }\n    if (type == \"variable\") {\n      if (isTS && value == \"declare\") {\n        cx.marked = \"keyword\"\n        return cont(statement)\n      } else if (isTS && (value == \"module\" || value == \"enum\" || value == \"type\") && cx.stream.match(/^\\s*\\w/, false)) {\n        cx.marked = \"keyword\"\n        if (value == \"enum\") return cont(enumdef);\n        else if (value == \"type\") return cont(typename, expect(\"operator\"), typeexpr, expect(\";\"));\n        else return cont(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), block, poplex, poplex)\n      } else if (isTS && value == \"namespace\") {\n        cx.marked = \"keyword\"\n        return cont(pushlex(\"form\"), expression, statement, poplex)\n      } else if (isTS && value == \"abstract\") {\n        cx.marked = \"keyword\"\n        return cont(statement)\n      } else {\n        return cont(pushlex(\"stat\"), maybelabel);\n      }\n    }\n    if (type == \"switch\") return cont(pushlex(\"form\"), parenExpr, expect(\"{\"), pushlex(\"}\", \"switch\"), pushblockcontext,\n                                      block, poplex, poplex, popcontext);\n    if (type == \"case\") return cont(expression, expect(\":\"));\n    if (type == \"default\") return cont(expect(\":\"));\n    if (type == \"catch\") return cont(pushlex(\"form\"), pushcontext, maybeCatchBinding, statement, poplex, popcontext);\n    if (type == \"export\") return cont(pushlex(\"stat\"), afterExport, poplex);\n    if (type == \"import\") return cont(pushlex(\"stat\"), afterImport, poplex);\n    if (type == \"async\") return cont(statement)\n    if (value == \"@\") return cont(expression, statement)\n    return pass(pushlex(\"stat\"), expression, expect(\";\"), poplex);\n  }\n  function maybeCatchBinding(type) {\n    if (type == \"(\") return cont(funarg, expect(\")\"))\n  }\n  function expression(type, value) {\n    return expressionInner(type, value, false);\n  }\n  function expressionNoComma(type, value) {\n    return expressionInner(type, value, true);\n  }\n  function parenExpr(type) {\n    if (type != \"(\") return pass()\n    return cont(pushlex(\")\"), expression, expect(\")\"), poplex)\n  }\n  function expressionInner(type, value, noComma) {\n    if (cx.state.fatArrowAt == cx.stream.start) {\n      var body = noComma ? arrowBodyNoComma : arrowBody;\n      if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, expect(\"=>\"), body, popcontext);\n      else if (type == \"variable\") return pass(pushcontext, pattern, expect(\"=>\"), body, popcontext);\n    }\n\n    var maybeop = noComma ? maybeoperatorNoComma : maybeoperatorComma;\n    if (atomicTypes.hasOwnProperty(type)) return cont(maybeop);\n    if (type == \"function\") return cont(functiondef, maybeop);\n    if (type == \"class\" || (isTS && value == \"interface\")) { cx.marked = \"keyword\"; return cont(pushlex(\"form\"), classExpression, poplex); }\n    if (type == \"keyword c\" || type == \"async\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"(\") return cont(pushlex(\")\"), maybeexpression, expect(\")\"), poplex, maybeop);\n    if (type == \"operator\" || type == \"spread\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"[\") return cont(pushlex(\"]\"), arrayLiteral, poplex, maybeop);\n    if (type == \"{\") return contCommasep(objprop, \"}\", null, maybeop);\n    if (type == \"quasi\") return pass(quasi, maybeop);\n    if (type == \"new\") return cont(maybeTarget(noComma));\n    if (type == \"import\") return cont(expression);\n    return cont();\n  }\n  function maybeexpression(type) {\n    if (type.match(/[;\\}\\)\\],]/)) return pass();\n    return pass(expression);\n  }\n\n  function maybeoperatorComma(type, value) {\n    if (type == \",\") return cont(expression);\n    return maybeoperatorNoComma(type, value, false);\n  }\n  function maybeoperatorNoComma(type, value, noComma) {\n    var me = noComma == false ? maybeoperatorComma : maybeoperatorNoComma;\n    var expr = noComma == false ? expression : expressionNoComma;\n    if (type == \"=>\") return cont(pushcontext, noComma ? arrowBodyNoComma : arrowBody, popcontext);\n    if (type == \"operator\") {\n      if (/\\+\\+|--/.test(value) || isTS && value == \"!\") return cont(me);\n      if (isTS && value == \"<\" && cx.stream.match(/^([^>]|<.*?>)*>\\s*\\(/, false))\n        return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, me);\n      if (value == \"?\") return cont(expression, expect(\":\"), expr);\n      return cont(expr);\n    }\n    if (type == \"quasi\") { return pass(quasi, me); }\n    if (type == \";\") return;\n    if (type == \"(\") return contCommasep(expressionNoComma, \")\", \"call\", me);\n    if (type == \".\") return cont(property, me);\n    if (type == \"[\") return cont(pushlex(\"]\"), maybeexpression, expect(\"]\"), poplex, me);\n    if (isTS && value == \"as\") { cx.marked = \"keyword\"; return cont(typeexpr, me) }\n    if (type == \"regexp\") {\n      cx.state.lastType = cx.marked = \"operator\"\n      cx.stream.backUp(cx.stream.pos - cx.stream.start - 1)\n      return cont(expr)\n    }\n  }\n  function quasi(type, value) {\n    if (type != \"quasi\") return pass();\n    if (value.slice(value.length - 2) != \"${\") return cont(quasi);\n    return cont(expression, continueQuasi);\n  }\n  function continueQuasi(type) {\n    if (type == \"}\") {\n      cx.marked = \"string-2\";\n      cx.state.tokenize = tokenQuasi;\n      return cont(quasi);\n    }\n  }\n  function arrowBody(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expression);\n  }\n  function arrowBodyNoComma(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expressionNoComma);\n  }\n  function maybeTarget(noComma) {\n    return function(type) {\n      if (type == \".\") return cont(noComma ? targetNoComma : target);\n      else if (type == \"variable\" && isTS) return cont(maybeTypeArgs, noComma ? maybeoperatorNoComma : maybeoperatorComma)\n      else return pass(noComma ? expressionNoComma : expression);\n    };\n  }\n  function target(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorComma); }\n  }\n  function targetNoComma(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorNoComma); }\n  }\n  function maybelabel(type) {\n    if (type == \":\") return cont(poplex, statement);\n    return pass(maybeoperatorComma, expect(\";\"), poplex);\n  }\n  function property(type) {\n    if (type == \"variable\") {cx.marked = \"property\"; return cont();}\n  }\n  function objprop(type, value) {\n    if (type == \"async\") {\n      cx.marked = \"property\";\n      return cont(objprop);\n    } else if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      if (value == \"get\" || value == \"set\") return cont(getterSetter);\n      var m // Work around fat-arrow-detection complication for detecting typescript typed arrow params\n      if (isTS && cx.state.fatArrowAt == cx.stream.start && (m = cx.stream.match(/^\\s*:\\s*/, false)))\n        cx.state.fatArrowAt = cx.stream.pos + m[0].length\n      return cont(afterprop);\n    } else if (type == \"number\" || type == \"string\") {\n      cx.marked = jsonldMode ? \"property\" : (cx.style + \" property\");\n      return cont(afterprop);\n    } else if (type == \"jsonld-keyword\") {\n      return cont(afterprop);\n    } else if (isTS && isModifier(value)) {\n      cx.marked = \"keyword\"\n      return cont(objprop)\n    } else if (type == \"[\") {\n      return cont(expression, maybetype, expect(\"]\"), afterprop);\n    } else if (type == \"spread\") {\n      return cont(expressionNoComma, afterprop);\n    } else if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(objprop);\n    } else if (type == \":\") {\n      return pass(afterprop)\n    }\n  }\n  function getterSetter(type) {\n    if (type != \"variable\") return pass(afterprop);\n    cx.marked = \"property\";\n    return cont(functiondef);\n  }\n  function afterprop(type) {\n    if (type == \":\") return cont(expressionNoComma);\n    if (type == \"(\") return pass(functiondef);\n  }\n  function commasep(what, end, sep) {\n    function proceed(type, value) {\n      if (sep ? sep.indexOf(type) > -1 : type == \",\") {\n        var lex = cx.state.lexical;\n        if (lex.info == \"call\") lex.pos = (lex.pos || 0) + 1;\n        return cont(function(type, value) {\n          if (type == end || value == end) return pass()\n          return pass(what)\n        }, proceed);\n      }\n      if (type == end || value == end) return cont();\n      if (sep && sep.indexOf(\";\") > -1) return pass(what)\n      return cont(expect(end));\n    }\n    return function(type, value) {\n      if (type == end || value == end) return cont();\n      return pass(what, proceed);\n    };\n  }\n  function contCommasep(what, end, info) {\n    for (var i = 3; i < arguments.length; i++)\n      cx.cc.push(arguments[i]);\n    return cont(pushlex(end, info), commasep(what, end), poplex);\n  }\n  function block(type) {\n    if (type == \"}\") return cont();\n    return pass(statement, block);\n  }\n  function maybetype(type, value) {\n    if (isTS) {\n      if (type == \":\" || value == \"in\") return cont(typeexpr);\n      if (value == \"?\") return cont(maybetype);\n    }\n  }\n  function mayberettype(type) {\n    if (isTS && type == \":\") {\n      if (cx.stream.match(/^\\s*\\w+\\s+is\\b/, false)) return cont(expression, isKW, typeexpr)\n      else return cont(typeexpr)\n    }\n  }\n  function isKW(_, value) {\n    if (value == \"is\") {\n      cx.marked = \"keyword\"\n      return cont()\n    }\n  }\n  function typeexpr(type, value) {\n    if (value == \"keyof\" || value == \"typeof\" || value == \"infer\") {\n      cx.marked = \"keyword\"\n      return cont(value == \"typeof\" ? expressionNoComma : typeexpr)\n    }\n    if (type == \"variable\" || value == \"void\") {\n      cx.marked = \"type\"\n      return cont(afterType)\n    }\n    if (value == \"|\" || value == \"&\") return cont(typeexpr)\n    if (type == \"string\" || type == \"number\" || type == \"atom\") return cont(afterType);\n    if (type == \"[\") return cont(pushlex(\"]\"), commasep(typeexpr, \"]\", \",\"), poplex, afterType)\n    if (type == \"{\") return cont(pushlex(\"}\"), commasep(typeprop, \"}\", \",;\"), poplex, afterType)\n    if (type == \"(\") return cont(commasep(typearg, \")\"), maybeReturnType, afterType)\n    if (type == \"<\") return cont(commasep(typeexpr, \">\"), typeexpr)\n  }\n  function maybeReturnType(type) {\n    if (type == \"=>\") return cont(typeexpr)\n  }\n  function typeprop(type, value) {\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\"\n      return cont(typeprop)\n    } else if (value == \"?\" || type == \"number\" || type == \"string\") {\n      return cont(typeprop)\n    } else if (type == \":\") {\n      return cont(typeexpr)\n    } else if (type == \"[\") {\n      return cont(expect(\"variable\"), maybetype, expect(\"]\"), typeprop)\n    } else if (type == \"(\") {\n      return pass(functiondecl, typeprop)\n    }\n  }\n  function typearg(type, value) {\n    if (type == \"variable\" && cx.stream.match(/^\\s*[?:]/, false) || value == \"?\") return cont(typearg)\n    if (type == \":\") return cont(typeexpr)\n    if (type == \"spread\") return cont(typearg)\n    return pass(typeexpr)\n  }\n  function afterType(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n    if (value == \"|\" || type == \".\" || value == \"&\") return cont(typeexpr)\n    if (type == \"[\") return cont(typeexpr, expect(\"]\"), afterType)\n    if (value == \"extends\" || value == \"implements\") { cx.marked = \"keyword\"; return cont(typeexpr) }\n    if (value == \"?\") return cont(typeexpr, expect(\":\"), typeexpr)\n  }\n  function maybeTypeArgs(_, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n  }\n  function typeparam() {\n    return pass(typeexpr, maybeTypeDefault)\n  }\n  function maybeTypeDefault(_, value) {\n    if (value == \"=\") return cont(typeexpr)\n  }\n  function vardef(_, value) {\n    if (value == \"enum\") {cx.marked = \"keyword\"; return cont(enumdef)}\n    return pass(pattern, maybetype, maybeAssign, vardefCont);\n  }\n  function pattern(type, value) {\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(pattern) }\n    if (type == \"variable\") { register(value); return cont(); }\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"[\") return contCommasep(eltpattern, \"]\");\n    if (type == \"{\") return contCommasep(proppattern, \"}\");\n  }\n  function proppattern(type, value) {\n    if (type == \"variable\" && !cx.stream.match(/^\\s*:/, false)) {\n      register(value);\n      return cont(maybeAssign);\n    }\n    if (type == \"variable\") cx.marked = \"property\";\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"}\") return pass();\n    if (type == \"[\") return cont(expression, expect(']'), expect(':'), proppattern);\n    return cont(expect(\":\"), pattern, maybeAssign);\n  }\n  function eltpattern() {\n    return pass(pattern, maybeAssign)\n  }\n  function maybeAssign(_type, value) {\n    if (value == \"=\") return cont(expressionNoComma);\n  }\n  function vardefCont(type) {\n    if (type == \",\") return cont(vardef);\n  }\n  function maybeelse(type, value) {\n    if (type == \"keyword b\" && value == \"else\") return cont(pushlex(\"form\", \"else\"), statement, poplex);\n  }\n  function forspec(type, value) {\n    if (value == \"await\") return cont(forspec);\n    if (type == \"(\") return cont(pushlex(\")\"), forspec1, poplex);\n  }\n  function forspec1(type) {\n    if (type == \"var\") return cont(vardef, forspec2);\n    if (type == \"variable\") return cont(forspec2);\n    return pass(forspec2)\n  }\n  function forspec2(type, value) {\n    if (type == \")\") return cont()\n    if (type == \";\") return cont(forspec2)\n    if (value == \"in\" || value == \"of\") { cx.marked = \"keyword\"; return cont(expression, forspec2) }\n    return pass(expression, forspec2)\n  }\n  function functiondef(type, value) {\n    if (value == \"*\") {cx.marked = \"keyword\"; return cont(functiondef);}\n    if (type == \"variable\") {register(value); return cont(functiondef);}\n    if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, statement, popcontext);\n    if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondef)\n  }\n  function functiondecl(type, value) {\n    if (value == \"*\") {cx.marked = \"keyword\"; return cont(functiondecl);}\n    if (type == \"variable\") {register(value); return cont(functiondecl);}\n    if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, popcontext);\n    if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondecl)\n  }\n  function typename(type, value) {\n    if (type == \"keyword\" || type == \"variable\") {\n      cx.marked = \"type\"\n      return cont(typename)\n    } else if (value == \"<\") {\n      return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex)\n    }\n  }\n  function funarg(type, value) {\n    if (value == \"@\") cont(expression, funarg)\n    if (type == \"spread\") return cont(funarg);\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(funarg); }\n    if (isTS && type == \"this\") return cont(maybetype, maybeAssign)\n    return pass(pattern, maybetype, maybeAssign);\n  }\n  function classExpression(type, value) {\n    // Class expressions may have an optional name.\n    if (type == \"variable\") return className(type, value);\n    return classNameAfter(type, value);\n  }\n  function className(type, value) {\n    if (type == \"variable\") {register(value); return cont(classNameAfter);}\n  }\n  function classNameAfter(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, classNameAfter)\n    if (value == \"extends\" || value == \"implements\" || (isTS && type == \",\")) {\n      if (value == \"implements\") cx.marked = \"keyword\";\n      return cont(isTS ? typeexpr : expression, classNameAfter);\n    }\n    if (type == \"{\") return cont(pushlex(\"}\"), classBody, poplex);\n  }\n  function classBody(type, value) {\n    if (type == \"async\" ||\n        (type == \"variable\" &&\n         (value == \"static\" || value == \"get\" || value == \"set\" || (isTS && isModifier(value))) &&\n         cx.stream.match(/^\\s+[\\w$\\xa1-\\uffff]/, false))) {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      return cont(isTS ? classfield : functiondef, classBody);\n    }\n    if (type == \"number\" || type == \"string\") return cont(isTS ? classfield : functiondef, classBody);\n    if (type == \"[\")\n      return cont(expression, maybetype, expect(\"]\"), isTS ? classfield : functiondef, classBody)\n    if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (isTS && type == \"(\") return pass(functiondecl, classBody)\n    if (type == \";\" || type == \",\") return cont(classBody);\n    if (type == \"}\") return cont();\n    if (value == \"@\") return cont(expression, classBody)\n  }\n  function classfield(type, value) {\n    if (value == \"?\") return cont(classfield)\n    if (type == \":\") return cont(typeexpr, maybeAssign)\n    if (value == \"=\") return cont(expressionNoComma)\n    var context = cx.state.lexical.prev, isInterface = context && context.info == \"interface\"\n    return pass(isInterface ? functiondecl : functiondef)\n  }\n  function afterExport(type, value) {\n    if (value == \"*\") { cx.marked = \"keyword\"; return cont(maybeFrom, expect(\";\")); }\n    if (value == \"default\") { cx.marked = \"keyword\"; return cont(expression, expect(\";\")); }\n    if (type == \"{\") return cont(commasep(exportField, \"}\"), maybeFrom, expect(\";\"));\n    return pass(statement);\n  }\n  function exportField(type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(expect(\"variable\")); }\n    if (type == \"variable\") return pass(expressionNoComma, exportField);\n  }\n  function afterImport(type) {\n    if (type == \"string\") return cont();\n    if (type == \"(\") return pass(expression);\n    return pass(importSpec, maybeMoreImports, maybeFrom);\n  }\n  function importSpec(type, value) {\n    if (type == \"{\") return contCommasep(importSpec, \"}\");\n    if (type == \"variable\") register(value);\n    if (value == \"*\") cx.marked = \"keyword\";\n    return cont(maybeAs);\n  }\n  function maybeMoreImports(type) {\n    if (type == \",\") return cont(importSpec, maybeMoreImports)\n  }\n  function maybeAs(_type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(importSpec); }\n  }\n  function maybeFrom(_type, value) {\n    if (value == \"from\") { cx.marked = \"keyword\"; return cont(expression); }\n  }\n  function arrayLiteral(type) {\n    if (type == \"]\") return cont();\n    return pass(commasep(expressionNoComma, \"]\"));\n  }\n  function enumdef() {\n    return pass(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), commasep(enummember, \"}\"), poplex, poplex)\n  }\n  function enummember() {\n    return pass(pattern, maybeAssign);\n  }\n\n  function isContinuedStatement(state, textAfter) {\n    return state.lastType == \"operator\" || state.lastType == \",\" ||\n      isOperatorChar.test(textAfter.charAt(0)) ||\n      /[,.]/.test(textAfter.charAt(0));\n  }\n\n  function expressionAllowed(stream, state, backUp) {\n    return state.tokenize == tokenBase &&\n      /^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\\[{}\\(,;:]|=>)$/.test(state.lastType) ||\n      (state.lastType == \"quasi\" && /\\{\\s*$/.test(stream.string.slice(0, stream.pos - (backUp || 0))))\n  }\n\n  // Interface\n\n  return {\n    startState: function(basecolumn) {\n      var state = {\n        tokenize: tokenBase,\n        lastType: \"sof\",\n        cc: [],\n        lexical: new JSLexical((basecolumn || 0) - indentUnit, 0, \"block\", false),\n        localVars: parserConfig.localVars,\n        context: parserConfig.localVars && new Context(null, null, false),\n        indented: basecolumn || 0\n      };\n      if (parserConfig.globalVars && typeof parserConfig.globalVars == \"object\")\n        state.globalVars = parserConfig.globalVars;\n      return state;\n    },\n\n    token: function(stream, state) {\n      if (stream.sol()) {\n        if (!state.lexical.hasOwnProperty(\"align\"))\n          state.lexical.align = false;\n        state.indented = stream.indentation();\n        findFatArrow(stream, state);\n      }\n      if (state.tokenize != tokenComment && stream.eatSpace()) return null;\n      var style = state.tokenize(stream, state);\n      if (type == \"comment\") return style;\n      state.lastType = type == \"operator\" && (content == \"++\" || content == \"--\") ? \"incdec\" : type;\n      return parseJS(state, style, type, content, stream);\n    },\n\n    indent: function(state, textAfter) {\n      if (state.tokenize == tokenComment) return CodeMirror.Pass;\n      if (state.tokenize != tokenBase) return 0;\n      var firstChar = textAfter && textAfter.charAt(0), lexical = state.lexical, top\n      // Kludge to prevent 'maybelse' from blocking lexical scope pops\n      if (!/^\\s*else\\b/.test(textAfter)) for (var i = state.cc.length - 1; i >= 0; --i) {\n        var c = state.cc[i];\n        if (c == poplex) lexical = lexical.prev;\n        else if (c != maybeelse) break;\n      }\n      while ((lexical.type == \"stat\" || lexical.type == \"form\") &&\n             (firstChar == \"}\" || ((top = state.cc[state.cc.length - 1]) &&\n                                   (top == maybeoperatorComma || top == maybeoperatorNoComma) &&\n                                   !/^[,\\.=+\\-*:?[\\(]/.test(textAfter))))\n        lexical = lexical.prev;\n      if (statementIndent && lexical.type == \")\" && lexical.prev.type == \"stat\")\n        lexical = lexical.prev;\n      var type = lexical.type, closing = firstChar == type;\n\n      if (type == \"vardef\") return lexical.indented + (state.lastType == \"operator\" || state.lastType == \",\" ? lexical.info.length + 1 : 0);\n      else if (type == \"form\" && firstChar == \"{\") return lexical.indented;\n      else if (type == \"form\") return lexical.indented + indentUnit;\n      else if (type == \"stat\")\n        return lexical.indented + (isContinuedStatement(state, textAfter) ? statementIndent || indentUnit : 0);\n      else if (lexical.info == \"switch\" && !closing && parserConfig.doubleIndentSwitch != false)\n        return lexical.indented + (/^(?:case|default)\\b/.test(textAfter) ? indentUnit : 2 * indentUnit);\n      else if (lexical.align) return lexical.column + (closing ? 0 : 1);\n      else return lexical.indented + (closing ? 0 : indentUnit);\n    },\n\n    electricInput: /^\\s*(?:case .*?:|default:|\\{|\\})$/,\n    blockCommentStart: jsonMode ? null : \"/*\",\n    blockCommentEnd: jsonMode ? null : \"*/\",\n    blockCommentContinue: jsonMode ? null : \" * \",\n    lineComment: jsonMode ? null : \"//\",\n    fold: \"brace\",\n    closeBrackets: \"()[]{}''\\\"\\\"``\",\n\n    helperType: jsonMode ? \"json\" : \"javascript\",\n    jsonldMode: jsonldMode,\n    jsonMode: jsonMode,\n\n    expressionAllowed: expressionAllowed,\n\n    skipExpression: function(state) {\n      var top = state.cc[state.cc.length - 1]\n      if (top == expression || top == expressionNoComma) state.cc.pop()\n    }\n  };\n});\n\nCodeMirror.registerHelper(\"wordChars\", \"javascript\", /[\\w$]/);\n\nCodeMirror.defineMIME(\"text/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"text/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/x-javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/json\", {name: \"javascript\", json: true});\nCodeMirror.defineMIME(\"application/x-json\", {name: \"javascript\", json: true});\nCodeMirror.defineMIME(\"application/ld+json\", {name: \"javascript\", jsonld: true});\nCodeMirror.defineMIME(\"text/typescript\", { name: \"javascript\", typescript: true });\nCodeMirror.defineMIME(\"application/typescript\", { name: \"javascript\", typescript: true });\n\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"./foldcode\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"./foldcode\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineOption(\"foldGutter\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      cm.clearGutter(cm.state.foldGutter.options.gutter);\n      cm.state.foldGutter = null;\n      cm.off(\"gutterClick\", onGutterClick);\n      cm.off(\"change\", onChange);\n      cm.off(\"viewportChange\", onViewportChange);\n      cm.off(\"fold\", onFold);\n      cm.off(\"unfold\", onFold);\n      cm.off(\"swapDoc\", onChange);\n    }\n    if (val) {\n      cm.state.foldGutter = new State(parseOptions(val));\n      updateInViewport(cm);\n      cm.on(\"gutterClick\", onGutterClick);\n      cm.on(\"change\", onChange);\n      cm.on(\"viewportChange\", onViewportChange);\n      cm.on(\"fold\", onFold);\n      cm.on(\"unfold\", onFold);\n      cm.on(\"swapDoc\", onChange);\n    }\n  });\n\n  var Pos = CodeMirror.Pos;\n\n  function State(options) {\n    this.options = options;\n    this.from = this.to = 0;\n  }\n\n  function parseOptions(opts) {\n    if (opts === true) opts = {};\n    if (opts.gutter == null) opts.gutter = \"CodeMirror-foldgutter\";\n    if (opts.indicatorOpen == null) opts.indicatorOpen = \"CodeMirror-foldgutter-open\";\n    if (opts.indicatorFolded == null) opts.indicatorFolded = \"CodeMirror-foldgutter-folded\";\n    return opts;\n  }\n\n  function isFolded(cm, line) {\n    var marks = cm.findMarks(Pos(line, 0), Pos(line + 1, 0));\n    for (var i = 0; i < marks.length; ++i)\n      if (marks[i].__isFold && marks[i].find().from.line == line) return marks[i];\n  }\n\n  function marker(spec) {\n    if (typeof spec == \"string\") {\n      var elt = document.createElement(\"div\");\n      elt.className = spec + \" CodeMirror-guttermarker-subtle\";\n      return elt;\n    } else {\n      return spec.cloneNode(true);\n    }\n  }\n\n  function updateFoldInfo(cm, from, to) {\n    var opts = cm.state.foldGutter.options, cur = from;\n    var minSize = cm.foldOption(opts, \"minFoldSize\");\n    var func = cm.foldOption(opts, \"rangeFinder\");\n    cm.eachLine(from, to, function(line) {\n      var mark = null;\n      if (isFolded(cm, cur)) {\n        mark = marker(opts.indicatorFolded);\n      } else {\n        var pos = Pos(cur, 0);\n        var range = func && func(cm, pos);\n        if (range && range.to.line - range.from.line >= minSize)\n          mark = marker(opts.indicatorOpen);\n      }\n      cm.setGutterMarker(line, opts.gutter, mark);\n      ++cur;\n    });\n  }\n\n  function updateInViewport(cm) {\n    var vp = cm.getViewport(), state = cm.state.foldGutter;\n    if (!state) return;\n    cm.operation(function() {\n      updateFoldInfo(cm, vp.from, vp.to);\n    });\n    state.from = vp.from; state.to = vp.to;\n  }\n\n  function onGutterClick(cm, line, gutter) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    if (gutter != opts.gutter) return;\n    var folded = isFolded(cm, line);\n    if (folded) folded.clear();\n    else cm.foldCode(Pos(line, 0), opts.rangeFinder);\n  }\n\n  function onChange(cm) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    state.from = state.to = 0;\n    clearTimeout(state.changeUpdate);\n    state.changeUpdate = setTimeout(function() { updateInViewport(cm); }, opts.foldOnChangeTimeSpan || 600);\n  }\n\n  function onViewportChange(cm) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    clearTimeout(state.changeUpdate);\n    state.changeUpdate = setTimeout(function() {\n      var vp = cm.getViewport();\n      if (state.from == state.to || vp.from - state.to > 20 || state.from - vp.to > 20) {\n        updateInViewport(cm);\n      } else {\n        cm.operation(function() {\n          if (vp.from < state.from) {\n            updateFoldInfo(cm, vp.from, state.from);\n            state.from = vp.from;\n          }\n          if (vp.to > state.to) {\n            updateFoldInfo(cm, state.to, vp.to);\n            state.to = vp.to;\n          }\n        });\n      }\n    }, opts.updateViewportTimeSpan || 400);\n  }\n\n  function onFold(cm, from) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var line = from.line;\n    if (line >= state.from && line < state.to)\n      updateFoldInfo(cm, line, line + 1);\n  }\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.registerHelper(\"fold\", \"brace\", function(cm, start) {\n  var line = start.line, lineText = cm.getLine(line);\n  var tokenType;\n\n  function findOpening(openCh) {\n    for (var at = start.ch, pass = 0;;) {\n      var found = at <= 0 ? -1 : lineText.lastIndexOf(openCh, at - 1);\n      if (found == -1) {\n        if (pass == 1) break;\n        pass = 1;\n        at = lineText.length;\n        continue;\n      }\n      if (pass == 1 && found < start.ch) break;\n      tokenType = cm.getTokenTypeAt(CodeMirror.Pos(line, found + 1));\n      if (!/^(comment|string)/.test(tokenType)) return found + 1;\n      at = found - 1;\n    }\n  }\n\n  var startToken = \"{\", endToken = \"}\", startCh = findOpening(\"{\");\n  if (startCh == null) {\n    startToken = \"[\", endToken = \"]\";\n    startCh = findOpening(\"[\");\n  }\n\n  if (startCh == null) return;\n  var count = 1, lastLine = cm.lastLine(), end, endCh;\n  outer: for (var i = line; i <= lastLine; ++i) {\n    var text = cm.getLine(i), pos = i == line ? startCh : 0;\n    for (;;) {\n      var nextOpen = text.indexOf(startToken, pos), nextClose = text.indexOf(endToken, pos);\n      if (nextOpen < 0) nextOpen = text.length;\n      if (nextClose < 0) nextClose = text.length;\n      pos = Math.min(nextOpen, nextClose);\n      if (pos == text.length) break;\n      if (cm.getTokenTypeAt(CodeMirror.Pos(i, pos + 1)) == tokenType) {\n        if (pos == nextOpen) ++count;\n        else if (!--count) { end = i; endCh = pos; break outer; }\n      }\n      ++pos;\n    }\n  }\n  if (end == null || line == end) return;\n  return {from: CodeMirror.Pos(line, startCh),\n          to: CodeMirror.Pos(end, endCh)};\n});\n\nCodeMirror.registerHelper(\"fold\", \"import\", function(cm, start) {\n  function hasImport(line) {\n    if (line < cm.firstLine() || line > cm.lastLine()) return null;\n    var start = cm.getTokenAt(CodeMirror.Pos(line, 1));\n    if (!/\\S/.test(start.string)) start = cm.getTokenAt(CodeMirror.Pos(line, start.end + 1));\n    if (start.type != \"keyword\" || start.string != \"import\") return null;\n    // Now find closing semicolon, return its position\n    for (var i = line, e = Math.min(cm.lastLine(), line + 10); i <= e; ++i) {\n      var text = cm.getLine(i), semi = text.indexOf(\";\");\n      if (semi != -1) return {startCh: start.end, end: CodeMirror.Pos(i, semi)};\n    }\n  }\n\n  var startLine = start.line, has = hasImport(startLine), prev;\n  if (!has || hasImport(startLine - 1) || ((prev = hasImport(startLine - 2)) && prev.end.line == startLine - 1))\n    return null;\n  for (var end = has.end;;) {\n    var next = hasImport(end.line + 1);\n    if (next == null) break;\n    end = next.end;\n  }\n  return {from: cm.clipPos(CodeMirror.Pos(startLine, has.startCh + 1)), to: end};\n});\n\nCodeMirror.registerHelper(\"fold\", \"include\", function(cm, start) {\n  function hasInclude(line) {\n    if (line < cm.firstLine() || line > cm.lastLine()) return null;\n    var start = cm.getTokenAt(CodeMirror.Pos(line, 1));\n    if (!/\\S/.test(start.string)) start = cm.getTokenAt(CodeMirror.Pos(line, start.end + 1));\n    if (start.type == \"meta\" && start.string.slice(0, 8) == \"#include\") return start.start + 8;\n  }\n\n  var startLine = start.line, has = hasInclude(startLine);\n  if (has == null || hasInclude(startLine - 1) != null) return null;\n  for (var end = startLine;;) {\n    var next = hasInclude(end + 1);\n    if (next == null) break;\n    ++end;\n  }\n  return {from: CodeMirror.Pos(startLine, has + 1),\n          to: cm.clipPos(CodeMirror.Pos(end))};\n});\n\n});\n","\nvar content = require(\"!!../../../css-loader/dist/cjs.js!./foldgutter.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../css-loader/dist/cjs.js!./foldgutter.css\", function() {\n\t\tvar newContent = require(\"!!../../../css-loader/dist/cjs.js!./foldgutter.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".CodeMirror-foldmarker {\\n  color: blue;\\n  text-shadow: #b9f 1px 1px 2px, #b9f -1px -1px 2px, #b9f 1px -1px 2px, #b9f -1px 1px 2px;\\n  font-family: arial;\\n  line-height: .3;\\n  cursor: pointer;\\n}\\n.CodeMirror-foldgutter {\\n  width: .7em;\\n}\\n.CodeMirror-foldgutter-open,\\n.CodeMirror-foldgutter-folded {\\n  cursor: pointer;\\n}\\n.CodeMirror-foldgutter-open:after {\\n  content: \\\"\\\\25BE\\\";\\n}\\n.CodeMirror-foldgutter-folded:after {\\n  content: \\\"\\\\25B8\\\";\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./state_editor.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./state_editor.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./state_editor.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2018 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n\\n.neuroglancer-state-editor {\\n  width: 80%;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./statistics.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./statistics.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./statistics.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2019 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-statistics-panel {\\n  overflow-x: auto;\\n  overflow-y: auto;\\n}\\n\\n.neuroglancer-statistics-panel > table > thead td {\\n  position: sticky;\\n  top: 0px;\\n  zIndex: 2;\\n  background-color: black;\\n}\\n\\n.neuroglancer-statistics-panel > table > tbody tr:hover {\\n  background-color: #333;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./annotation_tool_status.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./annotation_tool_status.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./annotation_tool_status.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2018 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-annotation-tool-status-widget {\\n  color: #3c3;\\n  font: 10pt sans-serif;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./viewer.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!./viewer.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!./viewer.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/**\\n * @license\\n * Copyright 2016 Google Inc.\\n * Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n * you may not use this file except in compliance with the License.\\n * You may obtain a copy of the License at\\n *\\n *      http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing, software\\n * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n * See the License for the specific language governing permissions and\\n * limitations under the License.\\n */\\n\\n.neuroglancer-viewer {\\n  outline: 0px;\\n}\\n\\n.neuroglancer-viewer-context-menu > label {\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: space-between;\\n}\\n\\n.neuroglancer-viewer-context-menu > label > input::before {\\n  flex: 1;\\n  content: \\\" \\\";\\n}\\n\\n.neuroglancer-viewer-context-menu > label > input {\\n  margin-left: 5px;\\n  width: 11ch;\\n}\\n\\n.neuroglancer-viewer-context-menu-limit-widget > input {\\n  width: 11ch;\\n}\\n\\n.neuroglancer-viewer-top-row {\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n  background-color: #222;\\n  margin-bottom: 3px;\\n  padding-right: 2px;\\n}\\n\", \"\"]);\n\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {registerEventListener} from 'neuroglancer/util/disposable';\n\n/**\n * Returns true if the event appears to be targetted on input text and should not be overridden by a\n * global handler.\n */\nexport function eventHasInputTextTarget(event: Event) {\n  const selection = window.getSelection();\n  if (selection !== null && !selection.isCollapsed) {\n    return true;\n  }\n  const {tagName} = (<HTMLElement>event.target);\n  if (tagName === 'TEXTAREA' || tagName === 'INPUT') {\n    return true;\n  }\n  return false;\n}\n\nexport function setClipboard(data: string, format = 'text/plain') {\n  let success = false;\n  const cleanup = registerEventListener(document, 'copy', (event: ClipboardEvent) => {\n    const {clipboardData} = event;\n    if (clipboardData !== null) {\n      clipboardData.setData(format, data);\n      success = true;\n    }\n    event.stopPropagation();\n    event.preventDefault();\n  }, true);\n  try {\n    document.execCommand('copy');\n  } finally {\n    cleanup();\n  }\n  return success;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {eventHasInputTextTarget} from 'neuroglancer/util/clipboard';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {getCachedJson} from 'neuroglancer/util/trackable';\nimport {Viewer} from 'neuroglancer/viewer';\n\nexport function bindDefaultCopyHandler(viewer: Viewer) {\n  viewer.registerEventListener(document, 'copy', (event: ClipboardEvent) => {\n    if (eventHasInputTextTarget(event)) {\n      return;\n    }\n    const stateJson = getCachedJson(viewer.state).value;\n    const {clipboardData} = event;\n    if (clipboardData !== null) {\n      clipboardData.setData('text/plain', JSON.stringify(stateJson, undefined, '  '));\n    }\n    event.preventDefault();\n  });\n}\n\n/**\n * Checks if s consists of 3 numbers separated by whitespace or commas, with optional parentheses or\n * brackets before and after.\n *\n * @param s The string to parse.\n * @return The parsed vector, or undefined if parsing failed.\n */\nexport function parsePositionString(s: string): vec3|undefined {\n  const match = s.match(\n      /^[\\[\\]{}()\\s,]*(\\d+(?:\\.\\d+)?)[,\\s]+(\\d+(?:\\.\\d+)?)[,\\s]+(\\d+(?:\\.\\d+)?)[\\[\\]{}()\\s,]*$/);\n  if (match !== null) {\n    return vec3.fromValues(parseFloat(match[1]), parseFloat(match[2]), parseFloat(match[3]));\n  }\n  return undefined;\n}\n\nexport function bindDefaultPasteHandler(viewer: Viewer) {\n  viewer.registerEventListener(document, 'paste', (event: ClipboardEvent) => {\n    if (eventHasInputTextTarget(event)) {\n      return;\n    }\n    const {clipboardData} = event;\n    if (clipboardData !== null) {\n      const data = clipboardData.getData('text/plain');\n      const parsedPosition = parsePositionString(data);\n      if (parsedPosition !== undefined) {\n        viewer.navigationState.position.setVoxelCoordinates(parsedPosition);\n      }\n    }\n    event.preventDefault();\n  });\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {EventActionMap} from 'neuroglancer/util/event_action_map';\nimport {InputEventBindings} from 'neuroglancer/viewer';\n\nlet defaultGlobalBindings: EventActionMap|undefined;\n\nexport function getDefaultGlobalBindings() {\n  if (defaultGlobalBindings === undefined) {\n    const map = new EventActionMap();\n    map.set('keyl', 'recolor');\n    map.set('keyx', 'clear-segments');\n    map.set('keys', 'toggle-show-slices');\n    map.set('keyb', 'toggle-scale-bar');\n    map.set('shift+keyb', 'toggle-default-annotations');\n    map.set('keya', 'toggle-axis-lines');\n    map.set('keyo', 'toggle-orthographic-projection');\n\n    for (let i = 1; i <= 9; ++i) {\n      map.set('digit' + i, 'toggle-layer-' + i);\n      map.set('control+digit' + i, 'select-layer-' + i);\n    }\n\n    map.set('keyn', 'add-layer');\n    map.set('keyh', 'help');\n\n    map.set('space', 'toggle-layout');\n    map.set('shift+space', 'toggle-layout-alternative');\n    map.set('backslash', 'toggle-show-statistics');\n    defaultGlobalBindings = map;\n  }\n  return defaultGlobalBindings;\n}\n\nlet defaultRenderedDataPanelBindings: EventActionMap|undefined;\nexport function getDefaultRenderedDataPanelBindings() {\n  if (defaultRenderedDataPanelBindings === undefined) {\n    defaultRenderedDataPanelBindings = EventActionMap.fromObject(\n        {\n          'arrowleft': 'x-',\n          'arrowright': 'x+',\n          'arrowup': 'y-',\n          'arrowdown': 'y+',\n          'comma': 'z-',\n          'period': 'z+',\n          'keyz': 'snap',\n          'control+equal': 'zoom-in',\n          'control+shift+equal': 'zoom-in',\n          'control+minus': 'zoom-out',\n          'keyr': 'rotate-relative-z-',\n          'keye': 'rotate-relative-z+',\n          'shift+arrowdown': 'rotate-relative-x-',\n          'shift+arrowup': 'rotate-relative-x+',\n          'shift+arrowleft': 'rotate-relative-y-',\n          'shift+arrowright': 'rotate-relative-y+',\n          'at:control+wheel': {action: 'zoom-via-wheel', preventDefault: true},\n          'at:wheel': {action: 'z+1-via-wheel', preventDefault: true},\n          'at:shift+wheel': {action: 'z+10-via-wheel', preventDefault: true},\n          'at:dblclick0': 'select',\n          'at:control+mousedown0': 'annotate',\n          'at:mousedown2': 'move-to-mouse-position',\n          'at:control+mousedown2': 'select-annotation',\n          'at:alt+mousedown0': 'move-annotation',\n          'at:control+alt+mousedown2': 'delete-annotation',\n          'at:touchpinch': 'zoom-via-touchpinch',\n          'at:touchrotate': 'rotate-in-plane-via-touchrotate',\n          'at:touchtranslate2': 'translate-in-plane-via-touchtranslate',\n          'at:touchhold1': 'move-to-mouse-position',\n          'at:touchtap1x2': 'select',\n          'at:touchtap2x3': 'snap',\n        },\n        {label: 'All Data Panels'});\n  }\n  return defaultRenderedDataPanelBindings;\n}\n\nlet defaultPerspectivePanelBindings: EventActionMap|undefined;\nexport function getDefaultPerspectivePanelBindings() {\n  if (defaultPerspectivePanelBindings === undefined) {\n    defaultPerspectivePanelBindings = EventActionMap.fromObject(\n        {\n          'at:mousedown0': {action: 'rotate-via-mouse-drag', stopPropagation: true},\n          'at:shift+mousedown0': {action: 'translate-via-mouse-drag', stopPropagation: true},\n          'at:touchtranslate1': 'rotate-out-of-plane-via-touchtranslate',\n        },\n        {parents: [[getDefaultRenderedDataPanelBindings(), Number.NEGATIVE_INFINITY]]});\n  }\n  return defaultPerspectivePanelBindings;\n}\n\nlet defaultSliceViewPanelBindings: EventActionMap|undefined;\nexport function getDefaultSliceViewPanelBindings() {\n  if (defaultSliceViewPanelBindings === undefined) {\n    defaultSliceViewPanelBindings = EventActionMap.fromObject(\n        {\n          'at:mousedown0': {action: 'translate-via-mouse-drag', stopPropagation: true},\n          'at:shift+mousedown0': {action: 'rotate-via-mouse-drag', stopPropagation: true},\n          'at:touchtranslate1': 'translate-z-via-touchtranslate',\n        },\n        {parents: [[getDefaultRenderedDataPanelBindings(), Number.NEGATIVE_INFINITY]]});\n  }\n  return defaultSliceViewPanelBindings;\n}\n\nexport function setDefaultInputEventBindings(inputEventBindings: InputEventBindings) {\n  inputEventBindings.global.addParent(getDefaultGlobalBindings(), Number.NEGATIVE_INFINITY);\n  inputEventBindings.sliceView.addParent(\n      getDefaultSliceViewPanelBindings(), Number.NEGATIVE_INFINITY);\n  inputEventBindings.perspectiveView.addParent(\n      getDefaultPerspectivePanelBindings(), Number.NEGATIVE_INFINITY);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {VolumeChunk, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {ChunkFormat} from 'neuroglancer/sliceview/volume/frontend';\nimport {TypedArray} from 'neuroglancer/util/array';\nimport {Disposable, RefCounted} from 'neuroglancer/util/disposable';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram, ShaderSamplerType, textureTargetForSamplerType} from 'neuroglancer/webgl/shader';\n\nconst textureUnitSymbol = Symbol('SingleTextureVolumeChunk.textureUnit');\nconst textureLayoutSymbol = Symbol('SingleTextureVolumeChunk.textureLayout');\n\nexport abstract class SingleTextureChunkFormat<TextureLayout extends Disposable> extends RefCounted\n    implements ChunkFormat {\n  constructor(public shaderKey: string) {\n    super();\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    builder.addTextureSampler(this.shaderSamplerType, 'uVolumeChunkSampler', textureUnitSymbol);\n  }\n\n  abstract get shaderSamplerType(): ShaderSamplerType;\n\n  beginDrawing(gl: GL, shader: ShaderProgram) {\n    let textureUnit = shader.textureUnit(textureUnitSymbol);\n    gl.activeTexture(WebGL2RenderingContext.TEXTURE0 + textureUnit);\n    (<any>shader)[textureLayoutSymbol] = null;\n  }\n\n  endDrawing(gl: GL, shader: ShaderProgram) {\n    gl.bindTexture(textureTargetForSamplerType[this.shaderSamplerType], null);\n    (<any>shader)[textureLayoutSymbol] = null;\n  }\n\n  /**\n   * Called each time textureLayout changes while drawing chunks.\n   */\n  abstract setupTextureLayout(gl: GL, shader: ShaderProgram, textureLayout: TextureLayout): void;\n\n  bindChunk<Data>(\n      gl: GL, shader: ShaderProgram, chunk: SingleTextureVolumeChunk<Data, TextureLayout>) {\n    let textureLayout = chunk.textureLayout!;\n    let existingTextureLayout = (<any>shader)[textureLayoutSymbol];\n    if (existingTextureLayout !== textureLayout) {\n      (<any>shader)[textureLayoutSymbol] = textureLayout;\n      this.setupTextureLayout(gl, shader, textureLayout);\n    }\n    gl.bindTexture(textureTargetForSamplerType[this.shaderSamplerType], chunk.texture);\n  }\n\n  abstract setTextureData(gl: GL, textureLayout: TextureLayout, data: TypedArray): void;\n\n  /**\n   * Does nothing, but may be overridden by subclass.\n   */\n  beginSource(_gl: GL, _shader: ShaderProgram) {}\n}\n\nexport abstract class SingleTextureVolumeChunk<Data, TextureLayout extends Disposable> extends\n    VolumeChunk {\n  texture: WebGLTexture|null = null;\n  data: Data;\n  textureLayout: TextureLayout|null;\n  chunkFormat: SingleTextureChunkFormat<TextureLayout>;\n\n  constructor(source: VolumeChunkSource, x: any) {\n    super(source, x);\n    this.data = x['data'];\n  }\n\n  abstract setTextureData(gl: GL): void;\n\n  copyToGPU(gl: GL) {\n    super.copyToGPU(gl);\n    let texture = this.texture = gl.createTexture();\n    const textureTarget = textureTargetForSamplerType[this.chunkFormat.shaderSamplerType];\n    gl.bindTexture(textureTarget, texture);\n    this.setTextureData(gl);\n    gl.bindTexture(textureTarget, null);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    gl.deleteTexture(this.texture);\n    this.texture = null;\n    this.textureLayout!.dispose();\n    this.textureLayout = null;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SingleTextureChunkFormat, SingleTextureVolumeChunk} from 'neuroglancer/sliceview/single_texture_chunk_format';\nimport {DataType, VolumeChunkSpecification} from 'neuroglancer/sliceview/volume/base';\nimport {VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {ChunkFormatHandler, registerChunkFormatHandler} from 'neuroglancer/sliceview/volume/frontend';\nimport {TypedArray, TypedArrayConstructor} from 'neuroglancer/util/array';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {vec3, vec3Key} from 'neuroglancer/util/geom';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram, ShaderSamplerPrefix, ShaderSamplerType} from 'neuroglancer/webgl/shader';\nimport {getShaderType} from 'neuroglancer/webgl/shader_lib';\nimport {computeTextureFormat, setThreeDimensionalTextureData, TextureFormat, ThreeDimensionalTextureAccessHelper} from 'neuroglancer/webgl/texture_access';\n\nclass TextureLayout extends RefCounted {\n  constructor(public chunkDataSize: vec3, public numChannels: number) {\n    super();\n  }\n\n  static get(gl: GL, chunkDataSize: vec3, numChannels: number) {\n    return gl.memoize.get(\n        `sliceview.UncompressedTextureLayout:${vec3Key(chunkDataSize)},${numChannels}`,\n        () => new TextureLayout(chunkDataSize, numChannels));\n  }\n}\n\nexport class ChunkFormat extends SingleTextureChunkFormat<TextureLayout> implements TextureFormat {\n  texelsPerElement: number;\n  textureInternalFormat: number;\n  textureFormat: number;\n  texelType: number;\n  arrayElementsPerTexel: number;\n  arrayConstructor: TypedArrayConstructor;\n  samplerPrefix: ShaderSamplerPrefix;\n  get shaderSamplerType() {\n    return `${this.samplerPrefix}sampler3D` as ShaderSamplerType;\n  }\n  private textureAccessHelper: ThreeDimensionalTextureAccessHelper;\n\n  static get(gl: GL, dataType: DataType, numChannels: number) {\n    let key = `sliceview.UncompressedChunkFormat:${dataType}:${numChannels}`;\n    return gl.memoize.get(key, () => new ChunkFormat(gl, dataType, numChannels, key));\n  }\n\n  constructor(_gl: GL, public dataType: DataType, public numChannels: number, key: string) {\n    super(key);\n    computeTextureFormat(this, dataType);\n    this.textureAccessHelper = new ThreeDimensionalTextureAccessHelper('chunkData');\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    let {textureAccessHelper} = this;\n    builder.addFragmentCode(\n        textureAccessHelper.getAccessor('readVolumeData', 'uVolumeChunkSampler', this.dataType));\n\n    let {numChannels} = this;\n    if (numChannels > 1) {\n      builder.addUniform('highp int', 'uChannelStride');\n      builder.addFragmentCode(`\nhighp int getChannelOffset(highp int channelIndex) {\n  return channelIndex * uChannelStride;\n}\n`);\n    } else {\n      builder.addFragmentCode(`highp int getChannelOffset(highp int channelIndex) { return 0; }`);\n    }\n    const shaderType = getShaderType(this.dataType);\n    builder.addFragmentCode(`\n${shaderType} getDataValue (highp int channelIndex) {\n  highp ivec3 p = getPositionWithinChunk();\n  return readVolumeData(ivec3(p.x, p.y, p.z + getChannelOffset(channelIndex)));\n}\n`);\n  }\n\n  /**\n   * Called each time textureLayout changes while drawing chunks.\n   */\n  setupTextureLayout(gl: GL, shader: ShaderProgram, textureLayout: TextureLayout) {\n    if (this.numChannels > 1) {\n      gl.uniform1i(shader.uniform('uChannelStride'), textureLayout.chunkDataSize[2]);\n    }\n  }\n\n  getTextureLayout(gl: GL, chunkDataSize: vec3) {\n    return TextureLayout.get(gl, chunkDataSize, this.numChannels);\n  }\n\n  setTextureData(gl: GL, textureLayout: TextureLayout, data: TypedArray) {\n    const {chunkDataSize} = textureLayout;\n    setThreeDimensionalTextureData(\n        gl, this, data, chunkDataSize[0], chunkDataSize[1], chunkDataSize[2] * this.numChannels);\n  }\n}\n\ninterface Source extends VolumeChunkSource {\n  chunkFormatHandler: UncompressedChunkFormatHandler;\n}\n\nexport class UncompressedVolumeChunk extends SingleTextureVolumeChunk<Uint8Array, TextureLayout> {\n  chunkFormat: ChunkFormat;\n  source: Source;\n\n  setTextureData(gl: GL) {\n    let {source} = this;\n    let {chunkFormatHandler} = source;\n    let {chunkFormat} = chunkFormatHandler;\n\n    let textureLayout: TextureLayout;\n    if (this.chunkDataSize === source.spec.chunkDataSize) {\n      this.textureLayout = textureLayout = chunkFormatHandler.textureLayout.addRef();\n    } else {\n      this.textureLayout = textureLayout = chunkFormat.getTextureLayout(gl, this.chunkDataSize);\n    }\n\n    this.chunkFormat.setTextureData(gl, textureLayout, this.data);\n  }\n\n  getChannelValueAt(dataPosition: vec3, channel: number): number|Uint64 {\n    let {chunkFormat} = this;\n    let chunkDataSize = this.chunkDataSize;\n    let index = dataPosition[0] +\n        chunkDataSize[0] *\n            (dataPosition[1] + chunkDataSize[1] * (dataPosition[2] + chunkDataSize[2] * channel));\n    let dataType = chunkFormat.dataType;\n    let data = this.data;\n    switch (dataType) {\n      case DataType.UINT8:\n      case DataType.FLOAT32:\n      case DataType.UINT16:\n      case DataType.UINT32:\n        return data[index];\n      case DataType.UINT64: {\n        let index2 = index * 2;\n        return new Uint64(data[index2], data[index2 + 1]);\n      }\n    }\n    throw new Error('Invalid data type: ' + dataType);\n  }\n}\n\nexport class UncompressedChunkFormatHandler extends RefCounted implements ChunkFormatHandler {\n  chunkFormat: ChunkFormat;\n  textureLayout: TextureLayout;\n\n  constructor(gl: GL, spec: VolumeChunkSpecification) {\n    super();\n    this.chunkFormat = this.registerDisposer(ChunkFormat.get(gl, spec.dataType, spec.numChannels));\n    this.textureLayout =\n        this.registerDisposer(this.chunkFormat.getTextureLayout(gl, spec.chunkDataSize));\n  }\n\n  getChunk(source: VolumeChunkSource, x: any) {\n    return new UncompressedVolumeChunk(source, x);\n  }\n}\n\nregisterChunkFormatHandler((gl: GL, spec: VolumeChunkSpecification) => {\n  if (spec.compressedSegmentationBlockSize == null) {\n    return new UncompressedChunkFormatHandler(gl, spec);\n  }\n  return null;\n});\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Support for decompressing uint32 and uint64 segment label chunks.\n */\n\n/**\n * Determines the offset of the value at the specified dataPosition in a single-channel compressed\n * segmentation.\n *\n * @param baseOffset The base offset into `data' at which the compressed data for this channel\n * starts.\n * @param chunkDataSize A 3-element array specifying the size of the volume,\n * @param blockSize A 3-element array specifying the block size ued for compression.\n * @param dataPosition A 3-element array specifying the position within the volume from which to\n * read.\n * @returns The offset into `data', relative to baseOffset, at which the value is located.\n */\nexport function decodeValueOffset(\n    data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>, dataPosition: ArrayLike<number>, uint32sPerElement: number) {\n  let gridOffset = 0, subchunkOffset = 0, gridStride = 1, subchunkStride = 1;\n  for (let i = 0; i < 3; ++i) {\n    let posValue = dataPosition[i];\n    let subchunkSizeValue = blockSize[i];\n    let gridSubscript = Math.floor(posValue / subchunkSizeValue);\n    let subchunkSubscript = posValue % subchunkSizeValue;\n    gridOffset += gridSubscript * gridStride;\n    gridStride *= Math.ceil(chunkDataSize[i] / subchunkSizeValue);\n    subchunkOffset += subchunkSubscript * subchunkStride;\n    subchunkStride *= subchunkSizeValue;\n  }\n  let subchunkHeaderOffset = baseOffset + gridOffset * 2;\n  let subchunkHeader0 = data[subchunkHeaderOffset];\n  let subchunkHeader1 = data[subchunkHeaderOffset + 1];\n  let outputValueOffset = subchunkHeader0 & 0xFFFFFF;\n  let encodingBits = (subchunkHeader0 >> 24) & 0xFF;\n  if (encodingBits > 0) {\n    let encodedValueBaseOffset = baseOffset + subchunkHeader1 & 0xFFFFFF;\n    let encodedValueOffset =\n        encodedValueBaseOffset + Math.floor(subchunkOffset * encodingBits / 32.0);\n    let encodedValue = data[encodedValueOffset];\n    let wordOffset = (subchunkOffset * encodingBits) % 32;\n\n    let decodedValue = (encodedValue >> wordOffset) & ((1 << encodingBits) - 1);\n    outputValueOffset += uint32sPerElement * decodedValue;\n  }\n  return outputValueOffset;\n}\n","// DO NOT EDIT.  Generated from\n// templates/neuroglancer/sliceview/compressed_segmentation/decode.template.ts.\n/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Support for decompressing uint64 segment label chunks.\n */\n\nimport {decodeValueOffset} from 'neuroglancer/sliceview/compressed_segmentation/decode_common';\n\n\n\n/**\n * Reads the single value at the specified dataPosition in a single-channel compressed segmentation.\n *\n * @param baseOffset The base offset into `data' at which the compressed data for this channel\n * starts.\n * @param chunkDataSize A 3-element array specifying the size of the volume.\n * @param blockSize A 3-element array specifying the block size ued for compression.\n * @param dataPosition A 3-element array specifying the position within the volume from which to\n * read.\n *\n * Stores the result in `out'.\n */\nexport function readSingleChannelValue(\n\n    data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>, dataPosition: ArrayLike<number>) {\n  let outputValueOffset =\n      decodeValueOffset(data, baseOffset, chunkDataSize, blockSize, dataPosition, 1) + baseOffset;\n\n  return data[outputValueOffset];\n}\n\n/**\n * Reads the single value (of a single channel) at the specified dataPosition in a multi-channel\n * compressed segmentation.\n *\n * @param dataPosition A 4-element [x, y, z, channel] array specifying the position to read.\n */\nexport function readValue(\n\n    data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>, dataPosition: ArrayLike<number>) {\n  return readSingleChannelValue(\n\n      data, baseOffset + data[dataPosition[3]], chunkDataSize, blockSize, dataPosition);\n}\n\n/**\n * Decodes a single channel of a compressed segmentation.\n *\n * This is not particularly efficient, because it is intended for testing purposes only.\n */\nexport function decodeChannel(\n    out: Uint32Array, data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>) {\n  const expectedLength = chunkDataSize[0] * chunkDataSize[1] * chunkDataSize[2] * 1;\n  if (expectedLength !== out.length) {\n    throw new Error(\n        `Output length ${out.length} is not equal to expected length ${expectedLength}.`);\n  }\n  let vx = chunkDataSize[0];\n  let vy = chunkDataSize[1];\n  let vz = chunkDataSize[2];\n  let dataPosition = [0, 0, 0];\n  let outputOffset = 0;\n  for (let z = 0; z < vz; ++z) {\n    dataPosition[2] = z;\n    for (let y = 0; y < vy; ++y) {\n      dataPosition[1] = y;\n      for (let x = 0; x < vx; ++x) {\n        dataPosition[0] = x;\n        let outputValueOffset =\n            decodeValueOffset(data, baseOffset, chunkDataSize, blockSize, dataPosition, 1) +\n            baseOffset;\n        out[outputOffset++] = data[outputValueOffset];\n      }\n    }\n  }\n  return out;\n}\n\n/**\n * Decodes a multi-channel compressed segmentation.\n *\n * This is not particularly efficient, because it is intended for testing purposes only.\n */\nexport function decodeChannels(\n    out: Uint32Array, data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>) {\n  const channelOutputLength = chunkDataSize[0] * chunkDataSize[1] * chunkDataSize[2] * 1;\n  const expectedLength = channelOutputLength * chunkDataSize[3];\n  if (expectedLength !== out.length) {\n    throw new Error(\n        `Output length ${out.length} is not equal to expected length ${expectedLength}.`);\n  }\n  const numChannels = chunkDataSize[3];\n  for (let channel = 0; channel < numChannels; ++channel) {\n    decodeChannel(\n        out.subarray(channelOutputLength * channel, channelOutputLength * (channel + 1)), data,\n        baseOffset + data[channel], chunkDataSize, blockSize);\n  }\n  return out;\n}\n","// DO NOT EDIT.  Generated from\n// templates/neuroglancer/sliceview/compressed_segmentation/decode.template.ts.\n/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Support for decompressing uint64 segment label chunks.\n */\n\nimport {decodeValueOffset} from 'neuroglancer/sliceview/compressed_segmentation/decode_common';\n\n\nimport {Uint64} from 'neuroglancer/util/uint64';\n\n\n/**\n * Reads the single value at the specified dataPosition in a single-channel compressed segmentation.\n *\n * @param baseOffset The base offset into `data' at which the compressed data for this channel\n * starts.\n * @param chunkDataSize A 3-element array specifying the size of the volume.\n * @param blockSize A 3-element array specifying the block size ued for compression.\n * @param dataPosition A 3-element array specifying the position within the volume from which to\n * read.\n *\n * Stores the result in `out'.\n */\nexport function readSingleChannelValue(\n\n    out: Uint64,\n\n    data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>, dataPosition: ArrayLike<number>) {\n  let outputValueOffset =\n      decodeValueOffset(data, baseOffset, chunkDataSize, blockSize, dataPosition, 2) + baseOffset;\n\n  out.low = data[outputValueOffset];\n  out.high = data[outputValueOffset + 1];\n  return out;\n}\n\n/**\n * Reads the single value (of a single channel) at the specified dataPosition in a multi-channel\n * compressed segmentation.\n *\n * @param dataPosition A 4-element [x, y, z, channel] array specifying the position to read.\n */\nexport function readValue(\n\n    out: Uint64,\n\n    data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>, dataPosition: ArrayLike<number>) {\n  return readSingleChannelValue(\n\n      out,\n\n      data, baseOffset + data[dataPosition[3]], chunkDataSize, blockSize, dataPosition);\n}\n\n/**\n * Decodes a single channel of a compressed segmentation.\n *\n * This is not particularly efficient, because it is intended for testing purposes only.\n */\nexport function decodeChannel(\n    out: Uint32Array, data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>) {\n  const expectedLength = chunkDataSize[0] * chunkDataSize[1] * chunkDataSize[2] * 2;\n  if (expectedLength !== out.length) {\n    throw new Error(\n        `Output length ${out.length} is not equal to expected length ${expectedLength}.`);\n  }\n  let vx = chunkDataSize[0];\n  let vy = chunkDataSize[1];\n  let vz = chunkDataSize[2];\n  let dataPosition = [0, 0, 0];\n  let outputOffset = 0;\n  for (let z = 0; z < vz; ++z) {\n    dataPosition[2] = z;\n    for (let y = 0; y < vy; ++y) {\n      dataPosition[1] = y;\n      for (let x = 0; x < vx; ++x) {\n        dataPosition[0] = x;\n        let outputValueOffset =\n            decodeValueOffset(data, baseOffset, chunkDataSize, blockSize, dataPosition, 2) +\n            baseOffset;\n        out[outputOffset++] = data[outputValueOffset];\n\n        out[outputOffset++] = data[outputValueOffset + 1];\n      }\n    }\n  }\n  return out;\n}\n\n/**\n * Decodes a multi-channel compressed segmentation.\n *\n * This is not particularly efficient, because it is intended for testing purposes only.\n */\nexport function decodeChannels(\n    out: Uint32Array, data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>) {\n  const channelOutputLength = chunkDataSize[0] * chunkDataSize[1] * chunkDataSize[2] * 2;\n  const expectedLength = channelOutputLength * chunkDataSize[3];\n  if (expectedLength !== out.length) {\n    throw new Error(\n        `Output length ${out.length} is not equal to expected length ${expectedLength}.`);\n  }\n  const numChannels = chunkDataSize[3];\n  for (let channel = 0; channel < numChannels; ++channel) {\n    decodeChannel(\n        out.subarray(channelOutputLength * channel, channelOutputLength * (channel + 1)), data,\n        baseOffset + data[channel], chunkDataSize, blockSize);\n  }\n  return out;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {readSingleChannelValue as readSingleChannelValueUint32} from 'neuroglancer/sliceview/compressed_segmentation/decode_uint32';\nimport {readSingleChannelValue as readSingleChannelValueUint64} from 'neuroglancer/sliceview/compressed_segmentation/decode_uint64';\nimport {SingleTextureChunkFormat, SingleTextureVolumeChunk} from 'neuroglancer/sliceview/single_texture_chunk_format';\nimport {DataType, VolumeChunkSpecification} from 'neuroglancer/sliceview/volume/base';\nimport {ChunkFormatHandler, registerChunkFormatHandler} from 'neuroglancer/sliceview/volume/frontend';\nimport {VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {vec3, vec3Key} from 'neuroglancer/util/geom';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram, ShaderSamplerType} from 'neuroglancer/webgl/shader';\nimport {getShaderType, glsl_getFortranOrderIndex, glsl_uint32, glsl_uint64} from 'neuroglancer/webgl/shader_lib';\nimport {compute1dTextureLayout, computeTextureFormat, OneDimensionalTextureAccessHelper, setOneDimensionalTextureData, TextureFormat} from 'neuroglancer/webgl/texture_access';\n\nclass TextureLayout extends RefCounted {\n  textureXBits: number;\n  textureWidth: number;\n  textureHeight: number;\n  subchunkGridSize: vec3;\n\n  constructor(gl: GL, public chunkDataSize: vec3, public subchunkSize: vec3, dataLength: number) {\n    super();\n    compute1dTextureLayout(this, gl, /*texelsPerElement=*/ 1, dataLength);\n    let subchunkGridSize = this.subchunkGridSize = vec3.create();\n    for (let i = 0; i < 3; ++i) {\n      subchunkGridSize[i] = Math.ceil(chunkDataSize[i] / subchunkSize[i]);\n    }\n  }\n\n  static get(gl: GL, chunkDataSize: vec3, subchunkSize: vec3, dataLength: number) {\n    return gl.memoize.get(\n        `sliceview.CompressedSegmentationTextureLayout:${vec3Key(chunkDataSize)},` +\n            `${vec3Key(subchunkSize)},${dataLength}`,\n        () => new TextureLayout(gl, chunkDataSize, subchunkSize, dataLength));\n  }\n}\n\nconst textureFormat = computeTextureFormat(new TextureFormat(), DataType.UINT32);\n\nexport class ChunkFormat extends SingleTextureChunkFormat<TextureLayout> {\n  static get(gl: GL, dataType: DataType, subchunkSize: vec3, numChannels: number) {\n    let shaderKey = `sliceview.CompressedSegmentationChunkFormat:${dataType}:${numChannels}`;\n    let cacheKey = `${shaderKey}:${vec3Key(subchunkSize)}`;\n    return gl.memoize.get(\n        cacheKey, () => new ChunkFormat(dataType, subchunkSize, numChannels, shaderKey));\n  }\n\n  private textureAccessHelper: OneDimensionalTextureAccessHelper;\n\n  get shaderSamplerType(): ShaderSamplerType {\n    return 'usampler2D';\n  }\n\n  constructor(\n      public dataType: DataType, public subchunkSize: vec3, public numChannels: number,\n      key: string) {\n    super(key);\n    this.textureAccessHelper = new OneDimensionalTextureAccessHelper('chunkData');\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    let {textureAccessHelper} = this;\n    textureAccessHelper.defineShader(builder);\n    let local = (x: string) => 'compressedSegmentationChunkFormat_' + x;\n    builder.addUniform('highp ivec3', 'uSubchunkGridSize');\n    builder.addUniform('highp ivec3', 'uSubchunkSize');\n    builder.addFragmentCode(glsl_getFortranOrderIndex);\n    const {dataType} = this;\n    const glslType = getShaderType(dataType);\n\n    if (dataType === DataType.UINT64) {\n      builder.addFragmentCode(glsl_uint64);\n    } else {\n      builder.addFragmentCode(glsl_uint32);\n    }\n    builder.addFragmentCode(textureAccessHelper.getAccessor(\n        local('readTextureValue'), 'uVolumeChunkSampler', DataType.UINT32, 1));\n    let fragmentCode = `\nuint ${local('getChannelOffset')}(int channelIndex) {\n  if (channelIndex == 0) {\n    return ${this.numChannels}u;\n  }\n  return ${local('readTextureValue')}(uint(channelIndex)).value;\n}\n${glslType} getDataValue (int channelIndex) {\n  ivec3 chunkPosition = getPositionWithinChunk();\n\n  // TODO: maybe premultiply this and store as uniform.\n  ivec3 subchunkGridPosition = chunkPosition / uSubchunkSize;\n  int subchunkGridOffset = getFortranOrderIndex(subchunkGridPosition, uSubchunkGridSize);\n\n  int channelOffset = int(${local('getChannelOffset')}(channelIndex));\n\n  // TODO: Maybe just combine this offset into subchunkGridStrides.\n  int subchunkHeaderOffset = subchunkGridOffset * 2 + channelOffset;\n\n  highp uint subchunkHeader0 = ${local('readTextureValue')}(uint(subchunkHeaderOffset)).value;\n  highp uint subchunkHeader1 = ${local('readTextureValue')}(uint(subchunkHeaderOffset + 1)).value;\n  highp uint outputValueOffset = (subchunkHeader0 & 0xFFFFFFu) + uint(channelOffset);\n  highp uint encodingBits = subchunkHeader0 >> 24u;\n  if (encodingBits > 0u) {\n    ivec3 subchunkPosition = chunkPosition - subchunkGridPosition * uSubchunkSize;\n    int subchunkOffset = getFortranOrderIndex(subchunkPosition, uSubchunkSize);\n    uint encodedValueBaseOffset = subchunkHeader1 + uint(channelOffset);\n    uint encodedValueOffset = encodedValueBaseOffset + uint(subchunkOffset) * encodingBits / 32u;\n    uint encodedValue = ${local('readTextureValue')}(encodedValueOffset).value;\n    uint wordOffset = uint(subchunkOffset) * encodingBits % 32u;\n    uint encodedValueShifted = encodedValue >> wordOffset;\n    uint decodedValue = encodedValueShifted - (encodedValueShifted >> encodingBits << encodingBits);\n    outputValueOffset += decodedValue * ${this.dataType === DataType.UINT64 ? '2u' : '1u'};\n  }\n  ${glslType} result;\n`;\n    if (dataType === DataType.UINT64) {\n      fragmentCode += `\n  result.value[0] = ${local('readTextureValue')}(outputValueOffset).value;\n  result.value[1] = ${local('readTextureValue')}(outputValueOffset+1u).value;\n`;\n    } else {\n      fragmentCode += `\n  result.value = ${local('readTextureValue')}(outputValueOffset).value;\n`;\n    }\n    fragmentCode += `\n  return result;\n}\n`;\n    builder.addFragmentCode(fragmentCode);\n  }\n\n  /**\n   * Called each time textureLayout changes while drawing chunks.\n   */\n  setupTextureLayout(gl: GL, shader: ShaderProgram, textureLayout: TextureLayout) {\n    const {subchunkGridSize} = textureLayout;\n    gl.uniform3i(\n        shader.uniform('uSubchunkGridSize'), subchunkGridSize[0], subchunkGridSize[1],\n        subchunkGridSize[2]);\n    this.textureAccessHelper.setupTextureLayout(gl, shader, textureLayout);\n  }\n\n  setTextureData(gl: GL, textureLayout: TextureLayout, data: Uint32Array) {\n    setOneDimensionalTextureData(gl, textureLayout, textureFormat, data);\n  }\n\n  getTextureLayout(gl: GL, chunkDataSize: vec3, dataLength: number) {\n    return TextureLayout.get(gl, chunkDataSize, this.subchunkSize, dataLength);\n  }\n\n  beginSource(gl: GL, shader: ShaderProgram) {\n    super.beginSource(gl, shader);\n    const {subchunkSize} = this;\n    gl.uniform3i(\n        shader.uniform('uSubchunkSize'), subchunkSize[0], subchunkSize[1], subchunkSize[2]);\n  }\n}\n\nexport class CompressedSegmentationVolumeChunk extends\n    SingleTextureVolumeChunk<Uint32Array, TextureLayout> {\n  chunkFormat: ChunkFormat;\n\n  setTextureData(gl: GL) {\n    let {data} = this;\n    let {chunkFormat} = this;\n    let textureLayout = this.textureLayout =\n        chunkFormat.getTextureLayout(gl, this.chunkDataSize, data.length);\n    chunkFormat.setTextureData(gl, textureLayout, data);\n  }\n\n  getChannelValueAt(dataPosition: vec3, channel: number): Uint64|number {\n    let {chunkDataSize, chunkFormat} = this;\n    let {data} = this;\n    let offset = data[channel];\n    if (chunkFormat.dataType === DataType.UINT64) {\n      let result = new Uint64();\n      readSingleChannelValueUint64(\n          result, data, /*baseOffset=*/ offset, chunkDataSize, chunkFormat.subchunkSize,\n          dataPosition);\n      return result;\n    } else {\n      return readSingleChannelValueUint32(\n          data, /*baseOffset=*/ offset, chunkDataSize, chunkFormat.subchunkSize, dataPosition);\n    }\n  }\n}\n\nexport class CompressedSegmentationChunkFormatHandler extends RefCounted implements\n    ChunkFormatHandler {\n  chunkFormat: ChunkFormat;\n\n  constructor(gl: GL, spec: VolumeChunkSpecification) {\n    super();\n    let {dataType} = spec;\n    if (dataType !== DataType.UINT64 && dataType !== DataType.UINT32) {\n      throw new Error(`Unsupported compressed segmentation data type: ${DataType[dataType]}`);\n    }\n    this.chunkFormat = this.registerDisposer(ChunkFormat.get(\n        gl, spec.dataType, spec.compressedSegmentationBlockSize!, spec.numChannels));\n  }\n\n  getChunk(source: VolumeChunkSource, x: any) {\n    return new CompressedSegmentationVolumeChunk(source, x);\n  }\n}\n\nregisterChunkFormatHandler((gl: GL, spec: VolumeChunkSpecification) => {\n  if (spec.compressedSegmentationBlockSize != null) {\n    return new CompressedSegmentationChunkFormatHandler(gl, spec);\n  }\n  return null;\n});\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface Handler { (element: HTMLElement): void; }\n\nexport function withFlex(value: any, handler: Handler) {\n  return (element: HTMLElement) => {\n    element.style.flex = value;\n    handler(element);\n  };\n}\nexport function withStyle(style: {}, handler: Handler) {\n  return (element: HTMLElement) => {\n    Object.assign(element.style, style);\n    handler(element);\n  };\n}\n\nexport function withAttributes(attributes: {}, handler: Handler) {\n  return (element: HTMLElement) => {\n    Object.assign(element, attributes);\n    handler(element);\n  };\n}\n\nexport function box(flexDirection: string, spec: Handler[]) {\n  return (container: HTMLElement) => {\n    container.style.display = 'flex';\n    container.style.flexDirection = flexDirection;\n    for (let handler of spec) {\n      let element = container.ownerDocument!.createElement('div');\n      container.appendChild(element);\n      handler(element);\n    }\n  };\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const PERSPECTIVE_VIEW_RPC_ID = 'perspective_view/PerspectiveView';\nexport const PERSPECTIVE_VIEW_ADD_LAYER_RPC_ID = 'perspective_view/addLayer';\nexport const PERSPECTIVE_VIEW_REMOVE_LAYER_RPC_ID = 'perspective_view/removeLayer';\nexport const PERSPECTIVE_VIEW_UPDATE_VIEWPORT_RPC_ID = 'perspective_view/updateViewport';\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {NullarySignal} from 'neuroglancer/util/signal';\n\nexport class WatchableMap<K, V> extends RefCounted {\n  changed = new NullarySignal();\n  map: Map<K, V>;\n  constructor(\n      private register: (v: V, k: K) => void, private unregister: (v: V, k: K) => void,\n      values?: Iterable<[K, V]>) {\n    super();\n    if (values === undefined) {\n      this.map = new Map();\n    } else {\n      this.map = new Map(values);\n      this.map.forEach(this.register);\n    }\n  }\n  set(key: K, value: V) {\n    const {map} = this;\n    const existing = map.get(key);\n    if (existing !== undefined) {\n      this.unregister(existing, key);\n    }\n    map.set(key, value);\n    this.register(value, key);\n    this.changed.dispatch();\n    return this;\n  }\n  delete(key: K) {\n    const {map} = this;\n    const existing = map.get(key);\n    if (existing !== undefined) {\n      this.unregister(existing, key);\n      this.changed.dispatch();\n      return true;\n    }\n    return false;\n  }\n  has(key: K) {\n    return this.map.has(key);\n  }\n  get size() {\n    return this.map.size;\n  }\n  [Symbol.iterator]() {\n    return this.map[Symbol.iterator]();\n  }\n  clear() {\n    const {map} = this;\n    if (map.size > 0) {\n      map.forEach(this.unregister);\n      map.clear();\n      this.changed.dispatch();\n    }\n  }\n  values() {\n    return this.map.values();\n  }\n  keys() {\n    return this.map.keys();\n  }\n  disposed() {\n    const {map} = this;\n    map.forEach(this.unregister);\n    this.map.clear();\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport throttle from 'lodash/throttle';\nimport {AxesLineHelper} from 'neuroglancer/axes_lines';\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {makeRenderedPanelVisibleLayerTracker, VisibleRenderLayerTracker} from 'neuroglancer/layer';\nimport {PERSPECTIVE_VIEW_ADD_LAYER_RPC_ID, PERSPECTIVE_VIEW_REMOVE_LAYER_RPC_ID, PERSPECTIVE_VIEW_RPC_ID, PERSPECTIVE_VIEW_UPDATE_VIEWPORT_RPC_ID} from 'neuroglancer/perspective_view/base';\nimport {PerspectiveViewReadyRenderContext, PerspectiveViewRenderContext, PerspectiveViewRenderLayer} from 'neuroglancer/perspective_view/render_layer';\nimport {clearOutOfBoundsPickData, FramePickingData, pickDiameter, pickOffsetSequence, pickRadius, RenderedDataPanel, RenderedDataViewerState} from 'neuroglancer/rendered_data_panel';\nimport {SliceView, SliceViewRenderHelper} from 'neuroglancer/sliceview/frontend';\nimport {TrackableBoolean, TrackableBooleanCheckbox} from 'neuroglancer/trackable_boolean';\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {Owned} from 'neuroglancer/util/disposable';\nimport {ActionEvent, registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {kAxes, mat4, transformVectorByMat4, vec3, vec4} from 'neuroglancer/util/geom';\nimport {startRelativeMouseDrag} from 'neuroglancer/util/mouse_drag';\nimport {TouchRotateInfo, TouchTranslateInfo} from 'neuroglancer/util/touch_bindings';\nimport {WatchableMap} from 'neuroglancer/util/watchable_map';\nimport {withSharedVisibility} from 'neuroglancer/visibility_priority/frontend';\nimport {DepthBuffer, FramebufferConfiguration, makeTextureBuffers, OffscreenCopyHelper, TextureBuffer} from 'neuroglancer/webgl/offscreen';\nimport {ShaderBuilder} from 'neuroglancer/webgl/shader';\nimport {ScaleBarOptions, ScaleBarTexture} from 'neuroglancer/widget/scale_bar';\nimport {RPC, SharedObject} from 'neuroglancer/worker_rpc';\n\nrequire('neuroglancer/noselect.css');\nrequire('./panel.css');\n\nexport interface PerspectiveViewerState extends RenderedDataViewerState {\n  orthographicProjection: TrackableBoolean;\n  showSliceViews: TrackableBoolean;\n  showScaleBar: TrackableBoolean;\n  scaleBarOptions: TrackableValue<ScaleBarOptions>;\n  showSliceViewsCheckbox?: boolean;\n  crossSectionBackgroundColor: TrackableRGB;\n  perspectiveViewBackgroundColor: TrackableRGB;\n  rpc: RPC;\n}\n\nexport enum OffscreenTextures {\n  COLOR,\n  Z,\n  PICK,\n  NUM_TEXTURES\n}\n\nexport const glsl_perspectivePanelEmit = `\nvoid emit(vec4 color, highp uint pickId) {\n  out_color = color;\n  out_z = 1.0 - gl_FragCoord.z;\n  out_pickId = float(pickId);\n}\n`;\n\n/**\n * http://jcgt.org/published/0002/02/09/paper.pdf\n * http://casual-effects.blogspot.com/2015/03/implemented-weighted-blended-order.html\n */\nexport const glsl_computeOITWeight = `\nfloat computeOITWeight(float alpha) {\n  float a = min(1.0, alpha) * 8.0 + 0.01;\n  float b = -gl_FragCoord.z * 0.95 + 1.0;\n  return a * a * a * b * b * b;\n}\n`;\n\n// Color must be premultiplied by alpha.\nexport const glsl_perspectivePanelEmitOIT = [\n  glsl_computeOITWeight, `\nvoid emit(vec4 color, highp uint pickId) {\n  float weight = computeOITWeight(color.a);\n  vec4 accum = color * weight;\n  v4f_fragData0 = vec4(accum.rgb, color.a);\n  v4f_fragData1 = vec4(accum.a, 0.0, 0.0, 0.0);\n}\n`\n];\n\nexport function perspectivePanelEmit(builder: ShaderBuilder) {\n  builder.addOutputBuffer('vec4', `out_color`, OffscreenTextures.COLOR);\n  builder.addOutputBuffer('highp float', `out_z`, OffscreenTextures.Z);\n  builder.addOutputBuffer('highp float', `out_pickId`, OffscreenTextures.PICK);\n  builder.addFragmentCode(glsl_perspectivePanelEmit);\n}\n\nexport function perspectivePanelEmitOIT(builder: ShaderBuilder) {\n  builder.addOutputBuffer('vec4', 'v4f_fragData0', 0);\n  builder.addOutputBuffer('vec4', 'v4f_fragData1', 1);\n  builder.addFragmentCode(glsl_perspectivePanelEmitOIT);\n}\n\nconst tempVec3 = vec3.create();\nconst tempVec3b = vec3.create();\nconst tempVec4 = vec4.create();\nconst tempMat4 = mat4.create();\n\nfunction defineTransparencyCopyShader(builder: ShaderBuilder) {\n  builder.addOutputBuffer('vec4', 'v4f_fragColor', null);\n  builder.setFragmentMain(`\nvec4 v0 = getValue0();\nvec4 v1 = getValue1();\nvec4 accum = vec4(v0.rgb, v1.r);\nfloat revealage = v0.a;\n\nv4f_fragColor = vec4(accum.rgb / accum.a, revealage);\n`);\n}\n\nconst PerspectiveViewStateBase = withSharedVisibility(SharedObject);\nclass PerspectiveViewState extends PerspectiveViewStateBase {}\n\nexport class PerspectivePanel extends RenderedDataPanel {\n  viewer: PerspectiveViewerState;\n\n  protected visibleLayerTracker: Owned<VisibleRenderLayerTracker<PerspectiveViewRenderLayer>>;\n\n  /**\n   * If boolean value is true, sliceView is shown unconditionally, regardless of the value of\n   * this.viewer.showSliceViews.value.\n   */\n  sliceViews = (() => {\n    const sliceViewDisposers = new Map<SliceView, () => void>();\n    return this.registerDisposer(new WatchableMap<SliceView, boolean>(\n        (_unconditional, sliceView) => {\n          const disposer = sliceView.visibility.add(this.visibility);\n          sliceViewDisposers.set(sliceView, disposer);\n          this.scheduleRedraw();\n        },\n        (_unconditional, sliceView) => {\n          const disposer = sliceViewDisposers.get(sliceView)!;\n          sliceViewDisposers.delete(sliceView);\n          disposer();\n          sliceView.dispose();\n          this.scheduleRedraw();\n        }));\n  })();\n\n  /**\n   * Transform from camera space to OpenGL clip space.\n   */\n  projectionMat = mat4.create();\n\n  /**\n   * Transform from world space to camera space.\n   */\n  viewMat = mat4.create();\n\n  /**\n   * Inverse of `viewMat`.\n   */\n  viewMatInverse = mat4.create();\n\n  /**\n   * Transform from world space to OpenGL clip space.  Equal to `projectionMat * viewMat`.\n   */\n  viewProjectionMat = mat4.create();\n\n  /**\n   * Inverse of `viewProjectionMat`.\n   */\n  viewProjectionMatInverse = mat4.create();\n\n  /**\n   * Width of panel viewport in pixels.\n   */\n  width = 0;\n\n  /**\n   * Height of panel viewport in pixels.\n   */\n  height = 0;\n\n  private axesLineHelper = this.registerDisposer(AxesLineHelper.get(this.gl));\n  sliceViewRenderHelper =\n      this.registerDisposer(SliceViewRenderHelper.get(this.gl, perspectivePanelEmit));\n\n  protected offscreenFramebuffer = this.registerDisposer(new FramebufferConfiguration(this.gl, {\n    colorBuffers: [\n      new TextureBuffer(\n          this.gl, WebGL2RenderingContext.RGBA8, WebGL2RenderingContext.RGBA,\n          WebGL2RenderingContext.UNSIGNED_BYTE),\n      new TextureBuffer(\n          this.gl, WebGL2RenderingContext.R32F, WebGL2RenderingContext.RED,\n          WebGL2RenderingContext.FLOAT),\n      new TextureBuffer(\n          this.gl, WebGL2RenderingContext.R32F, WebGL2RenderingContext.RED,\n          WebGL2RenderingContext.FLOAT),\n    ],\n    depthBuffer: new DepthBuffer(this.gl)\n  }));\n\n  protected transparentConfiguration_: FramebufferConfiguration<TextureBuffer>|undefined;\n\n  protected offscreenCopyHelper = this.registerDisposer(OffscreenCopyHelper.get(this.gl));\n  protected transparencyCopyHelper =\n      this.registerDisposer(OffscreenCopyHelper.get(this.gl, defineTransparencyCopyShader, 2));\n\n  private sharedObject: PerspectiveViewState;\n\n  private scaleBarCopyHelper = this.registerDisposer(OffscreenCopyHelper.get(this.gl));\n  private scaleBarTexture = this.registerDisposer(new ScaleBarTexture(this.gl));\n\n  private nanometersPerPixel = 1;\n\n\n  constructor(context: DisplayContext, element: HTMLElement, viewer: PerspectiveViewerState) {\n    super(context, element, viewer);\n    this.registerDisposer(this.navigationState.changed.add(() => {\n      this.throttledSendViewportUpdate();\n      this.context.scheduleRedraw();\n    }));\n\n    const sharedObject = this.sharedObject = this.registerDisposer(new PerspectiveViewState());\n    sharedObject.RPC_TYPE_ID = PERSPECTIVE_VIEW_RPC_ID;\n    sharedObject.initializeCounterpart(viewer.rpc, {});\n    sharedObject.visibility.add(this.visibility);\n\n    this.visibleLayerTracker = makeRenderedPanelVisibleLayerTracker(\n        this.viewer.layerManager, PerspectiveViewRenderLayer, this.viewer.visibleLayerRoles, this,\n        layer => {\n          const {backend} = layer;\n          if (backend) {\n            backend.rpc!.invoke(\n                PERSPECTIVE_VIEW_ADD_LAYER_RPC_ID,\n                {layer: backend.rpcId, view: this.sharedObject.rpcId});\n            return () => {\n              backend.rpc!.invoke(\n                  PERSPECTIVE_VIEW_REMOVE_LAYER_RPC_ID,\n                  {layer: backend.rpcId, view: this.sharedObject.rpcId});\n            };\n          }\n          return undefined;\n        });\n\n    registerActionListener(element, 'rotate-via-mouse-drag', (e: ActionEvent<MouseEvent>) => {\n      startRelativeMouseDrag(e.detail, (_event, deltaX, deltaY) => {\n        this.navigationState.pose.rotateRelative(kAxes[1], deltaX / 4.0 * Math.PI / 180.0);\n        this.navigationState.pose.rotateRelative(kAxes[0], -deltaY / 4.0 * Math.PI / 180.0);\n      });\n    });\n\n    registerActionListener(\n        element, 'rotate-in-plane-via-touchrotate', (e: ActionEvent<TouchRotateInfo>) => {\n          const {detail} = e;\n          this.navigationState.pose.rotateRelative(kAxes[2], detail.angle - detail.prevAngle);\n        });\n\n    registerActionListener(\n        element, 'rotate-out-of-plane-via-touchtranslate', (e: ActionEvent<TouchTranslateInfo>) => {\n          const {detail} = e;\n          this.navigationState.pose.rotateRelative(kAxes[1], detail.deltaX / 4.0 * Math.PI / 180.0);\n          this.navigationState.pose.rotateRelative(\n              kAxes[0], -detail.deltaY / 4.0 * Math.PI / 180.0);\n        });\n\n    if (viewer.showSliceViewsCheckbox) {\n      let showSliceViewsCheckbox =\n          this.registerDisposer(new TrackableBooleanCheckbox(viewer.showSliceViews));\n      showSliceViewsCheckbox.element.className =\n          'perspective-panel-show-slice-views neuroglancer-noselect';\n      let showSliceViewsLabel = document.createElement('label');\n      showSliceViewsLabel.className = 'perspective-panel-show-slice-views neuroglancer-noselect';\n      showSliceViewsLabel.appendChild(document.createTextNode('Slices'));\n      showSliceViewsLabel.appendChild(showSliceViewsCheckbox.element);\n      this.element.appendChild(showSliceViewsLabel);\n    }\n    this.registerDisposer(viewer.orthographicProjection.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(viewer.showScaleBar.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(viewer.scaleBarOptions.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(viewer.showSliceViews.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(viewer.showAxisLines.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(\n        viewer.crossSectionBackgroundColor.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(\n        viewer.perspectiveViewBackgroundColor.changed.add(() => this.scheduleRedraw()));\n  }\n\n  translateByViewportPixels(deltaX: number, deltaY: number): void {\n    const temp = tempVec3;\n    const {viewProjectionMat} = this;\n    const {width, height} = this;\n    const {position} = this.viewer.navigationState;\n    const pos = position.spatialCoordinates;\n    vec3.transformMat4(temp, pos, viewProjectionMat);\n    temp[0] = -2 * deltaX / width;\n    temp[1] = 2 * deltaY / height;\n    vec3.transformMat4(pos, temp, this.viewProjectionMatInverse);\n    position.changed.dispatch();\n  }\n\n  get navigationState() {\n    return this.viewer.navigationState;\n  }\n\n  isReady() {\n    if (!this.visible) {\n      return true;\n    }\n    for (const [sliceView, unconditional] of this.sliceViews) {\n      if (unconditional || this.viewer.showSliceViews.value) {\n        if (!sliceView.isReady()) {\n          return false;\n        }\n      }\n    }\n    this.checkForResize();\n    const {width, height} = this;\n    if (width === 0 || height === 0) {\n      return true;\n    }\n    const {viewProjectionMat} = this;\n    this.updateProjectionMatrix();\n\n    const renderContext: PerspectiveViewReadyRenderContext = {\n      viewportWidth: width,\n      viewportHeight: height,\n      dataToDevice: viewProjectionMat,\n    };\n\n    let visibleLayers = this.visibleLayerTracker.getVisibleLayers();\n    for (let renderLayer of visibleLayers) {\n      if (!renderLayer.isReady(renderContext)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  updateProjectionMatrix() {\n    const {projectionMat, viewProjectionMat} = this;\n    const zOffsetAmount = 100;\n    const widthOverHeight = this.width / this.height;\n    const fovy = Math.PI / 4.0;\n    const nearBound = 10, farBound = 5000;\n    if (this.viewer.orthographicProjection.value) {\n      // Pick orthographic projection to match perspective projection at plane parallel to image\n      // plane containing the center position.\n      const f = 1.0 / Math.tan(fovy / 2);\n      // We need -2 / (left - right) == f / widthOverHeight.\n      // left - right = - 2 * widthOverHeight * orthoScalar\n      // -2 / (left - right) = 1 / (widthOverHeight * orthoScalar).\n      // 1 / orthoScalar == f.\n      // orthoScalar = 1 / f\n      const orthoScalar = zOffsetAmount / f;\n      mat4.ortho(\n          projectionMat, -widthOverHeight * orthoScalar, widthOverHeight * orthoScalar,\n          -orthoScalar, orthoScalar, nearBound, farBound);\n      this.nanometersPerPixel = 1 / (2 * projectionMat[0]) * this.navigationState.zoomFactor.value;\n      this.nanometersPerPixel =\n          2 * widthOverHeight * orthoScalar / this.width * this.navigationState.zoomFactor.value;\n    } else {\n      mat4.perspective(projectionMat, fovy, widthOverHeight, nearBound, farBound);\n    }\n\n    const {viewMatInverse, viewMat} = this;\n    this.navigationState.toMat4(viewMatInverse);\n    vec3.set(tempVec3, 1, -1, -1);\n    mat4.scale(viewMatInverse, viewMatInverse, tempVec3);\n\n    let viewOffset = vec3.set(tempVec3, 0, 0, zOffsetAmount);\n    mat4.translate(viewMatInverse, viewMatInverse, viewOffset);\n\n    mat4.invert(viewMat, viewMatInverse);\n\n    mat4.multiply(viewProjectionMat, projectionMat, viewMat);\n    mat4.invert(this.viewProjectionMatInverse, viewProjectionMat);\n  }\n\n  private throttledSendViewportUpdate = this.registerCancellable(throttle(() => {\n    const {sharedObject} = this;\n    const {valid} = this.navigationState;\n    if (valid) {\n      this.updateProjectionMatrix();\n    }\n    sharedObject.rpc!.invoke(PERSPECTIVE_VIEW_UPDATE_VIEWPORT_RPC_ID, {\n      view: sharedObject.rpcId,\n      viewport: {\n        width: valid ? this.width : 0,\n        height: valid ? this.height : 0,\n        viewMat: this.viewMat,\n        projectionMat: this.projectionMat,\n        viewProjectionMat: this.viewProjectionMat,\n      },\n    });\n  }, 10));\n\n  panelSizeChanged() {\n    this.throttledSendViewportUpdate();\n  }\n\n  disposed() {\n    for (let sliceView of this.sliceViews.keys()) {\n      sliceView.dispose();\n    }\n    this.sliceViews.clear();\n    super.disposed();\n  }\n\n  issuePickRequest(glWindowX: number, glWindowY: number) {\n    const {offscreenFramebuffer} = this;\n    offscreenFramebuffer.readPixelFloat32IntoBuffer(\n        OffscreenTextures.Z, glWindowX - pickRadius, glWindowY - pickRadius, 0, pickDiameter,\n        pickDiameter);\n    offscreenFramebuffer.readPixelFloat32IntoBuffer(\n        OffscreenTextures.PICK, glWindowX - pickRadius, glWindowY - pickRadius,\n        4 * 4 * pickDiameter * pickDiameter, pickDiameter, pickDiameter);\n  }\n\n  completePickRequest(\n      glWindowX: number, glWindowY: number, data: Float32Array, pickingData: FramePickingData) {\n    const {mouseState} = this.viewer;\n    mouseState.pickedRenderLayer = null;\n    clearOutOfBoundsPickData(\n        data, 0, 4, glWindowX, glWindowY, pickingData.viewportWidth, pickingData.viewportHeight);\n    const numOffsets = pickOffsetSequence.length;\n    for (let i = 0; i < numOffsets; ++i) {\n      const offset = pickOffsetSequence[i];\n      let zValue = data[4 * offset];\n      if (zValue === 0) continue;\n      const relativeX = offset % pickDiameter;\n      const relativeY = (offset - relativeX) / pickDiameter;\n      let glWindowZ = 1.0 - zValue;\n      const out = mouseState.position;\n      out[0] = 2.0 * (glWindowX + relativeX - pickRadius) / pickingData.viewportWidth - 1.0;\n      out[1] = 2.0 * (glWindowY + relativeY - pickRadius) / pickingData.viewportHeight - 1.0;\n      out[2] = 2.0 * glWindowZ - 1.0;\n      vec3.transformMat4(out, out, pickingData.invTransform);\n      const pickValue = data[4 * pickDiameter * pickDiameter + 4 * offset];\n      pickingData.pickIDs.setMouseState(mouseState, pickValue);\n      mouseState.setActive(true);\n      return;\n    }\n    mouseState.setActive(false);\n  }\n\n  translateDataPointByViewportPixels(out: vec3, orig: vec3, deltaX: number, deltaY: number): vec3 {\n    const temp = tempVec3;\n    const {viewProjectionMat} = this;\n    const {width, height} = this;\n    vec3.transformMat4(temp, orig, viewProjectionMat);\n    temp[0] += 2 * deltaX / width;\n    temp[1] += -2 * deltaY / height;\n    return vec3.transformMat4(out, temp, this.viewProjectionMatInverse);\n  }\n\n  private get transparentConfiguration() {\n    let transparentConfiguration = this.transparentConfiguration_;\n    if (transparentConfiguration === undefined) {\n      transparentConfiguration = this.transparentConfiguration_ =\n          this.registerDisposer(new FramebufferConfiguration(this.gl, {\n            colorBuffers:\n                makeTextureBuffers(this.gl, 2, this.gl.RGBA32F, this.gl.RGBA, this.gl.FLOAT),\n            depthBuffer: this.offscreenFramebuffer.depthBuffer!.addRef(),\n          }));\n    }\n    return transparentConfiguration;\n  }\n\n  drawWithPicking(pickingData: FramePickingData): boolean {\n    if (!this.navigationState.valid) {\n      return false;\n    }\n    const {width, height} = this;\n\n    const showSliceViews = this.viewer.showSliceViews.value;\n    for (const [sliceView, unconditional] of this.sliceViews) {\n      if (unconditional || showSliceViews) {\n        sliceView.updateRendering();\n      }\n    }\n\n    let gl = this.gl;\n    this.offscreenFramebuffer.bind(width, height);\n\n    gl.disable(gl.SCISSOR_TEST);\n    const backgroundColor = this.viewer.perspectiveViewBackgroundColor.value;\n    this.gl.clearColor(backgroundColor[0], backgroundColor[1], backgroundColor[2], 0.0);\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n    gl.enable(gl.DEPTH_TEST);\n    let {viewProjectionMat} = this;\n    this.updateProjectionMatrix();\n\n    // FIXME; avoid temporaries\n    let lightingDirection = vec3.create();\n    transformVectorByMat4(lightingDirection, kAxes[2], this.viewMatInverse);\n    vec3.normalize(lightingDirection, lightingDirection);\n\n    let ambient = 0.2;\n    let directional = 1 - ambient;\n\n    const renderContext: PerspectiveViewRenderContext = {\n      dataToDevice: viewProjectionMat,\n      lightDirection: lightingDirection,\n      ambientLighting: ambient,\n      directionalLighting: directional,\n      pickIDs: pickingData.pickIDs,\n      emitter: perspectivePanelEmit,\n      emitColor: true,\n      emitPickID: true,\n      alreadyEmittedPickID: false,\n      viewportWidth: width,\n      viewportHeight: height,\n    };\n\n    mat4.copy(pickingData.invTransform, this.viewProjectionMatInverse);\n\n    let visibleLayers = this.visibleLayerTracker.getVisibleLayers();\n\n    let hasTransparent = false;\n\n    let hasAnnotation = false;\n\n    // Draw fully-opaque layers first.\n    for (let renderLayer of visibleLayers) {\n      if (!renderLayer.isTransparent) {\n        if (!renderLayer.isAnnotation) {\n          renderLayer.draw(renderContext);\n        } else {\n          hasAnnotation = true;\n        }\n      } else {\n        hasTransparent = true;\n      }\n    }\n    this.drawSliceViews(renderContext);\n\n    if (hasAnnotation) {\n      gl.enable(WebGL2RenderingContext.BLEND);\n      gl.depthFunc(WebGL2RenderingContext.LEQUAL);\n      gl.blendFunc(WebGL2RenderingContext.SRC_ALPHA, WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA);\n      // Render only to the color buffer, but not the pick or z buffer.  With blending enabled, the\n      // z and color values would be corrupted.\n      gl.drawBuffers([\n        gl.COLOR_ATTACHMENT0,\n        gl.NONE,\n        gl.NONE,\n      ]);\n      renderContext.emitPickID = false;\n\n      for (let renderLayer of visibleLayers) {\n        if (renderLayer.isAnnotation) {\n          renderLayer.draw(renderContext);\n        }\n      }\n      gl.depthFunc(WebGL2RenderingContext.LESS);\n      gl.disable(WebGL2RenderingContext.BLEND);\n      gl.drawBuffers([\n        gl.COLOR_ATTACHMENT0,\n        gl.COLOR_ATTACHMENT1,\n        gl.COLOR_ATTACHMENT2,\n      ]);\n      renderContext.emitPickID = true;\n    }\n\n    if (this.viewer.showAxisLines.value) {\n      this.drawAxisLines();\n    }\n\n    if (hasTransparent) {\n      // Draw transparent objects.\n      gl.depthMask(false);\n      gl.enable(WebGL2RenderingContext.BLEND);\n\n      // Compute accumulate and revealage textures.\n      const {transparentConfiguration} = this;\n      transparentConfiguration.bind(width, height);\n      this.gl.clearColor(0.0, 0.0, 0.0, 1.0);\n      gl.clear(WebGL2RenderingContext.COLOR_BUFFER_BIT);\n      renderContext.emitter = perspectivePanelEmitOIT;\n      gl.blendFuncSeparate(\n          WebGL2RenderingContext.ONE, WebGL2RenderingContext.ONE, WebGL2RenderingContext.ZERO,\n          WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA);\n      renderContext.emitPickID = false;\n      for (let renderLayer of visibleLayers) {\n        if (renderLayer.isTransparent) {\n          renderLayer.draw(renderContext);\n        }\n      }\n\n      // Copy transparent rendering result back to primary buffer.\n      gl.disable(WebGL2RenderingContext.DEPTH_TEST);\n      this.offscreenFramebuffer.bindSingle(OffscreenTextures.COLOR);\n      gl.blendFunc(WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA, WebGL2RenderingContext.SRC_ALPHA);\n      this.transparencyCopyHelper.draw(\n          transparentConfiguration.colorBuffers[0].texture,\n          transparentConfiguration.colorBuffers[1].texture);\n\n      gl.depthMask(true);\n      gl.disable(WebGL2RenderingContext.BLEND);\n      gl.enable(WebGL2RenderingContext.DEPTH_TEST);\n\n      // Restore framebuffer attachments.\n      this.offscreenFramebuffer.bind(width, height);\n    }\n\n    // Do picking only rendering pass.\n    gl.drawBuffers([gl.NONE, gl.COLOR_ATTACHMENT1, gl.COLOR_ATTACHMENT2]);\n    renderContext.emitter = perspectivePanelEmit;\n    renderContext.emitPickID = true;\n    renderContext.emitColor = false;\n\n    // Offset z values forward so that we reliably write pick IDs and depth information even though\n    // we've already done one drawing pass.\n    gl.enable(WebGL2RenderingContext.POLYGON_OFFSET_FILL);\n    gl.polygonOffset(-1, -1);\n    for (let renderLayer of visibleLayers) {\n      renderContext.alreadyEmittedPickID = !renderLayer.isTransparent && !renderLayer.isAnnotation;\n      renderLayer.draw(renderContext);\n    }\n    gl.disable(WebGL2RenderingContext.POLYGON_OFFSET_FILL);\n\n    if (this.viewer.showScaleBar.value && this.viewer.orthographicProjection.value) {\n      // Only modify color buffer.\n      gl.drawBuffers([\n        gl.COLOR_ATTACHMENT0,\n      ]);\n\n      gl.disable(WebGL2RenderingContext.DEPTH_TEST);\n      gl.enable(WebGL2RenderingContext.BLEND);\n      gl.blendFunc(WebGL2RenderingContext.SRC_ALPHA, WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA);\n      const {scaleBarTexture} = this;\n      const options = this.viewer.scaleBarOptions.value;\n      const {dimensions} = scaleBarTexture;\n      dimensions.targetLengthInPixels = Math.min(\n          options.maxWidthFraction * width, options.maxWidthInPixels * options.scaleFactor);\n      dimensions.nanometersPerPixel = this.nanometersPerPixel;\n      scaleBarTexture.update(options);\n      gl.viewport(\n          options.leftPixelOffset * options.scaleFactor,\n          options.bottomPixelOffset * options.scaleFactor, scaleBarTexture.width,\n          scaleBarTexture.height);\n      this.scaleBarCopyHelper.draw(scaleBarTexture.texture);\n      gl.disable(WebGL2RenderingContext.BLEND);\n    }\n    this.offscreenFramebuffer.unbind();\n\n    // Draw the texture over the whole viewport.\n    this.setGLViewport();\n    this.offscreenCopyHelper.draw(\n        this.offscreenFramebuffer.colorBuffers[OffscreenTextures.COLOR].texture);\n    return true;\n  }\n\n  protected drawSliceViews(renderContext: PerspectiveViewRenderContext) {\n    let {sliceViewRenderHelper} = this;\n    let {lightDirection, ambientLighting, directionalLighting, dataToDevice} = renderContext;\n\n    const showSliceViews = this.viewer.showSliceViews.value;\n    for (const [sliceView, unconditional] of this.sliceViews) {\n      if (!unconditional && !showSliceViews) {\n        continue;\n      }\n      if (sliceView.width === 0 || sliceView.height === 0 || !sliceView.hasValidViewport) {\n        continue;\n      }\n      let scalar = Math.abs(vec3.dot(lightDirection, sliceView.viewportAxes[2]));\n      let factor = ambientLighting + scalar * directionalLighting;\n      let mat = tempMat4;\n      // Need a matrix that maps (+1, +1, 0) to projectionMat * (width, height, 0)\n      mat4.identity(mat);\n      mat[0] = sliceView.width / 2.0;\n      mat[5] = -sliceView.height / 2.0;\n      mat4.multiply(mat, sliceView.viewportToData, mat);\n      mat4.multiply(mat, dataToDevice, mat);\n      const backgroundColor = tempVec4;\n      const crossSectionBackgroundColor = this.viewer.crossSectionBackgroundColor.value;\n      backgroundColor[0] = crossSectionBackgroundColor[0];\n      backgroundColor[1] = crossSectionBackgroundColor[1];\n      backgroundColor[2] = crossSectionBackgroundColor[2];\n      backgroundColor[3] = 1;\n      sliceViewRenderHelper.draw(\n          sliceView.offscreenFramebuffer.colorBuffers[0].texture, mat,\n          vec4.fromValues(factor, factor, factor, 1), tempVec4, 0, 0, 1, 1);\n    }\n  }\n\n  protected drawAxisLines() {\n    const temp = tempVec3;\n    const temp2 = tempVec3b;\n    const {viewProjectionMat} = this;\n    const {position} = this.viewer.navigationState;\n    const pos = position.spatialCoordinates;\n    vec3.transformMat4(temp, pos, viewProjectionMat);\n    temp[0] = 0.5;\n    vec3.transformMat4(temp2, temp, this.viewProjectionMatInverse);\n    const length0 = vec3.distance(temp2, pos);\n    temp[0] = 0;\n    temp[1] = 0.5;\n    vec3.transformMat4(temp2, temp, this.viewProjectionMatInverse);\n    const length1 = vec3.distance(temp2, pos);\n\n    let {gl} = this;\n    let mat = tempMat4;\n    mat4.identity(mat);\n    // Draw axes lines.\n    let axisLength = Math.min(length0, length1);\n\n    // Construct matrix that maps [-1, +1] x/y range to the full viewport data\n    // coordinates.\n    mat[0] = axisLength;\n    mat[5] = axisLength;\n    mat[10] = axisLength;\n    let center = this.navigationState.position.spatialCoordinates;\n    mat[12] = center[0];\n    mat[13] = center[1];\n    mat[14] = center[2];\n    mat[15] = 1;\n    mat4.multiply(mat, this.viewProjectionMat, mat);\n\n    gl.drawBuffers([gl.COLOR_ATTACHMENT0]);\n    this.axesLineHelper.draw(mat, false);\n  }\n\n  zoomByMouse(factor: number) {\n    this.navigationState.zoomBy(factor);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/ui/button.css';\nimport 'neuroglancer/data_panel_layout.css';\n\nimport debounce from 'lodash/debounce';\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {LayerManager, MouseSelectionState, RenderLayerRole, SelectedLayerState} from 'neuroglancer/layer';\nimport * as L from 'neuroglancer/layout';\nimport {LinkedOrientationState, LinkedSpatialPosition, LinkedZoomState, NavigationState, OrientationState, Pose} from 'neuroglancer/navigation_state';\nimport {PerspectivePanel} from 'neuroglancer/perspective_view/panel';\nimport {RenderedDataPanel} from 'neuroglancer/rendered_data_panel';\nimport {SliceView} from 'neuroglancer/sliceview/frontend';\nimport {SliceViewerState, SliceViewPanel} from 'neuroglancer/sliceview/panel';\nimport {TrackableBoolean} from 'neuroglancer/trackable_boolean';\nimport {TrackableValue, WatchableSet} from 'neuroglancer/trackable_value';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren, removeFromParent} from 'neuroglancer/util/dom';\nimport {EventActionMap, registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {quat} from 'neuroglancer/util/geom';\nimport {verifyObject, verifyObjectProperty, verifyPositiveInt} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\nimport {WatchableMap} from 'neuroglancer/util/watchable_map';\nimport {VisibilityPrioritySpecification} from 'neuroglancer/viewer_state';\nimport {ScaleBarOptions} from 'neuroglancer/widget/scale_bar';\n\nexport interface SliceViewViewerState {\n  chunkManager: ChunkManager;\n  navigationState: NavigationState;\n  layerManager: LayerManager;\n}\n\nexport class InputEventBindings {\n  perspectiveView = new EventActionMap();\n  sliceView = new EventActionMap();\n}\n\nexport interface ViewerUIState extends SliceViewViewerState, VisibilityPrioritySpecification {\n  display: DisplayContext;\n  mouseState: MouseSelectionState;\n  perspectiveNavigationState: NavigationState;\n  showPerspectiveSliceViews: TrackableBoolean;\n  showAxisLines: TrackableBoolean;\n  showScaleBar: TrackableBoolean;\n  scaleBarOptions: TrackableValue<ScaleBarOptions>;\n  visibleLayerRoles: WatchableSet<RenderLayerRole>;\n  selectedLayer: SelectedLayerState;\n  inputEventBindings: InputEventBindings;\n  crossSectionBackgroundColor: TrackableRGB;\n  perspectiveViewBackgroundColor: TrackableRGB;\n}\n\nexport interface DataDisplayLayout extends RefCounted {\n  rootElement: HTMLElement;\n  container: DataPanelLayoutContainer;\n}\n\ntype NamedAxes = 'xy'|'xz'|'yz';\n\nconst AXES_RELATIVE_ORIENTATION = new Map<NamedAxes, quat|undefined>([\n  ['xy', undefined],\n  ['xz', quat.rotateX(quat.create(), quat.create(), Math.PI / 2)],\n  ['yz', quat.rotateY(quat.create(), quat.create(), Math.PI / 2)],\n]);\n\nconst oneSquareSymbol = '';\n\nconst LAYOUT_SYMBOLS = new Map<string, string>([\n  ['4panel', ''],\n  ['3d', oneSquareSymbol],\n]);\n\nexport function makeSliceView(viewerState: SliceViewViewerState, baseToSelf?: quat) {\n  let navigationState: NavigationState;\n  if (baseToSelf === undefined) {\n    navigationState = viewerState.navigationState;\n  } else {\n    navigationState = new NavigationState(\n        new Pose(\n            viewerState.navigationState.pose.position,\n            OrientationState.makeRelative(\n                viewerState.navigationState.pose.orientation, baseToSelf)),\n        viewerState.navigationState.zoomFactor);\n  }\n  return new SliceView(viewerState.chunkManager, viewerState.layerManager, navigationState);\n}\n\nexport function makeNamedSliceView(viewerState: SliceViewViewerState, axes: NamedAxes) {\n  return makeSliceView(viewerState, AXES_RELATIVE_ORIENTATION.get(axes)!);\n}\n\nexport function makeOrthogonalSliceViews(viewerState: SliceViewViewerState) {\n  return new Map<NamedAxes, SliceView>([\n    ['xy', makeNamedSliceView(viewerState, 'xy')],\n    ['xz', makeNamedSliceView(viewerState, 'xz')],\n    ['yz', makeNamedSliceView(viewerState, 'yz')],\n  ]);\n}\n\nexport function getCommonViewerState(viewer: ViewerUIState) {\n  return {\n    crossSectionBackgroundColor: viewer.crossSectionBackgroundColor,\n    perspectiveViewBackgroundColor: viewer.perspectiveViewBackgroundColor,\n    mouseState: viewer.mouseState,\n    layerManager: viewer.layerManager,\n    showAxisLines: viewer.showAxisLines,\n    visibleLayerRoles: viewer.visibleLayerRoles,\n    selectedLayer: viewer.selectedLayer,\n    visibility: viewer.visibility,\n    scaleBarOptions: viewer.scaleBarOptions,\n  };\n}\n\nfunction getCommonPerspectiveViewerState(container: DataPanelLayoutContainer) {\n  const {viewer} = container;\n  return {\n    ...getCommonViewerState(viewer),\n    navigationState: viewer.perspectiveNavigationState,\n    inputEventMap: viewer.inputEventBindings.perspectiveView,\n    orthographicProjection: container.specification.orthographicProjection,\n    showScaleBar: viewer.showScaleBar,\n    rpc: viewer.chunkManager.rpc!,\n  };\n}\n\nfunction getCommonSliceViewerState(viewer: ViewerUIState) {\n  return {\n    ...getCommonViewerState(viewer),\n    navigationState: viewer.navigationState,\n    inputEventMap: viewer.inputEventBindings.sliceView,\n  };\n}\n\nfunction registerRelatedLayouts(\n  layout: DataDisplayLayout, panel: RenderedDataPanel, relatedLayouts: string[]) {\n  const controls = document.createElement('div');\n  controls.className = 'neuroglancer-data-panel-layout-controls';\n  layout.registerDisposer(() => removeFromParent(controls));\n  for (let i = 0; i < 2; ++i) {\n    const relatedLayout = relatedLayouts[Math.min(relatedLayouts.length - 1, i)];\n    layout.registerDisposer(registerActionListener(\n        panel.element, i === 0 ? 'toggle-layout' : 'toggle-layout-alternative', (event: Event) => {\n          layout.container.name = relatedLayout;\n          event.stopPropagation();\n        }));\n  }\n  for (const relatedLayout of relatedLayouts) {\n    const button = document.createElement('button');\n    const innerDiv = document.createElement('div');\n    button.appendChild(innerDiv);\n    innerDiv.textContent = LAYOUT_SYMBOLS.get(relatedLayout)!;\n    button.title = `Switch to ${relatedLayout} layout.`;\n    button.addEventListener('click', () => {\n      layout.container.name = relatedLayout;\n    });\n    controls.appendChild(button);\n  }\n  panel.element.appendChild(controls);\n}\n\nfunction makeSliceViewFromSpecification(\n    viewer: SliceViewViewerState, specification: Borrowed<CrossSectionSpecification>) {\n  const sliceView = new SliceView(\n      viewer.chunkManager, viewer.layerManager, specification.navigationState.addRef());\n  const updateViewportSize = () => {\n    sliceView.setViewportSizeDebounced(specification.width.value, specification.height.value);\n  };\n  sliceView.registerDisposer(specification.width.changed.add(updateViewportSize));\n  sliceView.registerDisposer(specification.height.changed.add(updateViewportSize));\n  updateViewportSize();\n  return sliceView;\n}\n\nfunction addUnconditionalSliceViews(\n    viewer: SliceViewViewerState, panel: PerspectivePanel,\n    crossSections: Borrowed<CrossSectionSpecificationMap>) {\n  const previouslyAdded = new Map<Borrowed<CrossSectionSpecification>, Borrowed<SliceView>>();\n  const update = () => {\n    const currentCrossSections = new Set<Borrowed<CrossSectionSpecification>>();\n    // Add missing cross sections.\n    for (const crossSection of crossSections.values()) {\n      currentCrossSections.add(crossSection);\n      if (previouslyAdded.has(crossSection)) {\n        continue;\n      }\n      const sliceView = makeSliceViewFromSpecification(viewer, crossSection);\n      panel.sliceViews.set(sliceView, true);\n      previouslyAdded.set(crossSection, sliceView);\n    }\n    // Remove extra cross sections.\n    for (const [crossSection, sliceView] of previouslyAdded) {\n      if (currentCrossSections.has(crossSection)) {\n        continue;\n      }\n      panel.sliceViews.delete(sliceView);\n    }\n  };\n  update();\n}\n\nexport class FourPanelLayout extends RefCounted {\n  constructor(\n      public container: DataPanelLayoutContainer, public rootElement: HTMLElement,\n      public viewer: ViewerUIState, crossSections: Borrowed<CrossSectionSpecificationMap>) {\n    super();\n\n    let sliceViews = makeOrthogonalSliceViews(viewer);\n    let {display} = viewer;\n\n    const perspectiveViewerState = {\n      ...getCommonPerspectiveViewerState(container),\n      showSliceViews: viewer.showPerspectiveSliceViews,\n      showSliceViewsCheckbox: true,\n    };\n\n    const sliceViewerState = {\n      ...getCommonSliceViewerState(viewer),\n      showScaleBar: viewer.showScaleBar,\n    };\n\n    const sliceViewerStateWithoutScaleBar = {\n      ...getCommonSliceViewerState(viewer),\n      showScaleBar: new TrackableBoolean(false, false),\n    };\n\n    const makeSliceViewPanel = (axes: NamedAxes, element: HTMLElement, state: SliceViewerState) => {\n      const panel =\n          this.registerDisposer(new SliceViewPanel(display, element, sliceViews.get(axes)!, state));\n      registerRelatedLayouts(this, panel, [axes, `${axes}-3d`]);\n      return panel;\n    };\n    let mainDisplayContents = [\n      L.withFlex(1, L.box('column', [\n        L.withFlex(1, L.box('row', [\n          L.withFlex(1, element => {\n            makeSliceViewPanel('xy', element, sliceViewerState);\n          }),\n          L.withFlex(1, element => {\n            makeSliceViewPanel('xz', element, sliceViewerStateWithoutScaleBar);\n          })\n        ])),\n        L.withFlex(1, L.box('row', [\n          L.withFlex(1, element => {\n            let panel = this.registerDisposer(\n                new PerspectivePanel(display, element, perspectiveViewerState));\n            for (let sliceView of sliceViews.values()) {\n              panel.sliceViews.set(sliceView.addRef(), false);\n            }\n            addUnconditionalSliceViews(viewer, panel, crossSections);\n            registerRelatedLayouts(this, panel, ['3d']);\n          }),\n          L.withFlex(1, element => {\n            makeSliceViewPanel('yz', element, sliceViewerStateWithoutScaleBar);\n          })\n        ])),\n      ]))\n    ];\n    L.box('row', mainDisplayContents)(rootElement);\n  }\n\n  disposed() {\n    removeChildren(this.rootElement);\n    super.disposed();\n  }\n}\n\nexport class SliceViewPerspectiveTwoPanelLayout extends RefCounted {\n  constructor(\n      public container: DataPanelLayoutContainer, public rootElement: HTMLElement,\n      public viewer: ViewerUIState, public direction: 'row'|'column', axes: NamedAxes,\n      crossSections: Borrowed<CrossSectionSpecificationMap>) {\n    super();\n\n    let sliceView = makeNamedSliceView(viewer, axes);\n    let {display} = viewer;\n\n    const perspectiveViewerState = {\n      ...getCommonPerspectiveViewerState(container),\n      showSliceViews: viewer.showPerspectiveSliceViews,\n      showSliceViewsCheckbox: true,\n    };\n\n    const sliceViewerState = {\n      ...getCommonSliceViewerState(viewer),\n      showScaleBar: viewer.showScaleBar,\n    };\n\n    L.withFlex(1, L.box(direction, [\n      L.withFlex(\n          1,\n          element => {\n            const panel = this.registerDisposer(\n                new SliceViewPanel(display, element, sliceView, sliceViewerState));\n            registerRelatedLayouts(this, panel, [axes, '4panel']);\n          }),\n      L.withFlex(\n          1,\n          element => {\n            let panel = this.registerDisposer(\n                new PerspectivePanel(display, element, perspectiveViewerState));\n            panel.sliceViews.set(sliceView.addRef(), false);\n            addUnconditionalSliceViews(viewer, panel, crossSections);\n            registerRelatedLayouts(this, panel, ['3d', '4panel']);\n          }),\n    ]))(rootElement);\n  }\n\n  disposed() {\n    removeChildren(this.rootElement);\n    super.disposed();\n  }\n}\n\nexport class SinglePanelLayout extends RefCounted {\n  constructor(\n      public container: DataPanelLayoutContainer, public rootElement: HTMLElement,\n      public viewer: ViewerUIState, axes: NamedAxes) {\n    super();\n    let sliceView = makeNamedSliceView(viewer, axes);\n    const sliceViewerState = {\n      ...getCommonSliceViewerState(viewer),\n      showScaleBar: viewer.showScaleBar,\n    };\n\n    L.box('row', [L.withFlex(1, element => {\n            const panel = this.registerDisposer(\n                new SliceViewPanel(viewer.display, element, sliceView, sliceViewerState));\n            registerRelatedLayouts(this, panel, ['4panel', `${axes}-3d`]);\n          })])(rootElement);\n  }\n\n  disposed() {\n    removeChildren(this.rootElement);\n    super.disposed();\n  }\n}\n\nexport class SinglePerspectiveLayout extends RefCounted {\n  constructor(\n      public container: DataPanelLayoutContainer, public rootElement: HTMLElement,\n      public viewer: ViewerUIState, crossSections: Borrowed<CrossSectionSpecificationMap>) {\n    super();\n    let perspectiveViewerState = {\n      ...getCommonPerspectiveViewerState(container),\n      showSliceViews: new TrackableBoolean(false, false),\n    };\n\n\n    L.box('row', [L.withFlex(1, element => {\n            const panel = this.registerDisposer(\n                new PerspectivePanel(viewer.display, element, perspectiveViewerState));\n            addUnconditionalSliceViews(viewer, panel, crossSections);\n            registerRelatedLayouts(this, panel, ['4panel']);\n          })])(rootElement);\n  }\n\n  disposed() {\n    removeChildren(this.rootElement);\n    super.disposed();\n  }\n}\n\nexport const LAYOUTS = new Map<string, {\n  factory:\n      (container: DataPanelLayoutContainer, element: HTMLElement, viewer: ViewerUIState,\n       crossSections: Borrowed<CrossSectionSpecificationMap>) => DataDisplayLayout\n}>(\n    [\n      [\n        '4panel', {\n          factory: (container, element, viewer, crossSections) =>\n              new FourPanelLayout(container, element, viewer, crossSections)\n        }\n      ],\n      [\n        '3d', {\n          factory: (container, element, viewer, crossSections) =>\n              new SinglePerspectiveLayout(container, element, viewer, crossSections)\n        }\n      ],\n    ],\n);\n\nfor (const axes of AXES_RELATIVE_ORIENTATION.keys()) {\n  LAYOUTS.set(axes, {\n    factory: (container, element, viewer) =>\n        new SinglePanelLayout(container, element, viewer, <NamedAxes>axes)\n  });\n  const splitLayout = `${axes}-3d`;\n  LAYOUT_SYMBOLS.set(axes, oneSquareSymbol);\n  LAYOUT_SYMBOLS.set(splitLayout, '');\n  LAYOUTS.set(splitLayout, {\n    factory: (container, element, viewer, crossSections) => new SliceViewPerspectiveTwoPanelLayout(\n        container, element, viewer, 'row', <NamedAxes>axes, crossSections)\n  });\n}\n\nexport function getLayoutByName(obj: any) {\n  let layout = LAYOUTS.get(obj);\n  if (layout === undefined) {\n    throw new Error(`Invalid layout name: ${JSON.stringify(obj)}.`);\n  }\n  return layout;\n}\n\nexport function validateLayoutName(obj: any) {\n  getLayoutByName(obj);\n  return <string>obj;\n}\n\nexport class CrossSectionSpecification extends RefCounted implements Trackable {\n  width = new TrackableValue<number>(1000, verifyPositiveInt);\n  height = new TrackableValue<number>(1000, verifyPositiveInt);\n  position: LinkedSpatialPosition;\n  orientation: LinkedOrientationState;\n  zoom: LinkedZoomState;\n  navigationState: NavigationState;\n  changed = new NullarySignal();\n  constructor(parent: Borrowed<NavigationState>) {\n    super();\n    this.position = new LinkedSpatialPosition(parent.position.addRef());\n    this.position.changed.add(this.changed.dispatch);\n    this.orientation = new LinkedOrientationState(parent.pose.orientation.addRef());\n    this.orientation.changed.add(this.changed.dispatch);\n    this.width.changed.add(this.changed.dispatch);\n    this.height.changed.add(this.changed.dispatch);\n    this.zoom = new LinkedZoomState(parent.zoomFactor.addRef());\n    this.zoom.changed.add(this.changed.dispatch);\n    this.navigationState = this.registerDisposer(new NavigationState(\n        new Pose(this.position.value, this.orientation.value), this.zoom.value));\n  }\n\n  restoreState(obj: any) {\n    verifyObject(obj);\n    verifyObjectProperty(obj, 'width', x => x !== undefined && this.width.restoreState(x));\n    verifyObjectProperty(obj, 'height', x => x !== undefined && this.height.restoreState(x));\n    verifyObjectProperty(obj, 'position', x => x !== undefined && this.position.restoreState(x));\n    verifyObjectProperty(\n        obj, 'orientation', x => x !== undefined && this.orientation.restoreState(x));\n    verifyObjectProperty(obj, 'zoom', x => x !== undefined && this.zoom.restoreState(x));\n  }\n\n  reset() {\n    this.width.reset();\n    this.height.reset();\n    this.position.reset();\n    this.orientation.reset();\n    this.zoom.reset();\n  }\n\n  toJSON() {\n    return {\n      width: this.width.toJSON(),\n      height: this.height.toJSON(),\n      position: this.position.toJSON(),\n      orientation: this.orientation.toJSON(),\n      zoom: this.zoom.toJSON(),\n    };\n  }\n}\n\nexport class CrossSectionSpecificationMap extends WatchableMap<string, CrossSectionSpecification> {\n  constructor(private parentNavigationState: Owned<NavigationState>) {\n    super(\n        v => this.registerDisposer(this.registerDisposer(v).changed.add(this.changed.dispatch)),\n        v => {\n          v.changed.remove(this.changed.dispatch);\n          v.dispose();\n        });\n    this.registerDisposer(parentNavigationState);\n  }\n\n  restoreState(obj: any) {\n    verifyObject(obj);\n    for (const key of Object.keys(obj)) {\n      const state = new CrossSectionSpecification(this.parentNavigationState);\n      try {\n        this.set(key, state.addRef());\n        state.restoreState(obj[key]);\n      } finally {\n        state.dispose();\n      }\n    }\n  }\n\n  reset() {\n    this.clear();\n  }\n\n  toJSON() {\n    if (this.size === 0) return undefined;\n    const obj: {[key: string]: any} = {};\n    for (const [k, v] of this) {\n      obj[k] = v.toJSON();\n    }\n    return obj;\n  }\n}\n\nexport class DataPanelLayoutSpecification extends RefCounted implements Trackable {\n  changed = new NullarySignal();\n  type: TrackableValue<string>;\n  crossSections: CrossSectionSpecificationMap;\n  orthographicProjection = new TrackableBoolean(false);\n\n  constructor(parentNavigationState: Owned<NavigationState>, defaultLayout: string) {\n    super();\n    this.type = new TrackableValue<string>(defaultLayout, validateLayoutName);\n    this.type.changed.add(this.changed.dispatch);\n    this.crossSections =\n        this.registerDisposer(new CrossSectionSpecificationMap(parentNavigationState));\n    this.crossSections.changed.add(this.changed.dispatch);\n    this.orthographicProjection.changed.add(this.changed.dispatch);\n    this.registerDisposer(parentNavigationState);\n  }\n\n  reset() {\n    this.crossSections.clear();\n    this.orthographicProjection.reset();\n    this.type.reset();\n  }\n\n  restoreState(obj: any) {\n    this.crossSections.clear();\n    this.orthographicProjection.reset();\n    if (typeof obj === 'string') {\n      this.type.restoreState(obj);\n    } else {\n      verifyObject(obj);\n      verifyObjectProperty(obj, 'type', x => this.type.restoreState(x));\n      verifyObjectProperty(\n          obj, 'orthographicProjection', x => this.orthographicProjection.restoreState(x));\n      verifyObjectProperty(\n          obj, 'crossSections', x => x !== undefined && this.crossSections.restoreState(x));\n    }\n  }\n\n  toJSON() {\n    const {type, crossSections, orthographicProjection} = this;\n    const orthographicProjectionJson = orthographicProjection.toJSON();\n    if (crossSections.size === 0 && orthographicProjectionJson === undefined) {\n      return type.value;\n    }\n    return {\n      type: type.value,\n      crossSections: crossSections.toJSON(),\n      orthographicProjection: orthographicProjectionJson,\n    };\n  }\n}\n\nexport class DataPanelLayoutContainer extends RefCounted {\n  element = document.createElement('div');\n  specification: Owned<DataPanelLayoutSpecification>;\n\n  private layout: DataDisplayLayout|undefined;\n\n  get name() {\n    return this.specification.type.value;\n  }\n  set name(value: string) {\n    this.specification.type.value = value;\n  }\n\n  constructor(public viewer: ViewerUIState, defaultLayout: string) {\n    super();\n    this.specification = this.registerDisposer(\n        new DataPanelLayoutSpecification(this.viewer.navigationState.addRef(), defaultLayout));\n    this.element.style.flex = '1';\n    const scheduleUpdateLayout = this.registerCancellable(debounce(() => this.updateLayout(), 0));\n    this.specification.type.changed.add(scheduleUpdateLayout);\n\n    registerActionListener(\n        this.element, 'toggle-orthographic-projection',\n        () => this.specification.orthographicProjection.toggle());\n\n    // Ensure the layout is updated before drawing begins to avoid flicker.\n    this.registerDisposer(\n        this.viewer.display.updateStarted.add(() => scheduleUpdateLayout.flush()));\n    scheduleUpdateLayout();\n  }\n  get changed() {\n    return this.specification.changed;\n  }\n  toJSON() {\n    return this.specification.toJSON();\n  }\n  restoreState(obj: any) {\n    this.specification.restoreState(obj);\n  }\n  reset() {\n    this.specification.reset();\n  }\n  private disposeLayout() {\n    let {layout} = this;\n    if (layout !== undefined) {\n      layout.dispose();\n      this.layout = undefined;\n    }\n  }\n  private updateLayout() {\n    this.disposeLayout();\n    this.layout = getLayoutByName(this.name).factory(\n        this, this.element, this.viewer, this.specification.crossSections);\n  }\n  disposed() {\n    this.disposeLayout();\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Overlay} from 'neuroglancer/overlay';\nimport {EventActionMap} from 'neuroglancer/util/event_action_map';\n\nrequire('./input_event_bindings.css');\n\nexport function formatKeyName(name: string) {\n  if (name.startsWith('key')) {\n    return name.substring(3);\n  }\n  if (name.startsWith('digit')) {\n    return name.substring(5);\n  }\n  if (name.startsWith('arrow')) {\n    return name.substring(5);\n  }\n  return name;\n}\n\nexport function formatKeyStroke(stroke: string) {\n  let parts = stroke.split('+');\n  return parts.map(formatKeyName).join('+');\n}\n\nexport class InputEventBindingHelpDialog extends Overlay {\n  /**\n   * @param keyMap Key map to list.\n   */\n  constructor(bindings: Iterable<[string, EventActionMap]>) {\n    super();\n\n    let {content} = this;\n    content.classList.add('describe-key-bindings');\n\n    let scroll = document.createElement('div');\n    scroll.classList.add('describe-key-bindings-container');\n\n    interface BindingList {\n      label: string;\n      entries: Map<string, string>;\n    }\n\n    const uniqueMaps = new Map<EventActionMap, BindingList>();\n    function addEntries(eventMap: EventActionMap, entries: Map<string, string>) {\n      for (const parent of eventMap.parents) {\n        if (parent.label !== undefined) {\n          addMap(parent.label, parent);\n        } else {\n          addEntries(parent, entries);\n        }\n      }\n      for (const [event, eventAction] of eventMap.bindings.entries()) {\n        const firstColon = event.indexOf(':');\n        const suffix = event.substring(firstColon + 1);\n        entries.set(suffix, eventAction.action);\n      }\n    }\n\n    function addMap(label: string, map: EventActionMap) {\n      if (uniqueMaps.has(map)) {\n        return;\n      }\n      const list: BindingList = {\n        label,\n        entries: new Map(),\n      };\n      addEntries(map, list.entries);\n      uniqueMaps.set(map, list);\n    }\n\n    for (const [label, eventMap] of bindings) {\n      addMap(label, eventMap);\n    }\n\n    for (const list of uniqueMaps.values()) {\n      let header = document.createElement('h2');\n      header.textContent = list.label;\n      scroll.appendChild(header);\n      let dl = document.createElement('div');\n      dl.className = 'dl';\n\n      for (const [event, action] of list.entries) {\n        let container = document.createElement('div');\n        let container2 = document.createElement('div');\n        container2.className = 'definition-outer-container';\n        container.className = 'definition-container';\n        let dt = document.createElement('div');\n        dt.className = 'dt';\n        dt.textContent = formatKeyStroke(event);\n        let dd = document.createElement('div');\n        dd.className = 'dd';\n        dd.textContent = action;\n        container.appendChild(dt);\n        container.appendChild(dd);\n        dl.appendChild(container2);\n        container2.appendChild(container);\n      }\n      scroll.appendChild(dl);\n    }\n    content.appendChild(scroll);\n  }\n}\n\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlet nextElementId = 0;\n\nexport function associateLabelWithElement(label: HTMLLabelElement, element: HTMLInputElement) {\n  if (element.id === '') {\n    element.id = `unique-id-for-association-${nextElementId++}`;\n  }\n  label.setAttribute('for', element.id);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function scrollIntoViewIfNeeded(element: HTMLElement) {\n  const parent = element.parentElement!;\n  const elementLeft = element.offsetLeft - parent.clientLeft;\n  const elementTop = element.offsetTop - parent.clientTop;\n  const elementRight = elementLeft + element.offsetWidth;\n  const elementBottom = elementTop + element.offsetHeight;\n  const parentWidth = parent.clientWidth;\n  const parentHeight = parent.clientHeight;\n  const viewportLeft = parent.scrollLeft;\n  const viewportRight = viewportLeft + parentWidth;\n  const viewportTop = parent.scrollTop;\n  const viewportBottom = viewportTop + parentHeight;\n\n  const scrollLeftDelta =\n      Math.max(0.0, elementRight - viewportRight) || Math.min(0.0, elementLeft - viewportLeft);\n  const scrollTopDelta =\n      Math.max(0.0, elementBottom - viewportBottom) || Math.min(0.0, elementTop - viewportTop);\n\n  parent.scrollLeft += scrollLeftDelta;\n  parent.scrollTop += scrollTopDelta;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {CancellationToken, CancellationTokenSource} from 'neuroglancer/util/cancellation';\nimport {BasicCompletionResult, Completion, CompletionWithDescription} from 'neuroglancer/util/completion';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren, removeFromParent} from 'neuroglancer/util/dom';\nimport {positionDropdown} from 'neuroglancer/util/dropdown';\nimport {EventActionMap, KeyboardEventBinder, registerActionListener} from 'neuroglancer/util/keyboard_bindings';\nimport {longestCommonPrefix} from 'neuroglancer/util/longest_common_prefix';\nimport {scrollIntoViewIfNeeded} from 'neuroglancer/util/scroll_into_view';\nimport {Signal} from 'neuroglancer/util/signal';\nimport {associateLabelWithElement} from 'neuroglancer/widget/associate_label';\n\nexport {Completion, CompletionWithDescription} from 'neuroglancer/util/completion';\n\nrequire('./autocomplete.css');\n\nconst ACTIVE_COMPLETION_CLASS_NAME = 'autocomplete-completion-active';\n\nconst AUTOCOMPLETE_INDEX_SYMBOL = Symbol('autocompleteIndex');\n\nexport interface CompletionResult extends BasicCompletionResult {\n  showSingleResult?: boolean;\n  selectSingleResult?: boolean;\n  makeElement?: (completion: Completion) => HTMLElement;\n}\n\nexport function makeDefaultCompletionElement(completion: Completion) {\n  let element = document.createElement('div');\n  element.textContent = completion.value;\n  return element;\n}\n\nexport function makeCompletionElementWithDescription(completion: CompletionWithDescription) {\n  let element = document.createElement('div');\n  element.className = 'autocomplete-completion-with-description';\n  element.textContent = completion.value;\n  let descriptionElement = document.createElement('div');\n  descriptionElement.className = 'autocomplete-completion-description';\n  descriptionElement.textContent = completion.description || '';\n  element.appendChild(descriptionElement);\n  return element;\n}\n\nconst keyMap = EventActionMap.fromObject({\n  'arrowdown': {action: 'cycle-next-active-completion'},\n  'arrowup': {action: 'cycle-prev-active-completion'},\n  'tab': {action: 'choose-active-completion-or-prefix', preventDefault: false},\n  'enter': {action: 'choose-active-completion', preventDefault: false},\n  'escape': {action: 'cancel', preventDefault: false, stopPropagation: false},\n});\n\n\nexport type Completer = (value: string, cancellationToken: CancellationToken) =>\n    Promise<CompletionResult>| null;\n\nconst DEFAULT_COMPLETION_DELAY = 200;  // milliseconds\n\nexport class AutocompleteTextInput extends RefCounted {\n  element: HTMLDivElement;\n  promptElement: HTMLLabelElement;\n  inputWrapperElement: HTMLDivElement;\n  inputElement: HTMLInputElement;\n  hintElement: HTMLInputElement;\n  dropdownElement: HTMLDivElement;\n  inputChanged = new Signal<(value: string) => void>();\n  private prevInputValue = '';\n  private completionsVisible = false;\n  private activeCompletionPromise: Promise<CompletionResult>|null = null;\n  private activeCompletionCancellationToken: CancellationTokenSource|undefined = undefined;\n  private hasFocus = false;\n  private completionResult: CompletionResult|null = null;\n  private dropdownContentsStale = true;\n  private updateHintScrollPositionTimer: number|null = null;\n  private completionElements: HTMLElement[]|null = null;\n  private hasResultForDropdown = false;\n  private commonPrefix = '';\n\n  /**\n   * Index of the active completion.  The active completion is displayed as the hint text and is\n   * highlighted in the dropdown.\n   */\n  private activeIndex = -1;\n\n  private dropdownStyleStale = true;\n\n  private scheduleUpdateCompletions: () => void;\n  completer: Completer;\n\n  constructor(options: {completer: Completer, delay?: number}) {\n    super();\n    this.completer = options.completer;\n    let {delay = DEFAULT_COMPLETION_DELAY} = options;\n\n    let debouncedCompleter = this.scheduleUpdateCompletions = debounce(() => {\n      const cancellationToken = this.activeCompletionCancellationToken =\n          new CancellationTokenSource();\n      let activeCompletionPromise = this.activeCompletionPromise =\n          this.completer(this.value, cancellationToken);\n      if (activeCompletionPromise !== null) {\n        activeCompletionPromise.then(completionResult => {\n          if (this.activeCompletionPromise === activeCompletionPromise) {\n            this.setCompletions(completionResult);\n            this.activeCompletionPromise = null;\n          }\n        });\n      }\n    }, delay);\n    this.registerDisposer(() => {\n      debouncedCompleter.cancel();\n    });\n\n    let element = this.element = document.createElement('div');\n    element.className = 'autocomplete';\n\n    let dropdownAndInputWrapper = document.createElement('div');\n    dropdownAndInputWrapper.className = 'autocomplete-dropdown-wrapper';\n\n    let dropdownElement = this.dropdownElement = document.createElement('div');\n    dropdownElement.className = 'autocomplete-dropdown';\n\n    let promptElement = this.promptElement = document.createElement('label');\n    promptElement.className = 'autocomplete-prompt';\n\n    let inputWrapperElement = this.inputWrapperElement = document.createElement('div');\n    inputWrapperElement.className = 'autocomplete-input-wrapper';\n\n    element.appendChild(promptElement);\n\n    let inputElement = this.inputElement = document.createElement('input');\n    inputElement.type = 'text';\n    inputElement.autocomplete = 'off';\n    inputElement.spellcheck = false;\n    inputElement.className = 'autocomplete-input';\n    associateLabelWithElement(promptElement, inputElement);\n\n    let hintElement = this.hintElement = document.createElement('input');\n    hintElement.type = 'text';\n    hintElement.spellcheck = false;\n    hintElement.className = 'autocomplete-hint';\n    hintElement.disabled = true;\n    inputWrapperElement.appendChild(hintElement);\n    inputWrapperElement.appendChild(inputElement);\n\n    dropdownAndInputWrapper.appendChild(inputWrapperElement);\n    dropdownAndInputWrapper.appendChild(dropdownElement);\n    element.appendChild(dropdownAndInputWrapper);\n\n    this.registerInputHandler();\n    this.handleInputChanged('');\n\n    this.registerEventListener(this.inputElement, 'focus', () => {\n      if (!this.hasFocus) {\n        this.hasFocus = true;\n        this.dropdownStyleStale = true;\n        this.updateDropdown();\n      }\n    });\n    this.registerEventListener(this.inputElement, 'blur', () => {\n      if (this.hasFocus) {\n        this.hasFocus = false;\n        this.updateDropdown();\n      }\n    });\n    this.registerEventListener(element.ownerDocument!.defaultView!, 'resize', () => {\n      this.dropdownStyleStale = true;\n    });\n\n    this.registerEventListener(element.ownerDocument!.defaultView!, 'scroll', () => {\n      this.dropdownStyleStale = true;\n    });\n\n    this.registerEventListener(\n        this.dropdownElement, 'mousedown', this.handleDropdownMousedown.bind(this));\n\n    this.registerEventListener(this.inputElement, 'keydown', () => {\n      // User may have used a keyboard shortcut to scroll the input.\n      this.hintScrollPositionMayBeStale();\n    });\n\n    this.registerEventListener(this.inputElement, 'mousemove', (event: MouseEvent) => {\n      if (event.buttons !== 0) {\n        // May be dragging the text, which could cause scrolling.  This is not perfect, because we\n        // don't detect mouse movements outside of the input box.\n        this.hintScrollPositionMayBeStale();\n      }\n    });\n\n    const keyboardHandler = this.registerDisposer(new KeyboardEventBinder(inputElement, keyMap));\n    keyboardHandler.allShortcutsAreGlobal = true;\n\n    registerActionListener(inputElement, 'cycle-next-active-completion', () => {\n      this.cycleActiveCompletion(+1);\n    });\n\n    registerActionListener(inputElement, 'cycle-prev-active-completion', () => {\n      this.cycleActiveCompletion(-1);\n    });\n\n    registerActionListener(\n        inputElement, 'choose-active-completion-or-prefix', (event: CustomEvent) => {\n          if (this.selectActiveCompletion(/*allowPrefix=*/true)) {\n            event.preventDefault();\n          }\n        });\n    registerActionListener(inputElement, 'choose-active-completion', (event: CustomEvent) => {\n      if (this.selectActiveCompletion(/*allowPrefix=*/false)) {\n        event.preventDefault();\n      }\n    });\n    registerActionListener(inputElement, 'cancel', (event: CustomEvent) => {\n      event.stopPropagation();\n      if (this.cancel()) {\n        event.detail.preventDefault();\n        event.detail.stopPropagation();\n      }\n    });\n  }\n\n  private hintScrollPositionMayBeStale() {\n    if (this.hintElement.value !== '') {\n      this.scheduleUpdateHintScrollPosition();\n    }\n  }\n\n  get disabled() {\n    return this.inputElement.disabled;\n  }\n\n  set disabled(value: boolean) {\n    this.inputElement.disabled = value;\n  }\n\n  private handleDropdownMousedown(event: MouseEvent) {\n    this.inputElement.focus();\n    let {dropdownElement} = this;\n    for (let target: EventTarget|null = event.target; target instanceof HTMLElement;\n         target = target.parentElement) {\n      let index = (<any>target)[AUTOCOMPLETE_INDEX_SYMBOL];\n      if (index !== undefined) {\n        this.selectCompletion(index);\n        break;\n      }\n      if (target === dropdownElement) {\n        break;\n      }\n    }\n    event.preventDefault();\n  }\n\n  cycleActiveCompletion(delta: number) {\n    if (this.completionResult === null) {\n      return;\n    }\n    let {activeIndex} = this;\n    let numCompletions = this.completionResult.completions.length;\n    if (activeIndex === -1) {\n      if (delta > 0) {\n        activeIndex = 0;\n      } else {\n        activeIndex = numCompletions - 1;\n      }\n    } else {\n      activeIndex = (activeIndex + delta + numCompletions) % numCompletions;\n    }\n    this.setActiveIndex(activeIndex);\n  }\n\n  private registerInputHandler() {\n    const handler = (_event: Event) => {\n      let value = this.inputElement.value;\n      if (value !== this.prevInputValue) {\n        this.prevInputValue = value;\n        this.handleInputChanged(value);\n      }\n    };\n    for (let eventType of ['input']) {\n      this.registerEventListener(this.inputElement, eventType, handler, /*useCapture=*/false);\n    }\n  }\n\n  private shouldShowDropdown() {\n    let {completionResult} = this;\n    if (completionResult === null || !this.hasFocus) {\n      return false;\n    }\n    return this.hasResultForDropdown;\n  }\n\n  private updateDropdownStyle() {\n    let {dropdownElement, inputElement} = this;\n    positionDropdown(dropdownElement, inputElement, {horizontal: false});\n    this.dropdownStyleStale = false;\n  }\n\n  private updateDropdown() {\n    if (this.shouldShowDropdown()) {\n      let {dropdownElement} = this;\n      let {activeIndex} = this;\n      if (this.dropdownContentsStale) {\n        let completionResult = this.completionResult!;\n        let {makeElement = makeDefaultCompletionElement} = completionResult;\n        this.completionElements = completionResult.completions.map((completion, index) => {\n          let completionElement = makeElement.call(completionResult, completion);\n          (<any>completionElement)[AUTOCOMPLETE_INDEX_SYMBOL] = index;\n          completionElement.classList.add('autocomplete-completion');\n          if (activeIndex === index) {\n            completionElement.classList.add(ACTIVE_COMPLETION_CLASS_NAME);\n          }\n          dropdownElement.appendChild(completionElement);\n          return completionElement;\n        });\n        this.dropdownContentsStale = false;\n      }\n      if (this.dropdownStyleStale) {\n        this.updateDropdownStyle();\n      }\n      if (!this.completionsVisible) {\n        dropdownElement.style.display = 'block';\n        this.completionsVisible = true;\n      }\n      if (activeIndex !== -1) {\n        let completionElement = this.completionElements![activeIndex];\n        scrollIntoViewIfNeeded(completionElement);\n      }\n    } else if (this.completionsVisible) {\n      this.dropdownElement.style.display = 'none';\n      this.completionsVisible = false;\n    }\n  }\n\n  private setCompletions(completionResult: CompletionResult) {\n    this.clearCompletions();\n    let {completions} = completionResult;\n    if (completions.length === 0) {\n      return;\n    }\n    this.completionResult = completionResult;\n\n    if (completions.length === 1) {\n      let completion = completions[0];\n      if (completionResult.showSingleResult) {\n        this.hasResultForDropdown = true;\n      } else {\n        let value = this.prevInputValue;\n        if (!completion.value.startsWith(value)) {\n          this.hasResultForDropdown = true;\n        } else {\n          this.hasResultForDropdown = false;\n        }\n      }\n      if (completionResult.selectSingleResult) {\n        this.setActiveIndex(0);\n      } else {\n        this.setHintValue(this.getCompletedValueByIndex(0));\n      }\n    } else {\n      this.hasResultForDropdown = true;\n      // Check for a common prefix.\n      let commonResultPrefix = longestCommonPrefix(function*() {\n        for (let completion of completionResult.completions) {\n          yield completion.value;\n        }\n      }());\n      let commonPrefix = this.getCompletedValue(commonResultPrefix);\n      let value = this.prevInputValue;\n      if (commonPrefix.startsWith(value)) {\n        this.commonPrefix = commonPrefix;\n        this.setHintValue(commonPrefix);\n      }\n    }\n    this.updateDropdown();\n  }\n\n  private scheduleUpdateHintScrollPosition() {\n    if (this.updateHintScrollPositionTimer === null) {\n      this.updateHintScrollPositionTimer = setTimeout(() => {\n        this.updateHintScrollPosition();\n      }, 0);\n    }\n  }\n\n  setHintValue(hintValue: string) {\n    let value = this.prevInputValue;\n    if (hintValue === value || !hintValue.startsWith(value)) {\n      // If the hint value is identical to the current value, there is no need to show it.  Also,\n      // if it is not a prefix of the current value, then we cannot show it either.\n      hintValue = '';\n    }\n    this.hintElement.value = hintValue;\n    this.scheduleUpdateHintScrollPosition();\n  }\n\n  /**\n   * This sets the active completion, which causes it to be highlighted and displayed as the hint.\n   * Additionally, if the user hits tab then it is chosen.\n   */\n  private setActiveIndex(index: number) {\n    if (!this.dropdownContentsStale) {\n      let {activeIndex} = this;\n      if (activeIndex !== -1) {\n        this.completionElements![activeIndex].classList.remove(ACTIVE_COMPLETION_CLASS_NAME);\n      }\n      if (index !== -1) {\n        let completionElement = this.completionElements![index];\n        completionElement.classList.add(ACTIVE_COMPLETION_CLASS_NAME);\n        scrollIntoViewIfNeeded(completionElement);\n      }\n    }\n    if (index !== -1) {\n      this.setHintValue(this.getCompletedValueByIndex(index));\n    }\n    this.activeIndex = index;\n  }\n\n  private getCompletedValueByIndex(index: number) {\n    return this.getCompletedValue(this.completionResult!.completions[index].value);\n  }\n\n  private getCompletedValue(completionValue: string) {\n    let completionResult = this.completionResult!;\n    let value = this.prevInputValue;\n    return value.substring(0, completionResult.offset) + completionValue;\n  }\n\n  selectActiveCompletion(allowPrefix: boolean) {\n    let {activeIndex} = this;\n    if (activeIndex === -1) {\n      if (!allowPrefix) {\n        return false;\n      }\n      let {completionResult} = this;\n      if (completionResult !== null && completionResult.completions.length === 1) {\n        activeIndex = 0;\n      } else {\n        let {commonPrefix} = this;\n        if (commonPrefix.length > this.value.length) {\n          this.value = commonPrefix;\n          return true;\n        }\n        return false;\n      }\n    }\n    let newValue = this.getCompletedValueByIndex(activeIndex);\n    if (this.value === newValue) {\n      return false;\n    }\n    this.value = newValue;\n    return true;\n  }\n\n  selectCompletion(index: number) {\n    this.value = this.getCompletedValueByIndex(index);\n  }\n\n  /**\n   * Called when user presses escape.  Does nothing here, but may be overridden in a subclass.\n   */\n  cancel() {\n    return false;\n  }\n\n  /**\n   * Updates the hintElement scroll position to match the scroll position of inputElement.\n   *\n   * This is called asynchronously after the input changes because automatic scrolling appears to\n   * take place after the 'input' event fires.\n   */\n  private updateHintScrollPosition() {\n    this.updateHintScrollPositionTimer = null;\n    this.hintElement.scrollLeft = this.inputElement.scrollLeft;\n  }\n\n  private cancelActiveCompletion() {\n    const token = this.activeCompletionCancellationToken;\n    if (token !== undefined) {\n      token.cancel();\n    }\n    this.activeCompletionCancellationToken = undefined;\n    this.activeCompletionPromise = null;\n  }\n\n  private handleInputChanged(value: string) {\n    this.cancelActiveCompletion();\n    this.hintElement.value = '';\n    this.clearCompletions();\n    this.inputChanged.dispatch(value);\n    this.scheduleUpdateCompletions();\n  }\n\n  private clearCompletions() {\n    if (this.completionResult !== null) {\n      this.activeIndex = -1;\n      this.completionResult = null;\n      this.completionElements = null;\n      this.dropdownContentsStale = true;\n      this.dropdownStyleStale = true;\n      this.commonPrefix = '';\n      removeChildren(this.dropdownElement);\n      this.updateDropdown();\n    }\n  }\n\n  get value() {\n    return this.prevInputValue;\n  }\n\n  set value(value: string) {\n    if (value !== this.prevInputValue) {\n      this.inputElement.value = value;\n      this.prevInputValue = value;\n      this.handleInputChanged(value);\n    }\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    this.cancelActiveCompletion();\n    if (this.updateHintScrollPositionTimer !== null) {\n      clearTimeout(this.updateHintScrollPositionTimer);\n      this.updateHintScrollPositionTimer = null;\n    }\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Utilities for positioning dropdown menus.\n */\n\nexport function positionDropdown(dropdownElement: HTMLElement, associatedElement: HTMLElement, {\n  horizontal = false,\n  vertical = true,\n  topMargin = 6,\n  bottomMargin = 6,\n  leftMargin = 6,\n  rightMargin = 6,\n  maxHeight = true,\n  maxWidth = true\n} = {}) {\n  let rect = associatedElement.getBoundingClientRect();\n\n  if (horizontal) {\n    let viewportWidth = dropdownElement.ownerDocument!.documentElement!.clientHeight;\n    let distanceLeft = rect.right;\n    let distanceRight = viewportWidth - rect.left;\n    if (distanceLeft > distanceRight) {\n      dropdownElement.style.left = '';\n      dropdownElement.style.right = '0';\n      if (maxWidth) {\n        dropdownElement.style.maxWidth = (distanceLeft - leftMargin) + 'px';\n      }\n    } else {\n      dropdownElement.style.right = '';\n      dropdownElement.style.left = '0';\n      if (maxWidth) {\n        dropdownElement.style.maxWidth = (distanceRight - rightMargin) + 'px';\n      }\n    }\n  }\n\n  if (vertical) {\n    let viewportHeight = dropdownElement.ownerDocument!.documentElement!.clientHeight;\n    let distanceToTop = rect.top - topMargin;\n    let distanceToBottom = viewportHeight - rect.bottom - bottomMargin;\n    if (distanceToTop > distanceToBottom * 3) {\n      dropdownElement.style.top = '';\n      dropdownElement.style.bottom = '100%';\n      if (maxHeight) {\n        dropdownElement.style.maxHeight = distanceToTop + 'px';\n      }\n    } else {\n      dropdownElement.style.top = '100%';\n      dropdownElement.style.bottom = '';\n      if (maxHeight) {\n        dropdownElement.style.maxHeight = distanceToBottom + 'px';\n      }\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns the longest common prefix of a sequence of strings.\n *\n * Returns '' if the sequence of strings is empty.\n */\nexport function longestCommonPrefix(strings: Iterable<string>) {\n  let it = strings[Symbol.iterator]();\n  let {value: firstValue, done: noValues} = it.next();\n  if (noValues) {\n    // The sequence of strings is empty.\n    return '';\n  }\n  let commonPrefixLength = firstValue.length;\n  while (commonPrefixLength > 0) {\n    let {value, done} = it.next();\n    if (done) {\n      break;\n    }\n    let i = 0;\n    for (; i < commonPrefixLength; ++i) {\n      if (firstValue.charCodeAt(i) !== value.charCodeAt(i)) {\n        break;\n      }\n    }\n    commonPrefixLength = i;\n  }\n  return firstValue.substring(0, commonPrefixLength);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {LayerListSpecification, ManagedUserLayerWithSpecification} from 'neuroglancer/layer_specification';\nimport {Overlay} from 'neuroglancer/overlay';\nimport {DataType, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {CancellationToken, CancellationTokenSource} from 'neuroglancer/util/cancellation';\nimport {associateLabelWithElement} from 'neuroglancer/widget/associate_label';\nimport {AutocompleteTextInput, makeCompletionElementWithDescription} from 'neuroglancer/widget/autocomplete';\nimport {makeHiddenSubmitButton} from 'neuroglancer/widget/hidden_submit_button';\n\nrequire('./layer_dialog.css');\n\nexport class LayerDialog extends Overlay {\n  /**\n   * Used for displaying status information.\n   */\n  statusElement = document.createElement('div');\n\n  sourceInput: AutocompleteTextInput;\n  submitElement = document.createElement('button');\n  namePromptElement = document.createElement('label');\n  nameInputElement = document.createElement('input');\n  volumeCancellationSource: CancellationTokenSource|undefined = undefined;\n  sourceValid: boolean = false;\n  nameValid: boolean = true;\n\n  constructor(\n      public manager: LayerListSpecification,\n      public existingLayer?: ManagedUserLayerWithSpecification) {\n    super();\n    let dialogElement = this.content;\n    dialogElement.classList.add('add-layer-overlay');\n\n    let sourceCompleter = (value: string, cancellationToken: CancellationToken) =>\n        this.manager.dataSourceProvider\n            .volumeCompleter(value, this.manager.chunkManager, cancellationToken)\n            .then(originalResult => ({\n                    completions: originalResult.completions,\n                    makeElement: makeCompletionElementWithDescription,\n                    offset: originalResult.offset,\n                    showSingleResult: true,\n                  }));\n    let sourceForm = document.createElement('form');\n    sourceForm.className = 'source-form';\n    this.registerEventListener(sourceForm, 'submit', (event: Event) => {\n      event.preventDefault();\n      this.validateSource(/*focusName=*/true);\n    });\n\n    let sourcePrompt = document.createElement('label');\n    sourcePrompt.textContent = 'Source:';\n    let sourceInput = this.sourceInput =\n        this.registerDisposer(new AutocompleteTextInput({completer: sourceCompleter, delay: 0}));\n    sourceInput.element.classList.add('add-layer-source');\n    sourceInput.inputElement.addEventListener('blur', () => {\n      this.validateSource(/*focusName=*/false);\n    });\n    this.submitElement.disabled = true;\n    sourceInput.inputChanged.add(() => {\n      const {volumeCancellationSource} = this;\n      if (volumeCancellationSource !== undefined) {\n        volumeCancellationSource.cancel();\n        this.volumeCancellationSource = undefined;\n      }\n      this.sourceValid = false;\n      this.submitElement.disabled = true;\n      this.statusElement.textContent = '';\n    });\n    sourceForm.appendChild(sourcePrompt);\n    sourceForm.appendChild(sourceInput.element);\n    associateLabelWithElement(sourcePrompt, sourceInput.inputElement);\n    let hiddenSourceSubmit = makeHiddenSubmitButton();\n    sourceForm.appendChild(hiddenSourceSubmit);\n\n    dialogElement.appendChild(sourceForm);\n\n    let {statusElement, namePromptElement, nameInputElement, submitElement} = this;\n    statusElement.className = 'dialog-status';\n\n    let nameForm = document.createElement('form');\n    nameForm.className = 'name-form';\n    namePromptElement.textContent = 'Name:';\n    nameInputElement.className = 'add-layer-name';\n    nameInputElement.autocomplete = 'off';\n    nameInputElement.spellcheck = false;\n\n    nameInputElement.type = 'text';\n\n    this.registerEventListener(nameInputElement, 'input', () => {\n      this.validateName();\n    });\n\n    submitElement.type = 'submit';\n\n    associateLabelWithElement(namePromptElement, nameInputElement);\n\n    nameForm.appendChild(namePromptElement);\n    nameForm.appendChild(nameInputElement);\n    nameForm.appendChild(submitElement);\n    dialogElement.appendChild(nameForm);\n\n    dialogElement.appendChild(statusElement);\n\n    if (existingLayer !== undefined) {\n      if (existingLayer.sourceUrl !== undefined) {\n        sourceInput.value = existingLayer.sourceUrl;\n        this.validateSource();\n      } else {\n        this.sourceValid = true;\n      }\n      sourceInput.disabled = true;\n      nameInputElement.value = existingLayer.name;\n      this.validateName();\n      submitElement.textContent = 'Save';\n      nameInputElement.focus();\n    } else {\n      let {managedLayers} = this.manager.layerManager;\n      for (let hintLayerIndex = managedLayers.length - 1; hintLayerIndex >= 0; --hintLayerIndex) {\n        const hintLayer = managedLayers[hintLayerIndex];\n        if (!(hintLayer instanceof ManagedUserLayerWithSpecification)) continue;\n        const {sourceUrl} = hintLayer;\n        if (sourceUrl === undefined) continue;\n        try {\n          let groupIndex = this.manager.dataSourceProvider.findSourceGroup(sourceUrl);\n          sourceInput.value = sourceUrl.substring(0, groupIndex);\n          sourceInput.inputElement.setSelectionRange(0, groupIndex);\n          break;\n        } catch {\n        }\n      }\n      sourceInput.inputElement.focus();\n      submitElement.textContent = 'Add Layer';\n    }\n\n    this.registerEventListener(nameForm, 'submit', (event: Event) => {\n      event.preventDefault();\n      this.submit();\n    });\n  }\n\n  isNameValid() {\n    let name = this.nameInputElement.value;\n    if (name === '') {\n      return false;\n    }\n    let otherLayer = this.manager.layerManager.getLayerByName(name);\n    return otherLayer === undefined || otherLayer === this.existingLayer;\n  }\n\n  submit() {\n    if (this.sourceValid && this.isNameValid()) {\n      if (this.existingLayer) {\n        this.existingLayer.name = this.nameInputElement.value;\n        this.manager.layerManager.layersChanged.dispatch();\n      } else {\n        this.manager.add(\n            this.manager.getLayer(this.nameInputElement.value, this.sourceInput.value));\n      }\n      this.dispose();\n    }\n  }\n\n  validateName() {\n    let {nameInputElement} = this;\n    let nameValid = this.nameValid = this.isNameValid();\n    if (nameValid) {\n      nameInputElement.classList.add('valid-input');\n      nameInputElement.classList.remove('invalid-input');\n    } else {\n      nameInputElement.classList.remove('valid-input');\n      nameInputElement.classList.add('invalid-input');\n    }\n    this.validityChanged();\n  }\n\n  validityChanged() {\n    this.submitElement.disabled = !(this.nameValid && this.sourceValid);\n  }\n\n  validateSource(focusName: boolean = false) {\n    let url = this.sourceInput.value;\n    if (url === '') {\n      return;\n    }\n    try {\n      let baseSuggestedName = this.manager.dataSourceProvider.suggestLayerName(url);\n      let {nameInputElement} = this;\n      if (this.nameInputElement.value === '') {\n        let suggestedName = this.manager.layerManager.getUniqueLayerName(baseSuggestedName);\n        nameInputElement.value = suggestedName;\n        nameInputElement.setSelectionRange(0, suggestedName.length);\n        this.validateName();\n      }\n      if (focusName) {\n        nameInputElement.focus();\n      }\n    } catch (error) {\n      this.setError(error.message);\n      return;\n    }\n\n    this.setInfo('Validating volume source...');\n    const token = this.volumeCancellationSource = new CancellationTokenSource();\n    this.manager.dataSourceProvider\n        .getVolume(\n            this.manager.chunkManager, url, /*options=*/undefined, token)\n        .then(source => {\n          if (token.isCanceled) {\n            return;\n          }\n          this.volumeCancellationSource = undefined;\n          this.sourceValid = true;\n          this.setInfo(\n              `${VolumeType[source.volumeType].toLowerCase()}: ` +\n              `${source.numChannels}-channel ${DataType[source.dataType].toLowerCase()}`);\n          this.validityChanged();\n        })\n        .catch((reason: Error) => {\n          if (token.isCanceled) {\n            return;\n          }\n          this.volumeCancellationSource = undefined;\n          this.setError(reason.message);\n        });\n  }\n\n  setInfo(message: string) {\n    this.statusElement.className = 'dialog-status dialog-status-info';\n    this.statusElement.textContent = message;\n  }\n\n  setError(message: string) {\n    this.statusElement.className = 'dialog-status dialog-status-error';\n    this.statusElement.textContent = message;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * This creates a form submit button that is not displayed, in order that the form may be submitted\n * using the enter key.\n */\nexport function makeHiddenSubmitButton() {\n  let element = document.createElement('button');\n  element.type = 'submit';\n  element.className = 'hidden-submit-button';\n  // We apply these styles directly to the element rather than by styling the class in order to\n  // avoid them being overridden accidentally.\n  element.style.margin = '0';\n  element.style.border = '0';\n  element.style.padding = '0';\n  element.style.width = '0';\n  element.style.height = '0';\n  element.style.overflow = 'hidden';\n  element.tabIndex = -1;\n  return element;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for encoding arbitrary strings as HTML5 Drag-and-drop types.\n *\n * The HTML5 Drag and Drop mechanism provides a way of attaching a set of (string key -> string\n * value) mappings to a drag.  The keys can be retrieved by any target the drag passes over, while\n * the values can only be retrieved when the actual \"drop\" happens.  Therefore, any data that needs\n * to be available prior to the drop must be stored as a key.  Additionally, the key strings are\n * munged.  According to the spec\n * <https://dev.w3.org/html5/spec-preview/dnd.html#the-drag-data-store>, the keys are converted to\n * ASCII lowercase, which means that only ASCII uppercase letters are modified, and all other\n * Unicode characters are preserved.  However, Chrome 62 does not appear to follow the spec, and\n * munges other characters as well.  Therefore, we hex encode to be safe.\n */\n\nimport {hexEncode, hexDecode} from 'neuroglancer/util/hex';\nimport {registerEventListener} from 'neuroglancer/util/disposable';\n\nexport function encodeStringAsDragType(s: string) {\n  return hexEncode(new TextEncoder().encode(s));\n}\n\nexport function decodeStringFromDragType(s: string) {\n  return new TextDecoder().decode(hexDecode(s));\n}\n\nexport function encodeDragType(prefix: string, parameters: any) {\n  return prefix + encodeStringAsDragType(JSON.stringify(parameters));\n}\n\nexport function decodeParametersFromDragType(dragType: string, prefix: string) {\n  if (!dragType.startsWith(prefix)) {\n    return undefined;\n  }\n  try {\n    const jsonString = decodeStringFromDragType(dragType.substring(prefix.length));\n    return JSON.parse(jsonString);\n  } catch {\n    return undefined;\n  }\n}\n\nexport function encodeParametersAsDragType(prefix: string, parameters: any) {\n  return prefix + encodeStringAsDragType(JSON.stringify(parameters));\n}\n\nexport interface DragInfo {\n  dragType: string;\n  parameters: any;\n}\n\nexport function decodeParametersFromDragTypeList(\n    dragTypes: ReadonlyArray<string>, prefix: string): DragInfo|undefined {\n  for (const dragType of dragTypes) {\n    const parameters = decodeParametersFromDragType(dragType, prefix);\n    if (parameters !== undefined) {\n      return {parameters, dragType};\n    }\n  }\n  return undefined;\n}\n\nlet savedDropEffect: string;\n\n/**\n * On Chrome 62, the dataTransfer.dropEffect property is reset to 'none' when the 'drop' event is\n * dispatched.  As a workaround, we store it in a global variable.\n *\n * The alternative workaround of recomputing it in the 'drop' event handler is problematic for a\n * different reason: the computation may depend on the modifier key states, and on Firefox 52, these\n * key states are not set in the 'drop' event.\n */\nexport function setDropEffect<T extends string>(event: DragEvent, dropEffect: T) {\n  event.dataTransfer!.dropEffect = dropEffect;\n  savedDropEffect = dropEffect;\n  return dropEffect;\n}\n\nexport function getDropEffect() {\n  return savedDropEffect;\n}\n\nexport function preventDrag(element: HTMLElement) {\n  element.draggable = true;\n  return registerEventListener(element, 'dragstart', (event: DragEvent) => {\n    event.stopPropagation();\n    event.preventDefault();\n  });\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {LayerListSpecification, ManagedUserLayerWithSpecification} from 'neuroglancer/layer_specification';\nimport {Borrowed, Owned} from 'neuroglancer/util/disposable';\nimport {decodeParametersFromDragTypeList, DragInfo, encodeParametersAsDragType, setDropEffect} from 'neuroglancer/util/drag_and_drop';\nimport {parseArray, verifyBoolean, verifyObjectProperty, verifyString} from 'neuroglancer/util/json';\n\nconst layerDragTypePrefix = 'neuroglancer-layer\\0';\n\nexport interface LayerDragSourceInfo {\n  manager: Owned<LayerListSpecification>;\n  layers: Owned<ManagedUserLayerWithSpecification>[];\n  layoutSpec: any;\n}\n\ninterface LayerDragSourceData extends LayerDragSourceInfo {\n  disposer: () => void;\n}\n\nlet dragSource: LayerDragSourceData|undefined;\n\nexport function startLayerDrag(event: DragEvent, sourceInfo: LayerDragSourceInfo) {\n  event.dataTransfer!.setData(\n      encodeParametersAsDragType(\n          layerDragTypePrefix,\n          sourceInfo.layers.map(layer => ({name: layer.name, visible: layer.visible}))),\n      JSON.stringify(\n          {layers: sourceInfo.layers.map(layer => layer.toJSON()), layout: sourceInfo.layoutSpec}));\n  if (dragSource !== undefined) {\n    dragSource.disposer();\n  }\n  let newDragSource: LayerDragSourceData;\n  let disposer = () => {\n    sourceInfo.manager.unregisterDisposer(disposer);\n    for (const layer of sourceInfo.layers) {\n      layer.dispose();\n    }\n    sourceInfo.manager.dispose();\n    if (dragSource === newDragSource) {\n      dragSource = undefined;\n    }\n  };\n  dragSource = newDragSource = {\n    manager: sourceInfo.manager.addRef(),\n    layers: sourceInfo.layers.map(x => x.addRef()),\n    layoutSpec: sourceInfo.layoutSpec,\n    disposer,\n  };\n}\n\nexport function endLayerDrag(event?: DragEvent) {\n  if (dragSource !== undefined) {\n    if (event && event.dataTransfer!.dropEffect === 'move') {\n      const removedLayers = new Set(dragSource.layers);\n      dragSource.manager.layerManager.filter(\n          (x: ManagedUserLayerWithSpecification) => !removedLayers.has(x));\n    }\n    dragSource.disposer();\n  }\n}\n\n\nexport function getLayerDragInfo(event: DragEvent): DragInfo|undefined {\n  return decodeParametersFromDragTypeList(event.dataTransfer!.types, layerDragTypePrefix);\n}\n\nfunction getCompatibleDragSource(manager: Borrowed<LayerListSpecification>): LayerDragSourceInfo|undefined {\n  if (dragSource !== undefined && dragSource.manager.rootLayers === manager.rootLayers) {\n    return dragSource;\n  }\n  return undefined;\n}\n\nexport class DropLayers {\n  dragType: string|undefined;\n\n  sourceManager: Borrowed<LayerListSpecification>|undefined;\n\n  moveSupported: boolean;\n\n  manager: Borrowed<LayerListSpecification>;\n\n  // Maps each layer to its index in the specification.\n  layers: Map<Owned<ManagedUserLayerWithSpecification>, number>;\n\n  numSourceLayers: number;\n\n  // LayerGroupViewer layout specification associated with these layers.  Only used if the drop\n  // operation creates a new layer group viewer.\n  layoutSpec: any;\n\n  /**\n   * Called in the 'drop' event handler to actually initialize the layers if they are external.\n   * Returns false if any layers failed to initialized.\n   */\n  finalize(event: DragEvent): boolean {\n    const {dragType} = this;\n    if (dragType !== undefined) {\n      try {\n        const {layers: spec, layout} = JSON.parse(event.dataTransfer!.getData(dragType));\n        if (!Array.isArray(spec) || this.numSourceLayers !== spec.length) {\n          throw new Error('Invalid layer drop data');\n        }\n        this.layoutSpec = layout;\n        for (const [layer, index] of this.layers) {\n          this.manager.initializeLayerFromSpec(layer, spec[index]);\n        }\n        return true;\n      } catch {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  get method () {\n    if (this.sourceManager !== undefined) {\n      if (this.manager === this.sourceManager) {\n        return 'move';\n      } else {\n        return 'link';\n      }\n    } else {\n      return 'copy';\n    }\n  }\n\n  compatibleWithMethod(otherMethod: string) {\n    if (this.method === otherMethod) {\n      return true;\n    }\n    if (!this.moveSupported && otherMethod === 'move') {\n      return true;\n    }\n    return false;\n  }\n}\n\nexport function getDefaultLayerDropEfect(manager: Borrowed<LayerListSpecification>, newTarget = false) {\n  const source = getCompatibleDragSource(manager);\n  if (source === undefined) {\n    return 'copy';\n  }\n  if (!newTarget && source.manager === manager) {\n    return 'move';\n  }\n  return 'link';\n}\n\nexport function getLayerDropEffect(\n    event: DragEvent, manager: Borrowed<LayerListSpecification>, newTarget = false): 'move'|'copy'|\n    'link' {\n  if (event.shiftKey) {\n    return 'copy';\n  } else if (event.ctrlKey) {\n    return 'move';\n  } else {\n    return getDefaultLayerDropEfect(manager, newTarget);\n  }\n}\n\nexport function updateLayerDropEffect(\n    event: DragEvent, manager: Borrowed<LayerListSpecification>, newTarget = false): 'move'|'copy'|\n    'link' {\n  return setDropEffect(event, getLayerDropEffect(event, manager, newTarget));\n}\n\nexport function getDropLayers(\n    event: DragEvent, manager: Borrowed<LayerListSpecification>, forceCopy: boolean,\n    allowMove: boolean, newTarget: boolean): DropLayers|undefined {\n  const source = getCompatibleDragSource(manager);\n  const moveSupported = !newTarget && source !== undefined && source.manager === manager;\n  if (!forceCopy) {\n    if (source !== undefined) {\n      const result = new DropLayers();\n      result.manager = manager;\n      result.numSourceLayers = source.layers.length;\n      result.sourceManager = source.manager;\n      result.moveSupported = moveSupported;\n      result.layers = new Map();\n      result.layoutSpec = source.layoutSpec;\n      if (!newTarget && source.manager === manager) {\n        if (allowMove) {\n          source.layers.forEach((layer, index) => {\n            result.layers.set(layer, index);\n          });\n        } else {\n          return undefined;\n        }\n      }\n      source.layers.forEach((layer, index) => {\n        if (newTarget || !manager.layerManager.has(layer)) {\n          result.layers.set(layer.addRef(), index);\n        }\n      });\n      return result;\n    }\n  }\n  const info = getLayerDragInfo(event);\n  if (info !== undefined) {\n    try {\n      const layers = parseArray(info.parameters, (layerInfo, index) => {\n        const name = verifyObjectProperty(layerInfo, 'name', verifyString);\n        const visible = verifyObjectProperty(layerInfo, 'visible', verifyBoolean);\n        const newLayer = new ManagedUserLayerWithSpecification(name, null, manager);\n        newLayer.visible = visible;\n        return <[ManagedUserLayerWithSpecification, number]>[newLayer, index];\n      });\n      const result = new DropLayers();\n      result.numSourceLayers = layers.length;\n      result.moveSupported = moveSupported;\n      result.manager = manager;\n      result.dragType = info.dragType;\n      result.layers = new Map(layers);\n      return result;\n    } catch {\n    }\n  }\n  return undefined;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface DebouncedFunction {\n  /**\n   * Ensures the wrapped function will be run at the next animation frame.\n   */\n  (): void;\n\n  /**\n   * Cancels any outstanding call.\n   */\n  cancel(): void;\n\n  /**\n   * Runs any outstanding call immediately.\n   */\n  flush(): void;\n}\n\n/**\n * Returns a function that, when called, ensures `callback` is invoked at the next animation frame.\n */\nexport function animationFrameDebounce(callback: () => void): DebouncedFunction {\n  let handle = -1;\n  const cancel = () => {\n    if (handle !== -1) {\n      cancelAnimationFrame(handle);\n      handle = -1;\n    }\n  };\n  const flush = () => {\n    if (handle !== -1) {\n      handle = -1;\n      callback();\n    }\n  };\n  return Object.assign(() => {\n    if (handle === -1) {\n      handle = requestAnimationFrame(() => {\n        handle = -1;\n        callback();\n      });\n    }\n  }, {flush, cancel});\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {MouseSelectionState} from 'neuroglancer/layer';\nimport {SpatialPosition, VoxelSize} from 'neuroglancer/navigation_state';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {animationFrameDebounce} from 'neuroglancer/util/animation_frame_debounce';\nimport {setClipboard} from 'neuroglancer/util/clipboard';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren, removeFromParent} from 'neuroglancer/util/dom';\nimport {EventActionMap, registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {KeyboardEventBinder} from 'neuroglancer/util/keyboard_bindings';\nimport {MouseEventBinder} from 'neuroglancer/util/mouse_bindings';\nimport {numberToStringFixed} from 'neuroglancer/util/number_to_string';\nimport {pickLengthUnit} from 'neuroglancer/widget/scale_bar';\n\nrequire('./position_widget.css');\nrequire('neuroglancer/ui/button.css');\n\nexport const positionDragType = 'neuroglancer-position';\n\nconst inputEventMap = EventActionMap.fromObject({\n  'tab': {action: 'tab-forward', preventDefault: false},\n  'arrowup': {action: 'adjust-up'},\n  'arrowdown': {action: 'adjust-down'},\n  'wheel': {action: 'adjust-via-wheel'},\n  'shift+tab': {action: 'tab-backward', preventDefault: false},\n  'backspace': {action: 'delete-backward', preventDefault: false},\n  'escape': {action: 'cancel'},\n  'mouseup0': {action: 'select-all-if-was-not-focused', preventDefault: false},\n});\n\nconst normalizedPrefixString = '  ';\nconst normalizedSeparatorString = ',   ';\n\nexport class PositionWidget extends RefCounted {\n  element = document.createElement('div');\n  inputContainer = document.createElement('div');\n  inputElement = document.createElement('input');\n  hintElement = document.createElement('input');\n\n  tempPosition = vec3.create();\n\n  inputFieldWidth: number;\n\n  constructor(public position: SpatialPosition, public maxNumberWidth = 6) {\n    super();\n    const {element, inputElement, hintElement, inputContainer} = this;\n    inputContainer.className = 'neuroglancer-position-widget-input-container';\n    inputElement.className = 'neuroglancer-position-widget-input';\n    hintElement.className = 'neuroglancer-position-widget-hint';\n\n    this.inputFieldWidth =\n        maxNumberWidth * 3 + normalizedPrefixString.length + normalizedSeparatorString.length * 2 + 1;\n\n    for (const x of [inputElement, hintElement]) {\n      x.spellcheck = false;\n      x.autocomplete = 'off';\n      x.type = 'text';\n      x.style.width = this.inputFieldWidth + 'ch';\n    }\n    hintElement.disabled = true;\n    const copyButton = document.createElement('div');\n    copyButton.textContent = '';\n    copyButton.className = 'neuroglancer-copy-button neuroglancer-button';\n    copyButton.title = 'Copy position to clipboard';\n    copyButton.addEventListener('click', () => {\n      const result = setClipboard(this.getPositionText());\n      StatusMessage.showTemporaryMessage(\n          result ? 'Position copied to clipboard' : 'Failed to copy position to clipboard');\n    });\n    copyButton.addEventListener('dragstart', event => {\n      event.dataTransfer!.setData(positionDragType, JSON.stringify(position.toJSON()));\n      event.dataTransfer!.setData('text', this.getPositionText());\n      event.stopPropagation();\n    });\n    copyButton.draggable = true;\n    element.appendChild(copyButton);\n    element.appendChild(inputContainer);\n    inputContainer.appendChild(inputElement);\n    inputContainer.appendChild(hintElement);\n    element.className = 'neuroglancer-position-widget';\n    this.registerDisposer(position.changed.add(\n        this.registerCancellable(animationFrameDebounce(() => this.updateView()))));\n\n    const keyboardHandler =\n        this.registerDisposer(new KeyboardEventBinder(inputElement, inputEventMap));\n    keyboardHandler.allShortcutsAreGlobal = true;\n    this.registerDisposer(new MouseEventBinder(inputElement, inputEventMap));\n\n    this.registerEventListener(inputElement, 'change', () => this.updatePosition());\n    this.registerEventListener(inputElement, 'blur', () => this.updatePosition());\n    this.registerEventListener(inputElement, 'input', () => this.cleanInput());\n    this.registerEventListener(inputElement, 'keydown', this.updateHintScrollPosition);\n    this.registerEventListener(inputElement, 'copy', (event: ClipboardEvent) => {\n      const {selectionStart, selectionEnd} = inputElement;\n      let selection = inputElement.value.substring(selectionStart || 0, selectionEnd || 0);\n      selection = selection.trim().replace(/\\s+/g, ' ');\n      const {clipboardData} = event;\n      if (clipboardData !== null) {\n        clipboardData.setData('text/plain', selection);\n      }\n      event.stopPropagation();\n      event.preventDefault();\n    });\n    let wasFocused = false;\n    this.registerEventListener(inputElement, 'mousedown', () => {\n      wasFocused = document.activeElement === inputElement;\n    });\n\n    this.registerDisposer(\n        registerActionListener(inputElement, 'select-all-if-was-not-focused', event => {\n          if (wasFocused) {\n            return;\n          }\n          inputElement.selectionStart = 0;\n          inputElement.selectionEnd = inputElement.value.length;\n          inputElement.selectionDirection = 'forward';\n          event.preventDefault();\n        }));\n\n    this.registerDisposer(registerActionListener(inputElement, 'tab-forward', event => {\n      const selectionStart =\n          Math.min(inputElement.selectionStart || 0, inputElement.selectionEnd || 0);\n      const valueSubstring = inputElement.value.substring(selectionStart);\n      const match = valueSubstring.match(/^([^,\\s]*)((?:\\s+)|(?:\\s*,\\s*))?([^,\\s]*)/);\n      if (match !== null) {\n        // Already on a field.  Pick the next field.\n        if (match[2] !== undefined) {\n          inputElement.selectionStart = selectionStart + match[1].length + match[2].length;\n          inputElement.selectionEnd = inputElement.selectionStart + match[3].length;\n          inputElement.selectionDirection = 'forward';\n          event.preventDefault();\n          return;\n        }\n      }\n    }));\n\n    this.registerDisposer(registerActionListener(inputElement, 'tab-backward', event => {\n      const selectionEnd =\n          Math.max(inputElement.selectionStart || 0, inputElement.selectionEnd || 0);\n      const valueSubstring = inputElement.value.substring(0, selectionEnd);\n      const match = valueSubstring.match(/([^,\\s]*)((?:\\s+)|(?:\\s*,\\s*))?([^,\\s]*)$/);\n      if (match !== null) {\n        // Already on a field.  Pick the previous field.\n        if (match[2] !== undefined) {\n          inputElement.selectionStart = match.index!;\n          inputElement.selectionEnd = inputElement.selectionStart + match[1].length;\n          inputElement.selectionDirection = 'forward';\n          event.preventDefault();\n          return;\n        }\n      }\n    }));\n\n    this.registerDisposer(registerActionListener(inputElement, 'delete-backward', event => {\n      if (inputElement.selectionStart === inputElement.selectionEnd &&\n          inputElement.selectionStart === inputElement.value.length) {\n        const match = inputElement.value.match(/^(.*)(?![\\s])(?:(?:\\s+)|(?:\\s*,\\s*))$/);\n        if (match !== null) {\n          inputElement.value = match[1];\n          this.cleanInput();\n          event.preventDefault();\n          return;\n        }\n      }\n    }));\n\n    this.registerDisposer(registerActionListener(inputElement, 'cancel', () => {\n      this.updateView();\n      this.inputElement.blur();\n    }));\n\n    this.registerDisposer(\n        registerActionListener<WheelEvent>(inputElement, 'adjust-via-wheel', actionEvent => {\n          const event = actionEvent.detail;\n          const {deltaY} = event;\n          if (deltaY === 0) {\n            return;\n          }\n          const mouseCursorPosition = Math.ceil(\n              (inputElement.scrollLeft + event.offsetX - inputElement.clientLeft) /\n              (inputElement.scrollWidth / this.inputFieldWidth));\n\n          this.adjustFromCursor(mouseCursorPosition, -Math.sign(deltaY));\n        }));\n\n    this.registerDisposer(registerActionListener<WheelEvent>(inputElement, 'adjust-up', () => {\n      this.adjustFromCursor(undefined, 1);\n    }));\n    this.registerDisposer(registerActionListener<WheelEvent>(inputElement, 'adjust-down', () => {\n      this.adjustFromCursor(undefined, -1);\n    }));\n    this.updateView();\n  }\n\n  private adjustFromCursor(cursorPosition: number|undefined, adjustment: number) {\n    const {inputElement} = this;\n    if (cursorPosition === undefined) {\n      cursorPosition =\n          (inputElement.selectionDirection === 'forward' ? inputElement.selectionEnd :\n                                                           inputElement.selectionStart) ||\n          0;\n    }\n    if (this.cleanInput() === undefined) {\n      return;\n    }\n\n    const substring = inputElement.value.substring(0, cursorPosition);\n    const axisIndex = substring.split(',').length - 1;\n    this.updatePosition();\n    const voxelCoordinates = this.tempPosition;\n    if (this.position.getVoxelCoordinates(voxelCoordinates)) {\n      voxelCoordinates[axisIndex] += adjustment;\n      this.position.setVoxelCoordinates(voxelCoordinates);\n      this.updateView();\n    }\n  }\n\n  private cleanInput(): {position?: vec3}|undefined {\n    const s = this.inputElement.value;\n    const cursorPosition = this.inputElement.selectionStart || 0;\n    const numberPattern = /(-?\\d+(?:\\.(?:\\d+)?)?)/.source;\n    const separatorPattern = /((?:\\s+(?![\\s,]))|(?:\\s*,\\s*))/.source;\n    const startAndEndPattern = /([\\[\\]{}()\\s]*)/.source;\n    const pattern = new RegExp(\n        `^${startAndEndPattern}(?![\\\\s])${numberPattern}?` +\n        `(?:${separatorPattern}${numberPattern}?(?:${separatorPattern}${numberPattern}?)?)?` +\n        `${startAndEndPattern}$`);\n\n    const match = s.match(pattern);\n    if (match !== null) {\n      let cleanInput = normalizedPrefixString;\n      let hint = 'x ';\n      let cleanCursor = 2;\n      let curFieldStart = match[1].length;\n\n      const processField =\n          (matchText: string|undefined, replacementText: string|undefined = undefined,\n           hintText: string|undefined = undefined) => {\n            if (matchText === undefined) {\n              return;\n            }\n            let curFieldEnd = curFieldStart + matchText.length;\n            if (replacementText === undefined) {\n              replacementText = matchText;\n              hintText = ' '.repeat(replacementText.length);\n            }\n\n            if (cursorPosition >= curFieldStart) {\n              if (cursorPosition === curFieldEnd) {\n                cleanCursor = cleanInput.length + replacementText.length;\n              } else {\n                cleanCursor = cleanInput.length +\n                    Math.min(replacementText.length, cursorPosition - curFieldStart);\n              }\n            }\n            cleanInput += replacementText;\n            hint += hintText;\n            curFieldStart = curFieldEnd;\n          };\n\n      processField(match[2]);\n      processField(match[3], normalizedSeparatorString, '  y ');\n      processField(match[4]);\n      processField(match[5], normalizedSeparatorString, '  z ');\n      processField(match[6]);\n      this.hintElement.value = hint;\n\n      if (this.inputElement.value !== cleanInput) {\n        this.inputElement.value = cleanInput;\n        this.inputElement.selectionEnd = cleanCursor;\n        this.inputElement.selectionStart = cleanCursor;\n      }\n\n      this.updateHintScrollPosition();\n\n      if (match[2] !== undefined && match[4] !== undefined && match[6] !== undefined) {\n        return {\n          position: vec3.set(\n              this.tempPosition, parseFloat(match[2]), parseFloat(match[4]), parseFloat(match[6]))\n        };\n      }\n      return {};\n    } else {\n      this.hintElement.value = '';\n    }\n    return undefined;\n  }\n\n  private updatePosition() {\n    const cleanResult = this.cleanInput();\n    if (cleanResult !== undefined && cleanResult.position !== undefined) {\n      this.position.setVoxelCoordinates(cleanResult.position);\n    }\n  }\n\n  private getPositionText() {\n    const {position} = this;\n    const voxelPosition = this.tempPosition;\n    if (position.getVoxelCoordinates(voxelPosition)) {\n      return `${Math.floor(voxelPosition[0])}, ${Math.floor(voxelPosition[1])}, ${\n          Math.floor(voxelPosition[2])}`;\n    } else {\n      return '<unspecified position>';\n    }\n  }\n\n  private updateHintScrollPosition = this.registerCancellable(animationFrameDebounce(() => {\n    this.hintElement.scrollLeft = this.inputElement.scrollLeft;\n  }));\n\n  private updateView() {\n    const {position} = this;\n    const voxelPosition = this.tempPosition;\n    if (position.getVoxelCoordinates(voxelPosition)) {\n      const {inputElement} = this;\n      const inputText = `  ${Math.floor(voxelPosition[0])},   ${Math.floor(voxelPosition[1])},   ${\n          Math.floor(voxelPosition[2])}`;\n      const firstComma = inputText.indexOf(',');\n      const secondComma = inputText.indexOf(',', firstComma + 1);\n      const xLen = firstComma - 2;\n      const yLen = secondComma - firstComma - 4;\n      let hintText = `x ${' '.repeat(xLen)}  y ${' '.repeat(yLen)}  z`;\n\n      const prevSelectionStart = inputElement.selectionStart || 0;\n      const prevSelectionEnd = inputElement.selectionEnd || 0;\n      const prevSelectionDirection: any = inputElement.selectionDirection || undefined;\n      inputElement.value = inputText;\n      inputElement.setSelectionRange(prevSelectionStart, prevSelectionEnd, prevSelectionDirection);\n      this.hintElement.value = hintText + ' '.repeat(inputText.length - hintText.length);\n      this.updateHintScrollPosition();\n    } else {\n      this.inputElement.value = '';\n      this.hintElement.value = '';\n    }\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n\nexport class VoxelSizeWidget extends RefCounted {\n  dimensionsContainer = document.createElement('span');\n  unitsElement = document.createElement('span');\n\n  constructor (public element: HTMLElement, public voxelSize: VoxelSize) {\n    super();\n    const {dimensionsContainer, unitsElement} = this;\n    element.className = 'neuroglancer-voxel-size-widget';\n    element.title = 'Voxel size';\n    dimensionsContainer.className = 'neuroglancer-voxel-size-dimensions-container';\n    element.appendChild(dimensionsContainer);\n    element.appendChild(unitsElement);\n    unitsElement.className = 'neuroglancer-voxel-size-units';\n    this.registerDisposer(voxelSize.changed.add(\n        this.registerCancellable(animationFrameDebounce(() => this.updateView()))));\n    this.updateView();\n  }\n\n  private updateView() {\n    const {dimensionsContainer, unitsElement} = this;\n    removeChildren(dimensionsContainer);\n    if (!this.voxelSize.valid) {\n      this.element.style.display = 'none';\n    } else {\n      this.element.style.display = null;\n    }\n    const {size} = this.voxelSize;\n    const minVoxelSize = Math.min(size[0], size[1], size[2]);\n    const unit = pickLengthUnit(minVoxelSize);\n    unitsElement.textContent = unit.unit;\n    for (let i = 0; i < 3; ++i) {\n      const s = numberToStringFixed(size[i] / unit.lengthInNanometers, 2);\n      const dimElement = document.createElement('span');\n      dimElement.className = 'neuroglancer-voxel-size-dimension';\n      dimElement.textContent = s;\n      dimensionsContainer.appendChild(dimElement);\n    }\n  }\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n\nexport class MousePositionWidget extends RefCounted {\n  tempPosition = vec3.create();\n  constructor (public element: HTMLElement, public mouseState: MouseSelectionState, public voxelSize: VoxelSize) {\n    super();\n    element.className = 'neuroglancer-mouse-position-widget';\n    const updateViewFunction =\n        this.registerCancellable(animationFrameDebounce(() => this.updateView()));\n    this.registerDisposer(mouseState.changed.add(updateViewFunction));\n    this.registerDisposer(voxelSize.changed.add(updateViewFunction));\n  }\n  updateView() {\n    let text = '';\n    const {mouseState, voxelSize} = this;\n    if (mouseState.active && voxelSize.valid) {\n      const p = this.tempPosition;\n      voxelSize.voxelFromSpatial(p, mouseState.position);\n      text = `x ${Math.floor(p[0])},  y ${Math.floor(p[1])},  z ${Math.floor(p[2])}`;\n    }\n    this.element.textContent = text;\n  }\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {ManagedUserLayer, SelectedLayerState,} from 'neuroglancer/layer';\nimport {LayerDialog} from 'neuroglancer/layer_dialog';\nimport {LinkedViewerNavigationState} from 'neuroglancer/layer_group_viewer';\nimport {LayerListSpecification, ManagedUserLayerWithSpecification} from 'neuroglancer/layer_specification';\nimport {NavigationLinkType} from 'neuroglancer/navigation_state';\nimport {DropLayers, endLayerDrag, getDropLayers, getLayerDropEffect, startLayerDrag} from 'neuroglancer/ui/layer_drag_and_drop';\nimport {animationFrameDebounce} from 'neuroglancer/util/animation_frame_debounce';\nimport {RefCounted, registerEventListener} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {getDropEffect, preventDrag, setDropEffect} from 'neuroglancer/util/drag_and_drop';\nimport {float32ToString} from 'neuroglancer/util/float32_to_string';\nimport {makeCloseButton} from 'neuroglancer/widget/close_button';\nimport {PositionWidget} from 'neuroglancer/widget/position_widget';\n\nrequire('neuroglancer/noselect.css');\nrequire('./layer_panel.css');\nrequire('neuroglancer/ui/button.css');\n\nfunction destroyDropLayers(\n    dropLayers: DropLayers, targetLayer?: ManagedUserLayerWithSpecification) {\n  if (dropLayers.method === 'move') {\n    // Nothing to do.\n    return false;\n  }\n  dropLayers.manager.layerManager.filter(\n      layer => !dropLayers.layers.has(<ManagedUserLayerWithSpecification>layer));\n  return targetLayer !== undefined && dropLayers.layers.has(targetLayer);\n}\n\nfunction registerDropHandlers(\n    panel: LayerPanel, target: EventTarget,\n    targetLayer: ManagedUserLayerWithSpecification|undefined) {\n  function update(event: DragEvent, updateDropEffect: boolean): DropLayers|undefined {\n    let dropLayers = panel.dropLayers;\n    const dropEffect =\n        updateDropEffect ? getLayerDropEffect(event, panel.manager) : getDropEffect();\n    let existingDropLayers = true;\n    if (dropLayers !== undefined) {\n      if (updateDropEffect) {\n        setDropEffect(event, dropEffect);\n      }\n      if (!dropLayers.compatibleWithMethod(dropEffect)) {\n        panel.dropLayers = undefined;\n        if (destroyDropLayers(dropLayers, targetLayer)) {\n          // We destroyed the layer for which we received the dragenter event.  Wait until we get\n          // another dragenter or drop event to do something.\n          return undefined;\n        }\n      }\n    }\n    if (dropLayers === undefined) {\n      dropLayers = panel.dropLayers = getDropLayers(\n          event, panel.manager, /*forceCopy=*/dropEffect === 'copy', /*allowMove=*/true,\n          /*newTarget=*/false);\n      if (dropLayers === undefined) {\n        return undefined;\n      }\n      existingDropLayers = dropLayers.method === 'move';\n    }\n\n    // Dragged onto itself, nothing to do.\n    if (targetLayer !== undefined && dropLayers.layers.has(targetLayer)) {\n      return dropLayers;\n    }\n    if (!existingDropLayers) {\n      let newIndex: number|undefined;\n      if (targetLayer !== undefined) {\n        newIndex = panel.manager.layerManager.managedLayers.indexOf(targetLayer);\n      }\n      for (const newLayer of dropLayers.layers.keys()) {\n        panel.manager.add(newLayer, newIndex);\n      }\n    } else {\n      // Rearrange layers.\n      const {layerManager} = panel.manager;\n      const existingLayers = new Set<ManagedUserLayerWithSpecification>();\n      let firstRemovalIndex = Number.POSITIVE_INFINITY;\n      const managedLayers = layerManager.managedLayers =\n          layerManager.managedLayers.filter((x: ManagedUserLayerWithSpecification, index) => {\n            if (dropLayers!.layers.has(x)) {\n              if (firstRemovalIndex === Number.POSITIVE_INFINITY) {\n                firstRemovalIndex = index;\n              }\n              existingLayers.add(x);\n              return false;\n            } else {\n              return true;\n            }\n          });\n      let newIndex: number;\n      if (targetLayer !== undefined) {\n        newIndex = managedLayers.indexOf(targetLayer);\n        if (firstRemovalIndex <= newIndex) {\n          ++newIndex;\n        }\n      } else {\n        newIndex = managedLayers.length;\n      }\n      // Filter out layers that have been concurrently removed.\n      for (const layer of dropLayers.layers.keys()) {\n        if (!existingLayers.has(layer)) {\n          dropLayers.layers.delete(layer);\n        }\n      }\n      managedLayers.splice(newIndex, 0, ...dropLayers.layers.keys());\n      layerManager.layersChanged.dispatch();\n    }\n    return dropLayers;\n  }\n  const enterDisposer = registerEventListener(target, 'dragenter', (event: DragEvent) => {\n    if (update(event, /*updateDropEffect=*/true) !== undefined) {\n      event.preventDefault();\n    }\n  });\n  const dropDisposer = registerEventListener(target, 'drop', (event: DragEvent) => {\n    event.preventDefault();\n    const dropLayers = update(event, /*updateDropEffect=*/false);\n    if (dropLayers !== undefined) {\n      if (!dropLayers.finalize(event)) {\n        destroyDropLayers(dropLayers);\n      } else {\n        event.dataTransfer!.dropEffect = getDropEffect();\n        endLayerDrag(dropLayers.method === 'move' ? undefined : event);\n      }\n    }\n    panel.dropLayers = undefined;\n  });\n  const overDisposer = registerEventListener(target, 'dragover', (event: DragEvent) => {\n    const dropLayers = update(event, /*updateDropEffect=*/true);\n    if (dropLayers === undefined) {\n      return;\n    }\n    event.preventDefault();\n    event.stopPropagation();\n  });\n\n  return () => {\n    overDisposer();\n    dropDisposer();\n    enterDisposer();\n  };\n}\n\n\nclass LayerWidget extends RefCounted {\n  element: HTMLElement;\n  layerNumberElement: HTMLSpanElement;\n  labelElement: HTMLSpanElement;\n  valueElement: HTMLSpanElement;\n\n  constructor(public layer: ManagedUserLayerWithSpecification, public panel: LayerPanel) {\n    super();\n    let element = this.element = document.createElement('div');\n    element.title = 'Control+click for layer options, drag to move/copy.';\n    element.className = 'neuroglancer-layer-item neuroglancer-noselect';\n    let labelElement = this.labelElement = document.createElement('span');\n    labelElement.className = 'neuroglancer-layer-item-label';\n    let layerNumberElement = this.layerNumberElement = document.createElement('span');\n    layerNumberElement.className = 'neuroglancer-layer-item-number';\n    let valueElement = this.valueElement = document.createElement('span');\n    valueElement.className = 'neuroglancer-layer-item-value';\n    const closeElement = makeCloseButton();\n    closeElement.title = 'Delete layer';\n    this.registerEventListener(closeElement, 'click', (event: MouseEvent) => {\n      this.panel.layerManager.removeManagedLayer(this.layer);\n      event.stopPropagation();\n    });\n    element.appendChild(layerNumberElement);\n    element.appendChild(labelElement);\n    element.appendChild(valueElement);\n    element.appendChild(closeElement);\n    this.registerEventListener(element, 'click', (event: MouseEvent) => {\n      if (event.ctrlKey) {\n        panel.selectedLayer.layer = layer;\n        panel.selectedLayer.visible = true;\n      } else {\n        layer.setVisible(!layer.visible);\n      }\n    });\n\n    this.registerEventListener(element, 'contextmenu', (event: MouseEvent) => {\n      panel.selectedLayer.layer = layer;\n      panel.selectedLayer.visible = true;\n      event.stopPropagation();\n      event.preventDefault();\n    });\n\n    element.draggable = true;\n    this.registerEventListener(element, 'dragstart', (event: DragEvent) => {\n      startLayerDrag(\n          event,\n          {manager: panel.manager, layers: [this.layer], layoutSpec: panel.getLayoutSpecForDrag()});\n      event.stopPropagation();\n    });\n\n    this.registerEventListener(element, 'dragend', (event: DragEvent) => {\n      endLayerDrag(event);\n    });\n\n    this.registerDisposer(registerDropHandlers(this.panel, element, this.layer));\n\n    this.registerEventListener(element, 'dblclick', (_event: MouseEvent) => {\n      if (layer instanceof ManagedUserLayerWithSpecification) {\n        new LayerDialog(this.panel.manager, layer);\n      }\n    });\n  }\n\n  update() {\n    let {layer} = this;\n    this.labelElement.textContent = layer.name;\n    this.element.setAttribute('layer-visible', layer.visible.toString());\n    this.element.setAttribute(\n        'layer-selected', (layer === this.panel.selectedLayer.layer).toString());\n  }\n\n  disposed() {\n    this.element.parentElement!.removeChild(this.element);\n    super.disposed();\n  }\n}\n\nexport class LayerPanel extends RefCounted {\n  layerWidgets = new Map<ManagedUserLayer, LayerWidget>();\n  element = document.createElement('div');\n  private layerUpdateNeeded = true;\n  private valueUpdateNeeded = false;\n  dropZone: HTMLDivElement;\n  private layerWidgetInsertionPoint = document.createElement('div');\n  private positionWidget =\n      this.registerDisposer(new PositionWidget(this.viewerNavigationState.position.value));\n\n  /**\n   * For use within this module only.\n   */\n  dropLayers: DropLayers|undefined;\n\n  get layerManager() {\n    return this.manager.layerManager;\n  }\n\n  constructor(\n      public display: DisplayContext, public manager: LayerListSpecification,\n      public viewerNavigationState: LinkedViewerNavigationState,\n      public selectedLayer: SelectedLayerState, public getLayoutSpecForDrag: () => any) {\n    super();\n    this.registerDisposer(selectedLayer);\n    const {element} = this;\n    element.className = 'neuroglancer-layer-panel';\n    this.registerDisposer(manager.layerSelectedValues.changed.add(() => {\n      this.handleLayerValuesChanged();\n    }));\n    this.registerDisposer(manager.layerManager.layersChanged.add(() => {\n      this.handleLayersChanged();\n    }));\n    this.registerDisposer(selectedLayer.changed.add(() => {\n      this.handleLayersChanged();\n    }));\n    this.layerWidgetInsertionPoint.style.display = 'none';\n    this.element.appendChild(this.layerWidgetInsertionPoint);\n\n    let addButton = document.createElement('div');\n    addButton.className = 'neuroglancer-layer-add-button neuroglancer-button';\n    addButton.title = 'Click to add layer, control+click to add local annotation layer.';\n    addButton.textContent = '+';\n\n    let dropZone = this.dropZone = document.createElement('div');\n    dropZone.className = 'neuroglancer-layer-panel-drop-zone';\n\n    this.registerEventListener(addButton, 'click', (event: MouseEvent) => {\n      if (event.ctrlKey) {\n        const layer = new ManagedUserLayerWithSpecification('annotation', {}, this.manager);\n        this.manager.initializeLayerFromSpec(layer, {type: 'annotation'});\n        this.manager.add(layer);\n      } else {\n        this.addLayerMenu();\n      }\n    });\n    element.appendChild(addButton);\n    element.appendChild(dropZone);\n    this.registerDisposer(preventDrag(addButton));\n\n    element.appendChild(this.positionWidget.element);\n    const updatePositionWidgetVisibility = () => {\n      const linkValue = this.viewerNavigationState.position.link.value;\n      this.positionWidget.element.style.display =\n          linkValue === NavigationLinkType.LINKED ? 'none' : null;\n    };\n    this.registerDisposer(\n        this.viewerNavigationState.position.link.changed.add(updatePositionWidgetVisibility));\n    updatePositionWidgetVisibility();\n\n    this.update();\n\n    this.registerEventListener(element, 'dragleave', (event: DragEvent) => {\n      if (event.relatedTarget && element.contains(<Node>event.relatedTarget)) {\n        return;\n      }\n      const {dropLayers} = this;\n      if (dropLayers !== undefined) {\n        destroyDropLayers(dropLayers);\n        this.dropLayers = undefined;\n      }\n    });\n    this.registerDisposer(registerDropHandlers(this, addButton, undefined));\n    this.registerDisposer(registerDropHandlers(this, dropZone, undefined));\n\n    // Ensure layer widgets are updated before WebGL drawing starts; we don't want the layout to\n    // change after WebGL drawing or we will get flicker.\n    this.registerDisposer(display.updateStarted.add(() => this.updateLayers()));\n  }\n\n  disposed() {\n    this.layerWidgets.forEach(x => x.dispose());\n    this.layerWidgets = <any>undefined;\n    removeFromParent(this.element);\n    super.disposed();\n  }\n\n  handleLayersChanged() {\n    this.layerUpdateNeeded = true;\n    this.handleLayerValuesChanged();\n  }\n\n  handleLayerValuesChanged() {\n    if (!this.valueUpdateNeeded) {\n      this.valueUpdateNeeded = true;\n      this.scheduleUpdate();\n    }\n  }\n\n  private scheduleUpdate = this.registerCancellable(animationFrameDebounce(() => this.update()));\n\n  private update() {\n    this.valueUpdateNeeded = false;\n    this.updateLayers();\n    let values = this.manager.layerSelectedValues;\n    for (let [layer, widget] of this.layerWidgets) {\n      let userLayer = layer.layer;\n      let text = '';\n      if (userLayer !== null) {\n        let value = values.get(userLayer);\n        if (value !== undefined) {\n          value = Array().concat(value);\n          value = value.map((x: any) => {\n            if (x === null) {\n              return 'null';\n            } else if (Math.fround(x) === x) {\n              // FIXME: Verify actual layer data type\n              return float32ToString(x);\n            } else {\n              return x;\n            }\n          });\n          text += value.join(', ');\n        }\n      }\n      widget.valueElement.textContent = text;\n    }\n  }\n\n  updateLayers() {\n    if (!this.layerUpdateNeeded) {\n      return;\n    }\n    this.layerUpdateNeeded = false;\n    let container = this.element;\n    let layers = new Set();\n    let nextChild = this.layerWidgetInsertionPoint.nextElementSibling;\n    this.manager.layerManager.managedLayers.forEach((layer: ManagedUserLayerWithSpecification) => {\n      layers.add(layer);\n      let widget = this.layerWidgets.get(layer);\n      const layerIndex = this.manager.rootLayers.managedLayers.indexOf(layer);\n      if (widget === undefined) {\n        widget = new LayerWidget(layer, this);\n        this.layerWidgets.set(layer, widget);\n      }\n      widget.layerNumberElement.textContent = '' + (1 + layerIndex);\n      widget.update();\n      let {element} = widget;\n      if (element !== nextChild) {\n        container.insertBefore(widget.element, nextChild);\n      }\n      nextChild = element.nextElementSibling;\n    });\n    for (let [layer, widget] of this.layerWidgets) {\n      if (!layers.has(layer)) {\n        this.layerWidgets.delete(layer);\n        widget.dispose();\n      }\n    }\n  }\n\n  addLayerMenu() {\n    // Automatically destroys itself when it exits.\n    new LayerDialog(this.manager);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted, registerEventListener} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {NullarySignal} from 'neuroglancer/util/signal';\n\nrequire('./context_menu.css');\n\nexport function positionContextMenu(menu: HTMLElement, event: MouseEvent) {\n  const {offsetWidth, offsetHeight} = menu;\n  const viewportWidth = document.documentElement!.clientWidth;\n  const viewportHeight = document.documentElement!.clientHeight;\n  const posX =\n      document.documentElement!.scrollLeft + Math.min(viewportWidth - offsetWidth, event.clientX);\n  const posY =\n      document.documentElement!.scrollTop + Math.min(viewportHeight - offsetHeight, event.clientY);\n  menu.style.left = posX + 'px';\n  menu.style.top = posY + 'px';\n  menu.style.visibility = null;\n}\n\nexport class ContextMenu extends RefCounted {\n  element = document.createElement('div');\n  private menuDisposer: (() => void)|undefined;\n  private parentDisposers = new Map<HTMLElement, () => void>();\n  private disabledValue = false;\n  opened = new NullarySignal();\n  closed = new NullarySignal();\n  get disabled () {\n    return this.disabledValue;\n  }\n  set disabled(value: boolean) {\n    if (this.disabledValue !== value) {\n      this.disabledValue = value;\n      if (value) {\n        this.hide();\n      }\n    }\n  }\n  constructor(parent?: HTMLElement) {\n    super();\n    const {element} = this;\n    element.className = 'neuroglancer-context-menu';\n    element.style.visibility = 'hidden';\n    element.tabIndex = -1;\n    document.body.appendChild(element);\n\n    if (parent !== undefined) {\n      this.registerParent(parent);\n    }\n  }\n\n\n  get open () {\n    return this.menuDisposer !== undefined;\n  }\n\n  registerParent(parent: HTMLElement) {\n    const {parentDisposers} = this;\n    if (parentDisposers.has(parent)) {\n      return;\n    }\n    parentDisposers.set(\n        parent, registerEventListener(parent, 'contextmenu', (event: MouseEvent) => {\n          this.show(event);\n          event.stopPropagation();\n          event.preventDefault();\n        }));\n  }\n\n  show(originalEvent: MouseEvent) {\n    if (this.disabledValue) {\n      return;\n    }\n    this.hide();\n    const {element} = this;\n    const mousedownDisposer = registerEventListener(document, 'mousedown', (event: MouseEvent) => {\n      if (event.target instanceof Node && !element.contains(event.target)) {\n        this.hide();\n      }\n    }, /*capture=*/true);\n    const keydownDisposer = registerEventListener(document, 'keydown', (event: KeyboardEvent) => {\n      if (event.code === 'Escape') {\n        this.hide();\n      }\n    }, /*capture=*/true);\n    const menuDisposer = () => {\n      keydownDisposer();\n      mousedownDisposer();\n      element.style.display = 'none';\n    };\n    element.style.display = null;\n    element.style.visibility = 'hidden';\n    this.opened.dispatch();\n    positionContextMenu(element, originalEvent);\n    this.menuDisposer = menuDisposer;\n  }\n\n  unregisterParent(parent: HTMLElement) {\n    const {parentDisposers} = this;\n    const disposer = parentDisposers.get(parent);\n    if (disposer !== undefined) {\n      disposer();\n      parentDisposers.delete(parent);\n    }\n  }\n\n  disposed() {\n    const {parentDisposers} = this;\n    for (const disposer of parentDisposers.values()) {\n      disposer();\n    }\n    parentDisposers.clear();\n    removeFromParent(this.element);\n  }\n\n  hide() {\n    if (this.menuDisposer !== undefined) {\n      this.menuDisposer();\n      this.menuDisposer = undefined;\n      this.closed.dispatch();\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SpatialPosition} from 'neuroglancer/navigation_state';\nimport {Borrowed, registerEventListener} from 'neuroglancer/util/disposable';\nimport {positionDragType} from 'neuroglancer/widget/position_widget';\n\nexport function setupPositionDropHandlers(\n    target: EventTarget, position: Borrowed<SpatialPosition>) {\n  const dropDisposer = registerEventListener(target, 'drop', (event: DragEvent) => {\n    event.preventDefault();\n    if (event.dataTransfer!.types.indexOf(positionDragType) !== -1) {\n      const positionState = JSON.parse(event.dataTransfer!.getData(positionDragType));\n      position.restoreState(positionState);\n      event.stopPropagation();\n    }\n  });\n  const dragoverDisposer = registerEventListener(target, 'dragover', (event: DragEvent) => {\n    if (event.dataTransfer!.types.indexOf(positionDragType) !== -1) {\n      // Permit drag.\n      event.dataTransfer!.dropEffect = 'link';\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  });\n  return () => {\n    dragoverDisposer();\n    dropDisposer();\n  };\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Viewer for a group of layers.\n */\n\nimport debounce from 'lodash/debounce';\nimport {DataPanelLayoutContainer, InputEventBindings as DataPanelInputEventBindings} from 'neuroglancer/data_panel_layout';\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {MouseSelectionState, RenderLayerRole, SelectedLayerState} from 'neuroglancer/layer';\nimport {LayerPanel} from 'neuroglancer/layer_panel';\nimport {LayerListSpecification, LayerSubsetSpecification, ManagedUserLayerWithSpecification} from 'neuroglancer/layer_specification';\nimport {LinkedOrientationState, LinkedSpatialPosition, LinkedZoomState, NavigationState, Pose, TrackableNavigationLink} from 'neuroglancer/navigation_state';\nimport {TrackableBoolean} from 'neuroglancer/trackable_boolean';\nimport {WatchableSet, WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {ContextMenu} from 'neuroglancer/ui/context_menu';\nimport {endLayerDrag, startLayerDrag} from 'neuroglancer/ui/layer_drag_and_drop';\nimport {setupPositionDropHandlers} from 'neuroglancer/ui/position_drag_and_drop';\nimport {AutomaticallyFocusedElement} from 'neuroglancer/util/automatic_focus';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren} from 'neuroglancer/util/dom';\nimport {registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {CompoundTrackable} from 'neuroglancer/util/trackable';\nimport {WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\nimport {EnumSelectWidget} from 'neuroglancer/widget/enum_widget';\nimport {TrackableScaleBarOptions} from 'neuroglancer/widget/scale_bar';\n\nrequire('./layer_group_viewer.css');\n\nexport interface LayerGroupViewerState {\n  display: Borrowed<DisplayContext>;\n  navigationState: Owned<NavigationState>;\n  perspectiveNavigationState: Owned<NavigationState>;\n  mouseState: MouseSelectionState;\n  showAxisLines: TrackableBoolean;\n  showScaleBar: TrackableBoolean;\n  scaleBarOptions: TrackableScaleBarOptions;\n  showPerspectiveSliceViews: TrackableBoolean;\n  layerSpecification: Owned<LayerListSpecification>;\n  inputEventBindings: DataPanelInputEventBindings;\n  visibility: WatchableVisibilityPriority;\n  selectedLayer: SelectedLayerState;\n  visibleLayerRoles: WatchableSet<RenderLayerRole>;\n  crossSectionBackgroundColor: TrackableRGB;\n  perspectiveViewBackgroundColor: TrackableRGB;\n}\n\nexport interface LayerGroupViewerOptions {\n  showLayerPanel: WatchableValueInterface<boolean>;\n  showViewerMenu: boolean;\n}\n\nexport const viewerDragType = 'neuroglancer-layer-group-viewer';\n\nexport function hasViewerDrag(event: DragEvent) {\n  return event.dataTransfer!.types.indexOf(viewerDragType) !== -1;\n}\n\nlet dragSource: {viewer: LayerGroupViewer, disposer: () => void}|undefined;\n\nexport function getCompatibleViewerDragSource(manager: Borrowed<LayerListSpecification>):\n    LayerGroupViewer|undefined {\n  if (dragSource && dragSource.viewer.layerSpecification.rootLayers === manager.rootLayers) {\n    return dragSource.viewer;\n  } else {\n    return undefined;\n  }\n}\n\nfunction getDefaultViewerDropEffect(manager: Borrowed<LayerListSpecification>): 'move'|'copy' {\n  if (getCompatibleViewerDragSource(manager) !== undefined) {\n    return 'move';\n  } else {\n    return 'copy';\n  }\n}\n\nexport function getViewerDropEffect(\n    event: DragEvent, manager: Borrowed<LayerListSpecification>): 'move'|'copy' {\n  if (event.shiftKey) {\n    return 'copy';\n  } else if (event.ctrlKey) {\n    return 'move';\n  } else {\n    return getDefaultViewerDropEffect(manager);\n  }\n}\n\nexport class LinkedViewerNavigationState extends RefCounted {\n  position: LinkedSpatialPosition;\n  crossSectionOrientation: LinkedOrientationState;\n  crossSectionZoom: LinkedZoomState;\n  perspectiveOrientation: LinkedOrientationState;\n  perspectiveZoom: LinkedZoomState;\n\n  navigationState: NavigationState;\n  perspectiveNavigationState: NavigationState;\n\n  constructor(parent: {\n    navigationState: Borrowed<NavigationState>,\n    perspectiveNavigationState: Borrowed<NavigationState>\n  }) {\n    super();\n    this.position = new LinkedSpatialPosition(parent.navigationState.position.addRef());\n    this.crossSectionOrientation =\n        new LinkedOrientationState(parent.navigationState.pose.orientation.addRef());\n    this.crossSectionZoom = new LinkedZoomState(parent.navigationState.zoomFactor.addRef());\n    this.navigationState = this.registerDisposer(new NavigationState(\n        new Pose(this.position.value, this.crossSectionOrientation.value),\n        this.crossSectionZoom.value));\n    this.perspectiveOrientation =\n        new LinkedOrientationState(parent.perspectiveNavigationState.pose.orientation.addRef());\n    this.perspectiveZoom =\n        new LinkedZoomState(parent.perspectiveNavigationState.zoomFactor.addRef());\n    this.perspectiveNavigationState = this.registerDisposer(new NavigationState(\n        new Pose(this.position.value.addRef(), this.perspectiveOrientation.value),\n        this.perspectiveZoom.value));\n  }\n\n  copyToParent() {\n    for (const x\n             of [this.position, this.crossSectionOrientation, this.crossSectionZoom,\n                 this.perspectiveOrientation, this.perspectiveZoom]) {\n      x.copyToPeer();\n    }\n  }\n\n  register(state: CompoundTrackable) {\n    state.add('position', this.position);\n    state.add('crossSectionOrientation', this.crossSectionOrientation);\n    state.add('crossSectionZoom', this.crossSectionZoom);\n    state.add('perspectiveOrientation', this.perspectiveOrientation);\n    state.add('perspectiveZoom', this.perspectiveZoom);\n  }\n}\n\n\nfunction makeViewerMenu(parent: HTMLElement, viewer: LayerGroupViewer) {\n  const contextMenu = new ContextMenu(parent);\n  const menu = contextMenu.element;\n  menu.classList.add('neuroglancer-layer-group-viewer-context-menu');\n  const closeButton = document.createElement('button');\n  closeButton.textContent = 'Remove layer group';\n  menu.appendChild(closeButton);\n  contextMenu.registerEventListener(closeButton, 'click', () => {\n    viewer.layerSpecification.layerManager.clear();\n  });\n  const {viewerNavigationState} = viewer;\n  for (const [name, model] of <[string, TrackableNavigationLink][]>[\n         ['Position', viewerNavigationState.position.link],\n         ['Cross-section orientation', viewerNavigationState.crossSectionOrientation.link],\n         ['Cross-section zoom', viewerNavigationState.crossSectionZoom.link],\n         ['Perspective orientation', viewerNavigationState.perspectiveOrientation.link],\n         ['Perspective zoom', viewerNavigationState.perspectiveZoom.link],\n       ]) {\n    const widget = contextMenu.registerDisposer(new EnumSelectWidget(model));\n    const label = document.createElement('label');\n    label.style.display = 'flex';\n    label.style.flexDirection = 'row';\n    label.style.whiteSpace = 'nowrap';\n    label.textContent = name;\n    label.appendChild(widget.element);\n    menu.appendChild(label);\n  }\n  return contextMenu;\n}\n\nexport class LayerGroupViewer extends RefCounted {\n  layerSpecification: LayerListSpecification;\n  viewerNavigationState: LinkedViewerNavigationState;\n  get perspectiveNavigationState() {\n    return this.viewerNavigationState.perspectiveNavigationState;\n  }\n  get navigationState() {\n    return this.viewerNavigationState.navigationState;\n  }\n\n  // FIXME: don't make viewerState a property, just make these things properties directly\n  get display() {\n    return this.viewerState.display;\n  }\n  get selectedLayer() {\n    return this.viewerState.selectedLayer;\n  }\n  get layerManager() {\n    return this.layerSpecification.layerManager;\n  }\n\n  get chunkManager() {\n    return this.layerSpecification.chunkManager;\n  }\n  get mouseState() {\n    return this.viewerState.mouseState;\n  }\n  get showAxisLines() {\n    return this.viewerState.showAxisLines;\n  }\n  get showScaleBar() {\n    return this.viewerState.showScaleBar;\n  }\n  get showPerspectiveSliceViews() {\n    return this.viewerState.showPerspectiveSliceViews;\n  }\n  get inputEventBindings() {\n    return this.viewerState.inputEventBindings;\n  }\n  get visibility() {\n    return this.viewerState.visibility;\n  }\n  get visibleLayerRoles() {\n    return this.viewerState.visibleLayerRoles;\n  }\n  get crossSectionBackgroundColor() {\n    return this.viewerState.crossSectionBackgroundColor;\n  }\n  get perspectiveViewBackgroundColor() {\n    return this.viewerState.perspectiveViewBackgroundColor;\n  }\n  get scaleBarOptions() {\n    return this.viewerState.scaleBarOptions;\n  }\n  layerPanel: LayerPanel|undefined;\n  layout: DataPanelLayoutContainer;\n\n  options: LayerGroupViewerOptions;\n\n  state = new CompoundTrackable();\n\n  get changed() {\n    return this.state.changed;\n  }\n\n  constructor(\n      public element: HTMLElement, public viewerState: LayerGroupViewerState,\n      options: Partial<LayerGroupViewerOptions> = {}) {\n    super();\n    this.options = {showLayerPanel: new TrackableBoolean(true), showViewerMenu: false, ...options};\n    this.layerSpecification = this.registerDisposer(viewerState.layerSpecification);\n    this.viewerNavigationState =\n        this.registerDisposer(new LinkedViewerNavigationState(viewerState));\n    this.viewerNavigationState.register(this.state);\n    if (!(this.layerSpecification instanceof LayerSubsetSpecification)) {\n      this.state.add('layers', {\n        changed: this.layerSpecification.changed,\n        toJSON: () => this.layerSpecification.layerManager.managedLayers.map(x => x.name),\n        reset: () => {\n          throw new Error('not implemented');\n        },\n        restoreState: () => {\n          throw new Error('not implemented');\n        }\n      });\n    } else {\n      this.state.add('layers', this.layerSpecification);\n    }\n    element.classList.add('neuroglancer-layer-group-viewer');\n    this.registerDisposer(new AutomaticallyFocusedElement(element));\n\n    this.layout = this.registerDisposer(new DataPanelLayoutContainer(this, 'xy'));\n    this.state.add('layout', this.layout);\n    this.registerActionBindings();\n    this.registerDisposer(this.layerManager.useDirectly());\n    this.registerDisposer(setupPositionDropHandlers(element, this.navigationState.position));\n    this.registerDisposer(this.options.showLayerPanel.changed.add(\n        this.registerCancellable(debounce(() => this.updateUI(), 0))));\n    this.makeUI();\n  }\n\n  bindAction(action: string, handler: () => void) {\n    this.registerDisposer(registerActionListener(this.element, action, handler));\n  }\n\n  private registerActionBindings() {\n    this.bindAction('add-layer', () => {\n      if (this.layerPanel) {\n        this.layerPanel.addLayerMenu();\n      }\n    });\n  }\n\n  toJSON(): any {\n    return {'type': 'viewer', ...this.state.toJSON()};\n  }\n\n  reset() {\n    this.state.reset();\n  }\n\n  restoreState(obj: any) {\n    this.state.restoreState(obj);\n  }\n\n  private makeUI() {\n    this.element.style.flex = '1';\n    this.element.style.display = 'flex';\n    this.element.style.flexDirection = 'column';\n    this.element.appendChild(this.layout.element);\n    this.updateUI();\n  }\n\n  private updateUI() {\n    const {options} = this;\n    const showLayerPanel = options.showLayerPanel.value;\n    if (this.layerPanel !== undefined && !showLayerPanel) {\n      this.layerPanel.dispose();\n      this.layerPanel = undefined;\n      return;\n    }\n    if (showLayerPanel && this.layerPanel === undefined) {\n      const layerPanel = this.layerPanel = new LayerPanel(\n          this.display, this.layerSpecification, this.viewerNavigationState,\n          this.viewerState.selectedLayer, () => this.layout.toJSON());\n      if (options.showViewerMenu) {\n        layerPanel.registerDisposer(makeViewerMenu(layerPanel.element, this));\n        layerPanel.element.title = 'Right click for options, drag to move/copy layer group.';\n      } else {\n        layerPanel.element.title = 'Drag to move/copy layer group.';\n      }\n      layerPanel.element.draggable = true;\n      this.registerEventListener(layerPanel.element, 'dragstart', (event: DragEvent) => {\n        startLayerDrag(event, {\n          manager: this.layerSpecification,\n          layers: <ManagedUserLayerWithSpecification[]>this.layerManager.managedLayers,\n          layoutSpec: this.layout.toJSON(),\n        });\n        const disposer = () => {\n          if (dragSource && dragSource.viewer === this) {\n            dragSource = undefined;\n          }\n          this.unregisterDisposer(disposer);\n        };\n        dragSource = {viewer: this, disposer};\n        this.registerDisposer(disposer);\n        const dragData = this.toJSON();\n        delete dragData['layers'];\n        event.dataTransfer!.setData(viewerDragType, JSON.stringify(dragData));\n      });\n      this.registerEventListener(layerPanel.element, 'dragend', (event: DragEvent) => {\n        endLayerDrag(event);\n        if (dragSource !== undefined && dragSource.viewer === this) {\n          dragSource.disposer();\n        }\n      });\n      this.element.insertBefore(layerPanel.element, this.element.firstChild);\n    }\n  }\n\n  disposed() {\n    removeChildren(this.element);\n    const {layerPanel} = this;\n    if (layerPanel !== undefined) {\n      layerPanel.dispose();\n      this.layerPanel = undefined;\n    }\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for laying out multiple LayerGroupViewer instances.\n */\n\nimport debounce from 'lodash/debounce';\nimport {getViewerDropEffect, hasViewerDrag, LayerGroupViewer, viewerDragType} from 'neuroglancer/layer_group_viewer';\nimport {LayerListSpecification, LayerSubsetSpecification} from 'neuroglancer/layer_specification';\nimport {endLayerDrag, getDropLayers, getLayerDragInfo, updateLayerDropEffect} from 'neuroglancer/ui/layer_drag_and_drop';\nimport {Borrowed, RefCounted, registerEventListener} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {getDropEffect, setDropEffect} from 'neuroglancer/util/drag_and_drop';\nimport {parseArray, verifyObject, verifyObjectProperty, verifyString} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\nimport {Viewer} from 'neuroglancer/viewer';\n\nrequire('./layer_groups_layout.css');\n\ninterface LayoutComponent extends RefCounted {\n  element: HTMLElement;\n  changed: NullarySignal;\n  toJSON(): any;\n}\n\nconst layoutComponentContainerSymbol = Symbol('layoutComponentContainer');\n\n/**\n * Container for a LayoutComponent.  The contained LayoutComponent may change.\n */\nexport class LayoutComponentContainer extends RefCounted {\n  changed = new NullarySignal();\n  private componentValue: LayoutComponent;\n\n  private unsetComponent() {\n    const oldComponent = this.componentValue;\n    if (oldComponent !== undefined) {\n      oldComponent.changed.remove(this.changed.dispatch);\n      this.element.removeChild(oldComponent.element);\n      oldComponent.dispose();\n    }\n  }\n\n  get component() {\n    return this.componentValue;\n  }\n\n  private setComponent(component: LayoutComponent) {\n    this.unsetComponent();\n    this.componentValue = component;\n    component.changed.add(this.changed.dispatch);\n    this.element.appendChild(component.element);\n\n    if (component instanceof LayerGroupViewer) {\n      const {layerManager} = component;\n      const scheduleMaybeDelete = component.registerCancellable(debounce(() => {\n        if (layerManager.managedLayers.length === 0) {\n          this.dispose();\n        }\n      }, 0));\n      component.registerDisposer(layerManager.layersChanged.add(() => {\n        if (layerManager.managedLayers.length === 0) {\n          scheduleMaybeDelete();\n        }\n      }));\n      scheduleMaybeDelete();\n    } else if (component instanceof StackLayoutComponent) {\n      const scheduleMaybeDelete = component.registerCancellable(debounce(() => {\n        const {length} = component;\n        if (length === 0 && this.parent !== undefined) {\n          this.dispose();\n        } else if (length === 1) {\n          const childComponent = component.get(0).component;\n          let spec: any;\n          if (this.parent === undefined && childComponent instanceof LayerGroupViewer) {\n            spec = childComponent.layout.specification.toJSON();\n            childComponent.viewerNavigationState.copyToParent();\n            const layersToKeep = new Set(childComponent.layerManager.managedLayers);\n            const {layerSpecification} = childComponent;\n            layerSpecification.rootLayers.filter(layer => layersToKeep.has(layer));\n            layerSpecification.rootLayers.managedLayers =\n              Array.from(childComponent.layerManager.managedLayers);\n            layerSpecification.rootLayers.layersChanged.dispatch();\n          } else {\n            spec = childComponent.toJSON();\n          }\n          this.setSpecification(spec);\n        }\n      }, 0));\n      component.registerDisposer(component.changed.add(() => {\n        if (component.length < 2) {\n          scheduleMaybeDelete();\n        }\n      }));\n      scheduleMaybeDelete();\n    }\n    this.changed.dispatch();\n  }\n  element = document.createElement('div');\n\n  constructor(public viewer: Viewer, spec: any, public parent: StackLayoutComponent|undefined) {\n    super();\n    const {element} = this;\n    element.style.display = 'flex';\n    element.style.flex = '1';\n    element.style.position = 'relative';\n    element.style.alignItems = 'stretch';\n    (<any>element).foo = 'hello';\n    (<any>element)[layoutComponentContainerSymbol] = this;\n\n    this.setSpecification(spec);\n\n    interface DropZone {\n      element: HTMLElement;\n      direction: 'row' | 'column';\n      orientation: 'left' | 'right' | 'top' | 'bottom';\n    }\n\n    const dropZones: DropZone[] = [];\n    const makeDropZone = (name: 'left'|'right'|'top'|'bottom') => {\n      const dropZone = document.createElement('div');\n      dropZone.className = 'neuroglancer-layout-split-drop-zone';\n      let direction: 'row' | 'column';\n      dropZone.style[name] = '0';\n      switch (name) {\n        case 'left':\n        case 'right':\n          direction = 'row';\n          dropZone.style.width = '10px';\n          dropZone.style.height = '100%';\n          break;\n        case 'top':\n        case 'bottom':\n          direction = 'column';\n          dropZone.style.height = '10px';\n          dropZone.style.width = '100%';\n          break;\n      }\n      dropZone.style.display = 'none';\n      dropZones.push({element: dropZone, direction: direction!, orientation: name});\n      element.appendChild(dropZone);\n      this.registerDisposer(setupDropZone(\n          dropZone, this.viewer.layerSpecification,\n          () => <LayerGroupViewer>(this.split(name).newContainer.component)));\n    };\n    makeDropZone('left');\n    makeDropZone('right');\n    makeDropZone('top');\n    makeDropZone('bottom');\n\n    let dropZonesVisible = false;\n    this.registerEventListener(element, 'dragenter', (event: DragEvent) => {\n      if (dropZonesVisible) {\n        return;\n      }\n      if (getLayerDragInfo(event) === undefined) {\n        return;\n      }\n      dropZonesVisible = true;\n      for (const {element: dropZone, direction, orientation} of dropZones) {\n        if (parent !== undefined && direction === parent.direction) {\n          if (((orientation === 'left' || orientation === 'top') && parent.get(0) !== this) ||\n              ((orientation === 'bottom' || orientation === 'right') &&\n               parent.get(parent.length - 1) !== this)) {\n            continue;\n          }\n        }\n        const {component} = this;\n        if (component instanceof StackLayoutComponent && component.direction === direction) {\n          continue;\n        }\n        dropZone.style.display = 'block';\n      }\n    }, true);\n\n    this.registerEventListener(element, 'drop', (_event: DragEvent) => {\n      if (!dropZonesVisible) {\n        return;\n      }\n      dropZonesVisible = false;\n      for (const {element: dropZone} of dropZones) {\n        dropZone.style.display = 'none';\n      }\n    });\n    this.registerEventListener(element, 'dragleave', (event: DragEvent) => {\n      const {relatedTarget} = event;\n      if (!dropZonesVisible) {\n        return;\n      }\n      if (relatedTarget instanceof HTMLElement && this.element.contains(relatedTarget)) {\n        return;\n      }\n      dropZonesVisible = false;\n      for (const {element: dropZone} of dropZones) {\n        dropZone.style.display = 'none';\n      }\n    }, true);\n  }\n\n  toJSON() {\n    return this.component.toJSON();\n  }\n\n  setSpecification(spec: any) {\n    this.setComponent(makeComponent(this, spec));\n  }\n\n  static getFromElement(element: Element): LayoutComponentContainer {\n    return (<any>element)[layoutComponentContainerSymbol];\n  }\n\n  disposed () {\n    this.unsetComponent();\n    (<any>this).componentValue = undefined;\n    super.disposed();\n  }\n\n  split(side: 'left'|'top'|'bottom'|'right'):\n  {newContainer: LayoutComponentContainer, existingContainer: LayoutComponentContainer} {\n    const newComponentSpec: any = {\n      type: 'viewer',\n    };\n\n    const {parent} = this;\n    if (parent !== undefined) {\n      if ((side === 'left' && parent.direction === 'row') ||\n          (side === 'top' && parent.direction === 'column')) {\n        return {newContainer: parent.insertChild(newComponentSpec, this), existingContainer: this};\n      } else if (\n          (side === 'right' && parent.direction === 'row') ||\n          (side === 'bottom' && parent.direction === 'column')) {\n        return {newContainer: parent.insertChild(newComponentSpec), existingContainer: this};\n      }\n    }\n\n    let existingComponentSpec: any;\n    const existingComponent = this.component;\n    if (existingComponent instanceof SingletonLayerGroupViewer) {\n      existingComponentSpec = existingComponent.layerGroupViewer.toJSON();\n    } else {\n      existingComponentSpec = existingComponent.toJSON();\n    }\n    let spec: any;\n    let newIndex: number;\n    const direction = side === 'left' || side === 'right' ? 'row' : 'column';\n    switch (side) {\n      case 'left':\n      case 'top':\n        spec = {type: direction, children: [newComponentSpec, existingComponentSpec]};\n        newIndex = 0;\n        break;\n      case 'right':\n      case 'bottom':\n        spec = {type: direction, children: [existingComponentSpec, newComponentSpec]};\n        newIndex = 1;\n        break;\n    }\n    this.setSpecification(spec!);\n    const stackComponent = <StackLayoutComponent>this.component;\n    return {\n      newContainer: stackComponent.get(newIndex!),\n      existingContainer: stackComponent.get(1 - newIndex!)\n    };\n  }\n}\n\nfunction getCommonViewerState(viewer: Viewer) {\n  return {\n    mouseState: viewer.mouseState,\n    showAxisLines: viewer.showAxisLines,\n    showScaleBar: viewer.showScaleBar,\n    scaleBarOptions: viewer.scaleBarOptions,\n    showPerspectiveSliceViews: viewer.showPerspectiveSliceViews,\n    inputEventBindings: viewer.inputEventBindings,\n    visibility: viewer.visibility,\n    selectedLayer: viewer.selectedLayer,\n    visibleLayerRoles: viewer.visibleLayerRoles,\n    navigationState: viewer.navigationState.addRef(),\n    perspectiveNavigationState: viewer.perspectiveNavigationState.addRef(),\n    crossSectionBackgroundColor: viewer.crossSectionBackgroundColor,\n    perspectiveViewBackgroundColor: viewer.perspectiveViewBackgroundColor,\n  };\n}\n\nexport class SingletonLayerGroupViewer extends RefCounted implements LayoutComponent {\n  layerGroupViewer: LayerGroupViewer;\n\n  constructor(public element: HTMLElement, layout: any, viewer: Viewer) {\n    super();\n    this.layerGroupViewer = this.registerDisposer(new LayerGroupViewer(\n        element, {\n          display: viewer.display,\n          layerSpecification: viewer.layerSpecification.addRef(),\n          ...getCommonViewerState(viewer),\n        },\n        {showLayerPanel: viewer.uiControlVisibility.showLayerPanel, showViewerMenu: false}));\n    this.layerGroupViewer.layout.restoreState(layout);\n  }\n\n  toJSON() {\n    return this.layerGroupViewer.layout.specification.toJSON();\n  }\n\n  get changed() {\n    return this.layerGroupViewer.layout.changed;\n  }\n}\n\nfunction setupDropZone(\n  dropZone: HTMLElement, manager: Borrowed<LayerListSpecification>, makeLayerGroupViewer: () => Borrowed<LayerGroupViewer>) {\n  const enterDisposer = registerEventListener(dropZone, 'dragenter', (event: DragEvent) => {\n    if (getLayerDragInfo(event) === undefined) {\n      return;\n    }\n    dropZone.classList.add('neuroglancer-drag-over');\n  });\n  const leaveDisposer = registerEventListener(dropZone, 'dragleave', () => {\n    dropZone.classList.remove('neuroglancer-drag-over');\n  });\n  const overDisposer = registerEventListener(dropZone, 'dragover', (event: DragEvent) => {\n    if (hasViewerDrag(event)) {\n      setDropEffect(event, getViewerDropEffect(event, manager));\n      event.stopPropagation();\n      event.preventDefault();\n      return;\n    }\n    if (getLayerDragInfo(event) !== undefined) {\n      updateLayerDropEffect(event, manager, /*newTarget=*/true);\n      event.stopPropagation();\n      event.preventDefault();\n      return;\n    }\n  });\n  const dropDisposer = registerEventListener(dropZone, 'drop', (event: DragEvent) => {\n    dropZone.classList.remove('neuroglancer-drag-over');\n    if (hasViewerDrag(event)) {\n      event.stopPropagation();\n      let dropState: any;\n      try {\n        dropState = JSON.parse(event.dataTransfer!.getData(viewerDragType));\n      } catch (e) {\n        return;\n      }\n      const dropLayers = getDropLayers(\n          event, manager, /*forceCopy=*/false, /*allowMove=*/false,\n          /*newTarget=*/true);\n      if (dropLayers !== undefined && dropLayers.finalize(event)) {\n        event.preventDefault();\n        event.dataTransfer!.dropEffect = getDropEffect();\n        endLayerDrag(event);\n        const layerGroupViewer = makeLayerGroupViewer();\n        for (const newLayer of dropLayers.layers.keys()) {\n          layerGroupViewer.layerSpecification.add(newLayer);\n        }\n        try {\n          layerGroupViewer.restoreState(dropState);\n        } catch {\n        }\n      }\n    } else {\n      const dropLayers = getDropLayers(\n          event, manager, /*forceCopy=*/getDropEffect() === 'copy',\n          /*allowMove=*/false,\n          /*newTarget=*/true);\n      if (dropLayers !== undefined && dropLayers.finalize(event)) {\n        event.preventDefault();\n        event.dataTransfer!.dropEffect = getDropEffect();\n        endLayerDrag(event);\n        const layerGroupViewer = makeLayerGroupViewer();\n        for (const newLayer of dropLayers.layers.keys()) {\n          layerGroupViewer.layerSpecification.add(newLayer);\n        }\n        try {\n          layerGroupViewer.layout.restoreState(dropLayers.layoutSpec);\n        } catch {\n          layerGroupViewer.layout.reset();\n          // Ignore error restoring layout.\n        }\n        return;\n      }\n    }\n  });\n  return () => {\n    dropDisposer();\n    overDisposer();\n    leaveDisposer();\n    enterDisposer();\n  };\n}\n\nexport class StackLayoutComponent extends RefCounted implements LayoutComponent {\n  changed = new NullarySignal();\n\n  get length () {\n    return (this.element.childElementCount - 1) / 2;\n  }\n\n  private makeDropPlaceholder (refCounted: RefCounted) {\n    const dropZone = document.createElement('div');\n    dropZone.className = 'neuroglancer-stack-layout-drop-placeholder';\n    refCounted.registerDisposer(setupDropZone(dropZone, this.viewer.layerSpecification, () => {\n      const nextElement = dropZone.nextElementSibling;\n      let nextChild: LayoutComponentContainer|undefined;\n      if (nextElement !== null) {\n        nextChild = LayoutComponentContainer.getFromElement(nextElement);\n      }\n      const newChild = this.insertChild({type: 'viewer', layers: []}, nextChild);\n      return <LayerGroupViewer>newChild.component;\n    }));\n    refCounted.registerDisposer(() => {\n      removeFromParent(dropZone);\n    });\n    return dropZone;\n  }\n\n  get viewer() {\n    return this.container.viewer;\n  }\n\n  constructor(\n      public element: HTMLElement, public direction: 'row'|'column', children: any[],\n      public container: LayoutComponentContainer) {\n    super();\n    element.classList.add('neuroglancer-stack-layout');\n    element.classList.add(`neuroglancer-stack-layout-${direction}`);\n    element.style.display = 'flex';\n    element.style.flexDirection = direction;\n    element.appendChild(this.makeDropPlaceholder(this));\n    for (const childSpec of children) {\n      this.insertChild(childSpec);\n    }\n  }\n\n  get(index: number) {\n    return LayoutComponentContainer.getFromElement(this.element.children[index * 2 + 1]);\n  }\n\n  insertChild(spec: any, before?: LayoutComponentContainer) {\n    const child = new LayoutComponentContainer(this.viewer, spec, this);\n    const dropZone = this.makeDropPlaceholder(child);\n    child.element.classList.add('neuroglancer-stack-layout-child');\n    child.registerDisposer(child.changed.add(this.changed.dispatch));\n    child.registerDisposer(() => {\n      this.element.removeChild(child.element);\n      this.changed.dispatch();\n    });\n    const beforeElement = before !== undefined ? before.element : null;\n    this.element.insertBefore(child.element, beforeElement);\n    this.element.insertBefore(dropZone, beforeElement);\n    this.changed.dispatch();\n    return child;\n  }\n\n  disposed() {\n    this.clear();\n    super.disposed();\n  }\n\n  clear() {\n    while (this.length !== 0) {\n      this.get(0).dispose();\n    }\n  }\n\n  * [Symbol.iterator] () {\n    const {length} = this;\n    for (let i = 0; i < length; ++i) {\n      yield this.get(i);\n    }\n  }\n\n  toJSON() {\n    return {\n      type: this.direction,\n      children: Array.from(this).map(x => x.toJSON()),\n    };\n  }\n}\n\nfunction makeComponent(container: LayoutComponentContainer, spec: any) {\n  const element = document.createElement('div');\n  element.style.flex = '1';\n  element.style.width = '0px';\n  if (typeof spec === 'string') {\n    if (container.parent !== undefined) {\n      throw new Error(`Invalid layout component specification: ${JSON.stringify(spec)}`);\n    }\n    return new SingletonLayerGroupViewer(element, spec, container.viewer);\n  }\n  verifyObject(spec);\n  const componentType = verifyObjectProperty(spec, 'type', verifyString);\n  switch (componentType) {\n    case 'row':\n    case 'column': {\n      return new StackLayoutComponent(\n          element, componentType, verifyObjectProperty(spec, 'children', x => {\n            const children = parseArray(x, y => y);\n            if (container.parent === undefined && children.length === 0) {\n              throw new Error('Stack layout requires at least one child.');\n            }\n            return children;\n          }), container);\n    }\n    case 'viewer': {\n      const viewer = container.viewer;\n      const layerSpecification = new LayerSubsetSpecification(viewer.layerSpecification.addRef());\n      const layerGroupViewer = new LayerGroupViewer(\n          element, {\n            display: viewer.display,\n            layerSpecification,\n            ...getCommonViewerState(viewer),\n          },\n          {showLayerPanel: viewer.uiControlVisibility.showLayerPanel, showViewerMenu: true});\n      try {\n        layerGroupViewer.restoreState(spec);\n      } catch (e) {\n        layerGroupViewer.dispose();\n        throw e;\n      }\n      return layerGroupViewer;\n    }\n    default: {\n      // Treat it as a singleton layer group.\n      return new SingletonLayerGroupViewer(element, spec, container.viewer);\n    }\n  }\n}\n\nexport class RootLayoutContainer extends RefCounted implements Trackable {\n  container = this.registerDisposer(\n      new LayoutComponentContainer(this.viewer, this.defaultSpecification, undefined));\n\n  get changed () { return this.container.changed; }\n\n  get element() {\n    return this.container.element;\n  }\n\n  constructor(public viewer: Viewer, public defaultSpecification: any) {\n    super();\n  }\n\n  reset() {\n    this.container.setSpecification(this.defaultSpecification);\n  }\n\n  restoreState(obj: any) {\n    this.container.setSpecification(obj);\n  }\n\n  disposed() {\n    super.disposed();\n  }\n\n  toJSON() {\n    return this.container.toJSON();\n  }\n}\n","\n/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/ui/drag_resize.css';\n\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {startRelativeMouseDrag} from 'neuroglancer/util/mouse_drag';\n\nexport class DragResizablePanel extends RefCounted {\n  gutter = document.createElement('div');\n\n  private sizeProp: 'width'|'height' = this.direction === 'horizontal' ? 'width' : 'height';\n\n  constructor(\n      public element: HTMLElement, public visible: WatchableValueInterface<boolean>,\n      public size: WatchableValueInterface<number>, public direction: 'horizontal'|'vertical',\n      public minSize = 0) {\n    super();\n    const {gutter} = this;\n    gutter.className = `neuroglancer-resize-gutter-${direction}`;\n    element.insertAdjacentElement('beforebegin', gutter);\n    this.registerDisposer(visible.changed.add(() => this.updateView()));\n    this.registerDisposer(size.changed.add(() => this.updateView()));\n    const dragStart = (event: MouseEvent) => {\n      if ('button' in event && event.button !== 0) {\n        return;\n      }\n      event.preventDefault();\n      // Get initial size\n      const initialRect = element.getBoundingClientRect();\n      let size = initialRect[this.sizeProp];\n      const visibleCutoff = this.minSize / 2;\n      startRelativeMouseDrag(event, (_event, deltaX: number, deltaY: number) => {\n        size -= (direction === 'horizontal' ? deltaX : deltaY);\n        if (size < visibleCutoff) {\n          this.visible.value = false;\n        } else if (this.visible.value === false && size > visibleCutoff) {\n          this.visible.value = true;\n        }\n        this.size.value = Math.max(this.minSize, size);\n      });\n    };\n    this.registerEventListener(gutter, 'pointerdown', dragStart);\n    this.updateView();\n  }\n\n  private updateView() {\n    const {element, gutter} = this;\n    const {visible} = this;\n    if (!visible.value) {\n      element.style.display = 'none';\n      gutter.style.display = 'none';\n      return;\n    }\n    element.style.display = '';\n    gutter.style.display = '';\n    element.style[this.sizeProp] = Math.max(this.minSize, this.size.value) + 'px';\n  }\n\n  disposed() {\n    removeFromParent(this.gutter);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Side panel for displaying/editing layer details.\n */\n\nimport 'neuroglancer/ui/layer_side_panel.css';\n\nimport {LayerManager, ManagedUserLayer, SelectedLayerState, UserLayer} from 'neuroglancer/layer';\nimport {Borrowed, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\nimport {makeCloseButton} from 'neuroglancer/widget/close_button';\nimport {StackView, Tab, TabView} from 'neuroglancer/widget/tab_view';\n\nclass UserLayerInfoPanel extends Tab {\n  tabView = new TabView(this.layer.tabs.addRef(), this.visibility);\n  constructor(public layer: UserLayer) {\n    super();\n    this.element.appendChild(this.tabView.element);\n    this.element.classList.add('neuroglancer-layer-side-panel-info-panel');\n    this.tabView.element.style.flex = '1';\n  }\n}\n\nclass EmptyUserLayerInfoPanel extends Tab {\n  get layer(): null {\n    return null;\n  }\n\n  constructor() {\n    super();\n    this.element.classList.add('neuroglancer-layer-side-panel-info-panel-empty');\n    this.element.textContent =\n        'Information about this layer will be available once it finishes loading.';\n  }\n}\n\nclass ManagedUserLayerInfoPanel extends Tab {\n  element = document.createElement('div');\n  private title = document.createElement('div');\n  private layerName = document.createElement('input');\n  private stack = this.registerDisposer(\n      new StackView<UserLayer|null, UserLayerInfoPanel|EmptyUserLayerInfoPanel>(userLayer => {\n        if (userLayer === null) {\n          return new EmptyUserLayerInfoPanel();\n        } else {\n          return new UserLayerInfoPanel(userLayer);\n        }\n      }, this.visibility));\n\n  constructor(\n      public layer: Borrowed<ManagedUserLayer>, public layerManager: Borrowed<LayerManager>,\n      public collapse: () => void) {\n    super();\n    const {element, title, layerName, stack} = this;\n    element.className = 'neuroglancer-managed-user-layer-info-panel';\n    title.className = 'neuroglancer-layer-side-panel-title';\n    stack.element.classList.add('neuroglancer-layer-side-panel-content-container');\n    element.appendChild(title);\n    element.appendChild(stack.element);\n\n    const collapseButton = makeCloseButton();\n    collapseButton.title = 'Close side panel';\n    collapseButton.addEventListener('click', () => {\n      this.collapse();\n    });\n    title.appendChild(layerName);\n    layerName.spellcheck = false;\n    layerName.title = 'Rename layer';\n    title.appendChild(collapseButton);\n    layerName.addEventListener('change', () => this.handleLayerNameViewChanged());\n    layerName.addEventListener('blur', () => this.handleLayerNameViewChanged());\n    this.registerDisposer(layer.layerChanged.add(() => this.handleLayerNameModelChanged()));\n    this.handleUserLayerChanged();\n    this.handleLayerNameModelChanged();\n  }\n\n  private handleUserLayerChanged() {\n    if (this.stack.selected !== this.layer.layer) {\n      this.stack.invalidateAll();\n      this.stack.selected = this.layer.layer;\n    }\n  }\n\n  private handleLayerNameModelChanged() {\n    this.layerName.value = this.layer.name;\n  }\n\n  private handleLayerNameViewChanged() {\n    const {layer} = this;\n    if (layer !== undefined) {\n      let newName = this.layerName.value;\n      if (newName !== layer.name) {\n        newName = this.layerManager.getUniqueLayerName(newName);\n        this.layerName.value = newName;\n        layer.name = newName;\n        layer.layerChanged.dispatch();\n      }\n    }\n  }\n}\n\nexport class LayerInfoPanelContainer extends RefCounted {\n  element = document.createElement('div');\n  private stack = this.registerDisposer(new StackView<ManagedUserLayer, ManagedUserLayerInfoPanel>(\n      layer =>\n          new ManagedUserLayerInfoPanel(layer, this.state.layerManager, this.collapse.bind(this))));\n  constructor(public state: SelectedLayerState) {\n    super();\n    const {element, stack} = this;\n    element.className = 'neuroglancer-layer-side-panel';\n    stack.element.classList.add('neuroglancer-layer-info-panel-container');\n    element.appendChild(stack.element);\n    this.registerDisposer(state.changed.add(() => this.handleStateChanged()));\n    this.registerDisposer(state.layerManager.layersChanged.add(() => this.handleLayersChanged()));\n    this.handleStateChanged();\n  }\n\n  private handleLayersChanged() {\n    const {layerManager} = this.state;\n    const {stack} = this;\n    for (const layer of stack.tabs.keys()) {\n      if (!layerManager.has(layer)) {\n        stack.invalidate(layer);\n      }\n    }\n  }\n\n  collapse() {\n    const {state} = this;\n    if (state.visible === true) {\n      this.state.visible = false;\n      this.state.changed.dispatch();\n    }\n  }\n\n  private handleStateChanged() {\n    const {state} = this;\n    const {visible} = state;\n    this.element.style.display = visible ? null : 'none';\n    this.stack.visibility.value =\n        visible ? WatchableVisibilityPriority.VISIBLE : WatchableVisibilityPriority.IGNORED;\n    this.stack.selected = state.layer;\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for creating tooltips.\n */\n\nimport './tooltip.css';\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\n\nexport class Tooltip extends RefCounted {\n  element = document.createElement('div');\n  constructor() {\n    super();\n    const {element} = this;\n    element.className = 'neuroglancer-tooltip';\n    element.style.visibility = 'hidden';\n    document.body.appendChild(element);\n  }\n\n  updatePosition(pageX: number, pageY: number) {\n    const {element} = this;\n    element.style.left = pageX + 'px';\n    element.style.top = pageY + 'px';\n    element.style.visibility = 'inherit';\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Facility for showing a tooltip based on the mouse selection state.\n */\n\nimport './mouse_selection_state_tooltip.css';\n\nimport debounce from 'lodash/debounce';\nimport { Annotation, AnnotationType, AxisAlignedBoundingBox, AnnotationReference, getAnnotationTypeHandler} from 'neuroglancer/annotation';\nimport {getSelectedAnnotation} from 'neuroglancer/annotation/selection';\nimport {LayerManager, MouseSelectionState} from 'neuroglancer/layer';\nimport {VoxelSize} from 'neuroglancer/navigation_state';\nimport {getPositionSummary} from 'neuroglancer/ui/annotations';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren} from 'neuroglancer/util/dom';\nimport {mat4} from 'neuroglancer/util/geom';\nimport {formatBoundingBoxVolume} from 'neuroglancer/util/spatial_units';\nimport {Tooltip} from 'neuroglancer/widget/tooltip';\n\nconst annotationTooltipHandlers = new Map<\n    AnnotationType,\n    (annotation: Annotation, element: HTMLElement, transform: mat4, voxelSize: VoxelSize) => void>([\n  [\n    AnnotationType.AXIS_ALIGNED_BOUNDING_BOX,\n    (annotation: AxisAlignedBoundingBox, element, transform, _voxelSize) => {\n      const volume = document.createElement('div');\n      volume.className = 'neuroglancer-annotation-details-volume';\n      volume.textContent = formatBoundingBoxVolume(annotation.pointA, annotation.pointB, transform);\n      element.appendChild(volume);\n    },\n  ],\n]);\n\nconst TOOLTIP_DELAY = 500;\n\nexport class MouseSelectionStateTooltipManager extends RefCounted {\n  private tooltip: Tooltip|undefined = undefined;\n\n  private debouncedShowTooltip =\n    this.registerCancellable(debounce(() => this.doCreateTooltip(), TOOLTIP_DELAY));\n\n  private debouncedShowTooltip0 =\n      this.registerCancellable(debounce(() => this.doCreateTooltip(), 0));\n\n\n  private reference: AnnotationReference|undefined;\n\n  private setReference(reference: AnnotationReference|undefined) {\n    const existing = this.reference;\n    if (existing !== undefined) {\n      existing.changed.remove(this.debouncedShowTooltip0);\n      existing.dispose();\n      this.reference = undefined;\n    }\n    this.reference = reference;\n    if (reference !== undefined) {\n      reference.changed.add(this.debouncedShowTooltip0);\n    }\n  }\n\n  constructor(\n      public mouseState: MouseSelectionState, public layerManager: LayerManager,\n      public voxelSize: VoxelSize) {\n    super();\n    this.registerDisposer(mouseState.changed.add(() => this.mouseStateChanged()));\n  }\n\n  private maybeCreateTooltip() {\n    const state = getSelectedAnnotation(this.mouseState, this.layerManager);\n    if (state === undefined) {\n      return false;\n    }\n    if (!this.voxelSize.valid) {\n      return false;\n    }\n    let {tooltip} = this;\n    if (tooltip === undefined) {\n      tooltip = this.tooltip = new Tooltip();\n      tooltip.element.classList.add('neuroglancer-mouse-selection-tooltip');\n    }\n\n    const reference = state.annotationLayer.source.getReference(state.id);\n    this.setReference(reference);\n    if (reference.value === null) {\n      return false;\n    }\n\n    removeChildren(tooltip.element);\n    const header = document.createElement('div');\n    header.className = 'neuroglancer-mouse-selection-tooltip-title';\n    header.textContent = `${state.layer.name}`;\n\n    const description = document.createElement('div');\n    description.className = 'neuroglancer-mouse-selection-tooltip-description';\n\n    const annotation = reference.value;\n\n    if (annotation === undefined) {\n      description.textContent = 'Loading...';\n    } else {\n      description.textContent = annotation.description || '';\n    }\n\n    tooltip.element.appendChild(header);\n    tooltip.element.appendChild(description);\n\n    if (annotation != null) {\n      const {segments} = annotation;\n      if (segments !== undefined && segments.length > 0) {\n        const segmentContainer = document.createElement('div');\n        segmentContainer.className = 'neuroglancer-annotation-segment-list';\n\n        const segmentationState = state.annotationLayer.segmentationState.value;\n        const segmentColorHash = segmentationState ? segmentationState.segmentColorHash : undefined;\n        segments.forEach((segment, index) => {\n          if (index !== 0) {\n            segmentContainer.appendChild(document.createTextNode(' '));\n          }\n          const child = document.createElement('span');\n          child.className = 'neuroglancer-annotation-segment-item';\n          child.textContent = segment.toString();\n          if (segmentColorHash !== undefined) {\n            child.style.backgroundColor = segmentColorHash!.computeCssColor(segment);\n          }\n          segmentContainer.appendChild(child);\n        });\n        tooltip.element.appendChild(segmentContainer);\n      }\n      const combinedTransform = state.annotationLayer.objectToGlobal;\n\n      const typeHandler = getAnnotationTypeHandler(annotation.type);\n\n      const positionElement = document.createElement('div');\n      positionElement.appendChild(document.createTextNode(typeHandler.icon));\n      getPositionSummary(positionElement, annotation, combinedTransform, this.voxelSize);\n      positionElement.className = 'neuroglancer-mouse-selection-tooltip-annotation-corners';\n      tooltip.element.appendChild(positionElement);\n\n      const handler = annotationTooltipHandlers.get(annotation.type);\n      if (handler !== undefined) {\n        handler(annotation, tooltip.element, combinedTransform, this.voxelSize);\n      }\n    }\n    return true;\n  }\n\n  private mouseStateChanged() {\n    const {tooltip} = this;\n    if (tooltip !== undefined) {\n      tooltip.dispose();\n      this.tooltip = undefined;\n    }\n    this.setReference(undefined);\n    this.debouncedShowTooltip();\n  }\n\n  private doCreateTooltip = (() => {\n    this.debouncedShowTooltip.cancel();\n    this.debouncedShowTooltip0.cancel();\n    const {mouseState} = this;\n    if (!this.maybeCreateTooltip()) {\n      const {tooltip} = this;\n      if (tooltip !== undefined) {\n        tooltip.dispose();\n        this.tooltip = undefined;\n      }\n      this.setReference(undefined);\n      return;\n    } else {\n      const tooltip = this.tooltip!;\n      tooltip.updatePosition(mouseState.pageX, mouseState.pageY);\n    }\n  });\n\n  disposed() {\n    const {tooltip} = this;\n    if (tooltip !== undefined) {\n      tooltip.dispose();\n      this.tooltip = undefined;\n    }\n    this.setReference(undefined);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for editing Neuroglancer state as JSON directly within browser.\n */\n\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/mode/javascript/javascript';\nimport 'codemirror/addon/fold/foldcode';\nimport 'codemirror/addon/fold/foldgutter';\nimport 'codemirror/addon/fold/brace-fold';\nimport 'codemirror/addon/fold/foldgutter.css';\nimport 'codemirror/addon/lint/lint.css';\nimport './state_editor.css';\n\nimport CodeMirror from 'codemirror';\nimport debounce from 'lodash/debounce';\nimport {Overlay} from 'neuroglancer/overlay';\nimport {getCachedJson} from 'neuroglancer/util/trackable';\nimport {Viewer} from 'neuroglancer/viewer';\n\nconst valueUpdateDelay = 100;\n\nexport class StateEditorDialog extends Overlay {\n  textEditor: CodeMirror.Editor;\n  applyButton: HTMLButtonElement;\n  constructor(public viewer: Viewer) {\n    super();\n\n    this.content.classList.add('neuroglancer-state-editor');\n\n    const button = this.applyButton = document.createElement('button');\n    button.textContent = 'Apply changes';\n    this.content.appendChild(button);\n    button.addEventListener('click', () => this.applyChanges());\n    button.disabled = true;\n\n    this.textEditor = CodeMirror(_element => {}, <any>{\n      value: '',\n      mode: {'name': 'javascript', json: true},\n      foldGutter: true,\n      gutters: [\n        'CodeMirror-lint-markers',\n        'CodeMirror-foldgutter',\n      ],\n    });\n    this.updateView();\n\n    this.textEditor.on('change', () => {\n      this.debouncedValueUpdater();\n    });\n\n    this.content.appendChild(this.textEditor.getWrapperElement());\n    this.textEditor.refresh();\n  }\n\n  private applyChanges() {\n    if (this.parsedValue !== null) {\n      this.viewer.state.reset();\n      this.viewer.state.restoreState(this.parsedValue);\n    }\n    this.applyButton.disabled = true;\n  }\n\n  private updateView() {\n    this.textEditor.setValue(this.getJson());\n    (<any>this.textEditor).execCommand('foldAll');\n    (<any>this.textEditor).execCommand('unfold');\n  }\n\n  parsedValue: any = null;\n\n  debouncedValueUpdater = debounce(() => {\n    const value = this.textEditor.getValue();\n    try {\n      const json = JSON.parse(value);\n      this.parsedValue = json;\n      this.applyButton.disabled = false;\n      this.textEditor.setOption('lint', undefined);\n    } catch (parseError) {\n      this.parsedValue = null;\n      this.applyButton.disabled = true;\n      let line = 0, column = 0, message = 'Unknown parse error';\n      if (parseError instanceof Error) {\n        const m = parseError.message.match(/^((?:.|\\n)*) in JSON at position ([0-9]+)$/);\n        if (m !== null) {\n          message = m[1];\n          const offset = parseInt(m[2], 10);\n          const prefix = value.substring(0, offset);\n          const lines = prefix.split('\\n');\n          line = lines.length - 1;\n          column = lines[lines.length - 1].length;\n        } else {\n          message = parseError.message;\n        }\n      }\n      this.textEditor.setOption('lint', {\n        getAnnotations: () => {\n          return [{\n            message,\n            severity: 'error',\n            from: CodeMirror.Pos(line, column),\n          }];\n        },\n      });\n    }\n  }, valueUpdateDelay);\n\n  getJson() {\n    return JSON.stringify(getCachedJson(this.viewer.state).value, null, '  ');\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/ui/statistics.css';\n\nimport debounce from 'lodash/debounce';\nimport {ChunkDownloadStatistics, ChunkMemoryStatistics, ChunkPriorityTier, ChunkState, getChunkDownloadStatisticIndex, getChunkStateStatisticIndex, numChunkMemoryStatistics, numChunkStates, REQUEST_CHUNK_STATISTICS_RPC_ID} from 'neuroglancer/chunk_manager/base';\nimport {ChunkQueueManager, ChunkSource} from 'neuroglancer/chunk_manager/frontend';\nimport {TrackableBoolean} from 'neuroglancer/trackable_boolean';\nimport {TrackableValue, WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {Borrowed, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren, removeFromParent} from 'neuroglancer/util/dom';\nimport {verifyPositiveInt} from 'neuroglancer/util/json';\nimport {CompoundTrackable, Trackable} from 'neuroglancer/util/trackable';\n\nexport class StatisticsDisplayState implements Trackable {\n  private tracker = new CompoundTrackable();\n  get changed() {\n    return this.tracker.changed;\n  }\n  visible = new TrackableBoolean(false);\n  size = new TrackableValue<number>(100, verifyPositiveInt);\n  sortBy?: WatchableValueInterface<string>;\n  constructor() {\n    this.tracker.add('visible', this.visible);\n    this.tracker.add('size', this.size);\n  }\n\n  restoreState(obj: any) {\n    this.tracker.restoreState(obj);\n  }\n\n  reset() {\n    this.tracker.reset();\n  }\n\n  toJSON() {\n    const obj = this.tracker.toJSON();\n    for (const k of Object.keys(obj)) {\n      if (obj[k as keyof typeof obj] !== undefined) return obj;\n    }\n    return undefined;\n  }\n}\n\nfunction getProperties(obj: any): Map<string, string> {\n  const map = new Map<string, string>();\n  function handleObject(o: any, prefix: string) {\n    if (typeof o !== 'object') {\n      map.set(prefix, '' + o);\n      return;\n    }\n    for (const key of Object.keys(o)) {\n      handleObject(o[key], prefix + '.' + key);\n    }\n  }\n  handleObject(obj, '');\n  return map;\n}\n\nfunction getDistinguishingProperties(properties: Map<string,string>[]): string[] {\n  const selected = new Set<string>();\n  selected.add('.type');\n  const allProps = new Set<string>();\n  function areDistinguished(i: number, j: number) {\n    for (const prop of selected) {\n      if (properties[i].get(prop) !== properties[j].get(prop)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  for (let i = 0, n = properties.length; i < n; ++i) {\n    for (const prop of properties[i].keys()) {\n      allProps.add(prop);\n    }\n    let matches: number[] = [];\n    for (let j = 0; j < i; ++j) {\n      if (!areDistinguished(i, j)) {\n        matches.push(j);\n      }\n    }\n    while (matches.length > 0) {\n      let bestReducedMatches: number[] = matches;\n      let bestProp: string|undefined = undefined;\n      for (const prop of allProps) {\n        if (selected.has(prop)) continue;\n        const reducedMatches: number[] = [];\n        for (const j of matches) {\n          if (properties[j].get(prop) === properties[i].get(prop)) {\n            reducedMatches.push(j);\n          }\n        }\n        if (reducedMatches.length < bestReducedMatches.length) {\n          bestReducedMatches = reducedMatches;\n          bestProp = prop;\n        }\n        if (reducedMatches.length === 0) break;\n      }\n      // Prevent infinite loop if there are no distinguishing properties.\n      if (bestProp === undefined) break;\n      matches = bestReducedMatches;\n      selected.add(bestProp);\n    }\n  }\n  return Array.from(selected);\n}\n\nfunction getNameFromProps(properties: Map<string,string>, selected: string[]) {\n  const result: any = {};\n  for (const prop of selected) {\n    const value = properties.get(prop);\n    if (value === undefined) continue;\n    if (prop === '') return value;\n    result[prop] = value;\n  }\n  return JSON.stringify(result);\n}\n\nfunction getFormattedNames(objects: any[]) {\n  const properties = objects.map(getProperties);\n  const selectedProps = getDistinguishingProperties(properties);\n  return properties.map(p => getNameFromProps(p, selectedProps));\n}\n\ntype ChunkStatistics = Map<number, Float64Array>;\n\n/**\n * Interval in ms at which to request new statistics from the backend thread.\n */\nconst requestDataInterval = 1000;\n\nexport class StatisticsPanel extends RefCounted {\n  element = document.createElement('div');\n  columns = new Map<string, (statistics: Float64Array) => number>();\n  data: ChunkStatistics|undefined = undefined;\n  private requestDataTimerId = -1;\n  private dataRequested = false;\n  constructor(\n      public chunkQueueManager: Borrowed<ChunkQueueManager>,\n      public displayState: StatisticsDisplayState) {\n    super();\n\n    const {element} = this;\n    element.className = 'neuroglancer-statistics-panel';\n\n    this.registerDisposer(this.displayState.changed.add(this.debouncedUpdateView));\n    this.registerDisposer(this.displayState.visible.changed.add(() => this.requestData()));\n    this.requestData();\n\n    const {columns} = this;\n    // Total number of visible-priority chunks\n    //    number in downloading state\n    //    number in other system memory state\n    //    number in gpu memory state\n    //    number in failed state\n    columns.set('Visible chunks/T', (statistics) => {\n      let sum = 0;\n      for (let state: ChunkState = 0; state < numChunkStates; ++state) {\n        sum += statistics[getChunkStateStatisticIndex(state, ChunkPriorityTier.VISIBLE) *\n                          numChunkMemoryStatistics + ChunkMemoryStatistics.numChunks];\n      }\n      return sum;\n    });\n\n    columns.set('Visible chunks/D', (statistics) => {\n      return (statistics\n                  [getChunkStateStatisticIndex(ChunkState.DOWNLOADING, ChunkPriorityTier.VISIBLE) *\n                       numChunkMemoryStatistics +\n                   ChunkMemoryStatistics.numChunks]);\n    });\n\n    columns.set('Visible chunks/M', (statistics) => {\n      return (\n          statistics\n              [getChunkStateStatisticIndex(ChunkState.SYSTEM_MEMORY, ChunkPriorityTier.VISIBLE) *\n                   numChunkMemoryStatistics +\n               ChunkMemoryStatistics.numChunks] +\n          statistics\n              [getChunkStateStatisticIndex(\n                   ChunkState.SYSTEM_MEMORY_WORKER, ChunkPriorityTier.VISIBLE) *\n                   numChunkMemoryStatistics +\n               ChunkMemoryStatistics.numChunks]);\n    });\n\n    columns.set('Visible chunks/G', (statistics) => {\n      return statistics[getChunkStateStatisticIndex(ChunkState.GPU_MEMORY, ChunkPriorityTier.VISIBLE) *\n                   numChunkMemoryStatistics +\n               ChunkMemoryStatistics.numChunks];\n    });\n\n    columns.set('Visible chunks/F', (statistics) => {\n      return statistics[getChunkStateStatisticIndex(ChunkState.FAILED, ChunkPriorityTier.VISIBLE) *\n                   numChunkMemoryStatistics +\n               ChunkMemoryStatistics.numChunks];\n    });\n\n    columns.set('Visible memory', (statistics) => {\n      return statistics[getChunkStateStatisticIndex(ChunkState.GPU_MEMORY, ChunkPriorityTier.VISIBLE) *\n                   numChunkMemoryStatistics +\n               ChunkMemoryStatistics.gpuMemoryBytes];\n    });\n\n    columns.set('Download latency', (statistics) => {\n      return statistics[getChunkDownloadStatisticIndex(ChunkDownloadStatistics.totalTime)] /\n          statistics[getChunkDownloadStatisticIndex(ChunkDownloadStatistics.totalChunks)];\n    });\n  }\n\n  disposed() {\n    clearTimeout(this.requestDataTimerId);\n    removeFromParent(this.element);\n    super.disposed();\n  }\n\n  private requestData() {\n    if (!this.displayState.visible) return;\n    if (this.dataRequested) return;\n    const {chunkQueueManager} = this;\n    const rpc = chunkQueueManager.rpc!;\n    this.dataRequested = true;\n    rpc.promiseInvoke<ChunkStatistics>(\n           REQUEST_CHUNK_STATISTICS_RPC_ID, {queue: chunkQueueManager.rpcId})\n        .then(data => {\n          this.dataRequested = false;\n          this.data = data;\n          this.debouncedUpdateView();\n          this.requestDataTimerId = setTimeout(() => {\n            this.requestDataTimerId = -1;\n            this.requestData();\n          }, requestDataInterval);\n        });\n  }\n\n  private debouncedUpdateView = this.registerCancellable(debounce(() => this.updateView(), 0));\n\n  private updateView() {\n    if (!this.displayState.visible.value) return;\n    const {data} = this;\n    if (data === undefined) return;\n    const {columns} = this;\n    const rpc = this.chunkQueueManager.rpc!;\n    const table = document.createElement('table');\n    const rows: [ChunkSource, ...number[]][] = [];\n    for (const [id, statistics] of data) {\n      const source = rpc.get(id) as ChunkSource | undefined;\n      if (source === undefined) continue;\n      const row: [ChunkSource, ...number[]] = [source];\n      for (const column of columns.values()) {\n        row.push(column(statistics));\n      }\n      rows.push(row);\n    }\n\n    const formattedNames =\n        getFormattedNames(rows.map(x => Object.assign({type: x[0].RPC_TYPE_ID}, x[0].key || {})));\n    const sourceFormattedNames = new Map<ChunkSource, string>();\n    formattedNames.forEach((name, i) => {\n      sourceFormattedNames.set(rows[i][0], name);\n    });\n\n    {\n      const thead = document.createElement('thead');\n      let tr = document.createElement('tr');\n      thead.appendChild(tr);\n      const addHeaderColumn = (label: string) => {\n        const td = document.createElement('td');\n        td.textContent = label;\n        tr.appendChild(td);\n      };\n      addHeaderColumn('Name');\n      let prevPrefix: string|undefined = undefined;\n      for (const column of columns.keys()) {\n        const sepIndex = column.indexOf('/');\n        let prefix = column;\n        if (sepIndex !== -1) {\n          prefix = column.substring(0, sepIndex);\n          if (prefix === prevPrefix) {\n            ++(tr.lastElementChild! as HTMLTableCellElement).colSpan;\n            continue;\n          }\n          prevPrefix = prefix;\n        }\n        addHeaderColumn(prefix);\n      }\n      tr = document.createElement('tr');\n      thead.appendChild(tr);\n      {\n        const td = document.createElement('td');\n        tr.appendChild(td);\n      }\n      for (const column of columns.keys()) {\n        const sepIndex = column.indexOf('/');\n        let suffix = '';\n        if (sepIndex !== -1) {\n          suffix = column.substring(sepIndex+1);\n        }\n        const td = document.createElement('td');\n        td.textContent = suffix;\n        tr.appendChild(td);\n      }\n      table.appendChild(thead);\n    }\n    const tbody = document.createElement('tbody');\n    // TODO: sort rows\n    for (const [source, ...values] of rows) {\n      const tr = document.createElement('tr');\n      const addColumn = (label: string) => {\n        const td = document.createElement('td');\n        td.textContent = label;\n        tr.appendChild(td);\n      };\n      addColumn(sourceFormattedNames.get(source)!);\n      for (const value of values) {\n        addColumn('' + value);\n      }\n      tbody.appendChild(tr);\n    }\n    table.appendChild(tbody);\n    removeChildren(this.element);\n    this.element.appendChild(table);\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './annotation_tool_status.css';\n\nimport {SelectedLayerState} from 'neuroglancer/layer';\nimport {RefCounted} from 'neuroglancer/util/disposable';\n\nexport class AnnotationToolStatusWidget extends RefCounted {\n  element = document.createElement('div');\n  private unbindPreviousLayer: (() => void)|undefined;\n\n  constructor(public selectedLayer: SelectedLayerState) {\n    super();\n    const {element} = this;\n    element.className = 'neuroglancer-annotation-tool-status-widget';\n    this.registerDisposer(selectedLayer.changed.add(() => this.selectedLayerChanged()));\n    this.selectedLayerChanged();\n  }\n\n  private selectedLayerChanged() {\n    let {unbindPreviousLayer} = this;\n    if (unbindPreviousLayer !== undefined) {\n      unbindPreviousLayer();\n    }\n    const layer = this.selectedLayer.layer;\n    if (layer !== undefined) {\n      this.unbindPreviousLayer = layer.specificationChanged.add(() => {\n        this.updateView();\n      });\n    }\n    this.updateView();\n  }\n\n  disposed() {\n    const {unbindPreviousLayer} = this;\n    if (unbindPreviousLayer !== undefined) {\n      unbindPreviousLayer();\n    }\n    this.unbindPreviousLayer = undefined;\n  }\n\n  private getDescriptionText(): string|undefined {\n    const layer = this.selectedLayer.layer;\n    if (layer === undefined) {\n      return undefined;\n    }\n    const userLayer = layer.layer;\n    if (userLayer === null) {\n      return undefined;\n    }\n    const tool = userLayer.tool.value;\n    if (tool === undefined) {\n      return undefined;\n    }\n    return tool.description;\n  }\n\n  private updateView() {\n    this.element.textContent = this.getDescriptionText() || '';\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableValue, WatchableValue} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\n\nexport class NumberInputWidget extends RefCounted {\n  element = document.createElement('label');\n  inputElement = document.createElement('input');\n  validator: (x: number) => number;\n  constructor(public model: WatchableValue<number>, options: {\n    validator?: (x: number) => number,\n    label?: string\n  } = {}) {\n    super();\n    let {validator, label} = options;\n    const {element, inputElement} = this;\n    if (validator === undefined) {\n      if (model instanceof TrackableValue) {\n        validator = model.validator;\n      } else {\n        validator = x => x;\n      }\n    }\n    this.validator = validator;\n    if (label !== undefined) {\n      element.textContent = label;\n    }\n    element.appendChild(inputElement);\n    element.className = 'neuroglancer-number-input';\n    inputElement.type = 'input';\n    this.registerDisposer(this.model.changed.add(() => this.updateView()));\n    this.registerEventListener(inputElement, 'change', () => this.updateModel());\n    this.updateView();\n  }\n\n  private updateView() {\n    this.inputElement.value = '' + this.model.value;\n  }\n\n  private updateModel() {\n    let value = parseFloat(this.inputElement.value.trim());\n    if (Number.isNaN(value)) {\n      this.updateView();\n      return;\n    }\n    try {\n      value = this.validator(value);\n      this.model.value = value;\n    } catch {\n      this.updateView();\n    }\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {CapacitySpecification, ChunkManager, ChunkQueueManager, FrameNumberCounter} from 'neuroglancer/chunk_manager/frontend';\nimport {defaultCredentialsManager} from 'neuroglancer/credentials_provider/default_manager';\nimport {InputEventBindings as DataPanelInputEventBindings} from 'neuroglancer/data_panel_layout';\nimport {DataSourceProvider} from 'neuroglancer/datasource';\nimport {getDefaultDataSourceProvider} from 'neuroglancer/datasource/default_provider';\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {InputEventBindingHelpDialog} from 'neuroglancer/help/input_event_bindings';\nimport {allRenderLayerRoles, LayerManager, LayerSelectedValues, MouseSelectionState, RenderLayerRole, SelectedLayerState} from 'neuroglancer/layer';\nimport {LayerDialog} from 'neuroglancer/layer_dialog';\nimport {RootLayoutContainer} from 'neuroglancer/layer_groups_layout';\nimport {TopLevelLayerListSpecification} from 'neuroglancer/layer_specification';\nimport {NavigationState, Pose} from 'neuroglancer/navigation_state';\nimport {overlaysOpen} from 'neuroglancer/overlay';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {ElementVisibilityFromTrackableBoolean, TrackableBoolean, TrackableBooleanCheckbox} from 'neuroglancer/trackable_boolean';\nimport {makeDerivedWatchableValue, TrackableValue, WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {ContextMenu} from 'neuroglancer/ui/context_menu';\nimport {DragResizablePanel} from 'neuroglancer/ui/drag_resize';\nimport {LayerInfoPanelContainer} from 'neuroglancer/ui/layer_side_panel';\nimport {MouseSelectionStateTooltipManager} from 'neuroglancer/ui/mouse_selection_state_tooltip';\nimport {setupPositionDropHandlers} from 'neuroglancer/ui/position_drag_and_drop';\nimport {StateEditorDialog} from 'neuroglancer/ui/state_editor';\nimport {StatisticsDisplayState, StatisticsPanel} from 'neuroglancer/ui/statistics';\nimport {AutomaticallyFocusedElement} from 'neuroglancer/util/automatic_focus';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {EventActionMap, KeyboardEventBinder} from 'neuroglancer/util/keyboard_bindings';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {CompoundTrackable} from 'neuroglancer/util/trackable';\nimport {ViewerState, VisibilityPrioritySpecification} from 'neuroglancer/viewer_state';\nimport {WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {AnnotationToolStatusWidget} from 'neuroglancer/widget/annotation_tool_status';\nimport {NumberInputWidget} from 'neuroglancer/widget/number_input_widget';\nimport {MousePositionWidget, PositionWidget, VoxelSizeWidget} from 'neuroglancer/widget/position_widget';\nimport {TrackableScaleBarOptions} from 'neuroglancer/widget/scale_bar';\nimport {makeTextIconButton} from 'neuroglancer/widget/text_icon_button';\nimport {RPC} from 'neuroglancer/worker_rpc';\n\ndeclare var NEUROGLANCER_OVERRIDE_DEFAULT_VIEWER_OPTIONS: any\n\nrequire('./viewer.css');\nrequire('neuroglancer/noselect.css');\nrequire('neuroglancer/ui/button.css');\n\nexport class DataManagementContext extends RefCounted {\n  worker = new Worker('chunk_worker.bundle.js');\n  chunkQueueManager = this.registerDisposer(\n      new ChunkQueueManager(new RPC(this.worker), this.gl, this.frameNumberCounter, {\n        gpuMemory: new CapacitySpecification({defaultItemLimit: 1e6, defaultSizeLimit: 1e9}),\n        systemMemory: new CapacitySpecification({defaultItemLimit: 1e7, defaultSizeLimit: 2e9}),\n        download: new CapacitySpecification(\n            {defaultItemLimit: 32, defaultSizeLimit: Number.POSITIVE_INFINITY}),\n        compute: new CapacitySpecification({defaultItemLimit: 128, defaultSizeLimit: 5e8}),\n      }));\n  chunkManager = this.registerDisposer(new ChunkManager(this.chunkQueueManager));\n\n  get rpc(): RPC {\n    return this.chunkQueueManager.rpc!;\n  }\n\n  constructor(public gl: GL, public frameNumberCounter: FrameNumberCounter) {\n    super();\n    this.chunkQueueManager.registerDisposer(() => this.worker.terminate());\n  }\n}\n\nexport class InputEventBindings extends DataPanelInputEventBindings {\n  global = new EventActionMap();\n}\n\nconst viewerUiControlOptionKeys: (keyof ViewerUIControlConfiguration)[] = [\n  'showHelpButton',\n  'showEditStateButton',\n  'showLayerPanel',\n  'showLocation',\n  'showAnnotationToolStatus',\n];\n\nconst viewerOptionKeys: (keyof ViewerUIOptions)[] =\n    ['showUIControls', 'showPanelBorders', ...viewerUiControlOptionKeys];\n\nexport class ViewerUIControlConfiguration {\n  showHelpButton = new TrackableBoolean(true);\n  showEditStateButton = new TrackableBoolean(true);\n  showLayerPanel = new TrackableBoolean(true);\n  showLocation = new TrackableBoolean(true);\n  showAnnotationToolStatus = new TrackableBoolean(true);\n}\n\nexport class ViewerUIConfiguration extends ViewerUIControlConfiguration {\n  /**\n   * If set to false, all UI controls (controlled individually by the options below) are disabled.\n   */\n  showUIControls = new TrackableBoolean(true);\n  showPanelBorders = new TrackableBoolean(true);\n}\n\nfunction setViewerUiConfiguration(\n    config: ViewerUIConfiguration, options: Partial<ViewerUIOptions>) {\n  for (const key of viewerOptionKeys) {\n    const value = options[key];\n    if (value !== undefined) {\n      config[key].value = value;\n    }\n  }\n}\n\ninterface ViewerUIOptions {\n  showUIControls: boolean;\n  showHelpButton: boolean;\n  showEditStateButton: boolean;\n  showLayerPanel: boolean;\n  showLocation: boolean;\n  showPanelBorders: boolean;\n  showAnnotationToolStatus: boolean;\n}\n\nexport interface ViewerOptions extends ViewerUIOptions, VisibilityPrioritySpecification {\n  dataContext: Owned<DataManagementContext>;\n  element: HTMLElement;\n  dataSourceProvider: Borrowed<DataSourceProvider>;\n  uiConfiguration: ViewerUIConfiguration;\n  showLayerDialog: boolean;\n  inputEventBindings: InputEventBindings;\n  resetStateWhenEmpty: boolean;\n}\n\nconst defaultViewerOptions = \"undefined\" !== typeof NEUROGLANCER_OVERRIDE_DEFAULT_VIEWER_OPTIONS ?\n  NEUROGLANCER_OVERRIDE_DEFAULT_VIEWER_OPTIONS : {\n    showLayerDialog: true,\n    resetStateWhenEmpty: true,\n  };\n\nfunction makeViewerContextMenu(viewer: Viewer) {\n  const menu = new ContextMenu();\n  const {element} = menu;\n  element.classList.add('neuroglancer-viewer-context-menu');\n  const addLimitWidget = (label: string, limit: TrackableValue<number>) => {\n    const widget = menu.registerDisposer(new NumberInputWidget(limit, {label}));\n    widget.element.classList.add('neuroglancer-viewer-context-menu-limit-widget');\n    element.appendChild(widget.element);\n  };\n  addLimitWidget('GPU memory limit', viewer.chunkQueueManager.capacities.gpuMemory.sizeLimit);\n  addLimitWidget('System memory limit', viewer.chunkQueueManager.capacities.systemMemory.sizeLimit);\n  addLimitWidget(\n      'Concurrent chunk requests', viewer.chunkQueueManager.capacities.download.itemLimit);\n\n  const addCheckbox = (label: string, value: TrackableBoolean) => {\n    const labelElement = document.createElement('label');\n    labelElement.textContent = label;\n    const checkbox = menu.registerDisposer(new TrackableBooleanCheckbox(value));\n    labelElement.appendChild(checkbox.element);\n    element.appendChild(labelElement);\n  };\n  addCheckbox('Show axis lines', viewer.showAxisLines);\n  addCheckbox('Show scale bar', viewer.showScaleBar);\n  addCheckbox('Show cross sections in 3-d', viewer.showPerspectiveSliceViews);\n  addCheckbox('Show default annotations', viewer.showDefaultAnnotations);\n  addCheckbox('Show chunk statistics', viewer.statisticsDisplayState.visible);\n  return menu;\n}\n\nexport class Viewer extends RefCounted implements ViewerState {\n  navigationState = this.registerDisposer(new NavigationState());\n  perspectiveNavigationState = new NavigationState(new Pose(this.navigationState.position), 1);\n  mouseState = new MouseSelectionState();\n  layerManager = this.registerDisposer(new LayerManager());\n  selectedLayer = this.registerDisposer(new SelectedLayerState(this.layerManager.addRef()));\n  showAxisLines = new TrackableBoolean(true, true);\n  showScaleBar = new TrackableBoolean(true, true);\n  showPerspectiveSliceViews = new TrackableBoolean(true, true);\n  visibleLayerRoles = allRenderLayerRoles();\n  showDefaultAnnotations = new TrackableBoolean(true, true);\n  crossSectionBackgroundColor = new TrackableRGB(vec3.fromValues(0.5, 0.5, 0.5));\n  perspectiveViewBackgroundColor = new TrackableRGB(vec3.fromValues(0, 0, 0));\n  scaleBarOptions = new TrackableScaleBarOptions();\n  contextMenu: ContextMenu;\n  statisticsDisplayState = new StatisticsDisplayState();\n\n  layerSelectedValues =\n      this.registerDisposer(new LayerSelectedValues(this.layerManager, this.mouseState));\n  resetInitiated = new NullarySignal();\n\n  get chunkManager() {\n    return this.dataContext.chunkManager;\n  }\n  get chunkQueueManager() {\n    return this.dataContext.chunkQueueManager;\n  }\n\n  layerSpecification: TopLevelLayerListSpecification;\n  layout: RootLayoutContainer;\n\n  state = new CompoundTrackable();\n\n  dataContext: Owned<DataManagementContext>;\n  visibility: WatchableVisibilityPriority;\n  inputEventBindings: InputEventBindings;\n  element: HTMLElement;\n  dataSourceProvider: Borrowed<DataSourceProvider>;\n\n  uiConfiguration: ViewerUIConfiguration;\n\n  private makeUiControlVisibilityState(key: keyof ViewerUIOptions) {\n    const showUIControls = this.uiConfiguration.showUIControls;\n    const option = this.uiConfiguration[key];\n    return this.registerDisposer(\n        makeDerivedWatchableValue((a, b) => a && b, showUIControls, option));\n  }\n\n  /**\n   * Logical and of each of the above values with the value of showUIControls.\n   */\n  uiControlVisibility:\n      {[key in keyof ViewerUIControlConfiguration]: WatchableValueInterface<boolean>} = <any>{};\n\n  showLayerDialog: boolean;\n  resetStateWhenEmpty: boolean;\n\n  get inputEventMap() {\n    return this.inputEventBindings.global;\n  }\n\n  visible = true;\n\n  constructor(public display: DisplayContext, options: Partial<ViewerOptions> = {}) {\n    super();\n\n    const {\n      dataContext = new DataManagementContext(display.gl, display),\n      visibility = new WatchableVisibilityPriority(WatchableVisibilityPriority.VISIBLE),\n      inputEventBindings = {\n        global: new EventActionMap(),\n        sliceView: new EventActionMap(),\n        perspectiveView: new EventActionMap(),\n      },\n      element = display.makeCanvasOverlayElement(),\n      dataSourceProvider =\n          getDefaultDataSourceProvider({credentialsManager: defaultCredentialsManager}),\n      uiConfiguration = new ViewerUIConfiguration(),\n    } = options;\n    this.visibility = visibility;\n    this.inputEventBindings = inputEventBindings;\n    this.element = element;\n    this.dataSourceProvider = dataSourceProvider;\n    this.uiConfiguration = uiConfiguration;\n\n    this.registerDisposer(() => removeFromParent(this.element));\n\n    this.dataContext = this.registerDisposer(dataContext);\n\n    setViewerUiConfiguration(uiConfiguration, options);\n\n    const optionsWithDefaults = {...defaultViewerOptions, ...options};\n    const {\n      resetStateWhenEmpty,\n      showLayerDialog,\n    } = optionsWithDefaults;\n\n    for (const key of viewerUiControlOptionKeys) {\n      this.uiControlVisibility[key] = this.makeUiControlVisibilityState(key);\n    }\n    this.registerDisposer(this.uiConfiguration.showPanelBorders.changed.add(() => {\n      this.updateShowBorders();\n    }));\n\n    this.showLayerDialog = showLayerDialog;\n    this.resetStateWhenEmpty = resetStateWhenEmpty;\n\n    this.layerSpecification = new TopLevelLayerListSpecification(\n        this.dataSourceProvider, this.layerManager, this.chunkManager, this.layerSelectedValues,\n        this.navigationState.voxelSize);\n\n    this.registerDisposer(display.updateStarted.add(() => {\n      this.onUpdateDisplay();\n    }));\n\n    this.showDefaultAnnotations.changed.add(() => {\n      if (this.showDefaultAnnotations.value) {\n        this.visibleLayerRoles.add(RenderLayerRole.DEFAULT_ANNOTATION);\n      } else {\n        this.visibleLayerRoles.delete(RenderLayerRole.DEFAULT_ANNOTATION);\n      }\n    });\n\n    const {state} = this;\n    state.add('layers', this.layerSpecification);\n    state.add('navigation', this.navigationState);\n    state.add('showAxisLines', this.showAxisLines);\n    state.add('showScaleBar', this.showScaleBar);\n    state.add('showDefaultAnnotations', this.showDefaultAnnotations);\n\n    state.add('perspectiveOrientation', this.perspectiveNavigationState.pose.orientation);\n    state.add('perspectiveZoom', this.perspectiveNavigationState.zoomFactor);\n    state.add('showSlices', this.showPerspectiveSliceViews);\n    state.add('gpuMemoryLimit', this.dataContext.chunkQueueManager.capacities.gpuMemory.sizeLimit);\n    state.add(\n        'systemMemoryLimit', this.dataContext.chunkQueueManager.capacities.systemMemory.sizeLimit);\n    state.add(\n        'concurrentDownloads', this.dataContext.chunkQueueManager.capacities.download.itemLimit);\n    state.add('selectedLayer', this.selectedLayer);\n    state.add('crossSectionBackgroundColor', this.crossSectionBackgroundColor);\n    state.add('perspectiveViewBackgroundColor', this.perspectiveViewBackgroundColor);\n\n    this.registerDisposer(this.navigationState.changed.add(() => {\n      this.handleNavigationStateChanged();\n    }));\n\n    this.layerManager.initializePosition(this.navigationState.position);\n\n    this.registerDisposer(\n        this.layerSpecification.voxelCoordinatesSet.add((voxelCoordinates: vec3) => {\n          this.navigationState.position.setVoxelCoordinates(voxelCoordinates);\n        }));\n\n    this.registerDisposer(\n        this.layerSpecification.spatialCoordinatesSet.add((spatialCoordinates: vec3) => {\n          const {position} = this.navigationState;\n          vec3.copy(position.spatialCoordinates, spatialCoordinates);\n          position.markSpatialCoordinatesChanged();\n        }));\n\n\n    // Debounce this call to ensure that a transient state does not result in the layer dialog being\n    // shown.\n    const maybeResetState = this.registerCancellable(debounce(() => {\n      if (!this.wasDisposed && this.layerManager.managedLayers.length === 0 &&\n          this.resetStateWhenEmpty) {\n        // No layers, reset state.\n        this.navigationState.reset();\n        this.perspectiveNavigationState.pose.orientation.reset();\n        this.perspectiveNavigationState.zoomFactor.reset();\n        this.resetInitiated.dispatch();\n        if (!overlaysOpen && this.showLayerDialog && this.visibility.visible) {\n          new LayerDialog(this.layerSpecification);\n        }\n      }\n    }));\n    this.layerManager.layersChanged.add(maybeResetState);\n    maybeResetState();\n\n    this.registerDisposer(this.dataContext.chunkQueueManager.visibleChunksChanged.add(() => {\n      this.layerSelectedValues.handleLayerChange();\n    }));\n\n    this.registerDisposer(this.dataContext.chunkQueueManager.visibleChunksChanged.add(() => {\n      if (this.visible) {\n        display.scheduleRedraw();\n      }\n    }));\n\n    this.makeUI();\n    this.updateShowBorders();\n\n    state.add('layout', this.layout);\n\n\n    state.add('statistics', this.statisticsDisplayState);\n\n    this.registerActionListeners();\n    this.registerEventActionBindings();\n\n    this.registerDisposer(setupPositionDropHandlers(element, this.navigationState.position));\n\n    this.registerDisposer(new MouseSelectionStateTooltipManager(\n        this.mouseState, this.layerManager, this.navigationState.voxelSize));\n  }\n\n  private updateShowBorders() {\n    const {element} = this;\n    const className = 'neuroglancer-show-panel-borders';\n    if (this.uiConfiguration.showPanelBorders.value) {\n      element.classList.add(className);\n    } else {\n      element.classList.remove(className);\n    }\n  }\n\n  private makeUI() {\n    const gridContainer = this.element;\n    gridContainer.classList.add('neuroglancer-viewer');\n    gridContainer.classList.add('neuroglancer-noselect');\n    gridContainer.style.display = 'flex';\n    gridContainer.style.flexDirection = 'column';\n\n    const topRow = document.createElement('div');\n    topRow.title = 'Right click for settings';\n    topRow.classList.add('neuroglancer-viewer-top-row');\n    const contextMenu = this.contextMenu = this.registerDisposer(makeViewerContextMenu(this));\n    contextMenu.registerParent(topRow);\n    topRow.style.display = 'flex';\n    topRow.style.flexDirection = 'row';\n    topRow.style.alignItems = 'stretch';\n\n    const voxelSizeWidget = this.registerDisposer(\n        new VoxelSizeWidget(document.createElement('div'), this.navigationState.voxelSize));\n    this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n        this.uiControlVisibility.showLocation, voxelSizeWidget.element));\n    topRow.appendChild(voxelSizeWidget.element);\n\n    const positionWidget = this.registerDisposer(new PositionWidget(this.navigationState.position));\n    this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n        this.uiControlVisibility.showLocation, positionWidget.element));\n    topRow.appendChild(positionWidget.element);\n\n    const mousePositionWidget = this.registerDisposer(new MousePositionWidget(\n        document.createElement('div'), this.mouseState, this.navigationState.voxelSize));\n    mousePositionWidget.element.style.flex = '1';\n    mousePositionWidget.element.style.alignSelf = 'center';\n    this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n        this.uiControlVisibility.showLocation, mousePositionWidget.element));\n    topRow.appendChild(mousePositionWidget.element);\n\n    const annotationToolStatus =\n        this.registerDisposer(new AnnotationToolStatusWidget(this.selectedLayer));\n    topRow.appendChild(annotationToolStatus.element);\n    this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n        this.uiControlVisibility.showAnnotationToolStatus, annotationToolStatus.element));\n\n    {\n      const button = makeTextIconButton('{}', 'Edit JSON state');\n      this.registerEventListener(button, 'click', () => {\n        this.editJsonState();\n      });\n      this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n          this.uiControlVisibility.showEditStateButton, button));\n      topRow.appendChild(button);\n    }\n\n\n    {\n      const button = makeTextIconButton('?', 'Help');\n      this.registerEventListener(button, 'click', () => {\n        this.showHelpDialog();\n      });\n      this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n          this.uiControlVisibility.showHelpButton, button));\n      topRow.appendChild(button);\n    }\n\n    this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n        makeDerivedWatchableValue(\n            (...values: boolean[]) => values.reduce((a, b) => a || b, false),\n            this.uiControlVisibility.showHelpButton, this.uiControlVisibility.showEditStateButton,\n            this.uiControlVisibility.showLocation,\n            this.uiControlVisibility.showAnnotationToolStatus),\n        topRow));\n\n    gridContainer.appendChild(topRow);\n\n    const layoutAndSidePanel = document.createElement('div');\n    layoutAndSidePanel.style.display = 'flex';\n    layoutAndSidePanel.style.flex = '1';\n    layoutAndSidePanel.style.flexDirection = 'row';\n    this.layout = this.registerDisposer(new RootLayoutContainer(this, '4panel'));\n    layoutAndSidePanel.appendChild(this.layout.element);\n    const layerInfoPanel =\n        this.registerDisposer(new LayerInfoPanelContainer(this.selectedLayer.addRef()));\n    layoutAndSidePanel.appendChild(layerInfoPanel.element);\n    const self = this;\n    layerInfoPanel.registerDisposer(new DragResizablePanel(\n        layerInfoPanel.element, {\n          changed: self.selectedLayer.changed,\n          get value() {\n            return self.selectedLayer.visible;\n          },\n          set value(visible: boolean) {\n            self.selectedLayer.visible = visible;\n          }\n        },\n        this.selectedLayer.size, 'horizontal', 290));\n\n    gridContainer.appendChild(layoutAndSidePanel);\n\n    const statisticsPanel = this.registerDisposer(\n        new StatisticsPanel(this.chunkQueueManager, this.statisticsDisplayState));\n    gridContainer.appendChild(statisticsPanel.element);\n    statisticsPanel.registerDisposer(new DragResizablePanel(\n        statisticsPanel.element, this.statisticsDisplayState.visible,\n        this.statisticsDisplayState.size, 'vertical'));\n\n    const updateVisibility = () => {\n      const shouldBeVisible = this.visibility.visible;\n      if (shouldBeVisible !== this.visible) {\n        gridContainer.style.visibility = shouldBeVisible ? 'inherit' : 'hidden';\n        this.visible = shouldBeVisible;\n      }\n    };\n    updateVisibility();\n    this.registerDisposer(this.visibility.changed.add(updateVisibility));\n  }\n\n  /**\n   * Called once by the constructor to set up event handlers.\n   */\n  private registerEventActionBindings() {\n    const {element} = this;\n    this.registerDisposer(new KeyboardEventBinder(element, this.inputEventMap));\n    this.registerDisposer(new AutomaticallyFocusedElement(element));\n  }\n\n  bindAction(action: string, handler: () => void) {\n    this.registerDisposer(registerActionListener(this.element, action, handler));\n  }\n\n  /**\n   * Called once by the constructor to register the action listeners.\n   */\n  private registerActionListeners() {\n    for (const action of ['recolor', 'clear-segments', ]) {\n      this.bindAction(action, () => {\n        this.layerManager.invokeAction(action);\n      });\n    }\n\n    for (const action of ['select']) {\n      this.bindAction(action, () => {\n        this.mouseState.updateUnconditionally();\n        this.layerManager.invokeAction(action);\n      });\n    }\n\n    this.bindAction('help', () => this.showHelpDialog());\n\n    for (let i = 1; i <= 9; ++i) {\n      this.bindAction(`toggle-layer-${i}`, () => {\n        const layerIndex = i - 1;\n        const layers = this.layerManager.managedLayers;\n        if (layerIndex < layers.length) {\n          let layer = layers[layerIndex];\n          layer.setVisible(!layer.visible);\n        }\n      });\n      this.bindAction(`select-layer-${i}`, () => {\n        const layerIndex = i - 1;\n        const layers = this.layerManager.managedLayers;\n        if (layerIndex < layers.length) {\n          const layer = layers[layerIndex];\n          this.selectedLayer.layer = layer;\n          this.selectedLayer.visible = true;\n        }\n      });\n    }\n\n    this.bindAction('annotate', () => {\n      const selectedLayer = this.selectedLayer.layer;\n      if (selectedLayer === undefined) {\n        StatusMessage.showTemporaryMessage('The annotate command requires a layer to be selected.');\n        return;\n      }\n      const userLayer = selectedLayer.layer;\n      if (userLayer === null || userLayer.tool.value === undefined) {\n        StatusMessage.showTemporaryMessage(`The selected layer (${\n            JSON.stringify(selectedLayer.name)}) does not have an active annotation tool.`);\n        return;\n      }\n      userLayer.tool.value.trigger(this.mouseState);\n    });\n\n    this.bindAction('toggle-axis-lines', () => this.showAxisLines.toggle());\n    this.bindAction('toggle-scale-bar', () => this.showScaleBar.toggle());\n    this.bindAction('toggle-default-annotations', () => this.showDefaultAnnotations.toggle());\n    this.bindAction('toggle-show-slices', () => this.showPerspectiveSliceViews.toggle());\n    this.bindAction('toggle-show-statistics', () => this.showStatistics());\n  }\n\n  showHelpDialog() {\n    const {inputEventBindings} = this;\n    new InputEventBindingHelpDialog([\n      ['Global', inputEventBindings.global],\n      ['Slice View', inputEventBindings.sliceView],\n      ['Perspective View', inputEventBindings.perspectiveView],\n    ]);\n  }\n\n  editJsonState() {\n    new StateEditorDialog(this);\n  }\n\n  showStatistics(value: boolean|undefined = undefined) {\n    if (value === undefined) {\n      value = !this.statisticsDisplayState.visible.value;\n    }\n    this.statisticsDisplayState.visible.value = value;\n  }\n\n  get gl() {\n    return this.display.gl;\n  }\n\n  onUpdateDisplay() {\n    if (this.visible) {\n      this.dataContext.chunkQueueManager.chunkUpdateDeadline = null;\n    }\n  }\n\n  private handleNavigationStateChanged() {\n    if (this.visible) {\n      let {chunkQueueManager} = this.dataContext;\n      if (chunkQueueManager.chunkUpdateDeadline === null) {\n        chunkQueueManager.chunkUpdateDeadline = Date.now() + 10;\n      }\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nrequire('./default_viewer.css');\n\nimport 'neuroglancer/sliceview/chunk_format_handlers';\n\nimport {StatusMessage} from 'neuroglancer/status';\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {Viewer, ViewerOptions} from 'neuroglancer/viewer';\nimport {disableContextMenu, disableWheel} from 'neuroglancer/ui/disable_default_actions';\n\nexport function makeDefaultViewer(options?: Partial<ViewerOptions>) {\n  disableContextMenu();\n  disableWheel();\n  try {\n    let display = new DisplayContext(document.getElementById('neuroglancer-container')!);\n    return new Viewer(display, options);\n  } catch (error) {\n    StatusMessage.showMessage(`Error: ${error.message}`);\n    throw error;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {registerEventListener} from 'neuroglancer/util/disposable';\n\n/**\n * Prevent context menu on right click, as this interferes with other event handlers for right mouse\n * clicks.\n */\nexport function disableContextMenu() {\n  return registerEventListener(document, 'contextmenu', (e: Event) => {\n    e.preventDefault();\n  });\n}\n\nexport function disableWheel() {\n  return registerEventListener(document, 'wheel', (e: WheelEvent) => {\n    if (e.ctrlKey) {\n      e.preventDefault();\n    }\n  });\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {WatchableValue} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {urlSafeParse, verifyObject} from 'neuroglancer/util/json';\nimport {getCachedJson, Trackable} from 'neuroglancer/util/trackable';\n\n/**\n * @file Implements a binding between a Trackable value and the URL hash state.\n */\n\n/**\n * Encodes a fragment string robustly.\n */\nfunction encodeFragment(fragment: string) {\n  return encodeURI(fragment).replace(/[!'()*;,]/g, function(c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase();\n  });\n}\n\n/**\n * An instance of this class manages a binding between a Trackable value and the URL hash state.\n * The binding is initialized in the constructor, and is removed when dispose is called.\n */\nexport class UrlHashBinding extends RefCounted {\n  /**\n   * Most recently parsed or set state string.\n   */\n  private prevStateString: string|undefined;\n\n  /**\n   * Generation number of previous state set.\n   */\n  private prevStateGeneration: number|undefined;\n\n  /**\n   * Most recent error parsing URL hash.\n   */\n  parseError = new WatchableValue<Error|undefined>(undefined);\n\n  constructor(public root: Trackable, updateDelayMilliseconds = 200) {\n    super();\n    this.registerEventListener(window, 'hashchange', () => this.updateFromUrlHash());\n    const throttledSetUrlHash = debounce(() => this.setUrlHash(), updateDelayMilliseconds);\n    this.registerDisposer(root.changed.add(throttledSetUrlHash));\n    this.registerDisposer(() => throttledSetUrlHash.cancel());\n  }\n\n  /**\n   * Sets the URL hash to match the current state.\n   */\n  setUrlHash() {\n    const cacheState = getCachedJson(this.root);\n    const {generation} = cacheState;\n    if (generation !== this.prevStateGeneration) {\n      this.prevStateGeneration = cacheState.generation;\n      let stateString = encodeFragment(JSON.stringify(cacheState.value));\n      if (stateString !== this.prevStateString) {\n        this.prevStateString = stateString;\n        if (decodeURIComponent(stateString) === '{}') {\n          history.replaceState(null, '', '#');\n        } else {\n          history.replaceState(null, '', '#!' + stateString);\n        }\n      }\n    }\n  }\n\n  /**\n   * Sets the current state to match the URL hash.  If it is desired to initialize the state based\n   * on the URL hash, then this should be called immediately after construction.\n   */\n  updateFromUrlHash() {\n    try {\n      let s = location.href.replace(/^[^#]+/, '');\n      if (s === '' || s === '#' || s === '#!') {\n        s = '#!{}';\n      }\n      if (s.startsWith('#!+')) {\n        s = s.slice(3);\n        // Firefox always %-encodes the URL even if it is not typed that way.\n        s = decodeURIComponent(s);\n        let state = urlSafeParse(s);\n        verifyObject(state);\n        this.root.restoreState(state);\n        this.prevStateString = undefined;\n      } else if (s.startsWith('#!')) {\n        s = s.slice(2);\n        s = decodeURIComponent(s);\n        if (s === this.prevStateString) {\n          return;\n        }\n        this.prevStateString = s;\n        this.root.reset();\n        let state = urlSafeParse(s);\n        verifyObject(state);\n        this.root.restoreState(state);\n      } else {\n        throw new Error(`URL hash is expected to be of the form \"#!{...}\" or \"#!+{...}\".`);\n      }\n      this.parseError.value = undefined;\n    } catch (parseError) {\n      this.parseError.value = parseError;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {StatusMessage} from 'neuroglancer/status';\nimport {bindDefaultCopyHandler, bindDefaultPasteHandler} from 'neuroglancer/ui/default_clipboard_handling';\nimport {setDefaultInputEventBindings} from 'neuroglancer/ui/default_input_event_bindings';\nimport {makeDefaultViewer} from 'neuroglancer/ui/default_viewer';\nimport {UrlHashBinding} from 'neuroglancer/ui/url_hash_binding';\n\n/**\n * Sets up the default neuroglancer viewer.\n */\nexport function setupDefaultViewer() {\n  let viewer = (<any>window)['viewer'] = makeDefaultViewer();\n  setDefaultInputEventBindings(viewer.inputEventBindings);\n\n  const hashBinding = viewer.registerDisposer(new UrlHashBinding(viewer.state));\n  viewer.registerDisposer(hashBinding.parseError.changed.add(() => {\n    const {value} = hashBinding.parseError;\n    if (value !== undefined) {\n      const status = new StatusMessage();\n      status.setErrorMessage(`Error parsing state: ${value.message}`);\n      console.log('Error parsing state', value);\n    }\n    hashBinding.parseError;\n  }));\n  hashBinding.updateFromUrlHash();\n\n  bindDefaultCopyHandler(viewer);\n  bindDefaultPasteHandler(viewer);\n\n  return viewer;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Main entry point for default neuroglancer viewer.\n */\nimport {setupDefaultViewer} from 'neuroglancer/ui/default_viewer_setup';\n\nwindow.addEventListener('DOMContentLoaded', () => {\n  setupDefaultViewer();\n});\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Convenience interface for creating TrackableValue instances designed to represent alpha\n * (opacity) values.\n */\n\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {verifyFiniteFloat} from 'neuroglancer/util/json';\n\nexport type TrackableFiniteFloat = TrackableValue<number>;\n\nexport function trackableFiniteFloat(initialValue = 1.0) {\n  return new TrackableValue<number>(initialValue, verifyFiniteFloat);\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nimport {vec3} from 'neuroglancer/util/geom';\nimport {verify3dVec} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\n\nexport function trackableVec3(defaultValue = vec3.create()) {\n  return new TrackableVec3(defaultValue, defaultValue);\n}\n\nexport class TrackableVec3 implements Trackable {\n  get value() {\n    return this.value_;\n  }\n  set value(newValue: vec3) {\n    if (newValue !== this.value_) {\n      this.value_ = newValue;\n      this.changed.dispatch();\n    }\n  }\n  changed = new NullarySignal();\n  constructor(private value_: vec3, public defaultValue: vec3) {}\n  toJSON() {\n    let {value_} = this;\n    if (value_ === this.defaultValue) {\n      return undefined;\n    }\n    return this.value_.toString();\n  }\n  restoreState(x: any) {\n    try {\n      this.value = verify3dVec(x.split(','));\n    } catch (e) {\n      this.value = this.defaultValue;\n    }\n  }\n  reset() {\n    this.value = this.defaultValue;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {SliceView} from 'neuroglancer/sliceview/frontend';\nimport {VectorGraphicsSourceOptions} from 'neuroglancer/sliceview/vector_graphics/base';\nimport {MultiscaleVectorGraphicsChunkSource, RenderLayer as GenericVectorGraphicsRenderLayer, VectorGraphicsChunkSource} from 'neuroglancer/sliceview/vector_graphics/frontend';\nimport {TrackableAlphaValue, trackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {TrackableFiniteFloat, trackableFiniteFloat} from 'neuroglancer/trackable_finite_float';\nimport {trackableVec3, TrackableVec3} from 'neuroglancer/trackable_vec3';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nconst tempMat4 = mat4.create();\n\nexport class VectorGraphicsLineRenderLayer extends GenericVectorGraphicsRenderLayer {\n  opacity: TrackableAlphaValue;\n  lineWidth: TrackableFiniteFloat;\n  color: TrackableVec3;\n  private vertexIndexBuffer: Buffer;\n  private normalDirectionBuffer: Buffer;\n\n\n  constructor(multiscaleSource: MultiscaleVectorGraphicsChunkSource, {\n    opacity = trackableAlphaValue(0.5),\n    lineWidth = trackableFiniteFloat(10.0),\n    color = trackableVec3(vec3.fromValues(255.0, 255.0, 255.0)),\n    sourceOptions = <VectorGraphicsSourceOptions>{},\n  } = {}) {\n    super(multiscaleSource, {sourceOptions});\n\n    this.opacity = opacity;\n    this.registerDisposer(opacity.changed.add(() => {\n      this.redrawNeeded.dispatch();\n    }));\n\n    this.lineWidth = lineWidth;\n    this.registerDisposer(lineWidth.changed.add(() => {\n      this.redrawNeeded.dispatch();\n    }));\n\n    this.color = color;\n    this.registerDisposer(color.changed.add(() => {\n      this.redrawNeeded.dispatch();\n    }));\n\n    let gl = this.gl;\n\n    let vertexIndex = new Float32Array([1, 0, 0, 1, 1, 0, 0, 1]);\n\n    this.vertexIndexBuffer =\n        this.registerDisposer(Buffer.fromData(gl, vertexIndex, gl.ARRAY_BUFFER, gl.STATIC_DRAW));\n\n    let normalDirection = new Float32Array([1, 1, -1, -1]);\n\n    this.normalDirectionBuffer = this.registerDisposer(\n        Buffer.fromData(gl, normalDirection, gl.ARRAY_BUFFER, gl.STATIC_DRAW));\n  }\n\n  getShaderKey() {\n    return `vectorgraphics.VectorGraphicsLineRenderLayer`;\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n\n    builder.addUniform('highp float', 'uOpacity');\n    builder.addUniform('highp float', 'ulineWidth');\n    builder.addUniform('highp vec3', 'uColor');\n    builder.addVarying('vec3', 'vNormal');\n\n    builder.addAttribute('highp float', 'aNormalDirection');\n    builder.addAttribute('highp vec2', 'aVertexIndex');\n\n    builder.addAttribute('highp vec3', 'aVertexFirst');\n    builder.addAttribute('highp vec3', 'aVertexSecond');\n    builder.addUniform('highp mat4', 'uProjection');\n\n    builder.setFragmentMain(`\nfloat distance = length(vNormal);\n\nfloat antialiasing = 0.5;\n\nif (distance >= 1.0 - antialiasing) {\n  emitRGBA(vec4(uColor, (distance - 1.0) / -antialiasing ));\n}\nelse if (distance < 1.0 - antialiasing) {\n  emitRGB(uColor);\n}\n`);\n    builder.setVertexMain(`\nvec3 direction = vec3(0., 0., 0.);\ndirection.z = aNormalDirection;\n\nvec3 difference = aVertexSecond - aVertexFirst;\ndifference.z = 0.;\n\nvec3 normal = cross(difference, direction);\nnormal = normalize(normal);\nvNormal = normal;\n\nvec4 delta = vec4(normal * ulineWidth, 0.0);\nvec4 pos = vec4(aVertexFirst * aVertexIndex.x + aVertexSecond * aVertexIndex.y, 1.0);\n\ngl_Position = uProjection * (pos + delta);\n`);\n  }\n\n  beginSlice(_sliceView: SliceView) {\n    super.beginSlice(_sliceView);\n\n    let gl = this.gl;\n    let shader = this.shader!;\n    gl.uniform1f(shader.uniform('uOpacity'), this.opacity.value);\n    gl.uniform1f(shader.uniform('ulineWidth'), this.lineWidth.value);\n    gl.uniform3fv(shader.uniform('uColor'), this.color.value);\n\n    this.vertexIndexBuffer.bindToVertexAttrib(\n        shader.attribute('aVertexIndex'),\n        /*components=*/2);\n\n    this.normalDirectionBuffer.bindToVertexAttrib(\n        shader.attribute('aNormalDirection'),\n        /*components=*/1);\n\n    return shader;\n  }\n\n  endSlice(shader: ShaderProgram) {\n    let gl = this.gl;\n\n    gl.disableVertexAttribArray(shader.attribute('aVertexIndex'));\n    gl.disableVertexAttribArray(shader.attribute('aNormalDirection'));\n\n    gl.disableVertexAttribArray(shader.attribute('aVertexFirst'));\n    gl.disableVertexAttribArray(shader.attribute('aVertexSecond'));\n  }\n\n  draw(sliceView: SliceView) {\n    let visibleSources = sliceView.visibleLayers.get(this)!;\n    if (visibleSources.length === 0) {\n      return;\n    }\n\n    let gl = this.gl;\n\n    let shader = this.beginSlice(sliceView);\n    if (shader === undefined) {\n      console.log('error: shader undefined');\n      return;\n    }\n\n\n    for (let transformedSource of visibleSources) {\n      const chunkLayout = transformedSource.chunkLayout;\n      const source = transformedSource.source as VectorGraphicsChunkSource;\n      let voxelSize = source.spec.voxelSize;\n      let chunks = source.chunks;\n\n      let objectToDataMatrix = tempMat4;\n      mat4.identity(objectToDataMatrix);\n      if (source.vectorGraphicsCoordinatesInVoxels) {\n        mat4.scale(objectToDataMatrix, objectToDataMatrix, voxelSize);\n      }\n      mat4.multiply(objectToDataMatrix, chunkLayout.transform, objectToDataMatrix);\n\n      // Compute projection matrix that transforms vertex coordinates to device coordinates\n      gl.uniformMatrix4fv(\n          shader.uniform('uProjection'), false,\n          mat4.multiply(tempMat4, sliceView.dataToDevice, objectToDataMatrix));\n\n      let visibleChunks = sliceView.visibleChunks.get(chunkLayout);\n      if (!visibleChunks) {\n        continue;\n      }\n\n      for (let key of visibleChunks) {\n        let chunk = chunks.get(key);\n        if (chunk && chunk.state === ChunkState.GPU_MEMORY) {\n          let numInstances = chunk.numPoints / 2;  // Two points == One vector\n\n          const aVertexFirst = shader.attribute('aVertexFirst');\n          chunk.vertexBuffer.bindToVertexAttrib(\n              aVertexFirst,\n              /*components=*/3,\n              /*attributeType=*/WebGL2RenderingContext.FLOAT,\n              /*normalized=*/false,\n              /*stride=*/6 * 4,\n              /*offset=*/0);\n          gl.vertexAttribDivisor(aVertexFirst, 1);\n\n          const aVertexSecond = shader.attribute('aVertexSecond');\n          chunk.vertexBuffer.bindToVertexAttrib(\n              aVertexSecond,\n              /*components=*/3,\n              /*attributeType=*/WebGL2RenderingContext.FLOAT,\n              /*normalized=*/false,\n              /*stride=*/6 * 4,\n              /*offset=*/3 * 4);\n          gl.vertexAttribDivisor(aVertexSecond, 1);\n\n          gl.drawArraysInstanced(gl.TRIANGLE_STRIP, 0, 4, numInstances);\n\n          gl.vertexAttribDivisor(aVertexFirst, 0);\n          gl.vertexAttribDivisor(aVertexSecond, 0);\n        }\n      }\n    }\n    this.endSlice(shader);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableVec3} from 'neuroglancer/trackable_vec3';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {verifyFiniteFloat} from 'neuroglancer/util/json';\nimport {Signal} from 'neuroglancer/util/signal';\n\nrequire('./vec3.css');\n\nexport class Vec3Widget extends RefCounted {\n  promptElement = document.createElement('span');\n  element = document.createElement('label');\n  inputx = document.createElement('input');\n  inputy = document.createElement('input');\n  inputz = document.createElement('input');\n  valueEntered = new Signal<(value: number) => void>();\n\n  constructor(public model: TrackableVec3) {\n    super();\n    let {inputx, inputy, inputz, element, promptElement} = this;\n\n    element.className = 'vec3-input-row';\n    promptElement.className = 'vec3-input-label';\n\n    element.appendChild(promptElement);\n\n    element.appendChild(inputx);\n    element.appendChild(inputy);\n    element.appendChild(inputz);\n\n    inputx.type = inputy.type = inputz.type = 'number';\n    this.updateInput();\n\n    const inputValueChanged = () => {\n      this.model.value = this.getVec3Values();\n    };\n    this.registerEventListener(inputx, 'change', inputValueChanged);\n    this.registerEventListener(inputy, 'change', inputValueChanged);\n    this.registerEventListener(inputz, 'change', inputValueChanged);\n\n    this.model.changed.add(() => {\n      this.updateInput();\n    });\n  }\n\n  getVec3Values(): vec3 {\n    let ret = vec3.create();\n    ret[0] = this.verifyValue(this.inputx.valueAsNumber);\n    ret[1] = this.verifyValue(this.inputy.valueAsNumber);\n    ret[2] = this.verifyValue(this.inputz.valueAsNumber);\n\n    return ret;\n  }\n\n  verifyValue(value: any) {\n    return verifyFiniteFloat(value);\n  }\n\n  updateInput() {\n    this.inputx.valueAsNumber = this.model.value[0];\n    this.inputy.valueAsNumber = this.model.value[1];\n    this.inputz.valueAsNumber = this.model.value[2];\n  }\n\n  disposed() {\n    let {inputx, inputy, inputz, element} = this;\n    if (inputx.parentElement) {\n      inputx.parentElement.removeChild(inputx);\n    }\n    if (inputy.parentElement) {\n      inputy.parentElement.removeChild(inputy);\n    }\n    if (inputz.parentElement) {\n      inputz.parentElement.removeChild(inputz);\n    }\n    if (element.parentElement) {\n      element.parentElement.removeChild(element);\n    }\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {DataSourceProvider, GetVectorGraphicsOptions} from 'neuroglancer/datasource';\nimport {UserLayer} from 'neuroglancer/layer';\nimport {LayerListSpecification, registerLayerType} from 'neuroglancer/layer_specification';\nimport {VectorGraphicsType} from 'neuroglancer/sliceview/vector_graphics/base';\nimport {MultiscaleVectorGraphicsChunkSource, RenderLayer} from 'neuroglancer/sliceview/vector_graphics/frontend';\nimport {VectorGraphicsLineRenderLayer} from 'neuroglancer/sliceview/vector_graphics/vector_graphics_line_renderlayer';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {trackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {trackableFiniteFloat} from 'neuroglancer/trackable_finite_float';\nimport {trackableVec3, TrackableVec3} from 'neuroglancer/trackable_vec3';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {verifyEnumString, verifyFiniteFloat, verifyOptionalString} from 'neuroglancer/util/json';\nimport {RangeWidget} from 'neuroglancer/widget/range';\nimport {Tab} from 'neuroglancer/widget/tab_view';\nimport {Vec3Widget} from 'neuroglancer/widget/vec3_entry_widget';\n\nrequire('./image_user_layer.css');\nrequire('neuroglancer/maximize_button.css');\n\nfunction getVectorGraphicsWithStatusMessage(\n    dataSourceProvider: DataSourceProvider, chunkManager: ChunkManager, x: string,\n    options: GetVectorGraphicsOptions = {}): Promise<MultiscaleVectorGraphicsChunkSource> {\n  return StatusMessage.forPromise(\n      new Promise(function(resolve) {\n        resolve(dataSourceProvider.getVectorGraphicsSource(chunkManager, x, options));\n      }),\n      {\n        initialMessage: `Retrieving metadata for vector graphics source ${x}.`,\n        delay: true,\n        errorPrefix: `Error retrieving metadata for vector graphics source ${x}: `,\n      });\n}\n\nexport class VectorGraphicsUserLayer extends UserLayer {\n  vectorGraphicsPath: string|undefined;\n  vectorGraphicsLayerType: VectorGraphicsType;\n  opacity = trackableAlphaValue(0.5);\n  lineWidth = trackableFiniteFloat(10.0);\n  color = trackableVec3(vec3.fromValues(1.0, 1.0, 1.0));\n  renderLayer: RenderLayer;\n  constructor(manager: LayerListSpecification, x: any) {\n    super(manager, x);\n\n    this.opacity.restoreState(x['opacity']);\n    this.lineWidth.restoreState(x['linewidth']);\n    this.color.restoreState(x['color']);\n\n    this.lineWidth.changed.add(() => {\n      this.specificationChanged.dispatch();\n    });\n    this.color.changed.add(() => {\n      this.specificationChanged.dispatch();\n    });\n\n    this.vectorGraphicsLayerType = verifyEnumString(x['type'], VectorGraphicsType);\n\n    let vectorGraphicsPath = this.vectorGraphicsPath = verifyOptionalString(x['source']);\n    let remaining = 0;\n    if (vectorGraphicsPath !== undefined) {\n      ++remaining;\n      if (this.vectorGraphicsLayerType === VectorGraphicsType.LINE) {\n        getVectorGraphicsWithStatusMessage(\n            manager.dataSourceProvider, manager.chunkManager, vectorGraphicsPath)\n            .then(vectorGraphics => {\n              if (!this.wasDisposed) {\n                let renderLayer = this.renderLayer =\n                    new VectorGraphicsLineRenderLayer(vectorGraphics, {\n                      opacity: this.opacity,\n                      lineWidth: this.lineWidth,\n                      color: this.color,\n                      sourceOptions: {}\n                    });\n                this.addRenderLayer(renderLayer);\n                if (--remaining === 0) {\n                  this.isReady = true;\n                }\n              }\n            });\n      }\n    }\n    this.tabs.add(\n        'rendering', {label: 'Rendering', order: -100, getter: () => new DisplayOptionsTab(this)});\n    this.tabs.default = 'rendering';\n  }\n\n  toJSON() {\n    const x = super.toJSON();\n    x['type'] = this.getLayerType();\n    x['source'] = this.vectorGraphicsPath;\n    x['opacity'] = this.opacity.toJSON();\n    x['linewidth'] = this.lineWidth.toJSON();\n    x['color'] = this.color.toJSON();\n    return x;\n  }\n\n  getLayerType() {\n    let typeStr = VectorGraphicsType[this.vectorGraphicsLayerType];\n    return typeStr.toLowerCase();\n  }\n}\n\nclass DisplayOptionsTab extends Tab {\n  opacityWidget = this.registerDisposer(new RangeWidget(this.layer.opacity));\n  lineWidthWidget =\n      this.registerDisposer(new RangeWidget(this.layer.lineWidth, {min: 0, max: 50, step: 1}));\n  colorWidget = this.registerDisposer(new VectorGraphicsColorWidget(this.layer.color));\n\n  constructor(public layer: VectorGraphicsUserLayer) {\n    super();\n    const {element} = this;\n    element.classList.add('image-dropdown');\n    let {opacityWidget, lineWidthWidget, colorWidget} = this;\n    let topRow = document.createElement('div');\n    topRow.className = 'image-dropdown-top-row';\n    opacityWidget.promptElement.textContent = 'Opacity';\n    lineWidthWidget.promptElement.textContent = 'Line Width';\n    colorWidget.promptElement.textContent = 'Color';\n\n    let spacer = document.createElement('div');\n    spacer.style.flex = '1';\n    let helpLink = document.createElement('a');\n    let helpButton = document.createElement('button');\n    helpButton.type = 'button';\n    helpButton.textContent = '?';\n    helpButton.className = 'help-link';\n    helpLink.appendChild(helpButton);\n    helpLink.title = 'Documentation on vector graphics layer rendering';\n    helpLink.target = '_blank';\n    helpLink.href =\n        'https://github.com/google/neuroglancer/blob/master/src/neuroglancer/sliceview/vectorgraphics_layer_rendering.md';\n\n    topRow.appendChild(spacer);\n    topRow.appendChild(helpLink);\n\n    element.appendChild(topRow);\n    element.appendChild(this.opacityWidget.element);\n    element.appendChild(this.lineWidthWidget.element);\n    element.appendChild(this.colorWidget.element);\n  }\n}\n\n\nclass VectorGraphicsColorWidget extends Vec3Widget {\n  constructor(model: TrackableVec3) {\n    super(model);\n  }\n\n  verifyValue(value: any) {\n    let num = verifyFiniteFloat(value);\n    // Scale from [0,255] to [0,1]\n    num = num / 255.0;\n\n    if (num < 0.) {\n      return 0.;\n    }\n    if (num > 1.) {\n      return 1.;\n    }\n    return num;\n  }\n\n  updateInput() {\n    this.inputx.valueAsNumber = Math.round(this.model.value[0] * 255.);\n    this.inputy.valueAsNumber = Math.round(this.model.value[1] * 255.);\n    this.inputz.valueAsNumber = Math.round(this.model.value[2] * 255.);\n  }\n}\n\n\nregisterLayerType('line', VectorGraphicsUserLayer);\n// registerLayerType('point', VectorGraphicsUserLayer);\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DataType} from 'neuroglancer/util/data_type';\n\nexport const SINGLE_MESH_LAYER_RPC_ID = 'single_mesh/SingleMeshLayer';\nexport const GET_SINGLE_MESH_INFO_RPC_ID = 'single_mesh/getSingleMeshInfo';\n\nexport const SINGLE_MESH_CHUNK_KEY = '';\n\nexport interface VertexAttributeInfo {\n  name: string;\n  dataType: DataType;\n  numComponents: number;\n  source?: string;\n  min?: number;\n  max?: number;\n}\n\nexport interface SingleMeshInfo {\n  numVertices: number;\n  numTriangles: number;\n  // Perhaps bounding box?\n  // Perhaps transform data?\n  vertexAttributes: VertexAttributeInfo[];\n}\n\nexport interface SingleMeshData {\n  vertexPositions: Float32Array;\n  indices: Uint32Array;\n  vertexNormals?: Float32Array;\n  vertexAttributes: Float32Array[];\n}\n\nexport class SingleMeshSourceParameters {\n  meshSourceUrl: string;\n  attributeSourceUrls: string[];\n}\n\nexport class SingleMeshSourceParametersWithInfo extends SingleMeshSourceParameters {\n  info: SingleMeshInfo;\n\n  static RPC_ID = 'single_mesh/SingleMeshSource';\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {glsl_uint32} from 'neuroglancer/webgl/shader_lib';\n\nexport class CountingBuffer extends RefCounted {\n  length: number|undefined;\n  webglType: number|undefined;\n  buffer: Buffer;\n\n  constructor(public gl: GL) {\n    super();\n    this.buffer = this.registerDisposer(new Buffer(gl));\n  }\n\n  resize(length: number) {\n    let bufferData: ArrayBufferView;\n    if (length < 256) {\n      let data = bufferData = new Uint8Array(length);\n      for (let i = 0; i < length; ++i) {\n        data[i] = i;\n      }\n      this.webglType = WebGL2RenderingContext.UNSIGNED_BYTE;\n    } else if (length < 65536) {\n      const data = bufferData = new Uint16Array(length);\n      for (let i = 0; i < length; ++i) {\n        data[i] = i;\n      }\n      this.webglType = WebGL2RenderingContext.UNSIGNED_SHORT;\n    } else {\n      const data = bufferData = new Uint32Array(length);\n      for (let i = 0; i < length; ++i) {\n        data[i] = i;\n      }\n      this.webglType = WebGL2RenderingContext.UNSIGNED_INT;\n    }\n    this.buffer.setData(bufferData);\n    this.length = length;\n  }\n\n  ensure(length: number) {\n    if (this.length === undefined || this.length < length) {\n      this.resize(length);\n    }\n    return this;\n  }\n\n  bindToVertexAttrib(location: number) {\n    this.buffer.bindToVertexAttribI(location, 1, this.webglType);\n  }\n\n  bind(shader: ShaderProgram, divisor = 0) {\n    const location = shader.attribute('aIndexRaw');\n    if (location >= 0) {\n      this.bindToVertexAttrib(location);\n      if (divisor !== 0) {\n        this.gl.vertexAttribDivisor(location, divisor);\n      }\n    }\n  }\n}\n\nexport function disableCountingBuffer(gl: GL, shader: ShaderProgram, instanced = false) {\n  const location = shader.attribute('aIndexRaw');\n  if (location >= 0) {\n    if (instanced) {\n      gl.vertexAttribDivisor(location, 0);\n    }\n    gl.disableVertexAttribArray(location);\n  }\n}\n\nexport function getCountingBuffer(gl: GL) {\n  return gl.memoize.get('IndexBuffer', () => new CountingBuffer(gl));\n}\n\nexport function countingBufferShaderModule(builder: ShaderBuilder) {\n  builder.addAttribute('highp uint', 'aIndexRaw');\n  builder.addVertexCode(glsl_uint32);\n  builder.addVertexCode(`\nuint getPrimitiveIndex() {\n  return aIndexRaw;\n}\n`);\n}\n\n/**\n * Helper class for using a buffer containing uint32 index values as a vertex attribute.\n */\nexport class IndexBufferAttributeHelper {\n  constructor(public name: string) {}\n\n  defineShader(builder: ShaderBuilder) {\n    builder.addAttribute('highp uint', this.name);\n  }\n\n  bind(buffer: Buffer, shader: ShaderProgram) {\n    const attrib = shader.attribute(this.name);\n    buffer.bindToVertexAttribI(attrib, /*components=*/ 1, WebGL2RenderingContext.UNSIGNED_INT);\n  }\n\n  disable(shader: ShaderProgram) {\n    shader.gl.disableVertexAttribArray(shader.attribute(this.name));\n  }\n}\n\nexport function makeIndexBuffer(gl: WebGL2RenderingContext, data: Uint32Array) {\n  return Buffer.fromData(\n      gl, data, WebGL2RenderingContext.ARRAY_BUFFER, WebGL2RenderingContext.STATIC_DRAW);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {Chunk, ChunkManager, ChunkSource, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {PerspectiveViewRenderContext, PerspectiveViewRenderLayer} from 'neuroglancer/perspective_view/render_layer';\nimport {GET_SINGLE_MESH_INFO_RPC_ID, SINGLE_MESH_CHUNK_KEY, SINGLE_MESH_LAYER_RPC_ID, SingleMeshInfo, SingleMeshSourceParameters, SingleMeshSourceParametersWithInfo, VertexAttributeInfo} from 'neuroglancer/single_mesh/base';\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {DataType} from 'neuroglancer/util/data_type';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {parseArray, stableStringify, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {withSharedVisibility} from 'neuroglancer/visibility_priority/frontend';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport glsl_COLORMAPS from 'neuroglancer/webgl/colormaps.glsl';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {makeWatchableShaderError} from 'neuroglancer/webgl/dynamic_shader';\nimport {CountingBuffer, countingBufferShaderModule, disableCountingBuffer, getCountingBuffer, IndexBufferAttributeHelper, makeIndexBuffer} from 'neuroglancer/webgl/index_emulation';\nimport {ShaderBuilder, ShaderModule, ShaderProgram, ShaderSamplerType} from 'neuroglancer/webgl/shader';\nimport {getShaderType} from 'neuroglancer/webgl/shader_lib';\nimport {compute1dTextureLayout, computeTextureFormat, getSamplerPrefixForDataType, OneDimensionalTextureAccessHelper, setOneDimensionalTextureData, TextureFormat} from 'neuroglancer/webgl/texture_access';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\nexport const FRAGMENT_MAIN_START = '//NEUROGLANCER_SINGLE_MESH_LAYER_FRAGMENT_MAIN_START';\n\nconst DEFAULT_FRAGMENT_MAIN = `void main() {\n  emitGray();\n}\n`;\n\nexport type TrackableFragmentMain = TrackableValue<string>;\n\nexport function getTrackableFragmentMain(value = DEFAULT_FRAGMENT_MAIN) {\n  return new TrackableValue<string>(value, verifyString);\n}\n\nexport type TrackableAttributeNames = TrackableValue<Array<string|undefined>>;\n\nexport function getTrackableAttributeNames() {\n  return new TrackableValue<Array<string|undefined>>([], x => parseArray(x, verifyOptionalString));\n}\n\nexport class SingleMeshDisplayState {\n  shaderError = makeWatchableShaderError();\n  fragmentMain = getTrackableFragmentMain();\n  attributeNames = getTrackableAttributeNames();\n  objectToDataTransform = new CoordinateTransform();\n}\n\nexport function getShaderAttributeType(info: {dataType: DataType, numComponents: number}) {\n  return getShaderType(info.dataType, info.numComponents);\n}\n\nconst vertexAttributeSamplerSymbols: Symbol[] = [];\n\nconst vertexPositionTextureFormat = computeTextureFormat(new TextureFormat(), DataType.FLOAT32, 3);\nconst vertexNormalTextureFormat = vertexPositionTextureFormat;\n\nexport class SingleMeshShaderManager {\n  private tempLightVec = new Float32Array(4);\n\n  private textureAccessHelper = new OneDimensionalTextureAccessHelper('vertexData');\n  private indexBufferHelper = new IndexBufferAttributeHelper('vertexIndex');\n\n  constructor(\n      public attributeNames: (string|undefined)[], public attributeInfo: VertexAttributeInfo[],\n      public fragmentMain: string) {}\n\n  defineAttributeAccess(builder: ShaderBuilder, vertexIndexVariable: string) {\n    let {textureAccessHelper} = this;\n    textureAccessHelper.defineShader(builder);\n    let numAttributes = 2;\n    const {attributeNames} = this;\n    for (const attributeName of attributeNames) {\n      if (attributeName !== undefined) {\n        ++numAttributes;\n      }\n    }\n    for (let j = vertexAttributeSamplerSymbols.length; j < numAttributes; ++j) {\n      vertexAttributeSamplerSymbols[j] =\n          Symbol(`SingleMeshShaderManager.vertexAttributeTextureUnit${j}`);\n    }\n    numAttributes = 0;\n\n    builder.addTextureSampler(\n        `sampler2D`, 'uVertexAttributeSampler0', vertexAttributeSamplerSymbols[numAttributes++]);\n    builder.addTextureSampler(\n        `sampler2D`, 'uVertexAttributeSampler1', vertexAttributeSamplerSymbols[numAttributes++]);\n\n    builder.addVertexCode(textureAccessHelper.getAccessor(\n        'readVertexPosition', 'uVertexAttributeSampler0', DataType.FLOAT32, 3));\n    builder.addVertexCode(textureAccessHelper.getAccessor(\n        'readVertexNormal', 'uVertexAttributeSampler1', DataType.FLOAT32, 3));\n    let vertexMain = `\nvec3 vertexPosition = readVertexPosition(${vertexIndexVariable});\nvec3 vertexNormal = readVertexNormal(${vertexIndexVariable});\n`;\n    this.attributeInfo.forEach((info, i) => {\n      const attributeName = attributeNames[i];\n      if (attributeName !== undefined) {\n        builder.addTextureSampler(\n            `${getSamplerPrefixForDataType(info.dataType)}sampler2D` as ShaderSamplerType,\n            `uVertexAttributeSampler${numAttributes}`,\n            vertexAttributeSamplerSymbols[numAttributes]);\n\n        const attributeType = getShaderAttributeType(info);\n        builder.addVarying(`highp ${attributeType}`, `vCustom${i}`);\n        builder.addFragmentCode(`\n#define ${attributeNames[i]} vCustom${i}\n`);\n        builder.addVertexCode(textureAccessHelper.getAccessor(\n            `readAttribute${i}`, `uVertexAttributeSampler${numAttributes}`, info.dataType,\n            info.numComponents));\n        vertexMain += `vCustom${i} = readAttribute${i}(${vertexIndexVariable});\\n`;\n        ++numAttributes;\n      }\n    });\n    builder.addVertexMain(vertexMain);\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    builder.require(countingBufferShaderModule);\n    this.indexBufferHelper.defineShader(builder);\n    builder.addVarying('highp float', 'vLightingFactor');\n    builder.addUniform('highp vec4', 'uLightDirection');\n    builder.addUniform('highp vec4', 'uColor');\n    builder.addUniform('highp mat4', 'uModelMatrix');\n    builder.addUniform('highp mat4', 'uProjection');\n    builder.addUniform('highp uint', 'uPickID');\n    builder.addVarying('highp uint', 'vPickID', 'flat');\n    builder.addVertexMain(`\nuint triangleIndex = getPrimitiveIndex() / 3u;\nvPickID = uPickID + triangleIndex;\n`);\n    builder.addFragmentCode(`\nvoid emitPremultipliedRGBA(vec4 color) {\n  emit(vec4(color.rgb * vLightingFactor, color.a), vPickID);\n}\nvoid emitRGBA(vec4 color) {\n  color = clamp(color, 0.0, 1.0);\n  color.xyz *= color.a;\n  emitPremultipliedRGBA(color);\n}\nvoid emitRGB(vec3 color) {\n  emitRGBA(vec4(color, 1.0));\n}\nvoid emitGray() {\n  emitRGB(vec3(1.0, 1.0, 1.0));\n}\n`);\n    builder.addFragmentCode(glsl_COLORMAPS);\n\n    // Make sure defineAttributeAccess is the last thing that adds fragment code prior to\n    // this.fragmentMain, so that the #define attributes don't mess anything up.\n    this.defineAttributeAccess(builder, 'vertexIndex');\n\n    builder.addVertexMain(`\ngl_Position = uProjection * (uModelMatrix * vec4(vertexPosition, 1.0));\nvec3 normal = normalize((uModelMatrix * vec4(vertexNormal, 0.0)).xyz);\nvLightingFactor = abs(dot(normal, uLightDirection.xyz)) + uLightDirection.w;\n`);\n    builder.setFragmentMainFunction(FRAGMENT_MAIN_START + '\\n' + this.fragmentMain);\n  }\n\n  beginLayer(gl: GL, shader: ShaderProgram, renderContext: PerspectiveViewRenderContext) {\n    let {dataToDevice, lightDirection, ambientLighting, directionalLighting} = renderContext;\n    gl.uniformMatrix4fv(shader.uniform('uProjection'), false, dataToDevice);\n    let lightVec = <vec3>this.tempLightVec;\n    vec3.scale(lightVec, lightDirection, directionalLighting);\n    lightVec[3] = ambientLighting;\n    gl.uniform4fv(shader.uniform('uLightDirection'), lightVec);\n  }\n\n  setPickID(gl: GL, shader: ShaderProgram, pickID: number) {\n    gl.uniform1ui(shader.uniform('uPickID'), pickID);\n  }\n\n  beginObject(gl: GL, shader: ShaderProgram, objectToDataMatrix: mat4) {\n    gl.uniformMatrix4fv(shader.uniform('uModelMatrix'), false, objectToDataMatrix);\n  }\n\n  getShader(gl: GL, emitter: ShaderModule) {\n    const key = {\n      attributeNames: this.attributeNames,\n      attributeInfo: this.attributeInfo,\n      fragmentMain: this.fragmentMain\n    };\n    return gl.memoize.get(\n        `single_mesh/SingleMeshShaderManager:${getObjectId(emitter)}:${stableStringify(key)}`,\n        () => {\n          let builder = new ShaderBuilder(gl);\n          builder.require(emitter);\n          this.defineShader(builder);\n          return builder.build();\n        });\n  }\n\n  bindVertexData(gl: GL, shader: ShaderProgram, data: VertexChunkData) {\n    this.textureAccessHelper.setupTextureLayout(gl, shader, data);\n    let index = 0;\n    const bindTexture = (texture: WebGLTexture|null) => {\n      const textureUnit = WebGL2RenderingContext.TEXTURE0 +\n          shader.textureUnit(vertexAttributeSamplerSymbols[index]);\n      gl.activeTexture(textureUnit);\n      gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, texture);\n      ++index;\n    };\n    bindTexture(data.vertexTexture);\n    bindTexture(data.normalTexture);\n    const {attributeNames} = this;\n    data.vertexAttributeTextures.forEach((texture, i) => {\n      if (attributeNames[i] !== undefined) {\n        bindTexture(texture);\n      }\n    });\n  }\n\n  disableVertexData(gl: GL, shader: ShaderProgram) {\n    let numTextures = 2;\n    let numVertexAttributes = this.attributeInfo.length;\n    let {attributeNames} = this;\n    for (let i = 0; i < numVertexAttributes; ++i) {\n      if (attributeNames[i] !== undefined) {\n        ++numTextures;\n      }\n    }\n    for (let i = 0; i < numTextures; ++i) {\n      let curTextureUnit =\n          shader.textureUnit(vertexAttributeSamplerSymbols[i]) + WebGL2RenderingContext.TEXTURE0;\n      gl.activeTexture(curTextureUnit);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n    }\n  }\n\n  drawFragment(\n      gl: GL, shader: ShaderProgram, chunk: SingleMeshChunk, countingBuffer: CountingBuffer) {\n    countingBuffer.ensure(chunk.numIndices).bind(shader);\n    this.bindVertexData(gl, shader, chunk.vertexData);\n    this.indexBufferHelper.bind(chunk.indexBuffer, shader);\n    gl.drawArrays(WebGL2RenderingContext.TRIANGLES, 0, chunk.numIndices);\n  }\n\n  endLayer(gl: GL, shader: ShaderProgram) {\n    disableCountingBuffer(gl, shader);\n    this.indexBufferHelper.disable(shader);\n    this.disableVertexData(gl, shader);\n  }\n}\n\nexport class VertexChunkData {\n  vertexPositions: Float32Array;\n  vertexNormals: Float32Array;\n  vertexTexture: WebGLTexture|null;\n  normalTexture: WebGLTexture|null;\n  vertexAttributes: Float32Array[];\n  vertexAttributeTextures: (WebGLTexture|null)[];\n\n  // Emulation of buffer as texture.\n  textureXBits: number;\n  textureWidth: number;\n  textureHeight: number;\n\n  copyToGPU(gl: GL, attributeFormats: TextureFormat[]) {\n    let numVertices = this.vertexPositions.length / 3;\n    compute1dTextureLayout(this, gl, /*texelsPerElement=*/ 1, numVertices);\n    const getBufferTexture = (data: Float32Array, format: TextureFormat) => {\n      let texture = gl.createTexture();\n      gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, texture);\n      setOneDimensionalTextureData(gl, this, format, data);\n      return texture;\n    };\n    this.vertexTexture = getBufferTexture(this.vertexPositions, vertexPositionTextureFormat);\n    this.normalTexture = getBufferTexture(this.vertexNormals, vertexNormalTextureFormat);\n    this.vertexAttributeTextures =\n        this.vertexAttributes.map((data, i) => getBufferTexture(data, attributeFormats[i]));\n    gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, null);\n  }\n\n  freeGPUMemory(gl: GL) {\n    gl.deleteTexture(this.vertexTexture);\n    gl.deleteTexture(this.normalTexture);\n    let {vertexAttributeTextures} = this;\n    for (const buffer of vertexAttributeTextures) {\n      gl.deleteTexture(buffer);\n    }\n    vertexAttributeTextures.length = 0;\n  }\n}\n\nexport class SingleMeshChunk extends Chunk {\n  source: SingleMeshSource;\n  indexBuffer: Buffer;\n  numIndices: number;\n  indices: Uint32Array;\n  vertexData: VertexChunkData;\n\n  constructor(source: SingleMeshSource, x: any) {\n    super(source);\n\n    const vertexData = this.vertexData = new VertexChunkData();\n    vertexData.vertexPositions = x['vertexPositions'];\n    vertexData.vertexNormals = x['vertexNormals'];\n    vertexData.vertexAttributes = x['vertexAttributes'];\n    let indices = this.indices = x['indices'];\n    this.numIndices = indices.length;\n  }\n\n  copyToGPU(gl: GL) {\n    super.copyToGPU(gl);\n    this.vertexData.copyToGPU(gl, this.source.attributeTextureFormats);\n    this.indexBuffer = makeIndexBuffer(gl, this.indices);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    this.vertexData.freeGPUMemory(gl);\n    this.indexBuffer.dispose();\n  }\n}\n\nexport function getAttributeTextureFormats(vertexAttributes: VertexAttributeInfo[]) {\n  return vertexAttributes.map(\n      x => computeTextureFormat(new TextureFormat(), x.dataType, x.numComponents));\n}\n\nexport class SingleMeshSource extends\n(WithParameters(ChunkSource, SingleMeshSourceParametersWithInfo)) {\n  attributeTextureFormats = getAttributeTextureFormats(this.info.vertexAttributes);\n\n  get info() {\n    return this.parameters.info;\n  }\n\n  getChunk(x: any) {\n    return new SingleMeshChunk(this, x);\n  }\n}\n\nconst SharedObjectWithSharedVisibility = withSharedVisibility(SharedObject);\nclass SingleMeshLayerSharedObject extends SharedObjectWithSharedVisibility {}\n\nexport class SingleMeshLayer extends PerspectiveViewRenderLayer {\n  protected shaderManager: SingleMeshShaderManager|undefined;\n  private shaders = new Map<ShaderModule, ShaderProgram|null>();\n  private sharedObject = this.registerDisposer(new SingleMeshLayerSharedObject());\n  private fallbackFragmentMain = DEFAULT_FRAGMENT_MAIN;\n  protected countingBuffer = this.registerDisposer(getCountingBuffer(this.gl));\n\n  constructor(public source: SingleMeshSource, public displayState: SingleMeshDisplayState) {\n    super();\n\n    this.displayState.shaderError.value = undefined;\n    const shaderChanged = () => {\n      this.shaderManager = undefined;\n      this.displayState.shaderError.value = undefined;\n      this.disposeShaders();\n      this.redrawNeeded.dispatch();\n    };\n    this.registerDisposer(displayState.fragmentMain.changed.add(shaderChanged));\n    this.registerDisposer(displayState.attributeNames.changed.add(shaderChanged));\n    this.registerDisposer(displayState.objectToDataTransform.changed.add(() => {\n      this.redrawNeeded.dispatch();\n    }));\n    this.displayState.shaderError.value = undefined;\n    const {sharedObject} = this;\n    sharedObject.visibility.add(this.visibility);\n    sharedObject.RPC_TYPE_ID = SINGLE_MESH_LAYER_RPC_ID;\n    sharedObject.initializeCounterpart(source.chunkManager.rpc!, {\n      'chunkManager': source.chunkManager.rpcId,\n      'source': source.addCounterpartRef(),\n    });\n    this.setReady(true);\n  }\n\n  private disposeShaders() {\n    let {shaders} = this;\n    for (let shader of shaders.values()) {\n      if (shader !== null) {\n        shader.dispose();\n      }\n    }\n    shaders.clear();\n  }\n\n  disposed() {\n    this.disposeShaders();\n    super.disposed();\n  }\n\n  protected makeShaderManager(fragmentMain = this.displayState.fragmentMain.value) {\n    return new SingleMeshShaderManager(\n        this.displayState.attributeNames.value, this.source.info.vertexAttributes, fragmentMain);\n  }\n\n  protected getShader(emitter: ShaderModule): ShaderProgram|null {\n    let {shaders} = this;\n    let shader = shaders.get(emitter);\n    if (shader === undefined) {\n      shader = null;\n      let {shaderManager} = this;\n      if (shaderManager === undefined) {\n        shaderManager = this.shaderManager = this.makeShaderManager();\n      }\n      const fragmentMain = this.displayState.fragmentMain.value;\n      try {\n        shader = shaderManager.getShader(this.gl, emitter);\n        this.fallbackFragmentMain = fragmentMain;\n        this.displayState.shaderError.value = null;\n      } catch (shaderError) {\n        this.displayState.shaderError.value = shaderError;\n        let {fallbackFragmentMain} = this;\n        if (fallbackFragmentMain !== fragmentMain) {\n          shaderManager = this.shaderManager = this.makeShaderManager(fallbackFragmentMain);\n          try {\n            shader = shaderManager.getShader(this.gl, emitter);\n          } catch (otherShaderError) {\n          }\n        }\n      }\n      shaders.set(emitter, shader);\n    }\n    return shader;\n  }\n\n  get isTransparent() {\n    return this.displayState.fragmentMain.value.match(/emitRGBA|emitPremultipliedRGBA/) !== null;\n  }\n\n  get gl() {\n    return this.source.gl;\n  }\n\n  draw(renderContext: PerspectiveViewRenderContext) {\n    if (!renderContext.emitColor && renderContext.alreadyEmittedPickID) {\n      // No need for a separate pick ID pass.\n      return;\n    }\n    let chunk = <SingleMeshChunk|undefined>this.source.chunks.get(SINGLE_MESH_CHUNK_KEY);\n    if (chunk === undefined || chunk.state !== ChunkState.GPU_MEMORY) {\n      return;\n    }\n    let shader = this.getShader(renderContext.emitter);\n    if (shader === null) {\n      return;\n    }\n\n    let {gl} = this;\n    let shaderManager = this.shaderManager!;\n    shader.bind();\n    shaderManager.beginLayer(gl, shader, renderContext);\n\n\n    let {pickIDs} = renderContext;\n\n    shaderManager.beginObject(gl, shader, this.displayState.objectToDataTransform.transform);\n    if (renderContext.emitPickID) {\n      shaderManager.setPickID(gl, shader, pickIDs.register(this, chunk.numIndices / 3));\n    }\n    shaderManager.drawFragment(gl, shader, chunk, this.countingBuffer);\n    shaderManager.endLayer(gl, shader);\n  }\n\n  drawPicking(renderContext: PerspectiveViewRenderContext) {\n    this.draw(renderContext);\n  }\n\n  transformPickedValue(_pickedValue: Uint64, pickedOffset: number) {\n    let chunk = <SingleMeshChunk|undefined>this.source.chunks.get(SINGLE_MESH_CHUNK_KEY);\n    if (chunk === undefined) {\n      return undefined;\n    }\n    let startIndex = pickedOffset * 3;\n    let {indices} = chunk;\n\n    if (startIndex >= indices.length) {\n      return undefined;\n    }\n\n    // FIXME: compute closest vertex position.  For now just use first vertex.\n    let vertexIndex = indices[startIndex];\n\n    let values: string[] = [];\n    let attributeNames = this.displayState.attributeNames.value;\n    chunk.vertexData.vertexAttributes.forEach((attributes, i) => {\n      const attributeName = attributeNames[i];\n      if (attributeName !== undefined) {\n        values.push(`${attributeName}=${attributes[vertexIndex].toPrecision(6)}`);\n      }\n    });\n\n    return values.join(', ');\n  }\n}\n\nfunction getSingleMeshInfo(chunkManager: ChunkManager, parameters: SingleMeshSourceParameters) {\n  return chunkManager.memoize.getUncounted(\n      {type: 'single_mesh:getMeshInfo', parameters},\n      () => chunkManager.rpc!.promiseInvoke<SingleMeshInfo>(\n          GET_SINGLE_MESH_INFO_RPC_ID,\n          {'chunkManager': chunkManager.addCounterpartRef(), 'parameters': parameters}));\n}\n\nexport function getSingleMeshSource(\n    chunkManager: ChunkManager, parameters: SingleMeshSourceParameters) {\n  return getSingleMeshInfo(chunkManager, parameters)\n      .then(\n          info =>\n              chunkManager.getChunkSource(SingleMeshSource, {parameters: {...parameters, info}}));\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {UserLayer} from 'neuroglancer/layer';\nimport {LayerListSpecification, registerLayerType} from 'neuroglancer/layer_specification';\nimport {Overlay} from 'neuroglancer/overlay';\nimport {SingleMeshSourceParameters} from 'neuroglancer/single_mesh/base';\nimport {VertexAttributeInfo} from 'neuroglancer/single_mesh/base';\nimport {FRAGMENT_MAIN_START, getShaderAttributeType, getSingleMeshSource, SingleMeshDisplayState, SingleMeshLayer, SingleMeshSource, TrackableAttributeNames} from 'neuroglancer/single_mesh/frontend';\nimport {UserLayerWithCoordinateTransformMixin} from 'neuroglancer/user_layer_with_coordinate_transform';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {parseArray, verifyObjectProperty, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\nimport {ShaderCodeWidget} from 'neuroglancer/widget/shader_code_widget';\nimport {Tab} from 'neuroglancer/widget/tab_view';\n\nrequire('./single_mesh_user_layer.css');\n\nfunction makeValidIdentifier(x: string) {\n  return x.split(/[^a-zA-Z0-9]+/).filter(y => y).join('_');\n}\n\nfunction pickAttributeNames(existingNames: string[]) {\n  const seenNames = new Set<string>();\n  let result: string[] = [];\n  for (let existingName of existingNames) {\n    let name = makeValidIdentifier(existingName);\n    let suffix = '';\n    let suffixNumber = 0;\n    while (seenNames.has(name + suffix)) {\n      suffix = '' + (++suffixNumber);\n    }\n    result.push(name + suffix);\n  }\n  return result;\n}\n\nconst BaseUserLayer = UserLayerWithCoordinateTransformMixin(UserLayer);\n\nexport class SingleMeshUserLayer extends BaseUserLayer {\n  parameters: SingleMeshSourceParameters;\n  meshSource: SingleMeshSource|undefined;\n  displayState = new SingleMeshDisplayState();\n  userSpecifiedAttributeNames: (string|undefined)[]|undefined;\n  defaultAttributeNames: string[]|undefined;\n  constructor(public manager: LayerListSpecification, x: any) {\n    super(manager, x);\n    this.displayState.objectToDataTransform = this.transform;\n    this.parameters = {\n      meshSourceUrl: verifyObjectProperty(x, 'source', verifyString),\n      attributeSourceUrls: verifyObjectProperty(\n          x, 'vertexAttributeSources',\n          y => {\n            if (y !== undefined) {\n              return parseArray(y, verifyString);\n            } else {\n              return [];\n            }\n          }),\n    };\n    this.displayState.fragmentMain.restoreState(x['shader']);\n    this.userSpecifiedAttributeNames = verifyObjectProperty(x, 'vertexAttributeNames', y => {\n      if (y === undefined) {\n        return undefined;\n      }\n      return parseArray(y, z => {\n        let result = verifyOptionalString(z);\n        if (result) {\n          return result;\n        }\n        return undefined;\n      });\n    });\n    getSingleMeshSource(manager.chunkManager, this.parameters).then(source => {\n      if (this.wasDisposed) {\n        return;\n      }\n      this.meshSource = source;\n      const defaultAttributeNames = this.defaultAttributeNames =\n          pickAttributeNames(source.info.vertexAttributes.map(a => a.name));\n      const {userSpecifiedAttributeNames} = this;\n      let initialAttributeNames: (string|undefined)[];\n      if (userSpecifiedAttributeNames !== undefined &&\n          userSpecifiedAttributeNames.length === defaultAttributeNames.length) {\n        initialAttributeNames = userSpecifiedAttributeNames;\n        this.userSpecifiedAttributeNames = undefined;\n      } else {\n        initialAttributeNames = Array.from(defaultAttributeNames);\n      }\n      this.displayState.attributeNames.value = initialAttributeNames;\n      this.addRenderLayer(new SingleMeshLayer(source, this.displayState));\n      this.isReady = true;\n    });\n    this.registerDisposer(this.displayState.fragmentMain.changed.add(() => {\n      this.specificationChanged.dispatch();\n    }));\n    this.registerDisposer(this.displayState.attributeNames.changed.add(() => {\n      this.specificationChanged.dispatch();\n    }));\n    this.tabs.add(\n        'rendering', {label: 'Rendering', order: -100, getter: () => new DisplayOptionsTab(this)});\n    this.tabs.default = 'rendering';\n  }\n  toJSON() {\n    let x = super.toJSON();\n    x['type'] = 'mesh';\n    let {parameters} = this;\n    let {attributeSourceUrls} = parameters;\n    x['source'] = this.parameters.meshSourceUrl;\n    if (attributeSourceUrls) {\n      x['vertexAttributeSources'] = attributeSourceUrls;\n    }\n    x['shader'] = this.displayState.fragmentMain.toJSON();\n    let persistentAttributeNames: (string|undefined)[]|undefined = undefined;\n    if (this.meshSource === undefined) {\n      persistentAttributeNames = this.userSpecifiedAttributeNames;\n    } else {\n      const defaultAttributeNames = this.defaultAttributeNames!;\n      const attributeNames = this.displayState.attributeNames.value;\n      // Check if equal.\n      let equal = true;\n      const numAttributes = attributeNames.length;\n      for (let i = 0; i < numAttributes; ++i) {\n        if (attributeNames[i] !== defaultAttributeNames[i]) {\n          equal = false;\n          break;\n        }\n      }\n      if (equal) {\n        persistentAttributeNames = undefined;\n      } else {\n        persistentAttributeNames = Array.from(attributeNames);\n      }\n    }\n    x['vertexAttributeNames'] = persistentAttributeNames;\n    return x;\n  }\n}\n\nfunction makeShaderCodeWidget(layer: SingleMeshUserLayer) {\n  return new ShaderCodeWidget({\n    fragmentMain: layer.displayState.fragmentMain,\n    shaderError: layer.displayState.shaderError,\n    fragmentMainStartLine: FRAGMENT_MAIN_START,\n  });\n}\n\n/**\n * Time in milliseconds during which the input field must not be modified before the shader is\n * recompiled.\n */\nconst SHADER_UPDATE_DELAY = 500;\n\nclass VertexAttributeWidget extends RefCounted {\n  element = document.createElement('div');\n\n  attributeNameElements: HTMLInputElement[]|undefined;\n\n  private debouncedValueUpdater = debounce(() => {\n    this.updateAttributeNames();\n  }, SHADER_UPDATE_DELAY);\n\n  constructor(\n      public attributeNames: TrackableAttributeNames,\n      public getAttributeInfo: () => VertexAttributeInfo[] | undefined) {\n    super();\n    this.element.className = 'neuroglancer-single-mesh-attribute-widget';\n\n    this.updateInputElements();\n    this.registerDisposer(attributeNames.changed.add(() => {\n      this.updateInputElements();\n    }));\n  }\n\n  private updateInputElements() {\n    const attributeNames = this.attributeNames;\n    let {attributeNameElements} = this;\n    if (attributeNameElements === undefined) {\n      let attributeInfo = this.getAttributeInfo();\n      if (attributeInfo === undefined) {\n        return;\n      }\n      attributeNameElements = this.attributeNameElements = new Array<HTMLInputElement>();\n      let previousSource: string|undefined = undefined;\n      let numAttributes = attributeNames.value.length;\n      let {element} = this;\n      for (let i = 0; i < numAttributes; ++i) {\n        let info = attributeInfo[i];\n        let {source} = info;\n        if (source !== previousSource && source !== undefined) {\n          previousSource = source;\n          let div = document.createElement('div');\n          div.className = 'neuroglancer-single-mesh-source-header';\n          div.textContent = source;\n          element.appendChild(div);\n        }\n        let div = document.createElement('div');\n        div.className = 'neuroglancer-single-mesh-attribute';\n        let input = document.createElement('input');\n        input.title = info.name;\n        this.registerEventListener(input, 'input', this.debouncedValueUpdater);\n        input.type = 'text';\n        div.textContent = getShaderAttributeType(info);\n        div.appendChild(input);\n        if (info.min !== undefined && info.max !== undefined) {\n          let minMaxText = document.createElement('span');\n          minMaxText.className = 'neuroglancer-single-mesh-attribute-range';\n          minMaxText.textContent = `[${info.min.toPrecision(6)}, ${info.max.toPrecision(6)}]`;\n          div.appendChild(minMaxText);\n        }\n        attributeNameElements[i] = input;\n        element.appendChild(div);\n      }\n    }\n    const attributeNamesValue = attributeNames.value;\n    attributeNamesValue.forEach((name, i) => {\n      attributeNameElements![i].value = name || '';\n    });\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n  }\n\n  private updateAttributeNames() {\n    const attributeNames = this.attributeNames.value;\n    const attributeNameElements = this.attributeNameElements!;\n    let changed = false;\n    attributeNames.forEach((name, i) => {\n      let newName: string|undefined = attributeNameElements[i].value;\n      if (!newName) {\n        newName = undefined;\n      }\n      if (newName !== name) {\n        changed = true;\n        attributeNames[i] = newName;\n      }\n    });\n    if (changed) {\n      this.attributeNames.changed.dispatch();\n    }\n  }\n}\n\nfunction makeVertexAttributeWidget(layer: SingleMeshUserLayer) {\n  return new VertexAttributeWidget(\n      layer.displayState.attributeNames,\n      () => layer.meshSource && layer.meshSource.info.vertexAttributes);\n}\n\nclass DisplayOptionsTab extends Tab {\n  attributeWidget = this.registerDisposer(makeVertexAttributeWidget(this.layer));\n  codeWidget = this.registerDisposer(makeShaderCodeWidget(this.layer));\n  constructor(public layer: SingleMeshUserLayer) {\n    super();\n    const {element} = this;\n    element.classList.add('neuroglancer-single-mesh-dropdown');\n    let topRow = document.createElement('div');\n    topRow.className = 'neuroglancer-single-mesh-dropdown-top-row';\n    let spacer = document.createElement('div');\n    spacer.style.flex = '1';\n    let helpLink = document.createElement('a');\n    let helpButton = document.createElement('button');\n    helpButton.type = 'button';\n    helpButton.textContent = '?';\n    helpButton.className = 'help-link';\n    helpLink.appendChild(helpButton);\n    helpLink.title = 'Documentation on single mesh layer rendering';\n    helpLink.target = '_blank';\n    helpLink.href =\n        'https://github.com/google/neuroglancer/blob/master/src/neuroglancer/sliceview/image_layer_rendering.md';\n\n    let maximizeButton = document.createElement('button');\n    maximizeButton.innerHTML = '&square;';\n    maximizeButton.className = 'maximize-button';\n    maximizeButton.title = 'Show larger editor view';\n    this.registerEventListener(maximizeButton, 'click', () => {\n      new ShaderCodeOverlay(this.layer);\n    });\n\n    topRow.appendChild(spacer);\n    topRow.appendChild(maximizeButton);\n    topRow.appendChild(helpLink);\n\n    element.appendChild(topRow);\n    element.appendChild(this.attributeWidget.element);\n    element.appendChild(this.codeWidget.element);\n    this.codeWidget.textEditor.refresh();\n\n    this.visibility.changed.add(() => {\n      if (this.visible) {\n        this.codeWidget.textEditor.refresh();\n      }\n    });\n  }\n}\n\nclass ShaderCodeOverlay extends Overlay {\n  attributeWidget = this.registerDisposer(makeVertexAttributeWidget(this.layer));\n  codeWidget = this.registerDisposer(makeShaderCodeWidget(this.layer));\n  constructor(public layer: SingleMeshUserLayer) {\n    super();\n    this.content.classList.add('neuroglancer-single-mesh-layer-shader-overlay');\n    this.content.appendChild(this.attributeWidget.element);\n    this.content.appendChild(this.codeWidget.element);\n    this.codeWidget.textEditor.refresh();\n  }\n}\n\nregisterLayerType('mesh', SingleMeshUserLayer);\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CredentialsProvider, CredentialsWithGeneration, makeCredentialsGetter} from 'neuroglancer/credentials_provider';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {CANCELED, CancellationTokenSource, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {Owned} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {parseArray, verifyObject, verifyString} from 'neuroglancer/util/json';\nimport {getRandomHexString} from 'neuroglancer/util/random';\nimport {Signal} from 'neuroglancer/util/signal';\n\nexport const AUTH_SERVER = 'https://accounts.google.com/o/oauth2/auth';\n\nconst AUTH_ORIGIN = 'https://accounts.google.com';\n\nexport function embedRelayFrame(proxyName: string, rpcToken: string) {\n  let iframe = document.createElement('iframe');\n  iframe.style.display = 'none';\n  iframe.id = proxyName;\n  iframe.name = proxyName;\n  const origin = location.origin;\n  iframe.src = `https://accounts.google.com/o/oauth2/postmessageRelay?` +\n      `parent=${encodeURIComponent(origin)}#rpctoken=${rpcToken}`;\n  document.body.appendChild(iframe);\n}\n\n/**\n * OAuth2 Token\n */\nexport interface OAuth2Token {\n  accessToken: string;\n  expiresIn: string;\n  tokenType: string;\n  scope: string;\n}\n\nclass PendingRequest {\n  finished = new Signal<(token?: OAuth2Token, error?: any) => void>();\n}\n\nclass AuthHandler {\n  proxyName = `postmessageRelay${getRandomHexString()}`;\n  rpcToken = `${getRandomHexString()}`;\n  relayReadyService = `oauth2relayReady:${this.rpcToken}`;\n  oauth2CallbackService = `oauth2callback:${this.rpcToken}`;\n  relayReadyPromise: Promise<void>;\n  pendingRequests = new Map<string, PendingRequest>();\n\n  constructor() {\n    embedRelayFrame(this.proxyName, this.rpcToken);\n\n    this.relayReadyPromise = new Promise<void>((relayReadyPromiseResolve) => {\n      addEventListener('message', (event: MessageEvent) => {\n        if (event.origin !== AUTH_ORIGIN) {\n          return;\n        }\n        try {\n          let data = verifyObject(JSON.parse(event.data));\n          let service = verifyString(data['s']);\n          if (service === this.relayReadyService) {\n            relayReadyPromiseResolve();\n          }\n\n          if (service === this.oauth2CallbackService) {\n            let args = parseArray(data['a'], x => x);\n            let arg = verifyString(args[0]);\n            let origin = location.origin;\n            if (!arg.startsWith(origin + '#') && !arg.startsWith(origin + '?')) {\n              throw new Error(\n                  `oauth2callback: URL ${JSON.stringify(arg)} ` +\n                  `does not match current origin ${origin}.`);\n            }\n            let hashPart = arg.substring(origin.length + 1);\n            let parts = hashPart.split('&');\n            let params = new Map<string, string>();\n            for (let part of parts) {\n              let match = part.match('^([a-z_]+)=(.*)$');\n              if (match === null) {\n                throw new Error(\n                    `oauth2callback: URL part ${JSON.stringify(match)} ` +\n                    `does not match expected pattern.`);\n              }\n              params.set(match[1], match[2]);\n            }\n            let state = params.get('state');\n            if (state === undefined) {\n              throw new Error(`oauth2callback: State argument is missing.`);\n            }\n            let request = this.pendingRequests.get(state);\n            if (request === undefined) {\n              // Request may have been cancelled.\n              return;\n            }\n            let error = params.get('error');\n            if (error !== undefined) {\n              let errorSubtype = params.get('error_subtype');\n              let fullMessage = error;\n              if (errorSubtype !== undefined) {\n                fullMessage += ': ' + errorSubtype;\n              }\n              request.finished.dispatch(\n                  undefined, new Error(`Error obtaining Google OAuth2 token: ${fullMessage}`));\n              return;\n            }\n            let accessToken = params.get('access_token');\n            let tokenType = params.get('token_type');\n            let expiresIn = params.get('expires_in');\n            let scope = params.get('scope');\n            if (accessToken === undefined || tokenType === undefined || expiresIn === undefined ||\n                scope === undefined) {\n              throw new Error(`oauth2callback: URL lacks expected parameters.`);\n            }\n            request.finished.dispatch({\n              accessToken: accessToken,\n              tokenType: tokenType,\n              expiresIn: expiresIn,\n              scope: scope\n            });\n            return;\n          }\n        } catch (parseError) {\n          throw new Error(\n              `Invalid message received from ${AUTH_ORIGIN}: ${JSON.stringify(event.data)}: ` +\n              `${parseError.message}.`);\n        }\n      });\n    });\n  }\n\n  addPendingRequest(state: string) {\n    let request = new PendingRequest();\n    this.pendingRequests.set(state, request);\n    request.finished.add(() => {\n      this.pendingRequests.delete(state);\n    });\n    return request;\n  }\n\n  makeAuthRequestUrl(options: {\n    clientId: string,\n    scopes: string[],\n    approvalPrompt?: 'force'|'auto',\n    state?: string,\n    origin?: string,\n    loginHint?: string,\n    authUser?: number,\n    immediate?: boolean\n  }) {\n    let url = `${AUTH_SERVER}?client_id=${encodeURIComponent(options.clientId)}`;\n    url += `&redirect_uri=postmessage`;\n    url += `&response_type=token`;\n    let {origin = location.origin} = options;\n    url += `&origin=${encodeURIComponent(origin)}`;\n    url += `&proxy=${this.proxyName}`;\n    url += `&include_granted_scopes=true`;\n    url += `&scope=${encodeURIComponent(options.scopes.join(' '))}`;\n    if (options.state) {\n      url += `&state=${options.state}`;\n    }\n    if (options.approvalPrompt) {\n      url += `&approval_prompt=${encodeURIComponent(options.approvalPrompt)}`;\n    }\n    if (options.loginHint) {\n      url += `&login_hint=${encodeURIComponent(options.loginHint)}`;\n    }\n    if (options.immediate) {\n      url += `&immediate=true`;\n    }\n    if (options.authUser !== undefined) {\n      url += `&authuser=${options.authUser}`;\n    }\n    return url;\n  }\n}\n\n\nlet authHandlerInstance: AuthHandler;\n\nfunction authHandler() {\n  if (authHandlerInstance === undefined) {\n    authHandlerInstance = new AuthHandler();\n  }\n  return authHandlerInstance;\n}\n\n/**\n * Obtain a Google OAuth2 authentication token.\n * @return A Promise that resolves to an authentication token.\n */\nexport function authenticateGoogleOAuth2(\n    options: {\n      clientId: string,\n      scopes: string[],\n      approvalPrompt?: 'force'|'auto',\n      loginHint?: string,\n      immediate?: boolean,\n      authUser?: number,\n    },\n    cancellationToken = uncancelableToken) {\n  const state = getRandomHexString();\n  const handler = authHandler();\n  const url = handler.makeAuthRequestUrl({\n    state,\n    clientId: options.clientId,\n    scopes: options.scopes,\n    approvalPrompt: options.approvalPrompt,\n    loginHint: options.loginHint,\n    immediate: options.immediate,\n    authUser: options.authUser,\n  });\n  const request = handler.addPendingRequest(state);\n  const promise = new Promise<OAuth2Token>((resolve, reject) => {\n    request.finished.add((token, error) => {\n      if (token !== undefined) {\n        resolve(token);\n      } else {\n        reject(error);\n      }\n    });\n  });\n  request.finished.add(cancellationToken.add(() => {\n    request.finished.dispatch(undefined, CANCELED);\n  }));\n  if (options.immediate) {\n    // For immediate mode auth, we can wait until the relay is ready, since we aren't opening a new\n    // window.\n    handler.relayReadyPromise.then(() => {\n      if (cancellationToken.isCanceled) {\n        return;\n      }\n      const iframe = document.createElement('iframe');\n      iframe.src = url;\n      iframe.style.display = 'none';\n      document.body.appendChild(iframe);\n      request.finished.add(() => {\n        removeFromParent(iframe);\n      });\n    });\n  } else {\n    if (!cancellationToken.isCanceled) {\n      const newWindow = open(url);\n      if (newWindow !== null) {\n        request.finished.add(() => {\n          newWindow.close();\n        });\n      }\n    }\n  }\n  return promise;\n}\n\nexport class GoogleOAuth2CredentialsProvider extends CredentialsProvider<OAuth2Token> {\n  constructor(public options: {clientId: string, scopes: string[], description: string}) {\n    super();\n  }\n\n  get = makeCredentialsGetter(cancellationToken => {\n    const {options} = this;\n    const status = new StatusMessage(/*delay=*/ true);\n    let cancellationSource: CancellationTokenSource|undefined;\n    return new Promise<OAuth2Token>((resolve, reject) => {\n      const dispose = () => {\n        cancellationSource = undefined;\n        status.dispose();\n      };\n      cancellationToken.add(() => {\n        if (cancellationSource !== undefined) {\n          cancellationSource.cancel();\n          cancellationSource = undefined;\n          status.dispose();\n          reject(CANCELED);\n        }\n      });\n      function writeLoginStatus(\n          msg = `${options.description} authorization required.`,\n          linkMessage = 'Request authorization.') {\n        status.setText(msg + '  ');\n        let button = document.createElement('button');\n        button.textContent = linkMessage;\n        status.element.appendChild(button);\n        button.addEventListener('click', () => {\n          login(/*immediate=*/ false);\n        });\n        status.setVisible(true);\n      }\n      function login(immediate: boolean) {\n        if (cancellationSource !== undefined) {\n          cancellationSource.cancel();\n        }\n        cancellationSource = new CancellationTokenSource();\n        writeLoginStatus(`Waiting for ${options.description} authorization...`, 'Retry');\n        authenticateGoogleOAuth2(\n            {\n              clientId: options.clientId,\n              scopes: options.scopes,\n              immediate: immediate,\n              authUser: 0,\n            },\n            cancellationSource)\n            .then(\n                token => {\n                  if (cancellationSource !== undefined) {\n                    dispose();\n                    resolve(token);\n                  }\n                },\n                reason => {\n                  if (cancellationSource !== undefined) {\n                    cancellationSource = undefined;\n                    if (immediate) {\n                      writeLoginStatus();\n                    } else {\n                      writeLoginStatus(\n                          `${options.description} authorization failed: ${reason}.`, 'Retry');\n                    }\n                  }\n                });\n      }\n      login(/*immediate=*/ true);\n    });\n  });\n}\n\nexport function fetchWithGoogleCredentials(\n    credentialsProvider: Owned<CredentialsProvider<OAuth2Token>>, input: string|Request,\n    init: RequestInit = {}): Promise<Response> {\n  function start(credentials: CredentialsWithGeneration<OAuth2Token>): Promise<Response> {\n    const token = credentials.credentials;\n    const headers = new Headers(init.headers);\n    headers.append('Authorization', `${token.tokenType} ${token.accessToken}`);\n    return fetch(input, {...init, mode: 'cors', headers}).then(response => {\n      if (response.status === 401) {\n        // 401: Authorization needed.  OAuth2 token may have expired.\n        return credentialsProvider.get(credentials).then(start);\n      }\n      return response;\n    });\n  }\n  const promise = credentialsProvider.get(/*invalidToken=*/ undefined).then(start);\n  const disposeRef = () => {\n    credentialsProvider.dispose();\n  };\n  promise.then(disposeRef, disposeRef);\n  return promise;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file This implements a Brain Maps CredentialsProvider based on neuroglancer/util/google_auth2.\n */\n\nimport {GoogleOAuth2CredentialsProvider} from 'neuroglancer/util/google_oauth2';\n\ndeclare var BRAINMAPS_CLIENT_ID: string;\nconst BRAINMAPS_SCOPE = 'https://www.googleapis.com/auth/brainmaps';\n\nexport class BrainmapsCredentialsProvider extends GoogleOAuth2CredentialsProvider {\n  constructor() {\n    super({clientId: BRAINMAPS_CLIENT_ID, scopes: [BRAINMAPS_SCOPE], description: 'Brain Maps'});\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {defaultCredentialsManager} from 'neuroglancer/credentials_provider/default_manager';\nimport {credentialsKey} from 'neuroglancer/datasource/brainmaps/api';\nimport {BrainmapsCredentialsProvider} from 'neuroglancer/datasource/brainmaps/credentials_provider';\n\ndefaultCredentialsManager.register(credentialsKey, () => new BrainmapsCredentialsProvider());\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {verifyEnumString, verifyString} from 'neuroglancer/util/json';\n\nexport enum BLEND_MODES {\n  DEFAULT = 0,\n  ADDITIVE = 1\n}\n\nexport const BLEND_FUNCTIONS = new Map<BLEND_MODES, Function>();\nBLEND_FUNCTIONS.set(BLEND_MODES.DEFAULT, (gl: WebGL2RenderingContext) => {\n  gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n});\nBLEND_FUNCTIONS.set(BLEND_MODES.ADDITIVE, (gl: WebGL2RenderingContext) => {\n  gl.blendFunc(gl.SRC_ALPHA, gl.ONE);\n});\n\nexport type TrackableBlendModeValue = TrackableValue<string>;\n\nfunction blendModeValidator(obj: any): string {\n  if (verifyEnumString(obj, BLEND_MODES)) {\n    return verifyString(obj);\n  } else {\n    throw new Error();\n  }\n}\n\nexport function trackableBlendModeValue(initialValue = 'default') {\n  return new TrackableValue<string>(initialValue, blendModeValidator);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SliceView} from 'neuroglancer/sliceview/frontend';\nimport {MultiscaleVolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {RenderLayer, RenderLayerOptions} from 'neuroglancer/sliceview/volume/renderlayer';\nimport {TrackableAlphaValue, trackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {BLEND_FUNCTIONS, BLEND_MODES, TrackableBlendModeValue, trackableBlendModeValue} from 'neuroglancer/trackable_blend';\nimport {verifyEnumString} from 'neuroglancer/util/json';\nimport glsl_COLORMAPS from 'neuroglancer/webgl/colormaps.glsl';\nimport {makeTrackableFragmentMain, TrackableFragmentMain} from 'neuroglancer/webgl/dynamic_shader';\nimport {ShaderBuilder} from 'neuroglancer/webgl/shader';\n\nexport const FRAGMENT_MAIN_START = '//NEUROGLANCER_IMAGE_RENDERLAYER_FRAGMENT_MAIN_START';\n\nconst DEFAULT_FRAGMENT_MAIN = `void main() {\n  emitGrayscale(toNormalized(getDataValue()));\n}\n`;\n\n\nexport function getTrackableFragmentMain(value = DEFAULT_FRAGMENT_MAIN) {\n  return makeTrackableFragmentMain(value);\n}\n\nexport interface ImageRenderLayerOptions extends RenderLayerOptions {\n  opacity: TrackableAlphaValue;\n  blendMode: TrackableBlendModeValue;\n  fragmentMain: TrackableFragmentMain;\n}\n\nexport class ImageRenderLayer extends RenderLayer {\n  fragmentMain: TrackableFragmentMain;\n  opacity: TrackableAlphaValue;\n  blendMode: TrackableBlendModeValue;\n  constructor(multiscaleSource: MultiscaleVolumeChunkSource, options: ImageRenderLayerOptions) {\n    super(multiscaleSource, options);\n    const {\n      opacity = trackableAlphaValue(0.5),\n      blendMode = trackableBlendModeValue(),\n      fragmentMain = getTrackableFragmentMain(),\n    } = options;\n    this.fragmentMain = fragmentMain;\n    this.opacity = opacity;\n    this.blendMode = blendMode;\n    this.registerDisposer(opacity.changed.add(() => {\n      this.redrawNeeded.dispatch();\n    }));\n    this.registerDisposer(fragmentMain.changed.add(() => {\n      this.shaderGetter.invalidateShader();\n      this.redrawNeeded.dispatch();\n    }));\n  }\n\n  protected getShaderKey() {\n    return `volume.ImageRenderLayer:${JSON.stringify(this.fragmentMain.value)}`;\n  }\n\n  protected defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    builder.addUniform('highp float', 'uOpacity');\n    builder.addFragmentCode(`\nvoid emitRGBA(vec4 rgba) {\n  emit(vec4(rgba.rgb, rgba.a * uOpacity));\n}\nvoid emitRGB(vec3 rgb) {\n  emit(vec4(rgb, uOpacity));\n}\nvoid emitGrayscale(float value) {\n  emit(vec4(value, value, value, uOpacity));\n}\nvoid emitTransparent() {\n  emit(vec4(0.0, 0.0, 0.0, 0.0));\n}\n`);\n    builder.addFragmentCode(glsl_COLORMAPS);\n    builder.setFragmentMainFunction(FRAGMENT_MAIN_START + '\\n' + this.fragmentMain.value);\n  }\n\n  beginSlice(sliceView: SliceView) {\n    let shader = super.beginSlice(sliceView);\n    if (shader === undefined) {\n      return undefined;\n    }\n    let {gl} = this;\n    gl.uniform1f(shader.uniform('uOpacity'), this.opacity.value);\n    return shader;\n  }\n\n  setGLBlendMode(gl: WebGL2RenderingContext, renderLayerNum: number) {\n    let blendModeValue = verifyEnumString(this.blendMode.value, BLEND_MODES);\n    if (blendModeValue === BLEND_MODES.ADDITIVE || renderLayerNum > 0) {\n      gl.enable(gl.BLEND);\n      BLEND_FUNCTIONS.get(blendModeValue)!(gl);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {UserLayer} from 'neuroglancer/layer';\nimport {LayerListSpecification, registerLayerType, registerVolumeLayerType} from 'neuroglancer/layer_specification';\nimport {Overlay} from 'neuroglancer/overlay';\nimport {VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {FRAGMENT_MAIN_START, getTrackableFragmentMain, ImageRenderLayer} from 'neuroglancer/sliceview/volume/image_renderlayer';\nimport {trackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {trackableBlendModeValue} from 'neuroglancer/trackable_blend';\nimport {UserLayerWithVolumeSourceMixin} from 'neuroglancer/user_layer_with_volume_source';\nimport {makeWatchableShaderError} from 'neuroglancer/webgl/dynamic_shader';\nimport {RangeWidget} from 'neuroglancer/widget/range';\nimport {RenderScaleWidget} from 'neuroglancer/widget/render_scale_widget';\nimport {ShaderCodeWidget} from 'neuroglancer/widget/shader_code_widget';\nimport {Tab} from 'neuroglancer/widget/tab_view';\n\nrequire('./image_user_layer.css');\nrequire('neuroglancer/maximize_button.css');\n\nconst OPACITY_JSON_KEY = 'opacity';\nconst BLEND_JSON_KEY = 'blend';\nconst SHADER_JSON_KEY = 'shader';\n\nconst Base = UserLayerWithVolumeSourceMixin(UserLayer);\nexport class ImageUserLayer extends Base {\n  opacity = trackableAlphaValue(0.5);\n  blendMode = trackableBlendModeValue();\n  fragmentMain = getTrackableFragmentMain();\n  shaderError = makeWatchableShaderError();\n  renderLayer: ImageRenderLayer;\n  constructor(manager: LayerListSpecification, x: any) {\n    super(manager, x);\n    this.registerDisposer(this.fragmentMain.changed.add(this.specificationChanged.dispatch));\n    this.tabs.add(\n        'rendering',\n        {label: 'Rendering', order: -100, getter: () => new RenderingOptionsTab(this)});\n    this.tabs.default = 'rendering';\n  }\n\n  restoreState(specification: any) {\n    super.restoreState(specification);\n    this.opacity.restoreState(specification[OPACITY_JSON_KEY]);\n    this.blendMode.restoreState(specification[BLEND_JSON_KEY]);\n    this.fragmentMain.restoreState(specification[SHADER_JSON_KEY]);\n    const {multiscaleSource} = this;\n    if (multiscaleSource === undefined) {\n      throw new Error(`source property must be specified`);\n    }\n    multiscaleSource.then(volume => {\n      if (!this.wasDisposed) {\n        let renderLayer = this.renderLayer = new ImageRenderLayer(volume, {\n          opacity: this.opacity,\n          blendMode: this.blendMode,\n          fragmentMain: this.fragmentMain,\n          shaderError: this.shaderError,\n          transform: this.transform,\n          renderScaleTarget: this.sliceViewRenderScaleTarget,\n          renderScaleHistogram: this.sliceViewRenderScaleHistogram,\n        });\n        this.addRenderLayer(renderLayer);\n        this.shaderError.changed.dispatch();\n        this.isReady = true;\n      }\n    });\n  }\n  toJSON() {\n    const x = super.toJSON();\n    x['type'] = 'image';\n    x[OPACITY_JSON_KEY] = this.opacity.toJSON();\n    x[BLEND_JSON_KEY] = this.blendMode.toJSON();\n    x[SHADER_JSON_KEY] = this.fragmentMain.toJSON();\n    return x;\n  }\n}\n\nfunction makeShaderCodeWidget(layer: ImageUserLayer) {\n  return new ShaderCodeWidget({\n    shaderError: layer.shaderError,\n    fragmentMain: layer.fragmentMain,\n    fragmentMainStartLine: FRAGMENT_MAIN_START,\n  });\n}\n\nclass RenderingOptionsTab extends Tab {\n  opacityWidget = this.registerDisposer(new RangeWidget(this.layer.opacity));\n  codeWidget = this.registerDisposer(makeShaderCodeWidget(this.layer));\n  constructor(public layer: ImageUserLayer) {\n    super();\n    const {element} = this;\n    element.classList.add('image-dropdown');\n    let {opacityWidget} = this;\n    let topRow = document.createElement('div');\n    topRow.className = 'image-dropdown-top-row';\n    opacityWidget.promptElement.textContent = 'Opacity';\n\n    {\n      const renderScaleWidget = this.registerDisposer(new RenderScaleWidget(\n          this.layer.sliceViewRenderScaleHistogram, this.layer.sliceViewRenderScaleTarget));\n      renderScaleWidget.label.textContent = 'Resolution (slice)';\n      element.appendChild(renderScaleWidget.element);\n    }\n\n    let spacer = document.createElement('div');\n    spacer.style.flex = '1';\n    let helpLink = document.createElement('a');\n    let helpButton = document.createElement('button');\n    helpButton.type = 'button';\n    helpButton.textContent = '?';\n    helpButton.className = 'help-link';\n    helpLink.appendChild(helpButton);\n    helpLink.title = 'Documentation on image layer rendering';\n    helpLink.target = '_blank';\n    helpLink.href =\n        'https://github.com/google/neuroglancer/blob/master/src/neuroglancer/sliceview/image_layer_rendering.md';\n\n    let maximizeButton = document.createElement('button');\n    maximizeButton.innerHTML = '&square;';\n    maximizeButton.className = 'maximize-button';\n    maximizeButton.title = 'Show larger editor view';\n    this.registerEventListener(maximizeButton, 'click', () => {\n      new ShaderCodeOverlay(this.layer);\n    });\n\n    topRow.appendChild(this.opacityWidget.element);\n    topRow.appendChild(spacer);\n    topRow.appendChild(maximizeButton);\n    topRow.appendChild(helpLink);\n\n    element.appendChild(topRow);\n    element.appendChild(this.codeWidget.element);\n    this.codeWidget.textEditor.refresh();\n    this.visibility.changed.add(() => {\n      if (this.visible) {\n        this.codeWidget.textEditor.refresh();\n      }\n    });\n  }\n}\n\nclass ShaderCodeOverlay extends Overlay {\n  codeWidget = this.registerDisposer(makeShaderCodeWidget(this.layer));\n  constructor(public layer: ImageUserLayer) {\n    super();\n    this.content.classList.add('image-layer-shader-overlay');\n    this.content.appendChild(this.codeWidget.element);\n    this.codeWidget.textEditor.refresh();\n  }\n}\n\nregisterLayerType('image', ImageUserLayer);\nregisterVolumeLayerType(VolumeType.IMAGE, ImageUserLayer);\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * This implements a CredentialsProvider based on Keycloak.\n * The current implementation uses the implicit flow for ease of implementation.\n * TODO: Implement the authorization or hybrid flows.\n * TODO: Use an iframe to test for immediate login (active session).\n */\n\nimport {CredentialsProvider, makeCredentialsGetter} from 'neuroglancer/credentials_provider';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {CANCELED, CancellationTokenSource, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {verifyObject, verifyString} from 'neuroglancer/util/json';\nimport {getRandomHexString} from 'neuroglancer/util/random';\nimport {Signal} from 'neuroglancer/util/signal';\n\nexport type BossToken = string;\n\nclass PendingRequest {\n  finished = new Signal<(token?: BossToken, error?: any) => void>();\n}\n\nclass AuthHandler {\n  oidcCallbackService = `bossAuthCallback`;\n  relayReadyPromise: Promise<void>;\n  pendingRequests = new Map<string, PendingRequest>();\n\n  constructor() {\n    this.registerListener();\n  }\n\n  registerListener() {\n    addEventListener('message', (event: MessageEvent) => {\n      if (event.origin !== location.origin) {\n        // Ignore messages from different origins.\n        return;\n      }\n      try {\n        let data = verifyObject(JSON.parse(event.data));\n        let service = verifyString(data['service']);\n        if (service === this.oidcCallbackService) {\n          let accessToken = verifyString(data['access_token']);\n          let state = verifyString(data['state']);\n          let request = this.pendingRequests.get(state);\n          if (request === undefined) {\n            // Request may have been cancelled.\n            return;\n          }\n          request.finished.dispatch(accessToken);\n        }\n      } catch (parseError) {\n        // Ignore invalid message.\n      }\n    });\n  }\n\n  addPendingRequest(state: string) {\n    let request = new PendingRequest();\n    this.pendingRequests.set(state, request);\n    request.finished.add(() => {\n      this.pendingRequests.delete(state);\n    });\n    return request;\n  }\n\n  makeAuthRequestUrl(options: {\n    authServer: string,\n    clientId: string,\n    redirect_uri: string,\n    state?: string,\n    nonce?: string\n  }) {\n    let url = `${options.authServer}/realms/BOSS/protocol/openid-connect/auth?`;\n    url += `client_id=${encodeURIComponent(options.clientId)}`;\n    url += `&redirect_uri=${encodeURIComponent(options.redirect_uri)}`;\n    url += `&response_mode=fragment`;\n    url += `&response_type=code%20id_token%20token`;\n    if (options.state) {\n      url += `&state=${options.state}`;\n    }\n    if (options.nonce) {\n      url += `&nonce=${options.nonce}`;\n    }\n    return url;\n  }\n}\n\nlet authHandlerInstance: AuthHandler;\n\nfunction authHandler() {\n  if (authHandlerInstance === undefined) {\n    authHandlerInstance = new AuthHandler();\n  }\n  return authHandlerInstance;\n}\n\n\n/**\n * Obtain a Keycloak OIDC authentication token.\n * @return A Promise that resolves to an authentication token.\n */\nexport function authenticateKeycloakOIDC(\n    options: {realm: string, clientId: string, authServer: string},\n    cancellationToken = uncancelableToken) {\n  const state = getRandomHexString();\n  const nonce = getRandomHexString();\n  const handler = authHandler();\n  const url = handler.makeAuthRequestUrl({\n    state: state,\n    clientId: options.clientId,\n    redirect_uri: new URL('bossauth.html', window.location.href).href,\n    authServer: options.authServer,\n    nonce: nonce\n  });\n  const request = handler.addPendingRequest(state);\n  const promise = new Promise<BossToken>((resolve, reject) => {\n    request.finished.add((token: string, error: string) => {\n      if (token !== undefined) {\n        resolve(token);\n      } else {\n        reject(error);\n      }\n    });\n  });\n  request.finished.add(cancellationToken.add(() => {\n    request.finished.dispatch(undefined, CANCELED);\n  }));\n  if (!cancellationToken.isCanceled) {\n    const newWindow = open(url);\n    if (newWindow !== null) {\n      request.finished.add(() => {\n        newWindow.close();\n      });\n    }\n  }\n  return promise;\n}\n\n\n\nexport class BossCredentialsProvider extends CredentialsProvider<BossToken> {\n  constructor(public authServer: string) {\n    super();\n  }\n\n  get = makeCredentialsGetter(cancellationToken => {\n    const status = new StatusMessage(/*delay=*/true);\n    let cancellationSource: CancellationTokenSource|undefined;\n    return new Promise<BossToken>((resolve, reject) => {\n      const dispose = () => {\n        cancellationSource = undefined;\n        status.dispose();\n      };\n      cancellationToken.add(() => {\n        if (cancellationSource !== undefined) {\n          cancellationSource.cancel();\n          cancellationSource = undefined;\n          status.dispose();\n          reject(CANCELED);\n        }\n      });\n      function writeLoginStatus(\n          msg = 'Boss authorization required.', linkMessage = 'Request authorization.') {\n        status.setText(msg + ' ');\n        let button = document.createElement('button');\n        button.textContent = linkMessage;\n        status.element.appendChild(button);\n        button.addEventListener('click', () => {\n          login();\n        });\n        status.setVisible(true);\n      }\n      let authServer = this.authServer;\n      function login() {\n        if (cancellationSource !== undefined) {\n          cancellationSource.cancel();\n        }\n        cancellationSource = new CancellationTokenSource();\n        writeLoginStatus('Waiting for Boss authorization...', 'Retry');\n        authenticateKeycloakOIDC(\n            {realm: 'boss', clientId: 'endpoint', authServer: authServer}, cancellationSource)\n            .then(\n                token => {\n                  if (cancellationSource !== undefined) {\n                    dispose();\n                    resolve(token);\n                  }\n                },\n                reason => {\n                  if (cancellationSource !== undefined) {\n                    cancellationSource = undefined;\n                    writeLoginStatus(`Boss authorization failed: ${reason}.`, 'Retry');\n                  }\n                });\n      }\n      writeLoginStatus();\n    });\n  });\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {defaultCredentialsManager} from 'neuroglancer/credentials_provider/default_manager';\nimport {credentialsKey} from 'neuroglancer/datasource/boss/api';\nimport {BossCredentialsProvider} from 'neuroglancer/datasource/boss/credentials_provider';\n\ndefaultCredentialsManager.register(\n    credentialsKey, (authServer) => new BossCredentialsProvider(authServer));\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {LayerReference} from 'neuroglancer/layer';\nimport {Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren} from 'neuroglancer/util/dom';\n\nexport class LayerReferenceWidget extends RefCounted {\n  element = document.createElement('label');\n  private selectElement = document.createElement('select');\n  constructor(public ref: Owned<LayerReference>) {\n    super();\n    this.registerDisposer(ref);\n    const {element, selectElement} = this;\n    element.appendChild(selectElement);\n\n    this.updateView();\n    this.registerEventListener(selectElement, 'change', () => this.updateModel());\n    this.registerDisposer(this.ref.changed.add(debounce(() => this.updateView(), 0)));\n  }\n\n  private updateModel() {\n    this.ref.layerName = this.selectElement.value || undefined;\n  }\n\n  private updateView() {\n    const {selectElement, ref} = this;\n    const {filter} = ref;\n    removeChildren(selectElement);\n    const emptyOption = document.createElement('option');\n    selectElement.appendChild(emptyOption);\n    for (const layer of this.ref.layerManager.managedLayers) {\n      if (filter(layer)) {\n        const option = document.createElement('option');\n        const {name} = layer;\n        option.textContent = name;\n        option.value = name;\n        selectElement.appendChild(option);\n      }\n    }\n    selectElement.value = ref.layerName || '';\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationType, LocalAnnotationSource} from 'neuroglancer/annotation';\nimport {AnnotationLayerState} from 'neuroglancer/annotation/frontend';\nimport {CoordinateTransform, makeDerivedCoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {LayerReference, ManagedUserLayer, UserLayer} from 'neuroglancer/layer';\nimport {LayerListSpecification, registerLayerType} from 'neuroglancer/layer_specification';\nimport {VoxelSize} from 'neuroglancer/navigation_state';\nimport {SegmentationDisplayState} from 'neuroglancer/segmentation_display_state/frontend';\nimport {SegmentationUserLayer} from 'neuroglancer/segmentation_user_layer';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {ElementVisibilityFromTrackableBoolean, TrackableBoolean, TrackableBooleanCheckbox} from 'neuroglancer/trackable_boolean';\nimport {makeDerivedWatchableValue, WatchableValue} from 'neuroglancer/trackable_value';\nimport {AnnotationLayerView, getAnnotationRenderOptions, UserLayerWithAnnotationsMixin} from 'neuroglancer/ui/annotations';\nimport {UserLayerWithCoordinateTransformMixin} from 'neuroglancer/user_layer_with_coordinate_transform';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {parseArray, verify3dVec} from 'neuroglancer/util/json';\nimport {LayerReferenceWidget} from 'neuroglancer/widget/layer_reference';\n\nrequire('./user_layer.css');\n\nconst POINTS_JSON_KEY = 'points';\nconst ANNOTATIONS_JSON_KEY = 'annotations';\n\nfunction addPointAnnotations(annotations: LocalAnnotationSource, obj: any) {\n  if (obj === undefined) {\n    return;\n  }\n  parseArray(obj, (x, i) => {\n    annotations.add({\n      type: AnnotationType.POINT,\n      id: '' + i,\n      point: verify3dVec(x),\n    });\n  });\n}\n\nfunction isValidLinkedSegmentationLayer(layer: ManagedUserLayer) {\n  const userLayer = layer.layer;\n  if (userLayer === null) {\n    return true;\n  }\n  if (userLayer instanceof SegmentationUserLayer) {\n    return true;\n  }\n  return false;\n}\n\nfunction getSegmentationDisplayState(layer: ManagedUserLayer|undefined): SegmentationDisplayState|\n    undefined {\n  if (layer === undefined) {\n    return undefined;\n  }\n  const userLayer = layer.layer;\n  if (userLayer === null) {\n    return undefined;\n  }\n  if (!(userLayer instanceof SegmentationUserLayer)) {\n    return undefined;\n  }\n  return userLayer.displayState;\n}\n\nconst VOXEL_SIZE_JSON_KEY = 'voxelSize';\nconst SOURCE_JSON_KEY = 'source';\nconst LINKED_SEGMENTATION_LAYER_JSON_KEY = 'linkedSegmentationLayer';\nconst FILTER_BY_SEGMENTATION_JSON_KEY = 'filterBySegmentation';\nconst Base = UserLayerWithAnnotationsMixin(UserLayerWithCoordinateTransformMixin(UserLayer));\nexport class AnnotationUserLayer extends Base {\n  localAnnotations = this.registerDisposer(new LocalAnnotationSource());\n  voxelSize = new VoxelSize();\n  sourceUrl: string|undefined;\n  linkedSegmentationLayer = this.registerDisposer(\n      new LayerReference(this.manager.rootLayers.addRef(), isValidLinkedSegmentationLayer));\n  filterBySegmentation = new TrackableBoolean(false);\n\n  getAnnotationRenderOptions() {\n    const segmentationState =\n        new WatchableValue<SegmentationDisplayState|undefined|null>(undefined);\n    const setSegmentationState = () => {\n      const {linkedSegmentationLayer} = this;\n      if (linkedSegmentationLayer.layerName === undefined) {\n        segmentationState.value = null;\n      } else {\n        const {layer} = linkedSegmentationLayer;\n        segmentationState.value = getSegmentationDisplayState(layer);\n      }\n    };\n    this.registerDisposer(this.linkedSegmentationLayer.changed.add(setSegmentationState));\n    setSegmentationState();\n    return {\n      segmentationState,\n      filterBySegmentation: this.filterBySegmentation,\n      ...getAnnotationRenderOptions(this)\n    };\n  }\n\n  constructor(manager: LayerListSpecification, specification: any) {\n    super(manager, specification);\n    const sourceUrl = this.sourceUrl = specification[SOURCE_JSON_KEY];\n    this.linkedSegmentationLayer.restoreState(specification[LINKED_SEGMENTATION_LAYER_JSON_KEY]);\n    this.filterBySegmentation.restoreState(specification[FILTER_BY_SEGMENTATION_JSON_KEY]);\n    if (sourceUrl === undefined) {\n      this.isReady = true;\n      this.voxelSize.restoreState(specification[VOXEL_SIZE_JSON_KEY]);\n      this.localAnnotations.restoreState(specification[ANNOTATIONS_JSON_KEY]);\n      // Handle legacy \"points\" property.\n      addPointAnnotations(this.localAnnotations, specification[POINTS_JSON_KEY]);\n      let voxelSizeValid = false;\n      const handleVoxelSizeChanged = () => {\n        if (!this.voxelSize.valid && manager.voxelSize.valid) {\n          vec3.copy(this.voxelSize.size, manager.voxelSize.size);\n          this.voxelSize.setValid();\n        }\n        if (this.voxelSize.valid && voxelSizeValid === false) {\n          const derivedTransform = new CoordinateTransform();\n          this.registerDisposer(\n              makeDerivedCoordinateTransform(derivedTransform, this.transform, (output, input) => {\n                const voxelScalingMatrix = mat4.fromScaling(mat4.create(), this.voxelSize.size);\n                mat4.multiply(output, input, voxelScalingMatrix);\n              }));\n          this.annotationLayerState.value = new AnnotationLayerState({\n            transform: derivedTransform,\n            source: this.localAnnotations.addRef(),\n            ...this.getAnnotationRenderOptions()\n          });\n          voxelSizeValid = true;\n        }\n      };\n      this.registerDisposer(this.localAnnotations.changed.add(this.specificationChanged.dispatch));\n      this.registerDisposer(this.voxelSize.changed.add(this.specificationChanged.dispatch));\n      this.registerDisposer(\n          this.filterBySegmentation.changed.add(this.specificationChanged.dispatch));\n      this.registerDisposer(this.voxelSize.changed.add(handleVoxelSizeChanged));\n      this.registerDisposer(this.manager.voxelSize.changed.add(handleVoxelSizeChanged));\n      handleVoxelSizeChanged();\n    } else {\n      StatusMessage\n          .forPromise(\n              this.manager.dataSourceProvider.getAnnotationSource(\n                  this.manager.chunkManager, sourceUrl),\n              {\n                initialMessage: `Retrieving metadata for volume ${sourceUrl}.`,\n                delay: true,\n                errorPrefix: `Error retrieving metadata for volume ${sourceUrl}: `,\n              })\n          .then(source => {\n            if (this.wasDisposed) {\n              return;\n            }\n            this.annotationLayerState.value = new AnnotationLayerState(\n                {transform: this.transform, source, ...this.getAnnotationRenderOptions()});\n            this.isReady = true;\n          });\n    }\n    this.tabs.default = 'annotations';\n  }\n\n  initializeAnnotationLayerViewTab(tab: AnnotationLayerView) {\n    const widget = tab.registerDisposer(new LayerReferenceWidget(this.linkedSegmentationLayer));\n    widget.element.insertBefore(\n        document.createTextNode('Linked segmentation: '), widget.element.firstChild);\n    tab.element.appendChild(widget.element);\n\n    {\n      const checkboxWidget = this.registerDisposer(\n          new TrackableBooleanCheckbox(tab.annotationLayer.filterBySegmentation));\n      const label = document.createElement('label');\n      label.textContent = 'Filter by segmentation: ';\n      label.appendChild(checkboxWidget.element);\n      tab.element.appendChild(label);\n      tab.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n          this.registerDisposer(makeDerivedWatchableValue(\n              v => v !== undefined, tab.annotationLayer.segmentationState)),\n          label));\n    }\n  }\n\n  toJSON() {\n    const x = super.toJSON();\n    x['type'] = 'annotation';\n    x[SOURCE_JSON_KEY] = this.sourceUrl;\n    if (this.sourceUrl === undefined) {\n      x[ANNOTATIONS_JSON_KEY] = this.localAnnotations.toJSON();\n      x[VOXEL_SIZE_JSON_KEY] = this.voxelSize.toJSON();\n    }\n    x[LINKED_SEGMENTATION_LAYER_JSON_KEY] = this.linkedSegmentationLayer.toJSON();\n    x[FILTER_BY_SEGMENTATION_JSON_KEY] = this.filterBySegmentation.toJSON();\n    return x;\n  }\n}\n\nregisterLayerType('annotation', AnnotationUserLayer);\nregisterLayerType('pointAnnotation', AnnotationUserLayer);\n"],"sourceRoot":""}